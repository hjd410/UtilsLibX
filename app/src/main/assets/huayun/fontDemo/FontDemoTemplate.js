//>>built
define("com/huayun/fontDemo/FontDemoTemplate","../webgis/Viewpoint ../webgis/Graphic ../webgis/Feature ../webgis/gl/Context ../webgis/symbols/FontSymbol ../webgis/geometry/Point ../webgis/renderer/FontRenderer".split(" "),function(f,g,h,k,l,m,n){function b(a){this.size=a.size;this.canvas=document.createElement("canvas");this.canvas.width=this.size.width;this.canvas.height=this.size.height;this.webglContext=this.canvas.getContext("webgl");this.webglContext.clearColor(0,0,0,1);this._initViewPoint();
this.graphicList=[];this.callBack=null}b.prototype._initViewPoint=function(){var a=new k(this.webglContext);this.view={width:this.size.width,height:this.size.height,resolution:1,scale:1,context:a,threeRender:function(){this.graphicList.forEach(function(a){var c=a.graphic;if(c.renderer){var d=a.canvas,e=d.getContext("2d");e.clearRect(0,0,d.width,d.height);this.webglContext.clear(this.webglContext.COLOR_BUFFER_BIT);c.renderer.draw(this.view,c,c.feature.geometry,c.symbol);e.drawImage(this.canvas,0,0);
this.callBack({canvas:d,container:a.container})}}.bind(this))}.bind(this)};a=new f(this.view.width,this.view.height,0,0,0,0,0,this.view);this.view.viewpoint=a;a.center=[.5*this.size.width,.5*this.size.height];a.resolution=1;a.calcMatrix(!1)};b.prototype.clear=function(){this.graphicList=[]};b.prototype.initFontSymbol=function(a,b){this.callBack=b;this.symbol=a.symbol;b=new m(.5*this.size.width,.5*this.size.height);var c=new l(this.symbol),d=new g({feature:new h({attributes:null,geometry:b}),symbol:c}),
e=document.createElement("canvas");e.setAttribute("id","canvas_"+(new Date).getTime());e.width=this.size.width;e.height=this.size.height;e.graphic=this.symbol.text;this.graphicList.push({graphic:d,canvas:e,container:a.container});a=new n;null!==a&&(a.add(this.view,d,b,c),d.renderer=a,this.view.threeRender())};return b});