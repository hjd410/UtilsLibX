//>>built
define("com/huayun/webgis/handler/ScrollZoomHandler",["../utils/utils"],function(){var _1=4.000244140625;var _2=1/100;var _3=1/450;var _4=2;function _5(_6){this.view=_6.view;this.enabled=_6.enabled===undefined?true:!!_6.enabled;this._lastWheelEventTime=0;this._type=null;this._delta=0;this._defaultZoomRate=_2;this._wheelZoomRate=_3;};_5.prototype.onWheel=function(e){if(!this.enabled){return;}var _7=e.deltaMode===WheelEvent.DOM_DELTA_LINE?e.deltaY*40:e.deltaY;var _8=utils.now(),_9=_8-this._lastWheelEventTime;this._lastWheelEventTime=_8;if(_7!==0&&(_7%_1)===0){this._type="wheel";}else{if(_7!==0&&Math.abs(_7)<4){this._type="trackpad";}else{if(_9>400){this._type=null;this._lastValue=_7;this._timeout=setTimeout(this._onTimeout,40,e);}else{if(!this._type){this._type=Math.abs(_9*_7)<200?"trackpad":"wheel";if(this._timeout){clearTimeout(this._timeout);this._timeout=null;_7+=this._lastValue;}}}}}if(e.shiftKey&&_7){_7=_7/4;}if(this._type){this._lastWheelEvent=e;this._delta-=_7;if(!this.active){this._start(e);}}e.preventDefault();};_5.prototype._onTimeout=function(_a){this._type="wheel";this._delta-=this._lastValue;if(!this.active){this._start(_a);}};_5.prototype._start=function _start(e){if(!this._delta){return;}if(this._frameId){this.view.cancelRenderFrame(this._frameId);this._frameId=null;}this.active=true;if(!this.isZooming){this.zooming=true;}if(this._finishTimeout){clearTimeout(this._finishTimeout);}var _b=e.clientX,_c=e.clientY;if(!this._frameId){this._frameId=this.view.requestRenderFrame(this._onScrollFrame);}};_5.prototype._onScrollFrame=function(){var _d=this;this._frameId=null;if(!this.active){return;}if(this._delta!==0){var _e=(this._type==="wheel"&&Math.abs(this._delta)>_1)?this._wheelZoomRate:this._defaultZoomRate;var _f=_4/(1+Math.exp(-Math.abs(this._delta*_e)));if(this._delta<0&&_f!==0){_f=1/_f;}}};return _5;});