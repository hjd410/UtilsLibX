//>>built
define("com/huayun/webgis/handler/PanHandler-Backup",["dojo/_base/declare","dojo/on"],function(_1,on){return _1("com.huayun.webgis.handler.PanHandler",[],{view:null,_mouseDown:false,_fromX:0,_fromY:0,_toX:0,_toY:0,mouseMove:null,mouseUp:null,panRaf:null,mapMouseClickTolerance:0,isPanning:false,isRotating:false,isSwitching:false,constructor:function(_2){this.view=_2;this._mouseDown=false;this.mapMouseClickTolerance=3;oncontextmenu=function(){return false;};this.panRaf=null;var _3=this;on(_2.domNode,"mousedown",function(e){if(e.button==0&&_2.panEnabled){_3._fromX=e.x;_3._fromY=e.y;_3._mouseDown=true;if(!_3.isPanning){_3._toX=e.x;_3._toY=e.y;}_3.mouseMove=on(document,"mousemove",function(e){_3.mouseMoveHandler(e);});_3.mouseUp=on(document,"mouseup",function(e){_3.mouseUpHandler(e);});_3.enterFrameHandler();}else{if(e.button==2&&_2.rotateEnabled){_3._fromX=e.x;_3._fromY=e.y;_3._mouseDown=true;if(!_3.isRotating||!_3.isSwitching){_3._toX=e.x;_3._toY=e.y;}_3.mouseMove=on(this,"mousemove",function(e){_3.rightMoveHandle(e);});_3.mouseUp=on(this,"mouseup",function(e){_3.rightUpHandle(e);});_3.enterFrameHandler2();}}});},rightMoveHandle:function(e){this._toX=e.x;this._toY=e.y;},rightUpHandle:function(e){if(this.isRotating){this.isRotating=false;this.view._stopMouseRotate();}if(this.isSwitching){this.isSwitching=false;this.view._stopSwitch();}this._mouseDown=false;this.mouseMove.remove();this.mouseUp.remove();this.view.handlePushViewState();window.cancelAnimationFrame(this.panRaf);},mouseMoveHandler:function(e){this._toX=e.x;this._toY=e.y;},mouseUpHandler:function(e){if(this.isPanning){this.isPanning=false;this.view.stopMove();}this._mouseDown=false;this.mouseMove.remove();this.mouseUp.remove();this.view.handlePushViewState();window.cancelAnimationFrame(this.panRaf);},enterFrameHandler:function(){if(!this._mouseDown){return;}var _4=this._toX-this._fromX,_5=this._toY-this._fromY;if(this.isPanning){if(Math.abs(_5)<5&&Math.abs(_4)<5){this.isPanning=false;this.view.stopMove();this._fromX=this._toX;this._fromY=this._toY;}else{this.isPanning=true;this.view.mapMove(_4,_5);this._fromX=this._toX;this._fromY=this._toY;}}else{if(Math.abs(_4)>=this.mapMouseClickTolerance||Math.abs(_5)>=this.mapMouseClickTolerance){this.isPanning=true;this._fromX=this._toX;this._fromY=this._toY;}}this.panRaf=window.requestAnimationFrame(this.enterFrameHandler.bind(this));},enterFrameHandler2:function(){if(!this._mouseDown){return;}var _6=this._toX-this._fromX,_7=this._toY-this._fromY;if(this.isRotating||this.isSwitching){if(Math.abs(_7)<5&&Math.abs(_6)<5){if(this.isSwitching){this.isSwitching=false;this.view._stopSwitch();this._fromX=this._toX;this._fromY=this._toY;}if(this.isRotating){this.isRotating=false;this.view._stopMouseRotate();this._fromX=this._toX;this._fromY=this._toY;}}else{if(Math.abs(_6)>Math.abs(_7)){this.isRotating=true;this.isSwitching=false;this.view._mouseRotate(_6);}else{this.isSwitching=true;this.isRotating=false;this.view._mouseSwitchDip(_7);}this._fromX=this._toX;this._fromY=this._toY;}}else{if(Math.abs(_6)>=this.mapMouseClickTolerance||Math.abs(_7)>=this.mapMouseClickTolerance){if(Math.abs(_6)>Math.abs(_7)){this.isRotating=true;this.isSwitching=false;}else{this.isSwitching=true;this.isRotating=false;}this._fromX=this._toX;this._fromY=this._toY;}}this.panRaf=window.requestAnimationFrame(this.enterFrameHandler2.bind(this));}});});