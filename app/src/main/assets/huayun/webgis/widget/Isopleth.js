//>>built
define("com/huayun/webgis/widget/Isopleth",["dojo/_base/declare","dojo/dom","dojo/on","dojo/dom-construct","dojo/dom-style","./MapModuleX"],function(_1,_2,on,_3,_4,_5){return _1("com.huayun.webgis.widget.Isopleth",[_5],{_map:null,_extent:null,_cellWidth:300,_pointGrid:null,_graphicSceneLayer:null,_lineMaterial:null,constructor:function(){this._lineMaterial=new THREE.LineBasicMaterial({color:16711935});},postCreate:function(){this.inherited(arguments);_4.set(this.domNode,"pointer-events","none");},doInit:function(){this._map=this.get("map");this._extent=[400,0,this._map.width,this._map.height];this._graphicSceneLayer=this._map.findLayerById("graphic");this._pointGrid=turf.pointGrid(this._extent,this._cellWidth,{units:"miles"});for(var i=0;i<this._pointGrid.features.length;i++){this._pointGrid.features[i].properties.temperature=Math.random()*10;}var _6=[0,1,2,3,4,5,6,7,8,9,10];var _7=turf.isolines(this._pointGrid,_6,{zProperty:"temperature"});var _8=_3.create("div",{innerHTML:"等值线",style:"position:absolute;left:200px;background:#eeff00;pointer-events:all"},this.domNode,"last");on(_8,"click",function(){this._drawLine(_7);}.bind(this));},_drawLine:function(_9){var _a=this._graphicSceneLayer.group.position;var _b=this._map.rotationAngela/180*Math.PI;_9.features.forEach(function(_c){_c.geometry.coordinates.forEach(function(_d){var _e=new THREE.Geometry();_d.forEach(function(_f){var _10=this._map.screenTo3dPoint(_f[0],_f[1]);_e.vertices.push(new THREE.Vector3(_10.x,_10.y,1));}.bind(this));var _11=new THREE.Line(_e,this._lineMaterial);_11.computeLineDistances();_11.position.set(-_a.x,-_a.y,0.1);_11.rotateZ(_b);this._graphicSceneLayer.group.add(_11);}.bind(this));}.bind(this));}});});