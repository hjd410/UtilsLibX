//>>built
require({cache:{"url:com/huayun/webgis/templates/searchs/reactionSearch.html":"<div class=\"${baseClass}\"  style=\"pointer-events: all;\">\r\n    <div id=\"showList\" class=\"listView\" >\r\n        <span class=\"devTip\">设备列表</span>\r\n        <div class=\"first\">\r\n            <ul id=\"devList\" class=\"devView\" data-dojo-attach-event=\"onclick:isMessage\"></ul>\r\n        </div>\r\n    </div>\r\n    <div id=\"devMoreInfo\" class=\"infoView\">\r\n        <span class=\"infoTip\">设备详情列表</span>\r\n        <div class=\"end\">\r\n            <table id=\"moreInfoList\" class=\"infoTableView\"></table>\r\n        </div>\r\n        <button id=\"closeShow\" class=\"closeShow\" data-dojo-attach-event=\"onclick:closeMoreInfo\">关闭</button>\r\n    </div>\r\n</div>"}});define("com/huayun/webgis/widget/searchs/ReactionSearch",["dojo/_base/declare","dojo/dom","dojo/on","dojo/query","dojo/dom-style","dojo/dom-construct","dojo/topic","../MapModuleX","../../Feature","../../Graphic","../../geometry/Point","../../geometry/Polyline","../../geometry/Multipoint","../../geometry/Polygon","../../symbols/PointSymbol","../../symbols/LineSymbol","../../symbols/PolygonSymbol","dojo/text!../../templates/searchs/reactionSearch.html"],function(_1,_2,on,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11){return _1("com.huayun.webgis.widget.searchs.ReactionSearch",[_7],{baseClass:"reactionSearch",templateString:_11,constructor:function(){this.dataList=null;this.point=null;this.map=null;this.view=null;},doInit:function(){var _12=_2.byId("showList");this.map=this.get("map");this.view=this.get("view");_6.subscribe("showDevInfo",function(_13,e){this.dataList=_13;this.point=e;this.showDev();_12.style.display="block";_12.style.left=e.clientX+"px";_12.style.top=e.clientY+"px";}.bind(this));_6.subscribe("closeDevInfo",function(){_12.style.display="none";devMoreInfo.style.display="none";}.bind(this));},showDev:function(){var _14=_2.byId("devList");var _15=_2.byId("moreInfoList");devMoreInfo.style.display="none";_5.empty(_15);_5.empty(_14);for(var i=0;i<this.dataList.length;i++){var _16=this.dataList[i];var li=_5.create("li",{index:i,className:"showLi"},_14);var div=_5.create("div",{index:i,className:"message",innerHTML:(i+1)+"."+_16.attributes.NAME+"---"+_16.layerName},li);var btn=_5.create("button",{index:i,className:"locationBtn",innerHTML:"定位"},li);}},isMessage:function(e){if(e.target.className==="message"){this.showMoreInfo(e);}else{this.mscLocation(e);}},mscLocation:function(e){var _17=e.target.getAttribute("index");var _18=this.dataList[_17].geometry;var _19=this.dataList[_17].geometryType;var _1a=this.map.findLayerById("drawLayer");var _1b=new _e({color:"#FFFF00",radious:5,strokeColor:"#0000FF",strokeWidth:1});var _1c=new _f({color:"#ff2f39",width:3});var _1d=new _10({color:"#0FF",opacity:0.5});switch(_19){case "esriGeometryPoint":var _1e=new _a(_18.x,_18.y);this.addgraphic(_1a,_1e,_1b);break;case "esriGeometryMultipoint":var _1f=_18.points.map(function(_20){return new _a(_20[0],_20[1]);});var _21=new _c(_1f);this.addgraphic(_1a,_21,_1b);break;case "esriGeometryPolyline":var _22=_18.paths.map(function(_23){return _23.map(function(p){return new _a(p[0],p[1]);});});var _24=new _b(_22);this.addgraphic(_1a,_24,_1c);break;default:var _25=_18.rings.map(function(_26){return _26.map(function(p){return new _a(p[0],p[1]);});});var _27=new _d(_25);this.addgraphic(_1a,_27,_1d);}},addgraphic:function(_28,_29,_2a){var _2b=new _8({attributes:null,geometry:_29});var _2c=new _9({feature:_2b,symbol:_2a});_28.addGraphic(_2c);this.view.threeRender();},showMoreInfo:function(e){var _2d=_2.byId("devMoreInfo");var _2e=e.target.getAttribute("index");var _2f=this.dataList[_2e].attributes;_2d.style.display="block";_2d.style.zIndex="500";_5.empty(moreInfoList);this.createTable(_2f);},closeMoreInfo:function(){devMoreInfo.style.display="none";},createTable:function(_30){for(key in _30){if(key!=="SHAPE"&&key!=="SUBGEOREGION"){var _31=_5.create("tr",{className:"attrTr"},moreInfoList);var _32=_5.create("td",{className:"td1",noWrap:"false",innerHTML:key},_31);var _33=_5.create("td",{className:"td2",noWrap:"false",innerHTML:_30[key]},_31);}}}});});