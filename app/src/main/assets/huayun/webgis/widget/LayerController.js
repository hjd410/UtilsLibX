//>>built
define("com/huayun/webgis/widget/LayerController",["dojo/_base/declare","dojo/topic","dojo/dom-construct","../../util/HashTable","./MapModuleX"],function(_1,_2,_3,_4,_5){return _1("com.huayun.webgis.widget.LayerController",[_5],{name:"",baseClass:"layer-controller",backgroundColor:"",width:400,height:"100%",_inputDomHash:null,constructor:function(){_2.subscribe("tabChange",this._tabChangeHandler.bind(this));_2.subscribe("gridLayerControlChange",this._gridLayerControlChangeHandler.bind(this));this._inputDomHash=new _4();},doInit:function(_6){this.map=this.get("map");var _7=this.map.findAllLayers();if(_7.length>0){this._addLayerItem(_7);}else{_2.subscribe("layerComplete",function(){var _8=this.map.findAllLayers();this._addLayerItem(_8);}.bind(this));}},_addLayerItem:function(_9){var _a;for(var i=_9.length-1;i>-1;i--){_a=_9[i];if(_a.controlEnabled){var _b=_3.create("div",{innerHTML:_a.name,style:{"padding":"6px 12px","background-color":"rgba(255, 255, 255, 1)","color":"#333"}},this.domNode,"last");var _c=_3.create("input",{type:"checkbox",value:_a.id,checked:_a.visible,onchange:this.visibleSwitch.bind(this)},_b,"first");this._inputDomHash.put(_a.id,_c);}}},visibleSwitch:function(e){e.preventDefault();e.stopPropagation();var id=e.target.value,_d=e.target.checked;this.map.findLayerById(id).setVisible(_d);if(id==="power"){_2.publish("layerControllerGridChange",_d);}},_tabChangeHandler:function(_e){var _f=this._inputDomHash.get("power");_f.checked=this.map.findLayerById("power").visible;},_gridLayerControlChangeHandler:function(_10){var dom=this._inputDomHash.get("power");dom.checked=_10;}});});