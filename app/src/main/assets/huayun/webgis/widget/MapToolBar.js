//>>built
require({cache:{"url:com/huayun/webgis/templates/mapToolBar.html":"<div class=\"${baseClass}\" data-dojo-attach-event=\"onclick:onChange\">\r\n\r\n</div>"}});define("com/huayun/webgis/widget/MapToolBar",["dojo/_base/declare","dojo/dom-style","dojo/dom-class","dojo/topic","dojo/query","./components/buttons/Button","./components/buttons/SelectedButton","./components/buttons/DropDownButton","./MapModuleX","../action/ActionManager","dojo/text!../templates/mapToolBar.html"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b){_4.subscribe("mapSwitchDimension",function(d){if(d===2){_3.remove(_5(".map-switch-view")[0],"map-state-3D");_3.add(_5(".map-switch-view")[0],"map-state-2D");}else{if(d===3){_3.remove(_5(".map-switch-view")[0],"map-state-2D");_3.add(_5(".map-switch-view")[0],"map-state-3D");}}});return _1("com.huayun.webgis.widget.MapToolBar",[_9],{templateString:_b,baseClass:"map-tool-bar",constructor:function(){this.buttonList=[];this.gap=0;this.id="";this.layout="vertical";this.map=null;this.view=null;this._currentDropBtn=null;this._currentDropId="";this._lastDropId="";_4.subscribe("mapOnClick",function(){if(this._currentDropBtn!==null){this._currentDropBtn.invalid();}}.bind(this));_4.subscribe("onMapToolBarChange",function(_c){if(this._currentDropBtn!==null){this._currentDropBtn.invalid();}}.bind(this));},postCreate:function(){this.inherited(arguments);_2.set(this.domNode,"pointer-events","all");},doInit:function(){this.view=this.get("view");var _d=this.get("configData");this.buttonList=_d.buttons;this._layoutMethod(_d.layout);for(var i=0;i<this.buttonList.length;i++){var _e=this.buttonList[i];switch(_e.type.toLowerCase()){case "normal":this._createNormalButton(_e);break;case "selected":this._createSelectedButton(_e);break;case "drop-down":this._createDropDownButton(_e);break;default:break;}}},onChange:function(_f){},_layoutMethod:function(_10){_3.add(this.domNode,_10);},_createNormalButton:function(_11){_11.showLabel=false;_11.label=_11["tool-tip"];var btn=new _6(_11);if(_11.action==="SwitchViewAction"){if(this.view.is3DVision){_3.add(btn.iconNode,"map-state-3D");}else{_3.add(btn.iconNode,"map-state-2D");}}btn.placeAt(this.domNode);btn.onClickFun=this._normalButtonClick.bind(this,{target:btn,params:_11});},_createSelectedButton:function(_12){_12.iconClass=_12.id;_12.showLabel=false;_12.label=_12["tool-tip"];var btn=new _7(_12);btn.placeAt(this.domNode);btn.onClickFun=this._dropButtonSelected.bind(this,{target:btn,params:_12});},_createDropDownButton:function(_13){var btn=new _8(_13);btn.placeAt(this.domNode);btn.onSelected=this._dropButtonSelected.bind(this);btn.onClickFun=this._dropDownButtonClick.bind(this,{target:btn,params:_13});},_dropButtonSelected:function(_14){_14.params.view=this.view;var _15=_a.getInstance().createAction(_14.params);if(_15!==null){if(_15.isActive){var _16=_a.getInstance().getCurrentAction();_a.getInstance().invalidAction(_16);_a.getInstance().activeAction(_15);_15.endActionMethod=this._endActionMethod.bind(this,_15);}else{this._normalButtonClick({target:_14.target,params:_14.params});}}},_dropDownButtonClick:function(_17){_3.remove(this.view.domNode,"draw-cursor-style");_4.publish("onDropDownChange",_17);if(this._lastDropId===""){this._currentDropBtn=_17.target;this._currentDropId=this._currentDropBtn.id;this._lastDropId=this._currentDropId;}else{if(this._lastDropId!==_17.target.id){this._currentDropBtn.invalid();this._currentDropBtn=_17.target;this._lastDropId=_17.target.id;}}var _18=_a.getInstance().getCurrentAction();if(_18!==null){_a.getInstance().invalidAction(_18);}},_normalButtonClick:function(_19){_4.publish("onMapToolBarChange",_19);_19.params.view=this.view;var _1a=_a.getInstance().createAction(_19.params);var _1b=_a.getInstance().getCurrentAction();if(_1a&&_1b&&_1a.isActive){_a.getInstance().invalidAction(_1b);}if(_1a!==null){_1a.endActionMethod=this._endActionMethod.bind(this,{target:_19.target,currentAction:_1a});_a.getInstance().doAction(_1a);}},_endActionMethod:function(_1c){}});});