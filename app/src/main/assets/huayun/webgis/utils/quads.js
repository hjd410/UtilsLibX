//>>built
define("com/huayun/webgis/utils/quads",["exports","./parseGlyphPbf","../geometry/Point"],function(_1,_2,_3){function _4(_5,_6,_7,_8,_9,_a,_b){var _c=_8.layout.get("text-rotate").evaluate(_a,{})*Math.PI/180;var _d=_6.positionedGlyphs;var _e=[];for(var k=0;k<_d.length;k++){var _f=_d[k];var _10=_b[_f.fontStack];var _11=_10&&_10[_f.glyph];if(!_11){continue;}var _12=_11.rect;if(!_12){continue;}var _13=1;var _14=_2.GLYPH_PBF_BORDER+_13;var _15=_11.metrics.advance*_f.scale/2;var _16=_9?[_f.x+_15,_f.y]:[0,0];var _17=_9?[0,0]:[_f.x+_15+_7[0],_f.y+_7[1]];var x1=(_11.metrics.left-_14)*_f.scale-_15+_17[0];var y1=(-_11.metrics.top-_14)*_f.scale+_17[1];var x2=x1+_12.w*_f.scale;var y2=y1+_12.h*_f.scale;var tl=new _3(x1,y1);var tr=new _3(x2,y1);var bl=new _3(x1,y2);var br=new _3(x2,y2);if(_9&&_f.vertical){var _18=new _3(-_15,_15);var _19=-Math.PI/2;var _1a=new _3(5,0);tl._rotateAround(_19,_18)._add(_1a);tr._rotateAround(_19,_18)._add(_1a);bl._rotateAround(_19,_18)._add(_1a);br._rotateAround(_19,_18)._add(_1a);}if(_c){var sin=Math.sin(_c),cos=Math.cos(_c),_1b=[cos,-sin,sin,cos];tl._matMult(_1b);tr._matMult(_1b);bl._matMult(_1b);br._matMult(_1b);}_e.push({tl:tl,tr:tr,bl:bl,br:br,tex:_12,writingMode:_6.writingMode,glyphOffset:_16});}return _e;};function _1c(_1d,_1e,_1f,_20,_21,_22){var _23=_1e.image;var _24=_1f.layout;var _25=1;var top=_1e.top-_25/_23.pixelRatio;var _26=_1e.left-_25/_23.pixelRatio;var _27=_1e.bottom+_25/_23.pixelRatio;var _28=_1e.right+_25/_23.pixelRatio;var tl,tr,br,bl;if(_24.get("icon-text-fit")!=="none"&&_21){var _29=(_28-_26),_2a=(_27-top),_2b=_24.get("text-size").evaluate(_22,{})/24,_2c=_21.left*_2b,_2d=_21.right*_2b,_2e=_21.top*_2b,_2f=_21.bottom*_2b,_30=_2d-_2c,_31=_2f-_2e,_32=_24.get("icon-text-fit-padding")[0],_33=_24.get("icon-text-fit-padding")[1],_34=_24.get("icon-text-fit-padding")[2],_35=_24.get("icon-text-fit-padding")[3],_36=_24.get("icon-text-fit")==="width"?(_31-_2a)*0.5:0,_37=_24.get("icon-text-fit")==="height"?(_30-_29)*0.5:0,_38=_24.get("icon-text-fit")==="width"||_24.get("icon-text-fit")==="both"?_30:_29,_39=_24.get("icon-text-fit")==="height"||_24.get("icon-text-fit")==="both"?_31:_2a;tl=new _3(_2c+_37-_35,_2e+_36-_32);tr=new _3(_2c+_37+_33+_38,_2e+_36-_32);br=new _3(_2c+_37+_33+_38,_2e+_36+_34+_39);bl=new _3(_2c+_37-_35,_2e+_36+_34+_39);}else{tl=new _3(_26,top);tr=new _3(_28,top);br=new _3(_28,_27);bl=new _3(_26,_27);}var _3a=_1f.layout.get("icon-rotate").evaluate(_22,{})*Math.PI/180;if(_3a){var sin=Math.sin(_3a),cos=Math.cos(_3a),_3b=[cos,-sin,sin,cos];tl._matMult(_3b);tr._matMult(_3b);bl._matMult(_3b);br._matMult(_3b);}return [{tl:tl,tr:tr,bl:bl,br:br,tex:_23.paddedRect,writingMode:undefined,glyphOffset:[0,0]}];};_1.getGlyphQuads=_4;_1.getIconQuads=_1c;});