//>>built
define("com/huayun/webgis/utils/earcut",["exports"],function(_1){function _2(_3,_4,_5){_5=_5||2;var _6=_4&&_4.length,_7=_6?_4[0]*_5:_3.length,_8=_9(_3,0,_7,_5,true),_a=[];if(!_8||_8.next===_8.prev){return _a;}var _b,_c,_d,_e,x,y,_f;if(_6){_8=_10(_3,_4,_8,_5);}if(_3.length>80*_5){_b=_d=_3[0];_c=_e=_3[1];for(var i=_5;i<_7;i+=_5){x=_3[i];y=_3[i+1];if(x<_b){_b=x;}if(y<_c){_c=y;}if(x>_d){_d=x;}if(y>_e){_e=y;}}_f=Math.max(_d-_b,_e-_c);_f=_f!==0?1/_f:0;}_11(_8,_a,_5,_b,_c,_f);return _a;};function _9(_12,_13,end,dim,_14){var i,_15;if(_14===(_16(_12,_13,end,dim)>0)){for(i=_13;i<end;i+=dim){_15=_17(i,_12[i],_12[i+1],_15);}}else{for(i=end-dim;i>=_13;i-=dim){_15=_17(i,_12[i],_12[i+1],_15);}}if(_15&&_18(_15,_15.next)){_19(_15);_15=_15.next;}return _15;};function _1a(_1b,end){if(!_1b){return _1b;}if(!end){end=_1b;}var p=_1b,_1c;do{_1c=false;if(!p.steiner&&(_18(p,p.next)||_1d(p.prev,p,p.next)===0)){_19(p);p=end=p.prev;if(p===p.next){break;}_1c=true;}else{p=p.next;}}while(_1c||p!==end);return end;};function _11(ear,_1e,dim,_1f,_20,_21,_22){if(!ear){return;}if(!_22&&_21){_23(ear,_1f,_20,_21);}var _24=ear,_25,_26;while(ear.prev!==ear.next){_25=ear.prev;_26=ear.next;if(_21?_27(ear,_1f,_20,_21):_28(ear)){_1e.push(_25.i/dim);_1e.push(ear.i/dim);_1e.push(_26.i/dim);_19(ear);ear=_26.next;_24=_26.next;continue;}ear=_26;if(ear===_24){if(!_22){_11(_1a(ear),_1e,dim,_1f,_20,_21,1);}else{if(_22===1){ear=_29(ear,_1e,dim);_11(ear,_1e,dim,_1f,_20,_21,2);}else{if(_22===2){_2a(ear,_1e,dim,_1f,_20,_21);}}}break;}}};function _28(ear){var a=ear.prev,b=ear,c=ear.next;if(_1d(a,b,c)>=0){return false;}var p=ear.next.next;while(p!==ear.prev){if(_2b(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&_1d(p.prev,p,p.next)>=0){return false;}p=p.next;}return true;};function _27(ear,_2c,_2d,_2e){var a=ear.prev,b=ear,c=ear.next;if(_1d(a,b,c)>=0){return false;}var _2f=a.x<b.x?(a.x<c.x?a.x:c.x):(b.x<c.x?b.x:c.x),_30=a.y<b.y?(a.y<c.y?a.y:c.y):(b.y<c.y?b.y:c.y),_31=a.x>b.x?(a.x>c.x?a.x:c.x):(b.x>c.x?b.x:c.x),_32=a.y>b.y?(a.y>c.y?a.y:c.y):(b.y>c.y?b.y:c.y);var _33=_34(_2f,_30,_2c,_2d,_2e),_35=_34(_31,_32,_2c,_2d,_2e);var p=ear.prevZ,n=ear.nextZ;while(p&&p.z>=_33&&n&&n.z<=_35){if(p!==ear.prev&&p!==ear.next&&_2b(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&_1d(p.prev,p,p.next)>=0){return false;}p=p.prevZ;if(n!==ear.prev&&n!==ear.next&&_2b(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&_1d(n.prev,n,n.next)>=0){return false;}n=n.nextZ;}while(p&&p.z>=_33){if(p!==ear.prev&&p!==ear.next&&_2b(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&_1d(p.prev,p,p.next)>=0){return false;}p=p.prevZ;}while(n&&n.z<=_35){if(n!==ear.prev&&n!==ear.next&&_2b(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&_1d(n.prev,n,n.next)>=0){return false;}n=n.nextZ;}return true;};function _29(_36,_37,dim){var p=_36;do{var a=p.prev,b=p.next.next;if(!_18(a,b)&&_38(a,p,p.next,b)&&_39(a,b)&&_39(b,a)){_37.push(a.i/dim);_37.push(p.i/dim);_37.push(b.i/dim);_19(p);_19(p.next);p=_36=b;}p=p.next;}while(p!==_36);return p;};function _2a(_3a,_3b,dim,_3c,_3d,_3e){var a=_3a;do{var b=a.next.next;while(b!==a.prev){if(a.i!==b.i&&_3f(a,b)){var c=_40(a,b);a=_1a(a,a.next);c=_1a(c,c.next);_11(a,_3b,dim,_3c,_3d,_3e);_11(c,_3b,dim,_3c,_3d,_3e);return;}b=b.next;}a=a.next;}while(a!==_3a);};function _10(_41,_42,_43,dim){var _44=[],i,len,_45,end,_46;for(i=0,len=_42.length;i<len;i++){_45=_42[i]*dim;end=i<len-1?_42[i+1]*dim:_41.length;_46=_9(_41,_45,end,dim,false);if(_46===_46.next){_46.steiner=true;}_44.push(_47(_46));}_44.sort(_48);for(i=0;i<_44.length;i++){_49(_44[i],_43);_43=_1a(_43,_43.next);}return _43;};function _48(a,b){return a.x-b.x;};function _49(_4a,_4b){_4b=_4c(_4a,_4b);if(_4b){var b=_40(_4b,_4a);_1a(b,b.next);}};function _4c(_4d,_4e){var p=_4e,hx=_4d.x,hy=_4d.y,qx=-Infinity,m;do{if(hy<=p.y&&hy>=p.next.y&&p.next.y!==p.y){var x=p.x+(hy-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(x<=hx&&x>qx){qx=x;if(x===hx){if(hy===p.y){return p;}if(hy===p.next.y){return p.next;}}m=p.x<p.next.x?p:p.next;}}p=p.next;}while(p!==_4e);if(!m){return null;}if(hx===qx){return m.prev;}var _4f=m,mx=m.x,my=m.y,_50=Infinity,tan;p=m.next;while(p!==_4f){if(hx>=p.x&&p.x>=mx&&hx!==p.x&&_2b(hy<my?hx:qx,hy,mx,my,hy<my?qx:hx,hy,p.x,p.y)){tan=Math.abs(hy-p.y)/(hx-p.x);if((tan<_50||(tan===_50&&p.x>m.x))&&_39(p,_4d)){m=p;_50=tan;}}p=p.next;}return m;};function _23(_51,_52,_53,_54){var p=_51;do{if(p.z===null){p.z=_34(p.x,p.y,_52,_53,_54);}p.prevZ=p.prev;p.nextZ=p.next;p=p.next;}while(p!==_51);p.prevZ.nextZ=null;p.prevZ=null;_55(p);};function _55(_56){var i,p,q,e,_57,_58,_59,_5a,_5b=1;do{p=_56;_56=null;_57=null;_58=0;while(p){_58++;q=p;_59=0;for(i=0;i<_5b;i++){_59++;q=q.nextZ;if(!q){break;}}_5a=_5b;while(_59>0||(_5a>0&&q)){if(_59!==0&&(_5a===0||!q||p.z<=q.z)){e=p;p=p.nextZ;_59--;}else{e=q;q=q.nextZ;_5a--;}if(_57){_57.nextZ=e;}else{_56=e;}e.prevZ=_57;_57=e;}p=q;}_57.nextZ=null;_5b*=2;}while(_58>1);return _56;};function _34(x,y,_5c,_5d,_5e){x=32767*(x-_5c)*_5e;y=32767*(y-_5d)*_5e;x=(x|(x<<8))&16711935;x=(x|(x<<4))&252645135;x=(x|(x<<2))&858993459;x=(x|(x<<1))&1431655765;y=(y|(y<<8))&16711935;y=(y|(y<<4))&252645135;y=(y|(y<<2))&858993459;y=(y|(y<<1))&1431655765;return x|(y<<1);};function _47(_5f){var p=_5f,_60=_5f;do{if(p.x<_60.x||(p.x===_60.x&&p.y<_60.y)){_60=p;}p=p.next;}while(p!==_5f);return _60;};function _2b(ax,ay,bx,by,cx,cy,px,py){return (cx-px)*(ay-py)-(ax-px)*(cy-py)>=0&&(ax-px)*(by-py)-(bx-px)*(ay-py)>=0&&(bx-px)*(cy-py)-(cx-px)*(by-py)>=0;};function _3f(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!_61(a,b)&&_39(a,b)&&_39(b,a)&&_62(a,b);};function _1d(p,q,r){return (q.y-p.y)*(r.x-q.x)-(q.x-p.x)*(r.y-q.y);};function _18(p1,p2){return p1.x===p2.x&&p1.y===p2.y;};function _38(p1,q1,p2,q2){if((_18(p1,q1)&&_18(p2,q2))||(_18(p1,q2)&&_18(p2,q1))){return true;}return _1d(p1,q1,p2)>0!==_1d(p1,q1,q2)>0&&_1d(p2,q2,p1)>0!==_1d(p2,q2,q1)>0;};function _61(a,b){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==b.i&&p.next.i!==b.i&&_38(p,p.next,a,b)){return true;}p=p.next;}while(p!==a);return false;};function _39(a,b){return _1d(a.prev,a,a.next)<0?_1d(a,b,a.next)>=0&&_1d(a,a.prev,b)>=0:_1d(a,b,a.prev)<0||_1d(a,a.next,b)<0;};function _62(a,b){var p=a,_63=false,px=(a.x+b.x)/2,py=(a.y+b.y)/2;do{if(((p.y>py)!==(p.next.y>py))&&p.next.y!==p.y&&(px<(p.next.x-p.x)*(py-p.y)/(p.next.y-p.y)+p.x)){_63=!_63;}p=p.next;}while(p!==a);return _63;};function _40(a,b){var a2=new _64(a.i,a.x,a.y),b2=new _64(b.i,b.x,b.y),an=a.next,bp=b.prev;a.next=b;b.prev=a;a2.next=an;an.prev=a2;b2.next=a2;a2.prev=b2;bp.next=b2;b2.prev=bp;return b2;};function _17(i,x,y,_65){var p=new _64(i,x,y);if(!_65){p.prev=p;p.next=p;}else{p.next=_65.next;p.prev=_65;_65.next.prev=p;_65.next=p;}return p;};function _19(p){p.next.prev=p.prev;p.prev.next=p.next;if(p.prevZ){p.prevZ.nextZ=p.nextZ;}if(p.nextZ){p.nextZ.prevZ=p.prevZ;}};function _64(i,x,y){this.i=i;this.x=x;this.y=y;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false;};_2.deviation=function(_66,_67,dim,_68){var _69=_67&&_67.length;var _6a=_69?_67[0]*dim:_66.length;var _6b=Math.abs(_16(_66,0,_6a,dim));if(_69){for(var i=0,len=_67.length;i<len;i++){var _6c=_67[i]*dim;var end=i<len-1?_67[i+1]*dim:_66.length;_6b-=Math.abs(_16(_66,_6c,end,dim));}}var _6d=0;for(i=0;i<_68.length;i+=3){var a=_68[i]*dim;var b=_68[i+1]*dim;var c=_68[i+2]*dim;_6d+=Math.abs((_66[a]-_66[c])*(_66[b+1]-_66[a+1])-(_66[a]-_66[b])*(_66[c+1]-_66[a+1]));}return _6b===0&&_6d===0?0:Math.abs((_6d-_6b)/_6b);};function _16(_6e,_6f,end,dim){var sum=0;for(var i=_6f,j=end-dim;i<end;i+=dim){sum+=(_6e[j]-_6e[i])*(_6e[i+1]+_6e[j+1]);j=i;}return sum;};_2.flatten=function(_70){var dim=_70[0][0].length,_71={vertices:[],holes:[],dimensions:dim},_72=0;for(var i=0;i<_70.length;i++){for(var j=0;j<_70[i].length;j++){for(var d=0;d<dim;d++){_71.vertices.push(_70[i][j][d]);}}if(i>0){_72+=_70[i-1].length;_71.holes.push(_72);}}return _71;};_1.earcut=_2;});