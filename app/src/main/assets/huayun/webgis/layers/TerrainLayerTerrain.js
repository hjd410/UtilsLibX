//>>built
define("com/huayun/webgis/layers/TerrainLayerTerrain",["dojo/topic","./Layer","../views/3d/layers/TerrainLayerView3D","../geometry/Extent","../geometry/Point","./support/TerrainSourceCache","./support/LOD","./support/TileInfo","com/huayun/facades/TileInfoFacade"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9){var _a=function(_b){this.id=_b.id;this.loaded=false;this.url=_b.url;this.tileInfo=null;this.layerView=null;this.type="Tile";};if(_2){_a.__proto__=_2;}_a.prototype=Object.create(_2&&_2.prototype);_a.prototype.constructor=_a;_a.prototype._load=function(_c){var id="terrain";var _d={"tiles":this.format?this.url+this.format:this.url,"tileSize":256};var _e="../config/MapServer-4326.json";this.sourceCache=new _6(id,_d,_c.width,_c.height,this.url,this,_c);new _9().getTileInfoData(_e,function(_f){var _10=_f.tileInfo;var _11=_10.origin;_11=new _5(_11.x,_11.y);var _12=[];_f.lods.forEach(function(_13){_12.push(new _7({level:_13.level,scale:_13.scale,resolution:_13.resolution}));});var _14=_f.fullExtent;var _15=new _4(Number(_14.xmin),Number(_14.ymin),Number(_14.xmax),Number(_14.ymax));this.tileInfo=new _8({lods:_12,origin:_11,size:_10.cols,fullExtent:_15});_1.publish("tileInfoComplete",this.tileInfo,this.layerView.view.id);}.bind(this));};_a.prototype.createLayerView=function(_16,_17){var _18=new _3({visible:this.visible,view:_16,id:this.id,layer:this});this._load(_16);this.layerView=_18;_18.transform=_16.viewpoint;return _18;};return _a;});