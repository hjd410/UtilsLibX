//>>built
define("com/huayun/webgis/layers/support/TileCache",[],function(){var _1=function _1(_2,_3){this.max=_2;this.onRemove=_3;this.reset();};_1.prototype.reset=function reset(){for(var _4 in this.data){for(var i=0,_5=this.data[_4];i<_5.length;i+=1){var _6=_5[i];if(_6.timeout){clearTimeout(_6.timeout);}this.onRemove(_6.value);}}this.data={};this.order=[];return this;};_1.prototype.add=function add(_7,_8,_9){var _a=this;var _b=_7.wrapped().key;if(this.data[_b]===undefined){this.data[_b]=[];}var _c={value:_8,timeout:undefined};if(_9!==undefined){_c.timeout=setTimeout(function(){_a.remove(_7,_c);},_9);}this.data[_b].push(_c);this.order.push(_b);if(this.order.length>this.max){var _d=this._getAndRemoveByKey(this.order[0]);if(_d){this.onRemove(_d);}}return this;};_1.prototype.has=function has(_e){return _e.wrapped().key in this.data;};_1.prototype.getAndRemove=function getAndRemove(_f){if(!this.has(_f)){return null;}return this._getAndRemoveByKey(_f.wrapped().key);};_1.prototype._getAndRemoveByKey=function _getAndRemoveByKey(key){var _10=this.data[key].shift();if(_10.timeout){clearTimeout(_10.timeout);}if(this.data[key].length===0){delete this.data[key];}this.order.splice(this.order.indexOf(key),1);return _10.value;};_1.prototype.get=function get(_11){if(!this.has(_11)){return null;}var _12=this.data[_11.wrapped().key][0];return _12.value;};_1.prototype.remove=function remove(_13,_14){if(!this.has(_13)){return this;}var key=_13.wrapped().key;var _15=_14===undefined?0:this.data[key].indexOf(_14);var _16=this.data[key][_15];this.data[key].splice(_15,1);if(_16.timeout){clearTimeout(_16.timeout);}if(this.data[key].length===0){delete this.data[key];}this.onRemove(_16.value);this.order.splice(this.order.indexOf(key),1);return this;};_1.prototype.setMaxSize=function setMaxSize(max){this.max=max;while(this.order.length>this.max){var _17=this._getAndRemoveByKey(this.order[0]);if(_17){this.onRemove(_17);}}return this;};return _1;});