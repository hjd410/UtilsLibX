//>>built
define("com/huayun/webgis/layers/support/RasterTileSource",["../../facade/TileFacade","../../gl/Texture"],function(_1,_2){function _3(id,_4,_5,_6){this.id=id;this.type="raster";this.minzoom=_4.minzoom;this.maxzoom=_4.maxzoom;this.roundZoom=true;this.scheme="xyz";this.tileSize=_4.tileSize||256;this.url=_5;this.layer=_6;};_3.prototype.hasTile=function hasTile(_7){};_3.prototype.updateTileUrl=function(_8){this.url=_8;};_3.prototype.loadTile=function loadTile(_9,_a){var _b=this;var _c=_9.tileID.canonical.url([this.url]);_9.request=_1.loadTile(_c,function(_d,_e){delete _9.request;if(_9.aborted){_9.state="unloaded";_a(null);}else{if(_d){_9.state="errored";_a(_d);}else{if(_e){var _f=_b.layer.layerView.view.context;var gl=_f.gl;_9.texture=_b.layer.layerView.getTileTexture(_e.width);if(_9.texture){_9.texture.update(_e,{useMipmap:true});}else{_9.texture=new _2(_f,_e,gl.RGBA,{useMipmap:true});_9.texture.bind(gl.LINEAR,gl.CLAMP_TO_EDGE,gl.LINEAR_MIPMAP_NEAREST);if(_f.extTextureFilterAnisotropic){gl.texParameterf(gl.TEXTURE_2D,_f.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,_f.extTextureFilterAnisotropicMax);}}_9.state="loaded";_a(null);}}}});};_3.prototype.abortTile=function abortTile(_10,_11){if(_10.request){_10.request.cancel();delete _10.request;}_11();};_3.prototype.unloadTile=function unloadTile(_12,_13){if(_12.texture){this.layer.layerView.saveTileTexture(_12.texture);}_13();};_3.prototype.hasTransition=function hasTransition(){return false;};return _3;});