//>>built
define("com/huayun/webgis/layers/support/style/LineStyleLayer",["./StyleLayer","./Properties","./DataConstantProperty","./DataDrivenProperty","./CrossFadedProperty","./CrossFadedDataDrivenProperty","./ColorRampProperty","./spec","./EvaluationParameters","../../../data/bucket/LineBucket","../../../geometry/Point","./styleUtils","../../../utils/image","../../../utils/utils","../../../geometry/intersection_tests"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f){function _10(_11,_12){if(_12>0){return _12+2*_11;}else{return _11;}};function _13(_14,_15){var _16=[];var _17=new _b(0,0);for(var k=0;k<_14.length;k++){var _18=_14[k];var _19=[];for(var i=0;i<_18.length;i++){var a=_18[i-1];var b=_18[i];var c=_18[i+1];var _1a=i===0?_17:b.sub(a)._unit()._perp();var _1b=i===_18.length-1?_17:c.sub(b)._unit()._perp();var _1c=_1a._add(_1b)._unit();var _1d=_1c.x*_1b.x+_1c.y*_1b.y;_1c._mult(1/_1d);_19.push(_1c._mult(_15)._add(b));}_16.push(_19);}return _16;};var _1e=new _2({"line-cap":new _3(_8["layout_line"]["line-cap"]),"line-join":new _4(_8["layout_line"]["line-join"]),"line-miter-limit":new _3(_8["layout_line"]["line-miter-limit"]),"line-round-limit":new _3(_8["layout_line"]["line-round-limit"])});var _1f=new _2({"line-opacity":new _4(_8["paint_line"]["line-opacity"]),"line-color":new _4(_8["paint_line"]["line-color"]),"line-translate":new _3(_8["paint_line"]["line-translate"]),"line-translate-anchor":new _3(_8["paint_line"]["line-translate-anchor"]),"line-width":new _4(_8["paint_line"]["line-width"]),"line-gap-width":new _4(_8["paint_line"]["line-gap-width"]),"line-offset":new _4(_8["paint_line"]["line-offset"]),"line-blur":new _4(_8["paint_line"]["line-blur"]),"line-dasharray":new _5(_8["paint_line"]["line-dasharray"]),"line-pattern":new _6(_8["paint_line"]["line-pattern"]),"line-gradient":new _7(_8["paint_line"]["line-gradient"])});var _20={paint:_1f,layout:_1e};var _21=(function(_22){function _21(){_22.apply(this,arguments);};if(_22){_21.__proto__=_22;}_21.prototype=Object.create(_22&&_22.prototype);_21.prototype.constructor=_21;_21.prototype.possiblyEvaluate=function(_23,_24){_24=new _9(Math.floor(_24.zoom),{now:_24.now,fadeDuration:_24.fadeDuration,zoomHistory:_24.zoomHistory,transition:_24.transition});return _22.prototype.possiblyEvaluate.call(this,_23,_24);};_21.prototype.evaluate=function evaluate(_25,_26,_27,_28){_26=_e.extend({},_26,{zoom:Math.floor(_26.zoom)});return _22.prototype.evaluate.call(this,_25,_26,_27,_28);};return _21;}(_4));var _29=new _21(_20.paint.properties["line-width"].specification);_29.useIntegerZoom=true;function _2a(_2b){_1.call(this,_2b,_20);};if(_1){_2a.__proto__=_1;}_2a.prototype=Object.create(_1&&_1.prototype);_2a.prototype.constructor=_2a;_2a.prototype._handleSpecialPaintPropertyUpdate=function(_2c){if(_2c==="line-gradient"){this._updateGradient();}};_2a.prototype._updateGradient=function(){var _2d=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=_d.renderColorRamp(_2d,"lineProgress");this.gradientTexture=null;};_2a.prototype.recalculate=function(_2e){_1.prototype.recalculate.call(this,_2e);this.paint._values["line-floorwidth"]=_29.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,_2e);};_2a.prototype.createBucket=function(_2f){return new _a(_2f);};_2a.prototype.queryRadius=function(_30){var _31=_30;var _32=_10(_c.getMaximumPaintValue("line-width",this,_31),_c.getMaximumPaintValue("line-gap-width",this,_31));var _33=_c.getMaximumPaintValue("line-offset",this,_31);var _34=this.paint.get("line-translate");_34=Math.sqrt(_34[0]*_34[0]+_34[1]*_34[1]);return _32/2+Math.abs(_33)+_34;};_2a.prototype.queryIntersectsFeature=function(_35,_36,_37,_38,_39,_3a,_3b){var _3c=_c.translate(_35,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_3a.angle,_3b);var _3d=_3b/2*_10(this.paint.get("line-width").evaluate(_36,_37),this.paint.get("line-gap-width").evaluate(_36,_37));var _3e=this.paint.get("line-offset").evaluate(_36,_37);if(_3e){_38=_13(_38,_3e*_3b);}return _f.polygonIntersectsBufferedMultiLine(_3c,_38,_3d);};_2a.prototype.isTileClipped=function(){return true;};return _2a;});