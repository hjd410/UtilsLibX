//>>built
define("com/huayun/webgis/data/CollisionFeature",["../geometry/Point"],function(_1){var _2=function _2(_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e){var y1=_9.top*_a-_b;var y2=_9.bottom*_a+_b;var x1=_9.left*_a-_b;var x2=_9.right*_a+_b;this.boxStartIndex=_3.length;if(_c){var _f=y2-y1;var _10=x2-x1;if(_f>0){_f=Math.max(10*_a,_f);this._addLineCollisionCircles(_3,_4,_5,(_5.segment),_10,_f,_6,_7,_8,_d);}}else{if(_e){var tl=new _1(x1,y1);var tr=new _1(x2,y1);var bl=new _1(x1,y2);var br=new _1(x2,y2);var _11=_e*Math.PI/180;tl._rotate(_11);tr._rotate(_11);bl._rotate(_11);br._rotate(_11);x1=Math.min(tl.x,tr.x,bl.x,br.x);x2=Math.max(tl.x,tr.x,bl.x,br.x);y1=Math.min(tl.y,tr.y,bl.y,br.y);y2=Math.max(tl.y,tr.y,bl.y,br.y);}_3.emplaceBack(_5.x,_5.y,x1,y1,x2,y2,_6,_7,_8,0,0);}this.boxEndIndex=_3.length;};_2.prototype._addLineCollisionCircles=function _addLineCollisionCircles(_12,_13,_14,_15,_16,_17,_18,_19,_1a,_1b){var _1c=_17/2;var _1d=Math.floor(_16/_1c)||1;var _1e=1+0.4*Math.log(_1b)/Math.LN2;var _1f=Math.floor(_1d*_1e/2);var _20=-_17/2;var p=_14;var _21=_15+1;var _22=_20;var _23=-_16/2;var _24=_23-_16/4;do{_21--;if(_21<0){if(_22>_23){return;}else{_21=0;break;}}else{try{_22-=_13[_21].dist(p);}catch(e){debugger;}p=_13[_21];}}while(_22>_24);var _25=_13[_21].dist(_13[_21+1]);for(var i=-_1f;i<_1d+_1f;i++){var _26=i*_1c;var _27=_23+_26;if(_26<0){_27+=_26;}if(_26>_16){_27+=_26-_16;}if(_27<_22){continue;}while(_22+_25<_27){_22+=_25;_21++;if(_21+1>=_13.length){return;}_25=_13[_21].dist(_13[_21+1]);}var _28=_27-_22;var p0=_13[_21];var p1=_13[_21+1];var _29=p1.sub(p0)._unit()._mult(_28)._add(p0)._round();var _2a=Math.abs(_27-_20)<_1c?0:(_27-_20)*0.8;_12.emplaceBack(_29.x,_29.y,-_17/2,-_17/2,_17/2,_17/2,_18,_19,_1a,_17/2,_2a);}};return _2;});