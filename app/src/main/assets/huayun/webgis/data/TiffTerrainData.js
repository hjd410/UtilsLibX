//>>built
define("com/huayun/webgis/data/TiffTerrainData",["./ArrayType","../gl/SegmentVector","../gl/dataTransfer",],function(_1,_2,_3){function _4(_5){this.version=_5.version;this.imageWidth=_5.imageWidth;this.imageHeight=_5.imageHeight;var _6=_5.reference||[];this.originX=_6[3];this.originY=_6[4];this.resolutionX=_5.resolutions[0];this.resolutionY=_5.resolutions[1];this.tileWidth=_5.tileWidth;this.tileHeight=_5.tileHeight;this.tiles=_5.tiles;};_4.prototype.createTerrainVertice=function(_7,_8){var sx=_7.west,sy=_7.north;var ex=_7.east,ey=_7.south;var _9=new _1.StructArrayLayout3f12();var _a=new _1.StructArrayLayout3ui6();var _b=new _2();var _c=_b.prepareSegment(_d*_d,_9,_a);var _e=Math.floor((sx-this.originX)/this.resolutionX);var _f=Math.floor((this.originY-sy)/this.resolutionY);var _10=Math.ceil((ex-this.originX)/this.resolutionX);var _11=Math.ceil((this.originY-ey)/this.resolutionY);var _d=_10-_e;var _12=_11-_f;var _13=Infinity,_14=-Infinity;for(var n=_f;n<=_11;n++){for(var m=_e;m<=_10;m++){var _15=this.tiles[n][m];if(_15>_14){_14=_15;}if(_15<_13){_13=_15;}var _16=m*this.resolutionX+this.originX;var _17=this.originY-n*this.resolutionY;var _18=_16-sx;var _19=sy-_17;var _1a=_18/_8/256;var _1b=_19/_8/256;_9.emplaceBack(_1a,_1b,_15);}}var _1c=_d+1;for(n=0;n<_12;n++){for(m=0;m<_d;m++){var one=n*_1c+m;var two=(n+1)*_1c+m;var _1d=(n+1)*_1c+m+1;var _1e=n*_1c+m+1;_a.emplaceBack(one,two,_1d);_a.emplaceBack(_1e,one,_1d);}}_c.vertexLength+=(_d+1)*(_d+1);_c.primitiveLength+=_a.length;return {vertices:_9,indices:_a,segments:_b,maxH:_14,minH:_13};};_3.register("TiffTerrainData",_4,{omit:["version","imageWidth","imageHeight"]});return _4;});