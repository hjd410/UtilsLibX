//>>built
define("com/huayun/webgis/data/queryIntersects",["exports","../utils/utils","custom/gl-matrix-min"],function(_1,_2,_3){function _4(_5,p){var c=false;for(var i=0,j=_5.length-1;i<_5.length;j=i++){var p1=_5[i];var p2=_5[j];if(((p1.y>p.y)!==(p2.y>p.y))&&(p.x<(p2.x-p1.x)*(p.y-p1.y)/(p2.y-p1.y)+p1.x)){c=!c;}}return c;};function _6(a0,a1,b0,b1){return _2.isCounterClockwise(a0,b0,b1)!==_2.isCounterClockwise(a1,b0,b1)&&_2.isCounterClockwise(a0,a1,b0)!==_2.isCounterClockwise(a0,a1,b1);};function _7(_8,_9){if(_8.length===0||_9.length===0){return false;}for(var i=0;i<_8.length-1;i++){var a0=_8[i];var a1=_8[i+1];for(var j=0;j<_9.length-1;j++){var b0=_9[j];var b1=_9[j+1];if(_6(a0,a1,b0,b1)){return true;}}}return false;};function _a(p,v,w){var l2=v.distSqr(w);if(l2===0){return p.distSqr(v);}var t=((p.x-v.x)*(w.x-v.x)+(p.y-v.y)*(w.y-v.y))/l2;if(t<0){return p.distSqr(v);}if(t>1){return p.distSqr(w);}return p.distSqr(w.sub(v)._mult(t)._add(v));};function _b(p,_c,_d){var _e=_d*_d;if(_c.length===1){return p.distSqr(_c[0])<_e;}for(var i=1;i<_c.length;i++){var v=_c[i-1],w=_c[i];if(_a(p,v,w)<_e){return true;}}return false;};function _f(_10,_11,_12){if(_10.length>1){if(_7(_10,_11)){return true;}for(var j=0;j<_11.length;j++){if(_b(_11[j],_10,_12)){return true;}}}for(var k=0;k<_10.length;k++){if(_b(_10[k],_11,_12)){return true;}}return false;};function _13(_14,_15,_16,_17){_15=_15.path;var w=_16.uniforms.u_width||1;var _18=(w+4)*_17/2;for(var i=0;i<_15.length;i++){var _19=_15[i];if(_14.length>=3){for(var k=0;k<_19.length;k++){if(_4(_14,_19[k])){return true;}}}if(_f(_14,_19,_18)){return true;}}return false;};function _1a(_1b,p){var c=false,_1c,p1,p2;for(var k=0;k<_1b.length;k++){_1c=_1b[k];for(var i=0,j=_1c.length-1;i<_1c.length;j=i++){p1=_1c[i];p2=_1c[j];if(((p1.y>p.y)!==(p2.y>p.y))&&(p.x<(p2.x-p1.x)*(p.y-p1.y)/(p2.y-p1.y)+p1.x)){c=!c;}}}return c;};function _1d(_1e,_1f){_1f=_1f.path;if(_1e.length===1){return _1a(_1f,_1e[0]);}for(var m=0;m<_1f.length;m++){var _20=_1f[m];for(var n=0;n<_20.length;n++){if(_4(_1e,_20[n])){return true;}}}for(var i=0;i<_1e.length;i++){if(_1a(_1f,_1e[i])){return true;}}for(var k=0;k<_1f.length;k++){if(_7(_1e,_1f[k])){return true;}}return false;};function _21(_22,_23){var t=_3.mat4.identity([]);_3.mat4.translate(t,t,[1,1,0]);_3.mat4.scale(t,t,[_22.width*0.5,_22.height*0.5,1]);return _3.mat4.multiply(t,t,_23);};function _24(_25,_26,_27){if(_4(_25,_26)){return true;}if(_b(_26,_25,_27)){return true;}return false;};function _28(_29,_2a,_2b,_2c,_2d,_2e){_2a=_2a.center;var _2f=_21(_2e,_2b.uniforms.u_matrix);var _30=_2b.strokeWidth;var _31=_2b.pitchWithMap;var _32=_31?_29:_2.projectQueryGeometry(_29,_2f);var _33=_2d+_30*_2c;var _34=_2a;var _35=_31?_34:_2.projectPoint(_34,_2f);var _36=_33;var _37=_3.vec4.transformMat4([],[_34.x,_34.y,0,1],_2f);if(!_2b.scaleWithPitch&&_31){_36*=_37[3]/_2e.cameraToCenterDistance;}else{if(_2b.scaleWithPitch&&!_31){_36*=_2e.cameraToCenterDistance/_37[3];}}if(_24(_32,_35,_36)){return true;}};function _38(_39,_3a,_3b,_3c,_3d,_3e){var _3f=_21(_3e,_3b.uniforms.u_matrix);var _40=_3b.strokeWidth||0;_3d=_3b.uniforms.radius;var _41=_3d+_40;var _42=_3b.pitchWithMap;var _43=_42?_39:_2.projectQueryGeometry(_39,_3f);var _44=(_3d+_40);var _45=_3a;var _46=_42?_45:_2.projectPoint(_45,_3f);var _47=_44;var _48=_3.vec4.transformMat4([],[_45.x,_45.y,0,1],_3f);if(!_3b.scaleWithPitch&&_42){_47*=_48[3]/_3e.cameraToCenterDistance;}else{if(_3b.scaleWithPitch&&!_42){_47*=_3e.cameraToCenterDistance/_48[3];}}if(_24(_43,_46,_47)){return true;}};_1.line=_13;_1.polygon=_1d;_1.imageFill=_1d;_1.circle=_28;_1.point=_38;function _49(_4a,_4b,_4c,_4d,_4e,_4f){var _50=_21(_4f,_4c.uniforms.u_matrix);var _51=_2.projectQueryGeometry(_4a,_50);var _52=_2.projectPoint(_4b,_50);var hw=_4c.width/2,hh=_4c.height/2;var _53={path:[[{x:_52.x-hw,y:_52.y-hh},{x:_52.x+hw,y:_52.y-hh},{x:_52.x+hw,y:_52.y+hh},{x:_52.x-hw,y:_52.y+hh}]]};if(_1d(_51,_53)){return true;}};_1.image=_49;_1.canvas=_49;_1.text=function(){return false;};});