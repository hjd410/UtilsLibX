//>>built
define("com/huayun/webgis/action/search/AroundSearchAction",["dojo/_base/declare","dojo/on","dojo/dom-class","../../../facades/AgsFacade","../../symbols/ImageSymbol","../../geometry/Point2D","../../Graphic","../../Feature","../ActiveMapAction"],function(_1,on,_2,_3,_4,_5,_6,_7,_8){return _1("com.huayun.webgis.action.search.AroundSearchAction",[_8],{constructor:function(_9){_1.safeMixin(_9);this.isActive=true;this.view=_9.view;this.drawLayer=this.view.map.findLayerById("drawLayer");this._agsFacade=new _3();this._agsUrl="http://10.147.232.227:8188/";this._symbol=new _4({url:require.toUrl("com/huayun/webgis/css/images/blue.png"),width:21,height:33});},active:function(){if(!this.state){this.state=true;this.view.selectEnabled=true;this._mouseClick=on(this.view.domNode,"click",this._onClick.bind(this));_2.add(this.view.domNode,"draw-cursor-style");}},invalid:function(){this.drawLayer.clear();this.state=false;if(this._mouseClick){this._mouseClick.remove();this._mouseClick=null;}},_onClick:function(_a){_a.preventDefault();_a.stopPropagation();var _b=this.view.screenToGeometry(_a.x,_a.y);this.drawLayer.clear();this._agsFacade.getAroundPoints(this._agsUrl,_b,function(_c){if(_c.code===0){var _d=_c.data;var _e=_d.shapeX,_f=_d.shapeY;var _10=new _5(_e,_f);var _11=new _7({attribute:_d,geometry:_10});var _12=new _6({feature:_11,symbol:this._symbol});this.drawLayer.addGraphic(_12);this.view.threeRender();}}.bind(this));}});});