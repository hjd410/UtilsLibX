//>>built
define("com/huayun/webgis/action/draws/PointDraw",["dojo/_base/declare","dojo/on","dojo/dom-class","../../geometry/Circle","../../geometry/Point","../../Graphic","../../Feature","../../symbols/PointSymbol","../ActiveMapAction"],function(_1,on,_2,_3,_4,_5,_6,_7,_8){return _1("com.huayun.webgis.action.draws.PointDraw",[_8],{constructor:function(_9){this.view=_9.view;this.view.selectEnabled=false;this.isActive=true;this._mouseClick=null;this.drawLayer=_9.drawLayer?_9.drawLayer:this.view.map.findLayerById("drawLayer");this._symbol=_9.symbol?_9.symbol:new _7({radius:12,color:"#0000FF",strokeColor:"#00FF00",strokeWidth:1,pitchWithMap:false,scaleWithPitch:false});if(_9.addAttributes){this.addAttributes=_9.addAttributes;}this.capture=_9.capture===undefined?false:_9.capture;if(this.capture){this.captureWidth=_9.captureWidth===undefined?2:_9.captureWidth;}},active:function(){if(!this.state){this.state=true;this.view.panEnabled=false;this.view.selectEnabled=false;this._mouseClick=on(this.view.domNode,"click",this._onMouseClick.bind(this));if(this.capture){this.captureMove=on(this.view.domNode,"mousemove",this._captureMoveHandler.bind(this));}_2.add(this.view.domNode,"draw-cursor-style");}},_captureMoveHandler:function(e){var _a=this.view.screenToGeometry(e.x,e.y);var _b=this.drawLayer.captureFeaturesByGeometry(_a,this.captureWidth);if(_b.length>0){var _c=this.filterGraphic(_b);if(_c!==this.selectLine){if(this.selectLine){this.releaseLine(this.selectLine);}this.selectLine=_c;this.captureLine(this.selectLine);}this.view.threeRender();}else{if(this.selectLine){this.releaseLine(this.selectLine);this.selectLine=null;}this.view.threeRender();}},invalid:function(){this.state=false;if(this._mouseClick!==null){this._mouseClick.remove();this._mouseClick=null;}},_onMouseClick:function(_d){_d.preventDefault();_d.stopPropagation();this.doAction({x:_d.x,y:_d.y});},doAction:function(_e){this._drawPoint(_e.x,_e.y);},_drawPoint:function(x,y){var _f=this.view.screenToGeometry(x,y);var _10=new _4(_f.x,_f.y);var _11=new _6({attributes:null,geometry:_10});var _12=new _5({feature:_11,symbol:this._symbol});this.addAttributes(_12);if(this.selectLine){this.handleCapture(_12,this.selectLine);}this.drawLayer.addGraphic(_12);this.endDraw(_12);this.drawLayer.refresh();},captureLine:function(_13){},releaseLine:function(_14){},addAttributes:function(){},handleCapture:function(){},filterGraphic:function(_15){for(var i=0;i<_15.length;i++){if(_15[i].symbol.type==="line"){return _15[i];}}},endDraw:function(){}});});