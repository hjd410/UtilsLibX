//>>built
define("com/huayun/webgis/action/draws/CircleDraw",["dojo/_base/declare","dojo/on","dojo/dom-class","../../geometry/Circle","../../Graphic","../../Feature","../../symbols/CircleSymbol","../ActiveMapAction"],function(_1,on,_2,_3,_4,_5,_6,_7){return _1("com.huayun.webgis.action.draws.CircleDraw",[_7],{constructor:function(_8){this.view=_8.view;this.view.selectEnabled=false;this.isActive=true;this.drawLayer=this.view.map.findLayerById("drawLayer");this._mouseDown=null;this._mouseUp=null;this._mouseMove=null;this._centerPoint=null;this._symbol=new _6({radius:0,color:"#2196F3",strokeColor:"#8BC34A",strokeWidth:1,pitchWithMap:true,scaleWithPitch:true});},active:function(){if(!this.state){this.state=true;this.view.panEnabled=false;this.view.selectEnabled=false;this._mouseDown=on(this.view.domNode,"mousedown",this._onMouseDown.bind(this));this._mouseUp=on(this.view.domNode,"mouseup",this._onMouseUp.bind(this));_2.add(this.view.domNode,"draw-cursor-style");}},_onMouseDown:function(_9){if(_9.button===0){_9.preventDefault();_9.stopPropagation();var _a=this.view.screenToGeometry(_9.x,_9.y);this.doAction(_a);}},_onMouseUp:function(_b){_b.preventDefault();_b.stopPropagation();this._mouseMove.remove();this._currentGraphic=null;},_onMouseMove:function(_c){_c.preventDefault();_c.stopPropagation();var _d=this.view.screenToGeometry(_c.x,_c.y);this._drawCircle(_d);},invalid:function(){this.state=false;this.view.panEnabled=true;this.view.selectEnabled=true;if(this._mouseDown){this._mouseDown.remove();this._mouseDown=null;}if(this._mouseMove){this._mouseMove.remove();this._mouseMove=null;}this._endDrawMethod();this.endActionMethod.call();},doAction:function(_e){this.view.panEnabled=false;this._centerPoint=_e;this._mouseMove=on(this.view.container,"mousemove",this._onMouseMove.bind(this));},_drawCircle:function(_f){var _10=Math.abs(_f.x-this._centerPoint.x),_11=Math.abs(_f.y-this._centerPoint.y),r2=_10*_10+_11*_11,r=Math.sqrt(r2);this.drawLayer.removeGraphic(this._currentGraphic);var _12=new _3();var _13=new _5({attribute:null,geometry:_12});var _14=new _4({feature:_13,symbol:this._symbol});_12.setCenter(this._centerPoint);_12.setRadius(r);this._currentGraphic=_14;this.drawLayer.addGraphic(_14);this.drawLayer.layerView.view.threeRender();},_endDrawMethod:function(){if(this._mouseUp){this._mouseUp.remove();this._mouseUp=null;}this._centerPoint=null;this._currentGraphic=null;}});});