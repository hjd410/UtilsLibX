//>>built
define("com/huayun/webgis/action/draws/SphereDraw",["dojo/_base/declare","dojo/on","dojo/dom-class","../../geometry/Circle","../../Graphic","../../Feature","../../symbols/SphereSymbol","../ActiveMapAction"],function(_1,on,_2,_3,_4,_5,_6,_7){return _1("com.huayun.webgis.action.draws.SphereDraw",[_7],{constructor:function(_8){this.view=_8.view;this.view.selectEnabled=false;this.isActive=true;this.drawLayer=this.view.map.findLayerById("drawLayer");this._mouseDown=null;this._mouseUp=null;this._mouseMove=null;this._centerPoint=null;this._symbol=new _6({color:255,opacity:1,wireframe:true});this._currentGraphic=null;},active:function(){if(!this.state){this.state=true;this.view.panEnabled=false;this.view.selectEnabled=false;this._mouseDown=on(this.view.domNode,"mousedown",this._onMouseDown.bind(this));this._mouseUp=on(this.view.domNode,"mouseup",this._onMouseUp.bind(this));_2.add(this.view.domNode,"draw-cursor-style");}},_onMouseDown:function(_9){if(_9.button===0){_9.preventDefault();_9.stopPropagation();this._centerPoint=this.view.screenToGeometry(_9.x,_9.y);var _a=new _3();_a.setCenter(this._centerPoint);var _b=new _5({attribute:null,geometry:_a});var _c=new _4({feature:_b,symbol:this._symbol});this._currentGraphic=_c;this.drawLayer.addGraphic(_c);this.doAction();}},_onMouseUp:function(_d){_d.preventDefault();_d.stopPropagation();this._mouseMove.remove();this._endDrawMethod();},_onMouseMove:function(_e){_e.preventDefault();_e.stopPropagation();this._drawSphere(_e.x,_e.y);},invalid:function(){this.state=false;this.view.panEnabled=true;this.view.selectEnabled=true;if(this._mouseDown){this._mouseDown.remove();this._mouseDown=null;}if(this._mouseUp){this._mouseUp.remove();this._mouseUp=null;}this._endDrawMethod();this.endActionMethod.call();},doAction:function(){this.view.panEnabled=false;this._mouseMove=on(this.view.domNode,"mousemove",this._onMouseMove.bind(this));},_drawSphere:function(x,y){var _f=this.view.screenToGeometry(x,y);var _10=Math.abs(_f.x-this._centerPoint.x),_11=Math.abs(_f.y-this._centerPoint.y),r2=_10*_10+_11*_11,r=Math.sqrt(r2);this._currentGraphic.feature.geometry.setRadius(r);this._currentGraphic.refresh();},_endDrawMethod:function(){if(this._mouseMove){this._mouseMove.remove();this._mouseMove=null;}this._centerPoint=null;this._currentGraphic=null;}});});