//>>built
(function(f,c){var k,l=function(){return"undefined"!==typeof z&&"function"!==typeof z?z:"undefined"!==typeof window?window:"undefined"!==typeof self?self:this}(),d=function(){},a=function(b){for(var e in b)return 0;return 1},m={}.toString,n=function(b){return"[object Function]"==m.call(b)},g=function(b){return"[object String]"==m.call(b)},h=function(b){return"[object Array]"==m.call(b)},b=function(b,e){if(b)for(var a=0;a<b.length;)e(b[a++])},e=function(b,e){for(var a in e)b[a]=e[a];return b},q=function(b,
a){return e(Error(b),{src:"dojoLoader",info:a})},p=1,t=function(){return"_"+p++},v=function(b,e,a){return Ba(b,e,a,0,v)},z=l,y=z.document,u=y&&y.createElement("DiV"),r=v.has=function(b){return n(x[b])?x[b]=x[b](z,y,u):x[b]},x=r.cache=c.hasCache;n(f)&&(f=f(l));r.add=function(b,e,a,h){(void 0===x[b]||h)&&(x[b]=e);return a&&r(b)};r.add("host-webworker","undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope);r("host-webworker")&&(e(c.hasCache,{"host-browser":0,dom:0,"dojo-dom-ready-api":0,
"dojo-sniff":0,"dojo-inject-api":1,"host-webworker":1,"dojo-guarantee-console":0}),c.loaderPatch={injectUrl:function(b,e){try{importScripts(b),e()}catch(ma){console.error(ma)}}});for(var A in f.has)r.add(A,f.has[A],0,1);v.async=1;var w=r("csp-restrictions")?function(){}:new Function("return eval(arguments[0]);");v.eval=function(b,e){return w(b+"\r\n//# sourceURL\x3d"+e)};var B={},D=v.signal=function(e,a){e=B[e];b(e&&e.slice(0),function(b){b.apply(null,h(a)?a:[a])})},E=v.on=function(b,e){var a=B[b]||
(B[b]=[]);a.push(e);return{remove:function(){for(var b=0;b<a.length;b++)if(a[b]===e){a.splice(b,1);break}}}},F=[],G={},L=[],C={},O=v.map={},N=[],J={},H="",I={},K={},P={},T=0;if(!r("foreign-loader"))var aa=function(b,e){e=!1!==e;var a,h,g,q;for(a in K)h=K[a],(g=a.match(/^url\:(.+)/))?I["url:"+Ca(g[1],b)]=h:"*now"==a?q=h:"*noref"!=a&&(g=Z(a,b,!0),I[g.mid]=I["url:"+g.url]=h);q&&q(na(b));e&&(K={})};var Da=function(b){return b.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,function(b){return"\\"+b})},oa=function(b,
e){e.splice(0,e.length);for(var a in b)e.push([a,b[a],new RegExp("^"+Da(a)+"(/|$)"),a.length]);e.sort(function(b,e){return e[3]-b[3]});return e},Sa=function(e,a){b(e,function(b){a.push([g(b[0])?new RegExp("^"+Da(b[0])+"$"):b[0],b[1]])})},Ea=function(b){var a=b.name;a||(a=b,b={name:a});b=e({main:"main"},b);b.location=b.location?b.location:a;b.packageMap&&(O[a]=b.packageMap);b.main.indexOf("./")||(b.main=b.main.substring(2));C[a]=b},Fa=[],W=function(a,h,q){for(var p in a){"waitSeconds"==p&&(v.waitms=
1E3*(a[p]||0));"cacheBust"==p&&(H=a[p]?g(a[p])?a[p]:(new Date).getTime()+"":"");if("baseUrl"==p||"combo"==p)v[p]=a[p];a[p]!==x&&(v.rawConfig[p]=a[p],"has"!=p&&r.add("config-"+p,a[p],0,h))}v.baseUrl||(v.baseUrl="./");/\/$/.test(v.baseUrl)||(v.baseUrl+="/");for(p in a.has)r.add(p,a.has[p],0,h);b(a.packages,Ea);for(var d in a.packagePaths)b(a.packagePaths[d],function(b){var e=d+"/"+b;g(b)&&(b={name:b});b.location=e;Ea(b)});oa(e(O,a.map),N);b(N,function(b){b[1]=oa(b[1],[]);"*"==b[0]&&(N.star=b)});oa(e(G,
a.paths),L);Sa(a.aliases,F);if(!r("foreign-loader")){if(h)Fa.push({config:a.config});else for(p in a.config)h=S(p,q),h.config=e(h.config||{},a.config[p]);a.cache&&(aa(),K=a.cache,aa(0,!!a.cache["*noref"]))}D("config",[a,v.rawConfig])};r("dojo-cdn");var ba=y.getElementsByTagName("script");k=0;for(var Q,U,ca,X;k<ba.length;)if(Q=ba[k++],(ca=Q.getAttribute("src"))&&(X=ca.match(/(((.*)\/)|^)dojo\.js(\W|$)/i))&&(U=X[3]||"",c.baseUrl=c.baseUrl||U,T=Q),ca=Q.getAttribute("data-dojo-config")||Q.getAttribute("djConfig"))P=
v.eval("({ "+ca+" })","data-dojo-config"),T=Q;v.rawConfig={};W(c,1);r("dojo-cdn")&&((C.dojo.location=U)&&(U+="/"),C.dijit.location=U+"../dijit/",C.dojox.location=U+"../dojox/");W(f,1);W(P,1);if(!r("foreign-loader"))var da=function(e){pa(function(){b(e.deps,Ga)})},Ba=function(b,a,p,c,m){var n;if(g(b)){if((n=S(b,c,!0))&&n.executed)return n.result;throw q("undefinedModule",b);}h(b)||(W(b,0,c),b=a,a=p);if(h(b))if(b.length){p="require*"+t();for(var f,k=[],l=0;l<b.length;)f=b[l++],k.push(S(f,c));n=e(ea("",
p,0,""),{injected:2,deps:k,def:a||d,require:c?c.require:v,gc:1});J[n.mid]=n;da(n);var y=Y&&!0;pa(function(){qa(n,y)});n.executed||R.push(n);fa()}else a&&a();return m},na=function(b){if(!b)return v;var a=b.require;a||(a=function(e,h,g){return Ba(e,h,g,b,a)},b.require=e(a,v),a.module=b,a.toUrl=function(e){return Ca(e,b)},a.toAbsMid=function(e){return ra(e,b)});return a},R=[],ga=[],M={},Ua=function(b){b.injected=1;M[b.mid]=1;b.url&&(M[b.url]=b.pack||1);Ha()},ia=function(b){b.injected=2;delete M[b.mid];
b.url&&delete M[b.url];a(M)&&ha()},Va=v.idle=function(){return!ga.length&&a(M)&&!R.length&&!Y};var ja=function(b,e){if(e)for(var a=0;a<e.length;a++)if(e[a][2].test(b))return e[a];return 0},Ia=function(b){var e=[],a,h;for(b=b.replace(/\\/g,"/").split("/");b.length;)a=b.shift(),".."==a&&e.length&&".."!=h?(e.pop(),h=e[e.length-1]):"."!=a&&e.push(h=a);return e.join("/")},ea=function(b,e,a,h){return{pid:b,mid:e,pack:a,url:h,executed:0,def:0}},Ja=function(e,a,h,g,p,d,c,m,f,t){var v,k,l,y;y=/^\./.test(e);
if(/(^\/)|(\:)|(\.js$)/.test(e)||y&&!a)return ea(0,e,0,e);e=Ia(y?a.mid+"/../"+e:e);if(/^\./.test(e))throw q("irrationalPath",e);t||y||!d.star||(l=ja(e,d.star[1]));!l&&a&&(l=(l=ja(a.mid,d))&&ja(e,l[1]));l&&(e=l[1]+e.substring(l[3]));a=(X=e.match(/^([^\/]+)(\/(.+))?$/))?X[1]:"";(v=h[a])?e=a+"/"+(k=X[3]||v.main):a="";var E=0;b(m,function(b){var a=e.match(b[0]);a&&0<a.length&&(E=n(b[1])?e.replace(b[0],b[1]):b[1])});if(E)return Ja(E,0,h,g,p,d,c,m,f);if(h=g[e])return f?ea(h.pid,h.mid,h.pack,h.url):g[e];
g=(l=ja(e,c))?l[1]+e.substring(l[3]):a?("/"===v.location.slice(-1)?v.location.slice(0,-1):v.location)+"/"+k:r("config-tlmSiblingOfDojo")?"../"+e:e;/(^\/)|(\:)/.test(g)||(g=p+g);return ea(a,e,v,Ia(g+".js"))},Z=function(b,e,a){return Ja(b,e,C,J,v.baseUrl,N,L,F,void 0,a)};if(!r("foreign-loader"))var Ka=function(b,e,a){return b.normalize?b.normalize(e,function(b){return ra(b,a)}):ra(e,a)},La=0,S=function(b,e,a){var h,g;(h=b.match(/^(.+?)\!(.*)$/))?(g=S(h[1],e,a),5!==g.executed||g.load||sa(g),g.load?(h=
Ka(g,h[2],e),b=g.mid+"!"+(g.dynamic?++La+"!":"")+h):(h=h[2],b=g.mid+"!"+ ++La+"!waitingForPlugin"),b={plugin:g,mid:b,req:na(e),prid:h}):b=Z(b,e);return J[b.mid]||!a&&(J[b.mid]=b)};var ra=v.toAbsMid=function(b,e){return Z(b,e).mid},Ca=v.toUrl=function(b,e){e=Z(b+"/x",e);var a=e.url;return Ma(0===e.pid?b:a.substring(0,a.length-5))};if(!r("foreign-loader"))var Na={injected:2,executed:5,def:3,result:3},ta=function(b){return J[b]=e({mid:b},Na)},Wa=ta("require"),Xa=ta("exports"),Ya=ta("module"),ka={},ua=
0,sa=function(b){var e=b.result;b.dynamic=e.dynamic;b.normalize=e.normalize;b.load=e.load;return b},Za=function(a){var h={};b(a.loadQ,function(b){var g=Ka(a,b.prid,b.req.module),p=a.dynamic?b.mid.replace(/waitingForPlugin$/,g):a.mid+"!"+g,g=e(e({},b),{mid:p,prid:g,injected:0});J[p]&&J[p].injected||Oa(J[p]=g);h[b.mid]=J[p];ia(b);delete J[b.mid]});a.loadQ=0;var g=function(b){for(var e=b.deps||[],a=0;a<e.length;a++)(b=h[e[a].mid])&&(e[a]=b)},p;for(p in J)g(J[p]);b(R,g)},va=function(b){v.trace("loader-finish-exec",
[b.mid]);b.executed=5;b.defOrder=ua++;b.loadQ&&(sa(b),Za(b));for(k=0;k<R.length;)R[k]===b?R.splice(k,1):k++;/^require\*/.test(b.mid)&&delete J[b.mid]},$a=[],qa=function(b,e){if(4===b.executed)return v.trace("loader-circular-dependency",[$a.concat(b.mid).join("-\x3e")]),!b.def||e?ka:b.cjs&&b.cjs.exports;if(!b.executed){if(!b.def)return ka;var a=b.mid,h=b.deps||[],g,p=[],d=0;for(b.executed=4;g=h[d++];){g=g===Wa?na(b):g===Xa?b.cjs.exports:g===Ya?b.cjs:qa(g,e);if(g===ka)return b.executed=0,v.trace("loader-exec-module",
["abort",a]),ka;p.push(g)}v.trace("loader-run-factory",[b.mid]);e=b.def;var c;if(r("config-dojo-loader-catches"))try{c=n(e)?e.apply(null,p):e}catch(Ta){D("error",b.result=q("factoryThrew",[b,Ta]))}else c=n(e)?e.apply(null,p):e;b.result=void 0===c&&b.cjs?b.cjs.exports:c;va(b)}return b.result},Y=0,pa=function(b){try{Y++,b()}catch(Ra){throw Ra;}finally{Y--}Va()&&D("idle",[])},fa=function(){Y||pa(function(){for(var b,e,a=0;a<R.length;)b=ua,e=R[a],qa(e),b!=ua?a=0:a++})};var Ma="function"==typeof f.fixupUrl?
f.fixupUrl:function(b){b+="";return b+(H?(/\?/.test(b)?"\x26":"?")+H:"")};void 0===r("dojo-loader-eval-hint-url")&&r.add("dojo-loader-eval-hint-url",1);var Oa=function(b){var e=b.plugin;5!==e.executed||e.load||sa(e);var a=function(e){b.result=e;ia(b);va(b);fa()};e.load?e.load(b.prid,b.req,a):e.loadQ?e.loadQ.push(b):(e.loadQ=[b],R.unshift(e),Ga(e))},V=0,wa=0,xa=0,ab=function(b,e){r("config-stripStrict")&&(b=b.replace(/(["'])use strict\1/g,""));xa=1;if(r("config-dojo-loader-catches"))try{b===V?V.call(null):
v.eval(b,r("dojo-loader-eval-hint-url")?e.url:e.mid)}catch(ma){D("error",q("evalModuleThrew",e))}else b===V?V.call(null):v.eval(b,r("dojo-loader-eval-hint-url")?e.url:e.mid);xa=0},Ga=function(b){var a=b.mid,h=b.url;if(!(b.executed||b.injected||M[a]||b.url&&(b.pack&&M[b.url]===b.pack||1==M[b.url])))if(Ua(b),b.plugin)Oa(b);else{var g=function(){bb(b);if(2!==b.injected){if(r("dojo-enforceDefine")){D("error",q("noDefine",b));return}ia(b);e(b,Na);v.trace("loader-define-nonmodule",[b.url])}fa()};(V=I[a]||
I["url:"+b.url])?(v.trace("loader-inject",["cache",b.mid,h]),ab(V,b),g()):(v.trace("loader-inject",["script",b.mid,h]),wa=b,v.injectUrl(Ma(h),g,b),wa=0)}},ya=function(b,a,h){v.trace("loader-define-module",[b.mid,a]);if(2===b.injected)return D("error",q("multipleDefine",b)),b;e(b,{deps:a,def:h,cjs:{id:b.mid,uri:b.url,exports:b.result={},setExports:function(e){b.cjs.exports=e},config:function(){return b.config}}});for(var g=0;a[g];g++)a[g]=S(a[g],b);ia(b);n(h)||a.length||(b.result=h,va(b));return b},
bb=function(e,a){for(var h=[],g,p;ga.length;)p=ga.shift(),a&&(p[0]=a.shift()),g=p[0]&&S(p[0])||e,h.push([g,p[1],p[2]]);aa(e);b(h,function(b){da(ya.apply(null,b))})},la=0,ha=d,Ha=d,ha=function(){la&&clearTimeout(la);la=0},Ha=function(){ha();v.waitms&&(la=z.setTimeout(function(){ha();D("error",q("timeout",M))},v.waitms))};r.add("ie-event-behavior",y.attachEvent&&"undefined"===typeof Windows&&("undefined"===typeof opera||"[object Opera]"!=opera.toString()));var za=function(b,e,a,h){if(r("ie-event-behavior"))return b.attachEvent(a,
h),function(){b.detachEvent(a,h)};b.addEventListener(e,h,!1);return function(){b.removeEventListener(e,h,!1)}},cb=za(window,"load","onload",function(){v.pageLoaded=1;try{"complete"!=y.readyState&&(y.readyState="complete")}catch(db){}cb()}),ba=y.getElementsByTagName("script");for(k=0;!T;)/^dojo/.test((Q=ba[k++])&&Q.type)||(T=Q);v.injectUrl=function(b,e,a){a=a.node=y.createElement("script");var h=za(a,"load","onreadystatechange",function(b){b=b||window.event;var a=b.target||b.srcElement;if("load"===
b.type||/complete|loaded/.test(a.readyState))h(),g(),e&&e()}),g=za(a,"error","onerror",function(e){h();g();D("error",q("scriptError: "+b,[b,e]))});a.type="text/javascript";a.charset="utf-8";a.src=b;T.parentNode.insertBefore(a,T);return a};v.log=d;v.trace=d;if(r("foreign-loader"))Aa=d;else{var Aa=function(b,e,a){var h=arguments.length,p=["require","exports","module"],d=[0,b,e];1==h?d=[0,n(b)?p:[],b]:2==h&&g(b)?d=[b,n(e)?p:[],e]:3==h&&(d=[b,e,a]);v.trace("loader-define",d.slice(0,2));if((h=d[0]&&S(d[0]))&&
!M[h.mid])da(ya(h,d[1],d[2]));else if(!r("ie-event-behavior")||xa)ga.push(d);else{h=h||wa;if(!h)for(b in M)if((p=J[b])&&p.node&&"interactive"===p.node.readyState){h=p;break}h?(aa(h),da(ya(h,d[1],d[2]))):D("error",q("ieDefineFailed",d[0]));fa()}};Aa.amd={vendor:"dojotoolkit.org"}}e(e(v,c.loaderPatch),f.loaderPatch);E("error",function(b){try{if(console.error(b),b instanceof Error)for(var e in b);}catch(ma){}});e(v,{uid:t,cache:I,packs:C});if(!z.define&&(z.define=Aa,z.require=v,!r("foreign-loader"))){b(Fa,
function(b){W(b)});var Pa=P.deps||f.deps||c.deps,Qa=P.callback||f.callback||c.callback;v.boot=Pa||Qa?[Pa||[],Qa]:0}})(function(f){return f.dojoConfig||f.djConfig||f.require||{}},{async:0,hasCache:{"config-selectorEngine":"lite","config-tlmSiblingOfDojo":1,"dojo-built":1,"dojo-loader":1,dom:1,"host-browser":1},packages:[{location:"../dojox",name:"dojox"},{location:"../dijit",name:"dijit"},{location:".",name:"dojo"},{location:"../com",name:"com"}]});
require({cache:{"dojo/_base/fx":function(){define("./kernel ./config ./lang ../Evented ./Color ../aspect ../sniff ../dom ../dom-style".split(" "),function(f,c,k,l,d,a,m,n,g){var h=k.mixin,b={},e=b._Line=function(b,e){this.start=b;this.end=e};e.prototype.getValue=function(b){return(this.end-this.start)*b+this.start};var q=b.Animation=function(b){h(this,b);k.isArray(this.curve)&&(this.curve=new e(this.curve[0],this.curve[1]))};q.prototype=new l;k.extend(q,{duration:350,repeat:0,rate:20,_percent:0,_startRepeatCount:0,
_getStep:function(){var b=this._percent,e=this.easing;return e?e(b):b},_fire:function(b,e){e=e||[];if(this[b])if(c.debugAtAllCosts)this[b].apply(this,e);else try{this[b].apply(this,e)}catch(x){console.error("exception in animation handler for:",b),console.error(x)}return this},play:function(b,e){this._delayTimer&&this._clearTimer();if(e)this._stopTimer(),this._active=this._paused=!1,this._percent=0;else if(this._active&&!this._paused)return this;this._fire("beforeBegin",[this.node]);b=b||this.delay;
e=k.hitch(this,"_play",e);if(0<b)return this._delayTimer=setTimeout(e,b),this;e();return this},_play:function(b){this._delayTimer&&this._clearTimer();this._startTime=(new Date).valueOf();this._paused&&(this._startTime-=this.duration*this._percent);this._active=!0;this._paused=!1;b=this.curve.getValue(this._getStep());this._percent||(this._startRepeatCount||(this._startRepeatCount=this.repeat),this._fire("onBegin",[b]));this._fire("onPlay",[b]);this._cycle();return this},pause:function(){this._delayTimer&&
this._clearTimer();this._stopTimer();if(!this._active)return this;this._paused=!0;this._fire("onPause",[this.curve.getValue(this._getStep())]);return this},gotoPercent:function(b,e){this._stopTimer();this._active=this._paused=!0;this._percent=b;e&&this.play();return this},stop:function(b){this._delayTimer&&this._clearTimer();if(!this._timer)return this;this._stopTimer();b&&(this._percent=1);this._fire("onStop",[this.curve.getValue(this._getStep())]);this._active=this._paused=!1;return this},destroy:function(){this.stop()},
status:function(){return this._active?this._paused?"paused":"playing":"stopped"},_cycle:function(){if(this._active){var b=(new Date).valueOf(),b=0===this.duration?1:(b-this._startTime)/this.duration;1<=b&&(b=1);this._percent=b;this.easing&&(b=this.easing(b));this._fire("onAnimate",[this.curve.getValue(b)]);1>this._percent?this._startTimer():(this._active=!1,0<this.repeat?(this.repeat--,this.play(null,!0)):-1==this.repeat?this.play(null,!0):this._startRepeatCount&&(this.repeat=this._startRepeatCount,
this._startRepeatCount=0),this._percent=0,this._fire("onEnd",[this.node]),!this.repeat&&this._stopTimer())}return this},_clearTimer:function(){clearTimeout(this._delayTimer);delete this._delayTimer}});var p=0,t=null,v={run:function(){}};k.extend(q,{_startTimer:function(){this._timer||(this._timer=a.after(v,"run",k.hitch(this,"_cycle"),!0),p++);t||(t=setInterval(k.hitch(v,"run"),this.rate))},_stopTimer:function(){this._timer&&(this._timer.remove(),this._timer=null,p--);0>=p&&(clearInterval(t),t=null,
p=0)}});var z=m("ie")?function(b){var e=b.style;e.width.length||"auto"!=g.get(b,"width")||(e.width="auto")}:function(){};b._fade=function(e){e.node=n.byId(e.node);var p=h({properties:{}},e);e=p.properties.opacity={};e.start="start"in p?p.start:function(){return+g.get(p.node,"opacity")||0};e.end=p.end;e=b.animateProperty(p);a.after(e,"beforeBegin",k.partial(z,p.node),!0);return e};b.fadeIn=function(e){return b._fade(h({end:1},e))};b.fadeOut=function(e){return b._fade(h({end:0},e))};b._defaultEasing=
function(b){return.5+Math.sin((b+1.5)*Math.PI)/2};var y=function(b){this._properties=b;for(var e in b){var a=b[e];a.start instanceof d&&(a.tempColor=new d)}};y.prototype.getValue=function(b){var e={},a;for(a in this._properties){var h=this._properties[a],g=h.start;g instanceof d?e[a]=d.blendColors(g,h.end,b,h.tempColor).toCss():k.isArray(g)||(e[a]=(h.end-g)*b+g+("opacity"!=a?h.units||"px":0))}return e};b.animateProperty=function(b){var e=b.node=n.byId(b.node);b.easing||(b.easing=f._defaultEasing);
b=new q(b);a.after(b,"beforeBegin",k.hitch(b,function(){var b={},a;for(a in this.properties){var p=function(b,e){var a={height:b.offsetHeight,width:b.offsetWidth}[e];if(void 0!==a)return a;a=g.get(b,e);return"opacity"==e?+a:c?a:parseFloat(a)};if("width"==a||"height"==a)this.node.display="block";var q=this.properties[a];k.isFunction(q)&&(q=q(e));q=b[a]=h({},k.isObject(q)?q:{end:q});k.isFunction(q.start)&&(q.start=q.start(e));k.isFunction(q.end)&&(q.end=q.end(e));var c=0<=a.toLowerCase().indexOf("color");
"end"in q?"start"in q||(q.start=p(e,a)):q.end=p(e,a);c?(q.start=new d(q.start),q.end=new d(q.end)):q.start="opacity"==a?+q.start:parseFloat(q.start)}this.curve=new y(b)}),!0);a.after(b,"onAnimate",k.hitch(g,"set",b.node),!0);return b};b.anim=function(e,a,h,g,p,d){return b.animateProperty({node:e,duration:h||q.prototype.duration,properties:a,easing:g,onEnd:p}).play(d||0)};h(f,b);f._Animation=q;return b})},"dojo/dom-form":function(){define(["./_base/lang","./dom","./io-query","./json"],function(f,c,
k,l){var d={fieldToObject:function(a){var d=null;if(a=c.byId(a)){var n=a.name,g=(a.type||"").toLowerCase();if(n&&g&&!a.disabled)if("radio"==g||"checkbox"==g)a.checked&&(d=a.value);else if(a.multiple)for(d=[],a=[a.firstChild];a.length;)for(n=a.pop();n;n=n.nextSibling)if(1==n.nodeType&&"option"==n.tagName.toLowerCase())n.selected&&d.push(n.value);else{n.nextSibling&&a.push(n.nextSibling);n.firstChild&&a.push(n.firstChild);break}else d=a.value}return d},toObject:function(a){var m={};a=c.byId(a).elements;
for(var n=0,g=a.length;n<g;++n){var h=a[n],b=h.name,e=(h.type||"").toLowerCase();if(b&&e&&0>"file|submit|image|reset|button".indexOf(e)&&!h.disabled){var q=m,p=b,h=d.fieldToObject(h);if(null!==h){var t=q[p];"string"==typeof t?q[p]=[t,h]:f.isArray(t)?t.push(h):q[p]=h}"image"==e&&(m[b+".x"]=m[b+".y"]=m[b].x=m[b].y=0)}}return m},toQuery:function(a){return k.objectToQuery(d.toObject(a))},toJson:function(a,c){return l.stringify(d.toObject(a),null,c?4:0)}};return d})},"dojo/promise/tracer":function(){define(["../_base/lang",
"./Promise","../Evented"],function(f,c,k){function l(c){setTimeout(function(){a.apply(d,c)},0)}var d=new k,a=d.emit;d.emit=null;c.prototype.trace=function(){var a=f._toArray(arguments);this.then(function(d){l(["resolved",d].concat(a))},function(d){l(["rejected",d].concat(a))},function(d){l(["progress",d].concat(a))});return this};c.prototype.traceRejected=function(){var a=f._toArray(arguments);this.otherwise(function(d){l(["rejected",d].concat(a))});return this};return d})},"dojo/errors/RequestError":function(){define(["./create"],
function(f){return f("RequestError",function(c,f){this.response=f})})},"dojo/_base/html":function(){define("./kernel ../dom ../dom-style ../dom-attr ../dom-prop ../dom-class ../dom-construct ../dom-geometry".split(" "),function(f,c,k,l,d,a,m,n){f.byId=c.byId;f.isDescendant=c.isDescendant;f.setSelectable=c.setSelectable;f.getAttr=l.get;f.setAttr=l.set;f.hasAttr=l.has;f.removeAttr=l.remove;f.getNodeProp=l.getNodeProp;f.attr=function(a,h,b){return 2==arguments.length?l["string"==typeof h?"get":"set"](a,
h):l.set(a,h,b)};f.hasClass=a.contains;f.addClass=a.add;f.removeClass=a.remove;f.toggleClass=a.toggle;f.replaceClass=a.replace;f._toDom=f.toDom=m.toDom;f.place=m.place;f.create=m.create;f.empty=function(a){m.empty(a)};f._destroyElement=f.destroy=function(a){m.destroy(a)};f._getPadExtents=f.getPadExtents=n.getPadExtents;f._getBorderExtents=f.getBorderExtents=n.getBorderExtents;f._getPadBorderExtents=f.getPadBorderExtents=n.getPadBorderExtents;f._getMarginExtents=f.getMarginExtents=n.getMarginExtents;
f._getMarginSize=f.getMarginSize=n.getMarginSize;f._getMarginBox=f.getMarginBox=n.getMarginBox;f.setMarginBox=n.setMarginBox;f._getContentBox=f.getContentBox=n.getContentBox;f.setContentSize=n.setContentSize;f._isBodyLtr=f.isBodyLtr=n.isBodyLtr;f._docScroll=f.docScroll=n.docScroll;f._getIeDocumentElementOffset=f.getIeDocumentElementOffset=n.getIeDocumentElementOffset;f._fixIeBiDiScrollLeft=f.fixIeBiDiScrollLeft=n.fixIeBiDiScrollLeft;f.position=n.position;f.marginBox=function(a,h){return h?n.setMarginBox(a,
h):n.getMarginBox(a)};f.contentBox=function(a,h){return h?n.setContentSize(a,h):n.getContentBox(a)};f.coords=function(a,h){f.deprecated("dojo.coords()","Use dojo.position() or dojo.marginBox().");a=c.byId(a);var b=k.getComputedStyle(a),b=n.getMarginBox(a,b);a=n.position(a,h);b.x=a.x;b.y=a.y;return b};f.getProp=d.get;f.setProp=d.set;f.prop=function(a,h,b){return 2==arguments.length?d["string"==typeof h?"get":"set"](a,h):d.set(a,h,b)};f.getStyle=k.get;f.setStyle=k.set;f.getComputedStyle=k.getComputedStyle;
f.__toPixelValue=f.toPixelValue=k.toPixelValue;f.style=function(a,h,b){switch(arguments.length){case 1:return k.get(a);case 2:return k["string"==typeof h?"get":"set"](a,h)}return k.set(a,h,b)};return f})},"dojo/_base/kernel":function(){define(["../global","../has","./config","require","module"],function(f,c,k,l,d){var a,m={},n={},g={config:k,global:f,dijit:m,dojox:n},m={dojo:["dojo",g],dijit:["dijit",m],dojox:["dojox",n]};d=l.map&&l.map[d.id.match(/[^\/]+/)[0]];for(a in d)m[a]?m[a][0]=d[a]:m[a]=[d[a],
{}];for(a in m)d=m[a],d[1]._scopeName=d[0],k.noGlobals||(f[d[0]]=d[1]);g.scopeMap=m;g.baseUrl=g.config.baseUrl=l.baseUrl;g.isAsync=l.async;g.locale=k.locale;f="$Rev:$".match(/[0-9a-f]{7,}/);g.version={major:1,minor:15,patch:0,flag:"",revision:f?f[0]:NaN,toString:function(){var b=g.version;return b.major+"."+b.minor+"."+b.patch+b.flag+" ("+b.revision+")"}};c("csp-restrictions")||Function("d","d.eval \x3d function(){return d.global.eval ? d.global.eval(arguments[0]) : eval(arguments[0]);}")(g);g.exit=
function(){};c("host-webworker");c.add("console-as-object",function(){return Function.prototype.bind&&console&&"object"===typeof console.log});"undefined"!=typeof console||(console={});d="assert count debug dir dirxml error group groupEnd info profile profileEnd time timeEnd trace warn log".split(" ");var h;for(f=0;h=d[f++];)console[h]?c("console-as-object")&&(console[h]=Function.prototype.bind.call(console[h],console)):function(){var b=h+"";console[b]="log"in console?function(){var e=Array.prototype.slice.call(arguments);
e.unshift(b+":");console.log(e.join(" "))}:function(){};console[b]._fake=!0}();c.add("dojo-debug-messages",!!k.isDebug);g.deprecated=g.experimental=function(){};c("dojo-debug-messages")&&(g.deprecated=function(b,e,a){},g.experimental=function(b,e){});if(k.modulePaths){g.deprecated("dojo.modulePaths","use paths configuration");c={};for(a in k.modulePaths)c[a.replace(/\./g,"/")]=k.modulePaths[a];l({paths:c})}g.moduleUrl=function(b,e){g.deprecated("dojo.moduleUrl()","use require.toUrl","2.0");var a=
null;b&&(a=l.toUrl(b.replace(/\./g,"/")+(e?"/"+e:"")+"/*.*").replace(/\/\*\.\*/,"")+(e?"":"/"));return a};g._hasResource={};return g})},"dojo/io-query":function(){define(["./_base/lang"],function(f){var c={};return{objectToQuery:function(k){var l=encodeURIComponent,d=[],a;for(a in k){var m=k[a];if(m!=c[a]){var n=l(a)+"\x3d";if(f.isArray(m))for(var g=0,h=m.length;g<h;++g)d.push(n+l(m[g]));else d.push(n+l(m))}}return d.join("\x26")},queryToObject:function(c){var k=decodeURIComponent;c=c.split("\x26");
for(var d={},a,m,n=0,g=c.length;n<g;++n)if(m=c[n],m.length){var h=m.indexOf("\x3d");0>h?(a=k(m),m=""):(a=k(m.slice(0,h)),m=k(m.slice(h+1)));"string"==typeof d[a]&&(d[a]=[d[a]]);f.isArray(d[a])?d[a].push(m):d[a]=m}return d}}})},"dojo/_base/Deferred":function(){define("./kernel ../Deferred ../promise/Promise ../errors/CancelError ../has ./lang ../when".split(" "),function(f,c,k,l,d,a,m){var n=function(){},g=Object.freeze||function(){},h=f.Deferred=function(b){function e(b){if(m)throw Error("This deferred has already been resolved");
p=b;m=!0;q()}function q(){for(var b;!b&&r;){var e=r;r=r.next;if(b=e.progress==n)m=!1;var h=y?e.error:e.resolved;d("config-useDeferredInstrumentation")&&y&&c.instrumentRejected&&c.instrumentRejected(p,!!h);if(h)try{var g=h(p);g&&"function"===typeof g.then?g.then(a.hitch(e.deferred,"resolve"),a.hitch(e.deferred,"reject"),a.hitch(e.deferred,"progress")):(h=b&&void 0===g,b&&!h&&(y=g instanceof Error),e.deferred[h&&y?"reject":"resolve"](h?p:g))}catch(F){e.deferred.reject(F)}else y?e.deferred.reject(p):
e.deferred.resolve(p)}}var p,m,f,z,y,u,r,x=this.promise=new k;this.isResolved=x.isResolved=function(){return 0==z};this.isRejected=x.isRejected=function(){return 1==z};this.isFulfilled=x.isFulfilled=function(){return 0<=z};this.isCanceled=x.isCanceled=function(){return f};this.resolve=this.callback=function(b){this.fired=z=0;this.results=[b,null];e(b)};this.reject=this.errback=function(b){y=!0;this.fired=z=1;d("config-useDeferredInstrumentation")&&c.instrumentRejected&&c.instrumentRejected(b,!!r);
e(b);this.results=[null,b]};this.progress=function(b){for(var e=r;e;){var a=e.progress;a&&a(b);e=e.next}};this.addCallbacks=function(b,e){this.then(b,e,n);return this};x.then=this.then=function(b,e,a){var g=a==n?this:new h(x.cancel);b={resolved:b,error:e,progress:a,deferred:g};r?u=u.next=b:r=u=b;m&&q();return g.promise};var A=this;x.cancel=this.cancel=function(){if(!m){var e=b&&b(A);m||(e instanceof Error||(e=new l(e)),e.log=!1,A.reject(e))}f=!0};g(x)};a.extend(h,{addCallback:function(b){return this.addCallbacks(a.hitch.apply(f,
arguments))},addErrback:function(b){return this.addCallbacks(null,a.hitch.apply(f,arguments))},addBoth:function(b){var e=a.hitch.apply(f,arguments);return this.addCallbacks(e,e)},fired:-1});h.when=f.when=m;return h})},"dojo/NodeList-dom":function(){define("./_base/kernel ./query ./_base/array ./_base/lang ./dom-class ./dom-construct ./dom-geometry ./dom-attr ./dom-style".split(" "),function(f,c,k,l,d,a,m,n,g){function h(b){return function(e,a,h){return 2==arguments.length?b["string"==typeof a?"get":
"set"](e,a):b.set(e,a,h)}}var b=function(b){return 1==b.length&&"string"==typeof b[0]},e=function(b){var e=b.parentNode;e&&e.removeChild(b)},q=c.NodeList,p=q._adaptWithCondition,t=q._adaptAsForEach,v=q._adaptAsMap;l.extend(q,{_normalize:function(b,e){var h=!0===b.parse;if("string"==typeof b.template){var g=b.templateFunc||f.string&&f.string.substitute;b=g?g(b.template,b):b}g=typeof b;"string"==g||"number"==g?(b=a.toDom(b,e&&e.ownerDocument),b=11==b.nodeType?l._toArray(b.childNodes):[b]):l.isArrayLike(b)?
l.isArray(b)||(b=l._toArray(b)):b=[b];h&&(b._runParse=!0);return b},_cloneNode:function(b){return b.cloneNode(!0)},_place:function(b,e,h,g){if(1==e.nodeType||"only"!=h)for(var p,q=b.length,d=q-1;0<=d;d--){var c=g?this._cloneNode(b[d]):b[d];if(b._runParse&&f.parser&&f.parser.parse)for(p||(p=e.ownerDocument.createElement("div")),p.appendChild(c),f.parser.parse(p),c=p.firstChild;p.firstChild;)p.removeChild(p.firstChild);d==q-1?a.place(c,e,h):e.parentNode.insertBefore(c,e);e=c}},position:v(m.position),
attr:p(h(n),b),style:p(h(g),b),addClass:t(d.add),removeClass:t(d.remove),toggleClass:t(d.toggle),replaceClass:t(d.replace),empty:t(a.empty),removeAttr:t(n.remove),marginBox:v(m.getMarginBox),place:function(b,e){var h=c(b)[0];return this.forEach(function(b){a.place(b,h,e)})},orphan:function(b){return(b?c._filterResult(this,b):this).forEach(e)},adopt:function(b,e){return c(b).place(this[0],e)._stash(this)},query:function(b){if(!b)return this;var e=new q;this.map(function(a){c(b,a).forEach(function(b){void 0!==
b&&e.push(b)})});return e._stash(this)},filter:function(b){var e=arguments,a=this,h=0;if("string"==typeof b){a=c._filterResult(this,e[0]);if(1==e.length)return a._stash(this);h=1}return this._wrap(k.filter(a,e[h],e[h+1]),this)},addContent:function(b,e){b=this._normalize(b,this[0]);for(var h=0,g;g=this[h];h++)b.length?this._place(b,g,e,0<h):a.empty(g);return this}});return q})},"dojo/query":function(){define("./_base/kernel ./has ./dom ./on ./_base/array ./_base/lang ./selector/_loader ./selector/_loader!default".split(" "),
function(f,c,k,l,d,a,m,n){function g(b,e){var a=function(a,h){if("string"==typeof h&&(h=k.byId(h),!h))return new e([]);a="string"==typeof a?b(a,h):a?a.end&&a.on?a:[a]:[];return a.end&&a.on?a:new e(a)};a.matches=b.match||function(b,e,h){return 0<a.filter([b],e,h).length};a.filter=b.filter||function(b,e,h){return a(e,h).filter(function(e){return-1<d.indexOf(b,e)})};if("function"!=typeof b){var h=b.search;b=function(b,e){return h(e||document,b)}}return a}c.add("array-extensible",function(){return 1==
a.delegate([],{length:1}).length&&!c("bug-for-in-skips-shadowed")});var h=Array.prototype,b=h.slice,e=h.concat,q=d.forEach,p=function(e,a,h){a=[0].concat(b.call(a,0));h=h||f.global;return function(b){a[0]=b;return e.apply(h,a)}},t=function(b){var e=this instanceof v&&c("array-extensible");"number"==typeof b&&(b=Array(b));var h=b&&"length"in b?b:arguments;if(e||!h.sort){for(var g=e?this:[],p=g.length=h.length,q=0;q<p;q++)g[q]=h[q];if(e)return g;h=g}a._mixin(h,z);h._NodeListCtor=function(b){return v(b)};
return h},v=t,z=v.prototype=c("array-extensible")?[]:{};v._wrap=z._wrap=function(b,e,a){b=new (a||this._NodeListCtor||v)(b);return e?b._stash(e):b};v._adaptAsMap=function(b,e){return function(){return this.map(p(b,arguments,e))}};v._adaptAsForEach=function(b,e){return function(){this.forEach(p(b,arguments,e));return this}};v._adaptAsFilter=function(b,e){return function(){return this.filter(p(b,arguments,e))}};v._adaptWithCondition=function(b,e,a){return function(){var h=arguments,g=p(b,h,a);if(e.call(a||
f.global,h))return this.map(g);this.forEach(g);return this}};q(["slice","splice"],function(b){var e=h[b];z[b]=function(){return this._wrap(e.apply(this,arguments),"slice"==b?this:null)}});q(["indexOf","lastIndexOf","every","some"],function(e){var a=d[e];z[e]=function(){return a.apply(f,[this].concat(b.call(arguments,0)))}});a.extend(t,{constructor:v,_NodeListCtor:v,toString:function(){return this.join(",")},_stash:function(b){this._parent=b;return this},on:function(b,e){var a=this.map(function(a){return l(a,
b,e)});a.remove=function(){for(var b=0;b<a.length;b++)a[b].remove()};return a},end:function(){return this._parent?this._parent:new this._NodeListCtor(0)},concat:function(a){var h=b.call(this,0),g=d.map(arguments,function(e){return b.call(e,0)});return this._wrap(e.apply(h,g),this)},map:function(b,e){return this._wrap(d.map(this,b,e),this)},forEach:function(b,e){q(this,b,e);return this},filter:function(b){var e=arguments,a=this,h=0;if("string"==typeof b){a=y._filterResult(this,e[0]);if(1==e.length)return a._stash(this);
h=1}return this._wrap(d.filter(a,e[h],e[h+1]),this)},instantiate:function(b,e){var h=a.isFunction(b)?b:a.getObject(b);e=e||{};return this.forEach(function(b){new h(e,b)})},at:function(){var b=new this._NodeListCtor(0);q(arguments,function(e){0>e&&(e=this.length+e);this[e]&&b.push(this[e])},this);return b._stash(this)}});var y=g(n,t);f.query=g(n,function(b){return t(b)});y.load=function(b,e,a){m.load(b,e,function(b){a(g(b,t))})};f._filterQueryResult=y._filterResult=function(b,e,a){return new t(y.filter(b,
e,a))};f.NodeList=y.NodeList=t;return y})},"dojo/has":function(){define(["./global","require","module"],function(f,c,k){var l=c.has||function(){};l.add("dom-addeventlistener",!!document.addEventListener);l.add("touch","ontouchstart"in document||"onpointerdown"in document&&0<navigator.maxTouchPoints||window.navigator.msMaxTouchPoints);l.add("touch-events","ontouchstart"in document);l.add("pointer-events","pointerEnabled"in window.navigator?window.navigator.pointerEnabled:"PointerEvent"in window);l.add("MSPointer",
window.navigator.msPointerEnabled);l.add("touch-action",l("touch")&&l("pointer-events"));l.add("device-width",screen.availWidth||innerWidth);f=document.createElement("form");l.add("dom-attributes-explicit",0==f.attributes.length);l.add("dom-attributes-specified-flag",0<f.attributes.length&&40>f.attributes.length);l.clearElement=function(d){d.innerHTML="";return d};l.normalize=function(d,a){var c=d.match(/[\?:]|[^:\?]*/g),n=0,g=function(a){var b=c[n++];if(":"==b)return 0;if("?"==c[n++]){if(!a&&l(b))return g();
g(!0);return g(a)}return b||0};return(d=g())&&a(d)};l.load=function(d,a,c){d?a([d],c):c()};return l})},"dojo/json":function(){define(["./has"],function(f){var c="undefined"!=typeof JSON;f.add("json-parse",c);f.add("json-stringify",c&&'{"a":1}'==JSON.stringify({a:0},function(c,d){return d||1}));if(f("json-stringify"))return JSON;var k=function(c){return('"'+c.replace(/(["\\])/g,"\\$1")+'"').replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,
"\\r")};return{parse:f("json-parse")?JSON.parse:function(c,d){if(d&&!/^([\s\[\{]*(?:"(?:\\.|[^"])*"|-?\d[\d\.]*(?:[Ee][+-]?\d+)?|null|true|false|)[\s\]\}]*(?:,|:|$))+$/.test(c))throw new SyntaxError("Invalid characters in JSON");return eval("("+c+")")},stringify:function(c,d,a){function m(g,h,b){d&&(g=d(b,g));var e;e=typeof g;if("number"==e)return isFinite(g)?g+"":"null";if("boolean"==e)return g+"";if(null===g)return"null";if("string"==typeof g)return k(g);if("function"==e||"undefined"==e)return n;
if("function"==typeof g.toJSON)return m(g.toJSON(b),h,b);if(g instanceof Date)return'"{FullYear}-{Month+}-{Date}T{Hours}:{Minutes}:{Seconds}Z"'.replace(/\{(\w+)(\+)?\}/g,function(b,e,a){b=g["getUTC"+e]()+(a?1:0);return 10>b?"0"+b:b});if(g.valueOf()!==g)return m(g.valueOf(),h,b);var q=a?h+a:"",p=a?" ":"",c=a?"\n":"";if(g instanceof Array){var p=g.length,f=[];for(b=0;b<p;b++)e=m(g[b],q,b),"string"!=typeof e&&(e="null"),f.push(c+q+e);return"["+f.join(",")+c+h+"]"}f=[];for(b in g){var l;if(g.hasOwnProperty(b)){if("number"==
typeof b)l='"'+b+'"';else if("string"==typeof b)l=k(b);else continue;e=m(g[b],q,b);"string"==typeof e&&f.push(c+q+l+":"+p+e)}}return"{"+f.join(",")+c+h+"}"}var n;"string"==typeof d&&(a=d,d=null);return m(c,"","")}}})},"dojo/_base/declare":function(){define(["./kernel","../has","./lang"],function(f,c,k){function l(b,e){throw Error("declare"+(e?" "+e:"")+": "+b);}function d(b,e){for(var a=[],h=[{cls:0,refs:[]}],g={},p=1,q=b.length,d=0,c,m,n,f,t;d<q;++d){(c=b[d])?"[object Function]"!=A.call(c)&&l("mixin #"+
d+" is not a callable constructor.",e):l("mixin #"+d+" is unknown. Did you use dojo.require to pull it in?",e);m=c._meta?c._meta.bases:[c];n=0;for(c=m.length-1;0<=c;--c)f=m[c].prototype,f.hasOwnProperty("declaredClass")||(f.declaredClass="uniqName_"+B++),f=f.declaredClass,g.hasOwnProperty(f)||(g[f]={count:0,refs:[],cls:m[c]},++p),f=g[f],n&&n!==f&&(f.refs.push(n),++n.count),n=f;++n.count;h[0].refs.push(n)}for(;h.length;){n=h.pop();a.push(n.cls);for(--p;t=n.refs,1==t.length;){n=t[0];if(!n||--n.count){n=
0;break}a.push(n.cls);--p}if(n)for(d=0,q=t.length;d<q;++d)n=t[d],--n.count||h.push(n)}p&&l("can't build consistent linearization",e);c=b[0];a[0]=c?c._meta&&c===a[a.length-c._meta.bases.length]?c._meta.bases.length:1:0;return a}function a(b,e,a,h){var g,p,d,q,c,m,n=this._inherited=this._inherited||{};"string"===typeof b&&(g=b,b=e,e=a,a=h);if("function"===typeof b)d=b,b=e,e=a;else try{d=b.callee}catch(P){if(P instanceof TypeError)l("strict mode inherited() requires the caller function to be passed before arguments",
this.declaredClass);else throw P;}(g=g||d.nom)||l("can't deduce a name to call inherited()",this.declaredClass);a=h=0;q=this.constructor._meta;h=q.bases;m=n.p;if("constructor"!=g){if(n.c!==d&&(m=0,c=h[0],q=c._meta,q.hidden[g]!==d)){(p=q.chains)&&"string"==typeof p[g]&&l("calling chained method with inherited: "+g,this.declaredClass);do if(q=c._meta,p=c.prototype,q&&(p[g]===d&&p.hasOwnProperty(g)||q.hidden[g]===d))break;while(c=h[++m]);m=c?m:-1}if(c=h[++m])if(p=c.prototype,c._meta&&p.hasOwnProperty(g))a=
p[g];else{d=x[g];do if(p=c.prototype,(a=p[g])&&(c._meta?p.hasOwnProperty(g):a!==d))break;while(c=h[++m])}a=c&&a||x[g]}else{if(n.c!==d&&(m=0,(q=h[0]._meta)&&q.ctor!==d)){for((p=q.chains)&&"manual"===p.constructor||l("calling chained constructor with inherited",this.declaredClass);(c=h[++m])&&(!(q=c._meta)||q.ctor!==d););m=c?m:-1}for(;(c=h[++m])&&!(a=(q=c._meta)?q.ctor:c););a=c&&a}n.c=a;n.p=m;if(a)return!0===e?a:a.apply(this,e||b)}function m(b,e,a){return"string"===typeof b?"function"===typeof e?this.__inherited(b,
e,a,!0):this.__inherited(b,e,!0):"function"===typeof b?this.__inherited(b,e,!0):this.__inherited(b,!0)}function n(b,e,a,h){var g=this.getInherited(b,e,a);if(g)return g.apply(this,h||a||e||b)}function g(b){for(var e=this.constructor._meta.bases,a=0,h=e.length;a<h;++a)if(e[a]===b)return!0;return this instanceof b}function h(b,e){for(var a in e)"constructor"!=a&&e.hasOwnProperty(a)&&(b[a]=e[a]);if(c("bug-for-in-skips-shadowed"))for(var h=k._extraNames,g=h.length;g;)a=h[--g],"constructor"!=a&&e.hasOwnProperty(a)&&
(b[a]=e[a])}function b(b){u.safeMixin(this.prototype,b);return this}function e(b,e){b instanceof Array||"function"===typeof b||(e=b,b=void 0);e=e||{};b=b||[];return u([this].concat(b),e)}function q(b,e){return function(){var a=arguments,h=a,g=a[0],p,q;q=b.length;var d;if(!(this instanceof a.callee))return y(a);if(e&&(g&&g.preamble||this.preamble))for(d=Array(b.length),d[0]=a,p=0;;){(g=a[0])&&(g=g.preamble)&&(a=g.apply(this,a)||a);g=b[p].prototype;(g=g.hasOwnProperty("preamble")&&g.preamble)&&(a=g.apply(this,
a)||a);if(++p==q)break;d[p]=a}for(p=q-1;0<=p;--p)g=b[p],(g=(q=g._meta)?q.ctor:g)&&g.apply(this,d?d[p]:a);(g=this.postscript)&&g.apply(this,h)}}function p(b,e){return function(){var a=arguments,h=a,g=a[0];if(!(this instanceof a.callee))return y(a);e&&(g&&(g=g.preamble)&&(h=g.apply(this,h)||h),(g=this.preamble)&&g.apply(this,h));b&&b.apply(this,a);(g=this.postscript)&&g.apply(this,a)}}function t(b){return function(){var e=arguments,a=0,h,g;if(!(this instanceof e.callee))return y(e);for(;h=b[a];++a)if(h=
(g=h._meta)?g.ctor:h){h.apply(this,e);break}(h=this.postscript)&&h.apply(this,e)}}function v(b,e,a){return function(){var h,g,p=0,q=1;a&&(p=e.length-1,q=-1);for(;h=e[p];p+=q)g=h._meta,(h=(g?g.hidden:h.prototype)[b])&&h.apply(this,arguments)}}function z(b){w.prototype=b.prototype;b=new w;w.prototype=null;return b}function y(b){var e=b.callee,a=z(e);e.apply(a,b);return a}function u(n,f,y){"string"!=typeof n&&(y=f,f=n,n="");y=y||{};var E,F,w,B,G,H,I,K=1,P=f;"[object Array]"==A.call(f)?(H=d(f,n),w=H[0],
K=H.length-w,f=H[K]):(H=[0],f?"[object Function]"==A.call(f)?(w=f._meta,H=H.concat(w?w.bases:f)):l("base class is not a callable constructor.",n):null!==f&&l("unknown base class. Did you use dojo.require to pull it in?",n));if(f)for(F=K-1;;--F){E=z(f);if(!F)break;w=H[F];(w._meta?h:r)(E,w.prototype);B=c("csp-restrictions")?function(){}:new Function;B.superclass=f;B.prototype=E;f=E.constructor=B}else E={};u.safeMixin(E,y);w=y.constructor;w!==x.constructor&&(w.nom="constructor",E.constructor=w);for(F=
K-1;F;--F)(w=H[F]._meta)&&w.chains&&(I=r(I||{},w.chains));E["-chains-"]&&(I=r(I||{},E["-chains-"]));f&&f.prototype&&f.prototype["-chains-"]&&(I=r(I||{},f.prototype["-chains-"]));w=!I||!I.hasOwnProperty("constructor");H[0]=B=I&&"manual"===I.constructor?t(H):1==H.length?p(y.constructor,w):q(H,w);B._meta={bases:H,hidden:y,chains:I,parents:P,ctor:y.constructor};B.superclass=f&&f.prototype;B.extend=b;B.createSubclass=e;B.prototype=E;E.constructor=B;E.getInherited=m;E.isInstanceOf=g;E.inherited=D;E.__inherited=
a;n&&(E.declaredClass=n,k.setObject(n,B));if(I)for(G in I)E[G]&&"string"==typeof I[G]&&"constructor"!=G&&(w=E[G]=v(G,H,"after"===I[G]),w.nom=G);return B}var r=k.mixin,x=Object.prototype,A=x.toString,w,B=0;w=c("csp-restrictions")?function(){}:new Function;var D=f.config.isDebug?n:a;f.safeMixin=u.safeMixin=function(b,e){var a,h;for(a in e)h=e[a],h===x[a]&&a in x||"constructor"==a||("[object Function]"==A.call(h)&&(h.nom=a),b[a]=h);if(c("bug-for-in-skips-shadowed")&&e)for(var g=k._extraNames,p=g.length;p;)a=
g[--p],h=e[a],h===x[a]&&a in x||"constructor"==a||("[object Function]"==A.call(h)&&(h.nom=a),b[a]=h);return b};return f.declare=u})},"dojo/dom":function(){define(["./sniff","./_base/window","./_base/kernel"],function(f,c,k){if(7>=f("ie"))try{document.execCommand("BackgroundImageCache",!1,!0)}catch(a){}var l={};f("ie")?l.byId=function(a,d){if("string"!=typeof a)return a||null;var m=d||c.doc;d=a&&m.getElementById(a);if(!d||d.attributes.id.value!=a&&d.id!=a){m=m.all[a];if(!m||m.nodeName)m=[m];for(var g=
0;d=m[g++];)if(d.attributes&&d.attributes.id&&d.attributes.id.value==a||d.id==a)return d}else return d;return null}:l.byId=function(a,d){return("string"==typeof a?(d||c.doc).getElementById(a):a)||null};k=k.global.document||null;f.add("dom-contains",!(!k||!k.contains));l.isDescendant=f("dom-contains")?function(a,d){return!(!(d=l.byId(d))||!d.contains(l.byId(a)))}:function(a,d){try{for(a=l.byId(a),d=l.byId(d);a;){if(a==d)return!0;a=a.parentNode}}catch(n){}return!1};f.add("css-user-select",function(a,
d,c){if(!c)return!1;a=c.style;d=["Khtml","O","Moz","Webkit"];c=d.length;var g="userSelect";do if("undefined"!==typeof a[g])return g;while(c--&&(g=d[c]+"UserSelect"));return!1});var d=f("css-user-select");l.setSelectable=d?function(a,c){l.byId(a).style[d]=c?"":"none"}:function(a,d){a=l.byId(a);var c=a.getElementsByTagName("*"),g=c.length;if(d)for(a.removeAttribute("unselectable");g--;)c[g].removeAttribute("unselectable");else for(a.setAttribute("unselectable","on");g--;)c[g].setAttribute("unselectable",
"on")};return l})},"dojo/_base/browser":function(){require.has&&require.has.add("config-selectorEngine","acme");define("../ready ./kernel ./connect ./unload ./window ./event ./html ./NodeList ../query ./xhr ./fx".split(" "),function(f){return f})},"dojo/errors/RequestTimeoutError":function(){define(["./create","./RequestError"],function(f,c){return f("RequestTimeoutError",null,c,{dojoType:"timeout"})})},"dojo/dom-style":function(){define(["./sniff","./dom","./_base/window"],function(f,c,k){function l(a,
h,g){h=h.toLowerCase();if("auto"==g){if("height"==h)return a.offsetHeight;if("width"==h)return a.offsetWidth}if("fontweight"==h)switch(g){case 700:return"bold";default:return"normal"}h in b||(b[h]=e.test(h));return b[h]?m(a,g):g}var d,a={};d=f("webkit")?function(b){var e;if(1==b.nodeType){var a=b.ownerDocument.defaultView;e=a.getComputedStyle(b,null);!e&&b.style&&(b.style.display="",e=a.getComputedStyle(b,null))}return e||{}}:f("ie")&&(9>f("ie")||f("quirks"))?function(b){return 1==b.nodeType&&b.currentStyle?
b.currentStyle:{}}:function(b){if(1===b.nodeType){var e=b.ownerDocument.defaultView;return(e.opener?e:k.global.window).getComputedStyle(b,null)}return{}};a.getComputedStyle=d;var m;m=f("ie")?function(b,e){if(!e)return 0;if("medium"==e)return 4;if(e.slice&&"px"==e.slice(-2))return parseFloat(e);var a=b.style,h=b.runtimeStyle,g=a.left,d=h.left;h.left=b.currentStyle.left;try{a.left=e,e=a.pixelLeft}catch(r){e=0}a.left=g;h.left=d;return e}:function(b,e){return parseFloat(e)||0};a.toPixelValue=m;var n=
function(b,e){try{return b.filters.item("DXImageTransform.Microsoft.Alpha")}catch(v){return e?{}:null}},g=9>f("ie")||10>f("ie")&&f("quirks")?function(b){try{return n(b).Opacity/100}catch(t){return 1}}:function(b){return d(b).opacity},h=9>f("ie")||10>f("ie")&&f("quirks")?function(b,e){""===e&&(e=1);var a=100*e;1===e?(b.style.zoom="",n(b)&&(b.style.filter=b.style.filter.replace(/\s*progid:DXImageTransform.Microsoft.Alpha\([^\)]+?\)/i,""))):(b.style.zoom=1,n(b)?n(b,1).Opacity=a:b.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity\x3d"+
a+")",n(b,1).Enabled=!0);if("tr"==b.tagName.toLowerCase())for(b=b.firstChild;b;b=b.nextSibling)"td"==b.tagName.toLowerCase()&&h(b,e);return e}:function(b,e){return b.style.opacity=e},b={left:!0,top:!0},e=/margin|padding|width|height|max|min|offset/,q={cssFloat:1,styleFloat:1,"float":1};a.get=function(b,e){var h=c.byId(b),d=arguments.length;if(2==d&&"opacity"==e)return g(h);e=q[e]?"cssFloat"in h.style?"cssFloat":"styleFloat":e;var p=a.getComputedStyle(h);return 1==d?p:l(h,e,p[e]||h.style[e])};a.set=
function(b,e,g){var d=c.byId(b),p=arguments.length,m="opacity"==e;e=q[e]?"cssFloat"in d.style?"cssFloat":"styleFloat":e;if(3==p)return m?h(d,g):d.style[e]=g;for(var n in e)a.set(b,n,e[n]);return a.getComputedStyle(d)};return a})},"dojo/dom-geometry":function(){define(["./sniff","./_base/window","./dom","./dom-style"],function(f,c,k,l){function d(a,b,e,g,d,c){c=c||"px";a=a.style;isNaN(b)||(a.left=b+c);isNaN(e)||(a.top=e+c);0<=g&&(a.width=g+c);0<=d&&(a.height=d+c)}function a(a){return"button"==a.tagName.toLowerCase()||
"input"==a.tagName.toLowerCase()&&"button"==(a.getAttribute("type")||"").toLowerCase()}function m(h){return"border-box"==n.boxModel||"table"==h.tagName.toLowerCase()||a(h)}var n={boxModel:"content-box"};f("ie")&&(n.boxModel="BackCompat"==document.compatMode?"border-box":"content-box");n.getPadExtents=function(a,b){a=k.byId(a);var e=b||l.getComputedStyle(a),h=l.toPixelValue;b=h(a,e.paddingLeft);var g=h(a,e.paddingTop),d=h(a,e.paddingRight);a=h(a,e.paddingBottom);return{l:b,t:g,r:d,b:a,w:b+d,h:g+a}};
n.getBorderExtents=function(a,b){a=k.byId(a);var e=l.toPixelValue,h=b||l.getComputedStyle(a);b="none"!=h.borderLeftStyle?e(a,h.borderLeftWidth):0;var g="none"!=h.borderTopStyle?e(a,h.borderTopWidth):0,d="none"!=h.borderRightStyle?e(a,h.borderRightWidth):0;a="none"!=h.borderBottomStyle?e(a,h.borderBottomWidth):0;return{l:b,t:g,r:d,b:a,w:b+d,h:g+a}};n.getPadBorderExtents=function(a,b){a=k.byId(a);var e=b||l.getComputedStyle(a);b=n.getPadExtents(a,e);a=n.getBorderExtents(a,e);return{l:b.l+a.l,t:b.t+
a.t,r:b.r+a.r,b:b.b+a.b,w:b.w+a.w,h:b.h+a.h}};n.getMarginExtents=function(a,b){a=k.byId(a);var e=b||l.getComputedStyle(a),h=l.toPixelValue;b=h(a,e.marginLeft);var g=h(a,e.marginTop),d=h(a,e.marginRight);a=h(a,e.marginBottom);return{l:b,t:g,r:d,b:a,w:b+d,h:g+a}};n.getMarginBox=function(a,b){a=k.byId(a);b=b||l.getComputedStyle(a);b=n.getMarginExtents(a,b);var e=a.offsetLeft-b.l,h=a.offsetTop-b.t,g=a.parentNode,d=l.toPixelValue;8==f("ie")&&!f("quirks")&&g&&(g=l.getComputedStyle(g),e-="none"!=g.borderLeftStyle?
d(a,g.borderLeftWidth):0,h-="none"!=g.borderTopStyle?d(a,g.borderTopWidth):0);return{l:e,t:h,w:a.offsetWidth+b.w,h:a.offsetHeight+b.h}};n.getContentBox=function(a,b){a=k.byId(a);var e=b||l.getComputedStyle(a);b=a.clientWidth;var h,g=n.getPadExtents(a,e);h=n.getBorderExtents(a,e);var e=a.offsetLeft+g.l+h.l,d=a.offsetTop+g.t+h.t;b?h=a.clientHeight:(b=a.offsetWidth-h.w,h=a.offsetHeight-h.h);if(8==f("ie")&&!f("quirks")){var c=a.parentNode,m=l.toPixelValue;c&&(c=l.getComputedStyle(c),e-="none"!=c.borderLeftStyle?
m(a,c.borderLeftWidth):0,d-="none"!=c.borderTopStyle?m(a,c.borderTopWidth):0)}return{l:e,t:d,w:b-g.w,h:h-g.h}};n.setContentSize=function(a,b,e){a=k.byId(a);var h=b.w;b=b.h;m(a)&&(e=n.getPadBorderExtents(a,e),0<=h&&(h+=e.w),0<=b&&(b+=e.h));d(a,NaN,NaN,h,b)};var g={l:0,t:0,w:0,h:0};n.setMarginBox=function(h,b,e){h=k.byId(h);var c=e||l.getComputedStyle(h);e=b.w;var p=b.h,t=m(h)?g:n.getPadBorderExtents(h,c),c=n.getMarginExtents(h,c);if(f("webkit")&&a(h)){var v=h.style;0<=e&&!v.width&&(v.width="4px");
0<=p&&!v.height&&(v.height="4px")}0<=e&&(e=Math.max(e-t.w-c.w,0));0<=p&&(p=Math.max(p-t.h-c.h,0));d(h,b.l,b.t,e,p)};n.isBodyLtr=function(a){a=a||c.doc;return"ltr"==(c.body(a).dir||a.documentElement.dir||"ltr").toLowerCase()};n.docScroll=function(a){a=a||c.doc;var b=c.doc.parentWindow||c.doc.defaultView;return"pageXOffset"in b?{x:b.pageXOffset,y:b.pageYOffset}:(b=f("quirks")?c.body(a):a.documentElement)&&{x:n.fixIeBiDiScrollLeft(b.scrollLeft||0,a),y:b.scrollTop||0}};n.getIeDocumentElementOffset=function(a){return{x:0,
y:0}};n.fixIeBiDiScrollLeft=function(a,b){b=b||c.doc;var e=f("ie");if(e&&!n.isBodyLtr(b)){var h=f("quirks");b=h?c.body(b):b.documentElement;var g=c.global;6==e&&!h&&g.frameElement&&b.scrollHeight>b.clientHeight&&(a+=b.clientLeft);return 8>e||h?a+b.clientWidth-b.scrollWidth:-a}return a};n.position=function(a,b){a=k.byId(a);var e=c.body(a.ownerDocument),h=a.getBoundingClientRect(),h={x:h.left,y:h.top,w:h.right-h.left,h:h.bottom-h.top};9>f("ie")&&(h.x-=f("quirks")?e.clientLeft+e.offsetLeft:0,h.y-=f("quirks")?
e.clientTop+e.offsetTop:0);b&&(a=n.docScroll(a.ownerDocument),h.x+=a.x,h.y+=a.y);return h};n.getMarginSize=function(a,b){a=k.byId(a);b=n.getMarginExtents(a,b||l.getComputedStyle(a));a=a.getBoundingClientRect();return{w:a.right-a.left+b.w,h:a.bottom-a.top+b.h}};n.normalizeEvent=function(a){"layerX"in a||(a.layerX=a.offsetX,a.layerY=a.offsetY);if(!("pageX"in a)){var b=a.target,b=b&&b.ownerDocument||document,e=f("quirks")?b.body:b.documentElement;a.pageX=a.clientX+n.fixIeBiDiScrollLeft(e.scrollLeft||
0,b);a.pageY=a.clientY+(e.scrollTop||0)}};return n})},"dojo/global":function(){define(function(){return"undefined"!==typeof global&&"function"!==typeof global?global:"undefined"!==typeof window?window:"undefined"!==typeof self?self:this})},"dojo/dom-prop":function(){define("exports ./_base/kernel ./sniff ./_base/lang ./dom ./dom-style ./dom-construct ./_base/connect".split(" "),function(f,c,k,l,d,a,m,n){function g(b){var e="";b=b.childNodes;for(var a=0,h;h=b[a];a++)8!=h.nodeType&&(e=1==h.nodeType?
e+g(h):e+h.nodeValue);return e}var h={},b=1,e=c._scopeName+"attrid";k.add("dom-textContent",function(b,e,a){return"textContent"in a});f.names={"class":"className","for":"htmlFor",tabindex:"tabIndex",readonly:"readOnly",colspan:"colSpan",frameborder:"frameBorder",rowspan:"rowSpan",textcontent:"textContent",valuetype:"valueType"};f.get=function(b,e){b=d.byId(b);var a=e.toLowerCase();e=f.names[a]||e;return"textContent"!=e||k("dom-textContent")?b[e]:g(b)};f.set=function(g,c,t){g=d.byId(g);if(2==arguments.length&&
"string"!=typeof c){for(var p in c)f.set(g,p,c[p]);return g}p=c.toLowerCase();p=f.names[p]||c;if("style"==p&&"string"!=typeof t)return a.set(g,t),g;if("innerHTML"==p)return k("ie")&&g.tagName.toLowerCase()in{col:1,colgroup:1,table:1,tbody:1,tfoot:1,thead:1,tr:1,title:1}?(m.empty(g),g.appendChild(m.toDom(t,g.ownerDocument))):g[p]=t,g;if("textContent"==p&&!k("dom-textContent"))return m.empty(g),g.appendChild(g.ownerDocument.createTextNode(t)),g;if(l.isFunction(t)){var q=g[e];q||(q=b++,g[e]=q);h[q]||
(h[q]={});var y=h[q][p];if(y)n.disconnect(y);else try{delete g[p]}catch(u){}t?h[q][p]=n.connect(g,p,t):g[p]=null;return g}g[p]=t;return g}})},"dojo/when":function(){define(["./Deferred","./promise/Promise"],function(f,c){return function(k,l,d,a){var m=k&&"function"===typeof k.then,n=m&&k instanceof c;if(!m)return 1<arguments.length?l?l(k):k:(new f).resolve(k);n||(m=new f(k.cancel),k.then(m.resolve,m.reject,m.progress),k=m.promise);return l||d||a?k.then(l,d,a):k}})},"dojo/dom-attr":function(){define("exports ./sniff ./_base/lang ./dom ./dom-style ./dom-prop".split(" "),
function(f,c,k,l,d,a){function m(a,b){a=a.getAttributeNode&&a.getAttributeNode(b);return!!a&&a.specified}var n={innerHTML:1,textContent:1,className:1,htmlFor:c("ie")?1:0,value:1},g={classname:"class",htmlfor:"for",tabindex:"tabIndex",readonly:"readOnly"};f.has=function(h,b){var e=b.toLowerCase();return!!n[a.names[e]||b]||m(l.byId(h),g[e]||b)};f.get=function(h,b){h=l.byId(h);var e=b.toLowerCase(),d=a.names[e]||b,c=h[d];if(n[d]&&"undefined"!=typeof c)return c;if("textContent"==d)return a.get(h,d);if("href"!=
d&&("boolean"==typeof c||k.isFunction(c)))return c;b=g[e]||b;return m(h,b)?h.getAttribute(b):null};f.set=function(h,b,e){h=l.byId(h);if(2==arguments.length){for(var c in b)f.set(h,c,b[c]);return h}c=b.toLowerCase();var p=a.names[c]||b,m=n[p];if("style"==p&&"string"!=typeof e)return d.set(h,e),h;if(m||"boolean"==typeof e||k.isFunction(e))return a.set(h,b,e);h.setAttribute(g[c]||b,e);return h};f.remove=function(a,b){l.byId(a).removeAttribute(g[b.toLowerCase()]||b)};f.getNodeProp=function(h,b){h=l.byId(h);
var e=b.toLowerCase(),d=a.names[e]||b;if(d in h&&"href"!=d)return h[d];b=g[e]||b;return m(h,b)?h.getAttribute(b):null}})},"dojo/dom-construct":function(){define("exports ./_base/kernel ./sniff ./_base/window ./dom ./dom-attr".split(" "),function(f,c,k,l,d,a){function m(b,e){var a=e.parentNode;a&&a.insertBefore(b,e)}function n(b){if("innerHTML"in b)try{b.innerHTML="";return}catch(r){}for(var e;e=b.lastChild;)b.removeChild(e)}var g={option:["select"],tbody:["table"],thead:["table"],tfoot:["table"],
tr:["table","tbody"],td:["table","tbody","tr"],th:["table","thead","tr"],legend:["fieldset"],caption:["table"],colgroup:["table"],col:["table","colgroup"],li:["ul"]},h=/<\s*([\w\:]+)/,b={},e=0,q="__"+c._scopeName+"ToDomId",p;for(p in g)g.hasOwnProperty(p)&&(c=g[p],c.pre="option"==p?'\x3cselect multiple\x3d"multiple"\x3e':"\x3c"+c.join("\x3e\x3c")+"\x3e",c.post="\x3c/"+c.reverse().join("\x3e\x3c/")+"\x3e");var t;8>=k("ie")&&(t=function(b){b.__dojo_html5_tested="yes";var e=v("div",{innerHTML:"\x3cnav\x3ea\x3c/nav\x3e",
style:{visibility:"hidden"}},b.body);1!==e.childNodes.length&&"abbr article aside audio canvas details figcaption figure footer header hgroup mark meter nav output progress section summary time video".replace(/\b\w+\b/g,function(e){b.createElement(e)});z(e)});f.toDom=function(a,d){d=d||l.doc;var c=d[q];c||(d[q]=c=++e+"",b[c]=d.createElement("div"));8>=k("ie")&&!d.__dojo_html5_tested&&d.body&&t(d);a+="";var p=a.match(h),m=p?p[1].toLowerCase():"",c=b[c];if(p&&g[m])for(p=g[m],c.innerHTML=p.pre+a+p.post,
a=p.length;a;--a)c=c.firstChild;else c.innerHTML=a;if(1==c.childNodes.length)return c.removeChild(c.firstChild);for(a=d.createDocumentFragment();d=c.firstChild;)a.appendChild(d);return a};f.place=function(b,e,a){e=d.byId(e);"string"==typeof b&&(b=/^\s*</.test(b)?f.toDom(b,e.ownerDocument):d.byId(b));if("number"==typeof a){var g=e.childNodes;!g.length||g.length<=a?e.appendChild(b):m(b,g[0>a?0:a])}else switch(a){case "before":m(b,e);break;case "after":a=b;(g=e.parentNode)&&(g.lastChild==e?g.appendChild(a):
g.insertBefore(a,e.nextSibling));break;case "replace":e.parentNode.replaceChild(b,e);break;case "only":f.empty(e);e.appendChild(b);break;case "first":if(e.firstChild){m(b,e.firstChild);break}default:e.appendChild(b)}return b};var v=f.create=function(b,e,g,h){var c=l.doc;g&&(g=d.byId(g),c=g.ownerDocument);"string"==typeof b&&(b=c.createElement(b));e&&a.set(b,e);g&&f.place(b,g,h);return b};f.empty=function(b){n(d.byId(b))};var z=f.destroy=function(b){if(b=d.byId(b)){var e=b;b=b.parentNode;e.firstChild&&
n(e);b&&(k("ie")&&b.canHaveChildren&&"removeNode"in e?e.removeNode(!1):b.removeChild(e))}}})},"dojo/request/xhr":function(){define(["../errors/RequestError","./watch","./handlers","./util","../has"],function(f,c,k,l,d){function a(b,e){var a=b.xhr;b.status=b.xhr.status;try{b.text=a.responseText}catch(r){}"xml"===b.options.handleAs&&(b.data=a.responseXML);var g;if(e)this.reject(e);else{try{k(b)}catch(r){g=r}l.checkStatus(a.status)?g?this.reject(g):this.resolve(b):(e=g?new f("Unable to load "+b.url+
" status: "+a.status+" and an error in handleAs: transformation of response",b):new f("Unable to load "+b.url+" status: "+a.status,b),this.reject(e))}}function m(b){return this.xhr.getResponseHeader(b)}function n(k,z,y){var v=d("native-formdata")&&z&&z.data&&z.data instanceof FormData,r=l.parseArgs(k,l.deepCreate(t,z),v);k=r.url;z=r.options;var x=!z.data&&"POST"!==z.method&&"PUT"!==z.method;10>=d("ie")&&(k=k.split("#")[0]);var A,w=l.deferred(r,q,h,b,a,function(){A&&A()}),B=r.xhr=n._create();if(!B)return w.cancel(new f("XHR was not created")),
y?w:w.promise;r.getHeader=m;e&&(A=e(B,w,r,z.uploadProgress));var D="undefined"===typeof z.data?null:z.data,E=!z.sync,F=z.method;try{B.open(F,k,E,z.user||p,z.password||p);z.withCredentials&&(B.withCredentials=z.withCredentials);d("native-response-type")&&z.handleAs in g&&(B.responseType=g[z.handleAs]);var G=z.headers;k=v||x?!1:"application/x-www-form-urlencoded";if(G)for(var L in G)"content-type"===L.toLowerCase()?k=G[L]:G[L]&&B.setRequestHeader(L,G[L]);k&&!1!==k&&B.setRequestHeader("Content-Type",
k);G&&"X-Requested-With"in G||B.setRequestHeader("X-Requested-With","XMLHttpRequest");l.notify&&l.notify.emit("send",r,w.promise.cancel);B.send(D)}catch(C){w.reject(C)}c(w);B=null;return y?w:w.promise}d.add("native-xhr",function(){return"undefined"!==typeof XMLHttpRequest});d.add("dojo-force-activex-xhr",function(){return d("activex")&&"file:"===window.location.protocol});d.add("native-xhr2",function(){if(d("native-xhr")&&!d("dojo-force-activex-xhr")){var b=new XMLHttpRequest;return"undefined"!==
typeof b.addEventListener&&("undefined"===typeof opera||"undefined"!==typeof b.upload)}});d.add("native-formdata",function(){return"undefined"!==typeof FormData});d.add("native-blob",function(){return"undefined"!==typeof Blob});d.add("native-arraybuffer",function(){return"undefined"!==typeof ArrayBuffer});d.add("native-response-type",function(){return d("native-xhr")&&"undefined"!==typeof(new XMLHttpRequest).responseType});d.add("native-xhr2-blob",function(){if(d("native-response-type")){var b=new XMLHttpRequest;
b.open("GET","https://dojotoolkit.org/",!0);b.responseType="blob";var e=b.responseType;b.abort();return"blob"===e}});var g={blob:d("native-xhr2-blob")?"blob":"arraybuffer",document:"document",arraybuffer:"arraybuffer"},h,b,e,q;d("native-xhr2")?(h=function(b){return!this.isFulfilled()},q=function(b,e){e.xhr.abort()},e=function(b,e,a,g){function h(b){e.handleResponse(a)}function d(b){b=new f("Unable to load "+a.url+" status: "+b.target.status,a);e.handleResponse(a,b)}function c(b,g){a.transferType=
b;g.lengthComputable?(a.loaded=g.loaded,a.total=g.total,e.progress(a)):3===a.xhr.readyState&&(a.loaded="loaded"in g?g.loaded:g.position,e.progress(a))}function p(b){return c("download",b)}function q(b){return c("upload",b)}b.addEventListener("load",h,!1);b.addEventListener("error",d,!1);b.addEventListener("progress",p,!1);g&&b.upload&&b.upload.addEventListener("progress",q,!1);return function(){b.removeEventListener("load",h,!1);b.removeEventListener("error",d,!1);b.removeEventListener("progress",
p,!1);b.upload.removeEventListener("progress",q,!1);b=null}}):(h=function(b){return b.xhr.readyState},b=function(b){return 4===b.xhr.readyState},q=function(b,e){b=e.xhr;e=typeof b.abort;"function"!==e&&"object"!==e&&"unknown"!==e||b.abort()});var p,t={data:null,query:null,sync:!1,method:"GET"};n._create=function(){throw Error("XMLHTTP not available");};if(d("native-xhr")&&!d("dojo-force-activex-xhr"))n._create=function(){return new XMLHttpRequest};else if(d("activex"))try{new ActiveXObject("Msxml2.XMLHTTP"),
n._create=function(){return new ActiveXObject("Msxml2.XMLHTTP")}}catch(v){try{new ActiveXObject("Microsoft.XMLHTTP"),n._create=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}catch(z){}}l.addCommonMethods(n);return n})},"dojo/keys":function(){define(["./_base/kernel","./sniff"],function(f,c){return f.keys={BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,META:c("webkit")?91:224,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,
RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,HELP:47,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_PLUS:107,NUMPAD_ENTER:108,NUMPAD_MINUS:109,NUMPAD_PERIOD:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,NUM_LOCK:144,SCROLL_LOCK:145,UP_DPAD:175,DOWN_DPAD:176,LEFT_DPAD:177,
RIGHT_DPAD:178,copyKey:c("mac")&&!c("air")?c("safari")?91:224:17}})},"dojo/domReady":function(){define(["./global","./has"],function(f,c){function k(b){g.push(b);n&&l()}function l(){if(!h){for(h=!0;g.length;)try{g.shift()(d)}catch(v){console.error(v,"in domReady callback",v.stack)}h=!1;k._onQEmpty()}}var d=document,a={loaded:1,complete:1},m="string"!=typeof d.readyState,n=!!a[d.readyState],g=[],h;k.load=function(b,e,a){k(a)};k._Q=g;k._onQEmpty=function(){};m&&(d.readyState="loading");if(!n){var b=
[],e=function(b){b=b||f.event;n||"readystatechange"==b.type&&!a[d.readyState]||(m&&(d.readyState="complete"),n=1,l())},q=function(b,a){b.addEventListener(a,e,!1);g.push(function(){b.removeEventListener(a,e,!1)})};if(!c("dom-addeventlistener")){var q=function(b,a){a="on"+a;b.attachEvent(a,e);g.push(function(){b.detachEvent(a,e)})},p=d.createElement("div");try{p.doScroll&&null===f.frameElement&&b.push(function(){try{return p.doScroll("left"),1}catch(v){}})}catch(v){}}q(d,"DOMContentLoaded");q(f,"load");
"onreadystatechange"in d?q(d,"readystatechange"):m||b.push(function(){return a[d.readyState]});if(b.length){var t=function(){if(!n){for(var a=b.length;a--;)if(b[a]()){e("poller");return}setTimeout(t,30)}};t()}}return k})},"dojo/_base/lang":function(){define(["./kernel","../has","../sniff"],function(f,c){c.add("bug-for-in-skips-shadowed",function(){for(var a in{toString:1})return 0;return 1});var k=c("bug-for-in-skips-shadowed")?"hasOwnProperty valueOf isPrototypeOf propertyIsEnumerable toLocaleString toString constructor".split(" "):
[],l=k.length,d=function(a,b,e){e||(e=a[0]&&f.scopeMap[a[0]]?f.scopeMap[a.shift()][1]:f.global);try{for(var g=0;g<a.length;g++){var h=a[g];if(!(h in e))if(b)e[h]={};else return;e=e[h]}return e}catch(t){}},a=Object.prototype.toString,m=function(a,b,e){return(e||[]).concat(Array.prototype.slice.call(a,b||0))},n=/\{([^\}]+)\}/g,g={_extraNames:k,_mixin:function(a,b,e){var g,h,d,m={};for(g in b)h=b[g],g in a&&(a[g]===h||g in m&&m[g]===h)||(a[g]=e?e(h):h);if(c("bug-for-in-skips-shadowed")&&b)for(d=0;d<
l;++d)g=k[d],h=b[g],g in a&&(a[g]===h||g in m&&m[g]===h)||(a[g]=e?e(h):h);return a},mixin:function(a,b){a||(a={});for(var e=1,h=arguments.length;e<h;e++)g._mixin(a,arguments[e]);return a},setObject:function(a,b,e){var g=a.split(".");a=g.pop();return(e=d(g,!0,e))&&a?e[a]=b:void 0},getObject:function(a,b,e){return a?d(a.split("."),b,e):e},exists:function(a,b){return void 0!==g.getObject(a,!1,b)},isString:function(a){return"string"==typeof a||a instanceof String},isArray:Array.isArray||function(g){return"[object Array]"==
a.call(g)},isFunction:function(g){return"[object Function]"===a.call(g)},isObject:function(a){return void 0!==a&&(null===a||"object"==typeof a||g.isArray(a)||g.isFunction(a))},isArrayLike:function(a){return!!a&&!g.isString(a)&&!g.isFunction(a)&&!(a.tagName&&"form"==a.tagName.toLowerCase())&&(g.isArray(a)||isFinite(a.length))},isAlien:function(a){return a&&!g.isFunction(a)&&/\{\s*\[native code\]\s*\}/.test(String(a))},extend:function(a,b){for(var e=1,h=arguments.length;e<h;e++)g._mixin(a.prototype,
arguments[e]);return a},_hitchArgs:function(a,b){var e=g._toArray(arguments,2),h=g.isString(b);return function(){var d=g._toArray(arguments),c=h?(a||f.global)[b]:b;return c&&c.apply(a||this,e.concat(d))}},hitch:function(a,b){if(2<arguments.length)return g._hitchArgs.apply(f,arguments);b||(b=a,a=null);if(g.isString(b)){a=a||f.global;if(!a[b])throw['lang.hitch: scope["',b,'"] is null (scope\x3d"',a,'")'].join("");return function(){return a[b].apply(a,arguments||[])}}return a?function(){return b.apply(a,
arguments||[])}:b},delegate:function(){function a(){}return function(b,e){a.prototype=b;b=new a;a.prototype=null;e&&g._mixin(b,e);return b}}(),_toArray:c("ie")?function(){function a(b,a,g){g=g||[];for(a=a||0;a<b.length;a++)g.push(b[a]);return g}return function(b){return(b.item?a:m).apply(this,arguments)}}():m,partial:function(a){return g.hitch.apply(f,[null].concat(g._toArray(arguments)))},clone:function(a){if(!a||"object"!=typeof a||g.isFunction(a))return a;if(a.nodeType&&"cloneNode"in a)return a.cloneNode(!0);
if(a instanceof Date)return new Date(a.getTime());if(a instanceof RegExp)return new RegExp(a);var b,e,h;if(g.isArray(a))for(b=[],e=0,h=a.length;e<h;++e)e in a&&(b[e]=g.clone(a[e]));else b=a.constructor?new a.constructor:{};return g._mixin(b,a,g.clone)},trim:String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},replace:function(a,b,e){return a.replace(e||n,g.isFunction(b)?b:function(a,e){return g.getObject(e,!1,b)})}};g.mixin(f,g);return g})},
"dojo/request/util":function(){define("exports ../errors/RequestError ../errors/CancelError ../Deferred ../io-query ../_base/array ../_base/lang ../promise/Promise ../has".split(" "),function(f,c,k,l,d,a,m,n,g){function h(b){return g("native-arraybuffer")&&b instanceof ArrayBuffer}function b(b){return g("native-blob")&&b instanceof Blob}function e(b){return p(b)}function q(b){return void 0!==b.data?b.data:b.text}f.deepCopy=function(a,e){for(var d in e){var c=a[d],p=e[d];if(c!==p){var q=p,n;(n=!q||
"object"!==typeof q)||(n=q,n=g("native-formdata")&&n instanceof FormData);n||("undefined"!==typeof HTMLFormElement?n=q instanceof HTMLFormElement:("FORM"===q.tagName,n=void 0));n||b(q)||h(q)?a[d]=p:"[object Date]"===Object.prototype.toString.call(p)?a[d]=new Date(p):m.isArray(p)?a[d]=f.deepCopyArray(p):c&&"object"===typeof c?f.deepCopy(c,p):a[d]=f.deepCopy({},p)}}return a};f.deepCopyArray=function(b){for(var a=[],e=0,g=b.length;e<g;e++){var d=b[e];"object"===typeof d?a.push(f.deepCopy({},d)):a.push(d)}return a};
f.deepCreate=function(b,a){a=a||{};var e=m.delegate(b),g,d;for(g in b)(d=b[g])&&"object"===typeof d&&(e[g]=f.deepCreate(d,a[g]));return f.deepCopy(e,a)};var p=Object.freeze||function(b){return b};f.deferred=function(b,a,g,d,h,r){var t=new l(function(e){a&&a(t,b);return e&&(e instanceof c||e instanceof k)?e:new k("Request canceled",b)});t.response=b;t.isValid=g;t.isReady=d;t.handleResponse=h;g=t.then(e).otherwise(function(a){a.response=b;throw a;});f.notify&&g.then(m.hitch(f.notify,"emit","load"),
m.hitch(f.notify,"emit","error"));d=g.then(q);h=new n;for(var v in d)d.hasOwnProperty(v)&&(h[v]=d[v]);h.response=g;p(h);r&&t.then(function(b){r.call(t,b)},function(a){r.call(t,b,a)});t.promise=h;t.then=h.then;return t};f.addCommonMethods=function(b,e){a.forEach(e||["GET","POST","PUT","DELETE"],function(a){b[("DELETE"===a?"DEL":a).toLowerCase()]=function(e,g){g=m.delegate(g||{});g.method=a;return b(e,g)}})};f.parseArgs=function(a,e,c){var p=e.data,q=e.query;!p||c||"object"!==typeof p||g("native-xhr2")&&
(h(p)||b(p))||(e.data=d.objectToQuery(p));q?("object"===typeof q&&(q=d.objectToQuery(q)),e.preventCache&&(q+=(q?"\x26":"")+"request.preventCache\x3d"+ +new Date)):e.preventCache&&(q="request.preventCache\x3d"+ +new Date);a&&q&&(a+=(~a.indexOf("?")?"\x26":"?")+q);return{url:a,options:e,getHeader:function(b){return null}}};f.checkStatus=function(b){b=b||0;return 200<=b&&300>b||304===b||1223===b||!b}})},"dojo/Evented":function(){define(["./aspect","./on"],function(f,c){function k(){}var l=f.after;k.prototype=
{on:function(d,a){return c.parse(this,d,a,function(d,c){return l(d,"on"+c,a,!0)})},emit:function(d,a){var m=[this];m.push.apply(m,arguments);return c.emit.apply(c,m)}};return k})},"dojo/mouse":function(){define(["./_base/kernel","./on","./has","./dom","./_base/window"],function(f,c,k,l,d){function a(d,n){var g=function(a,b){return c(a,d,function(e){if(n)return n(e,b);if(!l.isDescendant(e.relatedTarget,a))return b.call(this,e)})};g.bubble=function(g){return a(d,function(b,a){var e=g(b.target),d=b.relatedTarget;
if(e&&e!=(d&&1==d.nodeType&&g(d)))return a.call(e,b)})};return g}k.add("dom-quirks",d.doc&&"BackCompat"==d.doc.compatMode);k.add("events-mouseenter",d.doc&&"onmouseenter"in d.doc.createElement("div"));k.add("events-mousewheel",d.doc&&"onmousewheel"in d.doc);d=k("dom-quirks")&&k("ie")||!k("dom-addeventlistener")?{LEFT:1,MIDDLE:4,RIGHT:2,isButton:function(a,d){return a.button&d},isLeft:function(a){return a.button&1},isMiddle:function(a){return a.button&4},isRight:function(a){return a.button&2}}:{LEFT:0,
MIDDLE:1,RIGHT:2,isButton:function(a,d){return a.button==d},isLeft:function(a){return 0==a.button},isMiddle:function(a){return 1==a.button},isRight:function(a){return 2==a.button}};f.mouseButtons=d;f=k("events-mousewheel")?"mousewheel":function(a,d){return c(a,"DOMMouseScroll",function(a){a.wheelDelta=-a.detail;d.call(this,a)})};return{_eventHandler:a,enter:a("mouseover"),leave:a("mouseout"),wheel:f,isLeft:d.isLeft,isMiddle:d.isMiddle,isRight:d.isRight}})},"dojo/topic":function(){define(["./Evented"],
function(f){var c=new f;return{publish:function(f,l){return c.emit.apply(c,arguments)},subscribe:function(f,l){return c.on.apply(c,arguments)}}})},"dojo/_base/xhr":function(){define("./kernel ./sniff require ../io-query ../dom ../dom-form ./Deferred ./config ./json ./lang ./array ../on ../aspect ../request/watch ../request/xhr ../request/util".split(" "),function(f,c,k,l,d,a,m,n,g,h,b,e,q,p,t,v){f._xhrObj=t._create;var z=f.config;f.objectToQuery=l.objectToQuery;f.queryToObject=l.queryToObject;f.fieldToObject=
a.fieldToObject;f.formToObject=a.toObject;f.formToQuery=a.toQuery;f.formToJson=a.toJson;f._blockAsync=!1;var y=f._contentHandlers=f.contentHandlers={text:function(b){return b.responseText},json:function(b){return g.fromJson(b.responseText||null)},"json-comment-filtered":function(b){b=b.responseText;var a=b.indexOf("/*"),e=b.lastIndexOf("*/");if(-1==a||-1==e)throw Error("JSON was not comment filtered");return g.fromJson(b.substring(a+2,e))},javascript:function(b){return f.eval(b.responseText)},xml:function(a){var e=
a.responseXML;e&&c("dom-qsa2.1")&&!e.querySelectorAll&&c("dom-parser")&&(e=(new DOMParser).parseFromString(a.responseText,"application/xml"));if(c("ie")&&(!e||!e.documentElement)){var g=function(b){return"MSXML"+b+".DOMDocument"},g=["Microsoft.XMLDOM",g(6),g(4),g(3),g(2)];b.some(g,function(b){try{var g=new ActiveXObject(b);g.async=!1;g.loadXML(a.responseText);e=g}catch(G){return!1}return!0})}return e},"json-comment-optional":function(b){return b.responseText&&/^[^{\[]*\/\*/.test(b.responseText)?y["json-comment-filtered"](b):
y.json(b)}};f._ioSetArgs=function(b,e,g,c){var p={args:b,url:b.url},q=null;if(b.form){var q=d.byId(b.form),n=q.getAttributeNode("action");p.url=p.url||(n?n.value:f.doc?f.doc.URL:null);q=a.toObject(q)}n={};q&&h.mixin(n,q);b.content&&h.mixin(n,b.content);b.preventCache&&(n["dojo.preventCache"]=(new Date).valueOf());p.query=l.objectToQuery(n);p.handleAs=b.handleAs||"text";var k=new m(function(b){b.canceled=!0;e&&e(b);var a=b.ioArgs.error;a||(a=Error("request cancelled"),a.dojoType="cancel",b.ioArgs.error=
a);return a});k.addCallback(g);var t=b.load;t&&h.isFunction(t)&&k.addCallback(function(a){return t.call(b,a,p)});var v=b.error;v&&h.isFunction(v)&&k.addErrback(function(a){return v.call(b,a,p)});var E=b.handle;E&&h.isFunction(E)&&k.addBoth(function(a){return E.call(b,a,p)});k.addErrback(function(b){return c(b,k)});z.ioPublish&&f.publish&&!1!==p.args.ioPublish&&(k.addCallbacks(function(b){f.publish("/dojo/io/load",[k,b]);return b},function(b){f.publish("/dojo/io/error",[k,b]);return b}),k.addBoth(function(b){f.publish("/dojo/io/done",
[k,b]);return b}));k.ioArgs=p;return k};var u=function(b){b=y[b.ioArgs.handleAs](b.ioArgs.xhr);return void 0===b?null:b},r=function(b,a){a.ioArgs.args.failOk||console.error(b);return b},x=function(b){0>=A&&(A=0,z.ioPublish&&f.publish&&(!b||b&&!1!==b.ioArgs.args.ioPublish)&&f.publish("/dojo/io/stop"))},A=0;q.after(p,"_onAction",function(){--A});q.after(p,"_onInFlight",x);f._ioCancelAll=p.cancelAll;f._ioNotifyStart=function(b){z.ioPublish&&f.publish&&!1!==b.ioArgs.args.ioPublish&&(A||f.publish("/dojo/io/start"),
A+=1,f.publish("/dojo/io/send",[b]))};f._ioWatch=function(b,a,e,g){b.ioArgs.options=b.ioArgs.args;h.mixin(b,{response:b.ioArgs,isValid:function(e){return a(b)},isReady:function(a){return e(b)},handleResponse:function(a){return g(b)}});p(b);x(b)};f._ioAddQueryToUrl=function(b){b.query.length&&(b.url+=(-1==b.url.indexOf("?")?"?":"\x26")+b.query,b.query=null)};f.xhr=function(b,a,e){var g,d=f._ioSetArgs(a,function(b){g&&g.cancel()},u,r),h=d.ioArgs;"postData"in a?h.query=a.postData:"putData"in a?h.query=
a.putData:"rawBody"in a?h.query=a.rawBody:(2<arguments.length&&!e||-1==="POST|PUT".indexOf(b.toUpperCase()))&&f._ioAddQueryToUrl(h);var c={method:b,handleAs:"text",timeout:a.timeout,withCredentials:a.withCredentials,ioArgs:h};"undefined"!==typeof a.headers&&(c.headers=a.headers);"undefined"!==typeof a.contentType&&(c.headers||(c.headers={}),c.headers["Content-Type"]=a.contentType);"undefined"!==typeof h.query&&(c.data=h.query);"undefined"!==typeof a.sync&&(c.sync=a.sync);f._ioNotifyStart(d);try{g=
t(h.url,c,!0)}catch(C){return d.cancel(),d}d.ioArgs.xhr=g.response.xhr;g.then(function(){d.resolve(d)}).otherwise(function(b){h.error=b;b.response&&(b.status=b.response.status,b.responseText=b.response.text,b.xhr=b.response.xhr);d.reject(b)});return d};f.xhrGet=function(b){return f.xhr("GET",b)};f.rawXhrPost=f.xhrPost=function(b){return f.xhr("POST",b,!0)};f.rawXhrPut=f.xhrPut=function(b){return f.xhr("PUT",b,!0)};f.xhrDelete=function(b){return f.xhr("DELETE",b)};f._isDocumentOk=function(b){return v.checkStatus(b.status)};
f._getText=function(b){var a;f.xhrGet({url:b,sync:!0,load:function(b){a=b}});return a};h.mixin(f.xhr,{_xhrObj:f._xhrObj,fieldToObject:a.fieldToObject,formToObject:a.toObject,objectToQuery:l.objectToQuery,formToQuery:a.toQuery,formToJson:a.toJson,queryToObject:l.queryToObject,contentHandlers:y,_ioSetArgs:f._ioSetArgs,_ioCancelAll:f._ioCancelAll,_ioNotifyStart:f._ioNotifyStart,_ioWatch:f._ioWatch,_ioAddQueryToUrl:f._ioAddQueryToUrl,_isDocumentOk:f._isDocumentOk,_getText:f._getText,get:f.xhrGet,post:f.xhrPost,
put:f.xhrPut,del:f.xhrDelete});return f.xhr})},"dojo/_base/unload":function(){define(["./kernel","./lang","../on"],function(f,c,k){var l=window,d={addOnWindowUnload:function(a,d){f.windowUnloaded||k(l,"unload",f.windowUnloaded=function(){});k(l,"unload",c.hitch(a,d))},addOnUnload:function(a,d){k(l,"beforeunload",c.hitch(a,d))}};f.addOnWindowUnload=d.addOnWindowUnload;f.addOnUnload=d.addOnUnload;return d})},"dojo/Deferred":function(){define(["./has","./_base/lang","./errors/CancelError","./promise/Promise",
"./promise/instrumentation"],function(f,c,k,l,d){var a=Object.freeze||function(){},m=function(a,g,d,h,c){2===g&&b.instrumentRejected&&0===a.length&&b.instrumentRejected(d,!1,h,c);for(c=0;c<a.length;c++)n(a[c],g,d,h)},n=function(a,d,c,m){var e=a[d],p=a.deferred;if(e)try{var q=e(c);if(0===d)"undefined"!==typeof q&&h(p,d,q);else{if(q&&"function"===typeof q.then){a.cancel=q.cancel;q.then(g(p,1),g(p,2),g(p,0));return}h(p,1,q)}}catch(u){h(p,2,u)}else h(p,d,c);2===d&&b.instrumentRejected&&b.instrumentRejected(c,
!!e,m,p.promise)},g=function(b,a){return function(e){h(b,a,e)}},h=function(b,a,g){if(!b.isCanceled())switch(a){case 0:b.progress(g);break;case 1:b.resolve(g);break;case 2:b.reject(g)}},b=function(e){var g=this.promise=new l,d=this,h,c,f,y=!1,u=[];Error.captureStackTrace&&(Error.captureStackTrace(d,b),Error.captureStackTrace(g,b));this.isResolved=g.isResolved=function(){return 1===h};this.isRejected=g.isRejected=function(){return 2===h};this.isFulfilled=g.isFulfilled=function(){return!!h};this.isCanceled=
g.isCanceled=function(){return y};this.progress=function(b,a){if(h){if(!0===a)throw Error("This deferred has already been fulfilled.");return g}m(u,0,b,null,d);return g};this.resolve=function(b,a){if(h){if(!0===a)throw Error("This deferred has already been fulfilled.");return g}m(u,h=1,c=b,null,d);u=null;return g};var r=this.reject=function(b,a){if(h){if(!0===a)throw Error("This deferred has already been fulfilled.");return g}Error.captureStackTrace&&Error.captureStackTrace(f={},r);m(u,h=2,c=b,f,
d);u=null;return g};this.then=g.then=function(a,e,d){var p=[d,a,e];p.cancel=g.cancel;p.deferred=new b(function(b){return p.cancel&&p.cancel(b)});h&&!u?n(p,h,c,f):u.push(p);return p.deferred.promise};this.cancel=g.cancel=function(b,a){if(!h){e&&(a=e(b),b="undefined"===typeof a?b:a);y=!0;if(!h)return"undefined"===typeof b&&(b=new k),r(b),b;if(2===h&&c===b)return b}else if(!0===a)throw Error("This deferred has already been fulfilled.");};a(g)};b.prototype.toString=function(){return"[object Deferred]"};
d&&d(b);return b})},"dojo/_base/NodeList":function(){define(["./kernel","../query","./array","./html","../NodeList-dom"],function(f,c,k){c=c.NodeList;var l=c.prototype;l.connect=c._adaptAsForEach(function(){return f.connect.apply(this,arguments)});l.coords=c._adaptAsMap(f.coords);c.events="blur focus change click error keydown keypress keyup load mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup submit".split(" ");k.forEach(c.events,function(d){var a="on"+d;l[a]=function(d,c){return this.connect(a,
d,c)}});return f.NodeList=c})},"dojo/_base/Color":function(){define(["./kernel","./lang","./array","./config"],function(f,c,k,l){var d=f.Color=function(a){a&&this.setColor(a)};d.named={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],transparent:l.transparentColor||[0,0,0,0]};
c.extend(d,{r:255,g:255,b:255,a:1,_set:function(a,d,c,g){this.r=a;this.g=d;this.b=c;this.a=g},setColor:function(a){c.isString(a)?d.fromString(a,this):c.isArray(a)?d.fromArray(a,this):(this._set(a.r,a.g,a.b,a.a),a instanceof d||this.sanitize());return this},sanitize:function(){return this},toRgb:function(){return[this.r,this.g,this.b]},toRgba:function(){return[this.r,this.g,this.b,this.a]},toHex:function(){return"#"+k.map(["r","g","b"],function(a){a=this[a].toString(16);return 2>a.length?"0"+a:a},
this).join("")},toCss:function(a){var d=this.r+", "+this.g+", "+this.b;return(a?"rgba("+d+", "+this.a:"rgb("+d)+")"},toString:function(){return this.toCss(!0)}});d.blendColors=f.blendColors=function(a,c,n,g){g=g||new d;g.r=Math.round(a.r+(c.r-a.r)*n);g.g=Math.round(a.g+(c.g-a.g)*n);g.b=Math.round(a.b+(c.b-a.b)*n);g.a=a.a+(c.a-a.a)*n;return g.sanitize()};d.fromRgb=f.colorFromRgb=function(a,c){return(a=a.toLowerCase().match(/^rgba?\(([\s\.,0-9]+)\)/))&&d.fromArray(a[1].split(/\s*,\s*/),c)};d.fromHex=
f.colorFromHex=function(a,c){var m=c||new d,g=4==a.length?4:8,h=(1<<g)-1;a=Number("0x"+a.substr(1));if(isNaN(a))return null;k.forEach(["b","g","r"],function(b){var e=a&h;a>>=g;m[b]=4==g?17*e:e});m.a=1;return m};d.fromArray=f.colorFromArray=function(a,c){c=c||new d;c._set(Number(a[0]),Number(a[1]),Number(a[2]),Number(a[3]));isNaN(c.a)&&(c.a=1);return c.sanitize()};d.fromString=f.colorFromString=function(a,c){var m=d.named[a];return m&&d.fromArray(m,c)||d.fromRgb(a,c)||d.fromHex(a,c)};return d})},"dojo/promise/instrumentation":function(){define(["./tracer",
"../has","../_base/lang","../_base/array"],function(f,c,k,l){function d(b,a,g){if(!b||!1!==b.log){var e="";b&&b.stack&&(e+=b.stack);a&&a.stack&&(e+="\n    ----------------------------------------\n    rejected"+a.stack.split("\n").slice(1).join("\n").replace(/^\s+/," "));g&&g.stack&&(e+="\n    ----------------------------------------\n"+g.stack);console.error(b,e)}}function a(b,a,g,h){a||d(b,g,h)}function m(a,d,c,m){l.some(g,function(b){if(b.error===a)return d&&(b.handled=!0),!0})||g.push({error:a,
rejection:c,handled:d,deferred:m,timestamp:(new Date).getTime()});h||(h=setTimeout(n,b))}function n(){var a=(new Date).getTime(),c=a-b;g=l.filter(g,function(b){return b.timestamp<c?(b.handled||d(b.error,b.rejection,b.deferred),!1):!0});h=g.length?setTimeout(n,g[0].timestamp+b-a):!1}c.add("config-useDeferredInstrumentation","report-unhandled-rejections");var g=[],h=!1,b=1E3;return function(e){var g=c("config-useDeferredInstrumentation");if(g){f.on("resolved",k.hitch(console,"log","resolved"));f.on("rejected",
k.hitch(console,"log","rejected"));f.on("progress",k.hitch(console,"log","progress"));var d=[];"string"===typeof g&&(d=g.split(","),g=d.shift());if("report-rejections"===g)e.instrumentRejected=a;else if("report-unhandled-rejections"===g||!0===g||1===g)e.instrumentRejected=m,b=parseInt(d[0],10)||b;else throw Error("Unsupported instrumentation usage \x3c"+g+"\x3e");}}})},"dojo/selector/_loader":function(){define(["../has","require"],function(f,c){if("undefined"!==typeof document){var k=document.createElement("div");
f.add("dom-qsa2.1",!!k.querySelectorAll);f.add("dom-qsa3",function(){try{return k.innerHTML="\x3cp class\x3d'TEST'\x3e\x3c/p\x3e",1==k.querySelectorAll(".TEST:empty").length}catch(d){}})}var l;return{load:function(d,a,m,n){if(n&&n.isBuild)m();else{n=c;d="default"==d?f("config-selectorEngine")||"css3":d;d="css2"==d||"lite"==d?"./lite":"css2.1"==d?f("dom-qsa2.1")?"./lite":"./acme":"css3"==d?f("dom-qsa3")?"./lite":"./acme":"acme"==d?"./acme":(n=a)&&d;if("?"==d.charAt(d.length-1)){d=d.substring(0,d.length-
1);var g=!0}if(g&&(f("dom-compliant-qsa")||l))return m(l);n([d],function(a){"./lite"!=d&&(l=a);m(a)})}}}})},"dojo/promise/Promise":function(){define(["../_base/lang"],function(f){function c(){throw new TypeError("abstract");}return f.extend(function(){},{then:function(f,l,d){c()},cancel:function(f,l){c()},isResolved:function(){c()},isRejected:function(){c()},isFulfilled:function(){c()},isCanceled:function(){c()},always:function(c){return this.then(c,c)},"catch":function(c){return this.then(null,c)},
otherwise:function(c){return this.then(null,c)},trace:function(){return this},traceRejected:function(){return this},toString:function(){return"[object Promise]"}})})},"dojo/request/watch":function(){define("./util ../errors/RequestTimeoutError ../errors/CancelError ../_base/array ../_base/window ../has!host-browser?dom-addeventlistener?:../on:".split(" "),function(f,c,k,l,d,a){function m(){for(var b=+new Date,a=0,d;a<h.length&&(d=h[a]);a++){var p=d.response,m=p.options;d.isCanceled&&d.isCanceled()||
d.isValid&&!d.isValid(p)?(h.splice(a--,1),n._onAction&&n._onAction()):d.isReady&&d.isReady(p)?(h.splice(a--,1),d.handleResponse(p),n._onAction&&n._onAction()):d.startTime&&d.startTime+(m.timeout||0)<b&&(h.splice(a--,1),d.cancel(new c("Timeout exceeded",p)),n._onAction&&n._onAction())}n._onInFlight&&n._onInFlight(d);h.length||(clearInterval(g),g=null)}function n(b){b.response.options.timeout&&(b.startTime=+new Date);b.isFulfilled()||(h.push(b),g||(g=setInterval(m,50)),b.response.options.sync&&m())}
var g=null,h=[];n.cancelAll=function(){try{l.forEach(h,function(b){try{b.cancel(new k("All requests canceled."))}catch(e){}})}catch(b){}};d&&a&&d.doc.attachEvent&&a(d.global,"unload",function(){n.cancelAll()});return n})},"dojo/selector/lite":function(){define(["../has","../_base/kernel"],function(f,c){var k=document.createElement("div"),l=k.matches||k.webkitMatchesSelector||k.mozMatchesSelector||k.msMatchesSelector||k.oMatchesSelector,d=k.querySelectorAll,a=/([^\s,](?:"(?:\\.|[^"])+"|'(?:\\.|[^'])+'|[^,])*)/g;
f.add("dom-matches-selector",!!l);f.add("dom-qsa",!!d);var m=function(b,a){if(h&&-1<b.indexOf(","))return h(b,a);var e=a?a.ownerDocument||a:c.doc||document,p=(d?/^([\w]*)#([\w\-]+$)|^(\.)([\w\-\*]+$)|^(\w+$)/:/^([\w]*)#([\w\-]+)(?:\s+(.*))?$|(?:^|(>|.+\s+))([\w\-\*]+)(\S*$)/).exec(b);a=a||e;if(p){var k=8===f("ie")&&f("quirks")?a.nodeType===e.nodeType:null!==a.parentNode&&9!==a.nodeType&&a.parentNode===e;if(p[2]&&k){var l=c.byId?c.byId(p[2],e):e.getElementById(p[2]);if(!l||p[1]&&p[1]!=l.tagName.toLowerCase())return[];
if(a!=e)for(b=l;b!=a;)if(b=b.parentNode,!b)return[];return p[3]?m(p[3],l):[l]}if(p[3]&&a.getElementsByClassName)return a.getElementsByClassName(p[4]);if(p[5])if(l=a.getElementsByTagName(p[5]),p[4]||p[6])b=(p[4]||"")+p[6];else return l}if(d)return 1===a.nodeType&&"object"!==a.nodeName.toLowerCase()?n(a,b,a.querySelectorAll):a.querySelectorAll(b);l||(l=a.getElementsByTagName("*"));p=[];e=0;for(k=l.length;e<k;e++){var z=l[e];1==z.nodeType&&g(z,b,a)&&p.push(z)}return p},n=function(b,e,g){var d=b,h=b.getAttribute("id"),
c=h||"__dojo__",q=b.parentNode,m=/^\s*[+~]/.test(e);if(m&&!q)return[];h?c=c.replace(/'/g,"\\$\x26"):b.setAttribute("id",c);m&&q&&(b=b.parentNode);e=e.match(a);for(q=0;q<e.length;q++)e[q]="[id\x3d'"+c+"'] "+e[q];e=e.join(",");try{return g.call(b,e)}finally{h||d.removeAttribute("id")}};if(!f("dom-matches-selector"))var g=function(){function b(b,a,e){var g=a.charAt(0);if('"'==g||"'"==g)a=a.slice(1,-1);a=a.replace(/\\/g,"");var d=m[e||""];return function(e){return(e=e.getAttribute(b))&&d(e,a)}}function a(b){return function(a,
e){for(;(a=a.parentNode)!=e;)if(b(a,e))return!0}}function g(b){return function(a,e){a=a.parentNode;return b?a!=e&&b(a,e):a==e}}function d(b,a){return b?function(e,g){return a(e)&&b(e,g)}:a}var h="div"==k.tagName?"toLowerCase":"toUpperCase",c={"":function(b){b=b[h]();return function(a){return a.tagName==b}},".":function(b){var a=" "+b+" ";return function(e){return-1<e.className.indexOf(b)&&-1<(" "+e.className+" ").indexOf(a)}},"#":function(b){return function(a){return a.id==b}}},m={"^\x3d":function(b,
a){return 0==b.indexOf(a)},"*\x3d":function(b,a){return-1<b.indexOf(a)},"$\x3d":function(b,a){return b.substring(b.length-a.length,b.length)==a},"~\x3d":function(b,a){return-1<(" "+b+" ").indexOf(" "+a+" ")},"|\x3d":function(b,a){return 0==(b+"-").indexOf(a+"-")},"\x3d":function(b,a){return b==a},"":function(b,a){return!0}},n={};return function(e,h,p){var q=n[h];if(!q){if(h.replace(/(?:\s*([> ])\s*)|(#|\.)?((?:\\.|[\w-])+)|\[\s*([\w-]+)\s*(.?=)?\s*("(?:\\.|[^"])+"|'(?:\\.|[^'])+'|(?:\\.|[^\]])*)\s*\]/g,
function(e,h,p,m,n,f,k){m?q=d(q,c[p||""](m.replace(/\\/g,""))):h?q=(" "==h?a:g)(q):n&&(q=d(q,b(n,k,f)));return""}))throw Error("Syntax error in query");if(!q)return!0;n[h]=q}return q(e,p)}}();if(!f("dom-qsa"))var h=function(b,e){for(var g=b.match(a),d=[],h=0;h<g.length;h++){b=new String(g[h].replace(/\s*$/,""));b.indexOf=escape;b=m(b,e);for(var c=0,n=b.length;c<n;c++){var f=b[c];d[f.sourceIndex]=f}}e=[];for(h in d)e.push(d[h]);return e};m.match=l?function(b,a,g){return g&&9!=g.nodeType?n(g,a,function(a){return l.call(b,
a)}):l.call(b,a)}:g;return m})},"dojo/on":function(){define(["./has!dom-addeventlistener?:./aspect","./_base/kernel","./sniff"],function(f,c,k){function l(b,a,d,h,c){if(h=a.match(/(.*):(.*)/))return a=h[2],h=h[1],n.selector(h,a).call(c,b,d);k("touch")&&(g.test(a)&&(d=w(d)),k("event-orientationchange")||"orientationchange"!=a||(a="resize",b=window,d=w(d)));p&&(d=p(d));if(b.addEventListener){var q=a in e,m=q?e[a]:a;b.addEventListener(m,d,q);return{remove:function(){b.removeEventListener(m,d,q)}}}if(y&&
b.attachEvent)return y(b,"on"+a,d);throw Error("Target must be an event emitter");}function d(){this.cancelable=!1;this.defaultPrevented=!0}function a(){this.bubbles=!1}var m=window.ScriptEngineMajorVersion;k.add("jscript",m&&m()+ScriptEngineMinorVersion()/10);k.add("event-orientationchange",k("touch")&&!k("android"));k.add("event-stopimmediatepropagation",window.Event&&!!window.Event.prototype&&!!window.Event.prototype.stopImmediatePropagation);k.add("event-focusin",function(b,a,e){return"onfocusin"in
e});k("touch")&&k.add("touch-can-modify-event-delegate",function(){var b=function(){};b.prototype=document.createEvent("MouseEvents");try{var a=new b;a.target=null;return null===a.target}catch(E){return!1}});var n=function(b,a,e,g){return"function"!=typeof b.on||"function"==typeof a||b.nodeType?n.parse(b,a,e,l,g,this):b.on(a,e)};n.pausable=function(b,a,e,g){var d;b=n(b,a,function(){if(!d)return e.apply(this,arguments)},g);b.pause=function(){d=!0};b.resume=function(){d=!1};return b};n.once=function(b,
a,e,g){var d=n(b,a,function(){d.remove();return e.apply(this,arguments)});return d};n.parse=function(b,a,e,g,d,h){var c;if(a.call)return a.call(h,b,e);a instanceof Array?c=a:-1<a.indexOf(",")&&(c=a.split(/\s*,\s*/));if(c){var p=[];a=0;for(var q;q=c[a++];)p.push(n.parse(b,q,e,g,d,h));p.remove=function(){for(var b=0;b<p.length;b++)p[b].remove()};return p}return g(b,a,e,d,h)};var g=/^touch/;n.matches=function(b,a,e,g,d){d=d&&"function"==typeof d.matches?d:c.query;g=!1!==g;1!=b.nodeType&&(b=b.parentNode);
for(;!d.matches(b,a,e);)if(b==e||!1===g||!(b=b.parentNode)||1!=b.nodeType)return!1;return b};n.selector=function(b,a,e){return function(g,d){function h(a){return n.matches(a,b,g,e,c)}var c="function"==typeof b?{matches:b}:this,p=a.bubble;return p?n(g,p(h),d):n(g,a,function(b){var a=h(b.target);if(a)return b.selectorTarget=a,d.call(a,b)})}};var h=[].slice,b=n.emit=function(b,e,g){var c=h.call(arguments,2),p="on"+e;if("parentNode"in b){var q=c[0]={},m;for(m in g)q[m]=g[m];q.preventDefault=d;q.stopPropagation=
a;q.target=b;q.type=e;g=q}do b[p]&&b[p].apply(b,c);while(g&&g.bubbles&&(b=b.parentNode));return g&&g.cancelable&&g},e=k("event-focusin")?{}:{focusin:"focus",focusout:"blur"};if(!k("event-stopimmediatepropagation"))var q=function(){this.modified=this.immediatelyStopped=!0},p=function(b){return function(a){if(!a.immediatelyStopped)return a.stopImmediatePropagation=q,b.apply(this,arguments)}};if(k("dom-addeventlistener"))n.emit=function(a,e,g){if(a.dispatchEvent&&document.createEvent){var d=(a.ownerDocument||
document).createEvent("HTMLEvents");d.initEvent(e,!!g.bubbles,!!g.cancelable);for(var h in g)h in d||(d[h]=g[h]);return a.dispatchEvent(d)&&d}return b.apply(n,arguments)};else{n._fixEvent=function(b,a){b||(b=(a&&(a.ownerDocument||a.document||a).parentWindow||window).event);if(!b)return b;try{t&&b.type==t.type&&b.srcElement==t.target&&(b=t)}catch(E){}if(!b.target)switch(b.target=b.srcElement,b.currentTarget=a||b.srcElement,"mouseover"==b.type&&(b.relatedTarget=b.fromElement),"mouseout"==b.type&&(b.relatedTarget=
b.toElement),b.stopPropagation||(b.stopPropagation=u,b.preventDefault=r),b.type){case "keypress":a="charCode"in b?b.charCode:b.keyCode,10==a?(a=0,b.keyCode=13):13==a||27==a?a=0:3==a&&(a=99),b.charCode=a,a=b,a.keyChar=a.charCode?String.fromCharCode(a.charCode):"",a.charOrCode=a.keyChar||a.keyCode}return b};var t,v=function(b){this.handle=b};v.prototype.remove=function(){delete _dojoIEListeners_[this.handle]};var z=function(b){return function(a){a=n._fixEvent(a,this);var e=b.call(this,a);a.modified&&
(t||setTimeout(function(){t=null}),t=a);return e}},y=function(b,a,e){e=z(e);if(((b.ownerDocument?b.ownerDocument.parentWindow:b.parentWindow||b.window||window)!=top||5.8>k("jscript"))&&!k("config-_allow_leaks")){"undefined"==typeof _dojoIEListeners_&&(_dojoIEListeners_=[]);var g=b[a];if(!g||!g.listeners){var d=g,g=Function("event","var callee \x3d arguments.callee; for(var i \x3d 0; i\x3ccallee.listeners.length; i++){var listener \x3d _dojoIEListeners_[callee.listeners[i]]; if(listener){listener.call(this,event);}}");
g.listeners=[];b[a]=g;g.global=this;d&&g.listeners.push(_dojoIEListeners_.push(d)-1)}g.listeners.push(b=g.global._dojoIEListeners_.push(e)-1);return new v(b)}return f.after(b,a,e,!0)},u=function(){this.cancelBubble=!0},r=n._preventDefault=function(){this.bubbledKeyCode=this.keyCode;if(this.ctrlKey)try{this.keyCode=0}catch(B){}this.defaultPrevented=!0;this.returnValue=!1;this.modified=!0}}if(k("touch"))var x=function(){},A=window.orientation,w=function(b){return function(a){var e=a.corrected;if(!e){var g=
a.type;try{delete a.type}catch(C){}if(a.type){if(k("touch-can-modify-event-delegate"))x.prototype=a,e=new x;else{var e={},d;for(d in a)e[d]=a[d]}e.preventDefault=function(){a.preventDefault()};e.stopPropagation=function(){a.stopPropagation()}}else e=a,e.type=g;a.corrected=e;if("resize"==g){if(A==window.orientation)return null;A=window.orientation;e.type="orientationchange";return b.call(this,e)}"rotation"in e||(e.rotation=0,e.scale=1);if(window.TouchEvent&&a instanceof TouchEvent){var g=e.changedTouches[0],
h;for(h in g)delete e[h],e[h]=g[h]}}return b.call(this,e)}};return n})},"dojo/_base/sniff":function(){define(["./kernel","./lang","../sniff"],function(f,c,k){f._name="browser";c.mixin(f,{isBrowser:!0,isFF:k("ff"),isIE:k("ie"),isKhtml:k("khtml"),isWebKit:k("webkit"),isMozilla:k("mozilla"),isMoz:k("mozilla"),isOpera:k("opera"),isSafari:k("safari"),isChrome:k("chrome"),isMac:k("mac"),isIos:k("ios"),isAndroid:k("android"),isWii:k("wii"),isQuirks:k("quirks"),isAir:k("air")});return k})},"dojo/errors/create":function(){define(["../_base/lang"],
function(f){return function(c,k,l,d){l=l||Error;var a=function(d){if(l===Error){Error.captureStackTrace&&Error.captureStackTrace(this,a);var c=Error.call(this,d),g;for(g in c)c.hasOwnProperty(g)&&(this[g]=c[g]);this.message=d;this.stack=c.stack}else l.apply(this,arguments);k&&k.apply(this,arguments)};a.prototype=f.delegate(l.prototype,d);a.prototype.name=c;return a.prototype.constructor=a}})},"dojo/_base/array":function(){define(["./kernel","../has","./lang"],function(f,c,k){function l(a){return m[a]=
new Function("item","index","array",a)}function d(a){var b=!a;return function(e,g,d){var h=0,c=e&&e.length||0,p;c&&"string"==typeof e&&(e=e.split(""));"string"==typeof g&&(g=m[g]||l(g));if(d)for(;h<c;++h){if(p=!g.call(d,e[h],h,e),a^p)return!p}else for(;h<c;++h)if(p=!g(e[h],h,e),a^p)return!p;return b}}function a(a){var b=1,e=0,d=0;a||(b=e=d=-1);return function(h,c,q,m){if(m&&0<b)return g.lastIndexOf(h,c,q);m=h&&h.length||0;var p=a?m+d:e;q===n?q=a?e:m+d:0>q?(q=m+q,0>q&&(q=e)):q=q>=m?m+d:q;for(m&&"string"==
typeof h&&(h=h.split(""));q!=p;q+=b)if(h[q]==c)return q;return-1}}var m={},n,g={every:d(!1),some:d(!0),indexOf:a(!0),lastIndexOf:a(!1),forEach:function(a,b,e){var g=0,d=a&&a.length||0;d&&"string"==typeof a&&(a=a.split(""));"string"==typeof b&&(b=m[b]||l(b));if(e)for(;g<d;++g)b.call(e,a[g],g,a);else for(;g<d;++g)b(a[g],g,a)},map:function(a,b,e,g){var d=0,h=a&&a.length||0;g=new (g||Array)(h);h&&"string"==typeof a&&(a=a.split(""));"string"==typeof b&&(b=m[b]||l(b));if(e)for(;d<h;++d)g[d]=b.call(e,a[d],
d,a);else for(;d<h;++d)g[d]=b(a[d],d,a);return g},filter:function(a,b,e){var g=0,d=a&&a.length||0,h=[],c;d&&"string"==typeof a&&(a=a.split(""));"string"==typeof b&&(b=m[b]||l(b));if(e)for(;g<d;++g)c=a[g],b.call(e,c,g,a)&&h.push(c);else for(;g<d;++g)c=a[g],b(c,g,a)&&h.push(c);return h},clearCache:function(){m={}}};k.mixin(f,g);return g})},"dojo/_base/json":function(){define(["./kernel","../json"],function(f,c){f.fromJson=function(c){return eval("("+c+")")};f._escapeString=c.stringify;f.toJsonIndentStr=
"\t";f.toJson=function(k,l){return c.stringify(k,function(d,a){return a&&(d=a.__json__||a.json,"function"==typeof d)?d.call(a):a},l&&f.toJsonIndentStr)};return f})},"dojo/_base/window":function(){define(["./kernel","./lang","../sniff"],function(f,c,k){var l={global:f.global,doc:f.global.document||null,body:function(d){d=d||f.doc;return d.body||d.getElementsByTagName("body")[0]},setContext:function(d,a){f.global=l.global=d;f.doc=l.doc=a},withGlobal:function(d,a,c,n){var g=f.global;try{return f.global=
l.global=d,l.withDoc.call(null,d.document,a,c,n)}finally{f.global=l.global=g}},withDoc:function(d,a,c,n){var g=l.doc,h=k("quirks"),b=k("ie"),e,q,p;try{return f.doc=l.doc=d,f.isQuirks=k.add("quirks","BackCompat"==f.doc.compatMode,!0,!0),k("ie")&&(p=d.parentWindow)&&p.navigator&&(e=parseFloat(p.navigator.appVersion.split("MSIE ")[1])||void 0,(q=d.documentMode)&&5!=q&&Math.floor(e)!=q&&(e=q),f.isIE=k.add("ie",e,!0,!0)),c&&"string"==typeof a&&(a=c[a]),a.apply(c,n||[])}finally{f.doc=l.doc=g,f.isQuirks=
k.add("quirks",h,!0,!0),f.isIE=k.add("ie",b,!0,!0)}}};c.mixin(f,l);return l})},"dojo/dom-class":function(){define(["./_base/lang","./_base/array","./dom"],function(f,c,k){function l(g){if("string"==typeof g||g instanceof String){if(g&&!a.test(g))return m[0]=g,m;g=g.split(a);g.length&&!g[0]&&g.shift();g.length&&!g[g.length-1]&&g.pop();return g}return g?c.filter(g,function(a){return a}):[]}var d,a=/\s+/,m=[""],n={};return d={contains:function(a,d){return 0<=(" "+k.byId(a).className+" ").indexOf(" "+
d+" ")},add:function(a,d){a=k.byId(a);d=l(d);var b=a.className,e,b=b?" "+b+" ":" ";e=b.length;for(var g=0,c=d.length,h;g<c;++g)(h=d[g])&&0>b.indexOf(" "+h+" ")&&(b+=h+" ");e<b.length&&(a.className=b.substr(1,b.length-2))},remove:function(a,d){a=k.byId(a);var b;if(void 0!==d){d=l(d);b=" "+a.className+" ";for(var e=0,g=d.length;e<g;++e)b=b.replace(" "+d[e]+" "," ");b=f.trim(b)}else b="";a.className!=b&&(a.className=b)},replace:function(a,c,b){a=k.byId(a);n.className=a.className;d.remove(n,b);d.add(n,
c);a.className!==n.className&&(a.className=n.className)},toggle:function(a,c,b){a=k.byId(a);if(void 0===b){c=l(c);for(var e=0,g=c.length,h;e<g;++e)h=c[e],d[d.contains(a,h)?"remove":"add"](a,h)}else d[b?"add":"remove"](a,c);return b}}})},"dojo/_base/config":function(){define(["../global","../has","require"],function(f,c,k){f={};k=k.rawConfig;for(var l in k)f[l]=k[l];!f.locale&&"undefined"!=typeof navigator&&(l=navigator.languages&&navigator.languages.length?navigator.languages[0]:navigator.language||
navigator.userLanguage)&&(f.locale=l.toLowerCase());return f})},"dojo/_base/event":function(){define(["./kernel","../on","../has","../dom-geometry"],function(f,c,k,l){if(c._fixEvent){var d=c._fixEvent;c._fixEvent=function(a,c){(a=d(a,c))&&l.normalizeEvent(a);return a}}var a={fix:function(a,d){return c._fixEvent?c._fixEvent(a,d):a},stop:function(a){k("dom-addeventlistener")||a&&a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a=a||window.event,a.cancelBubble=!0,c._preventDefault.call(a))}};
f.fixEvent=a.fix;f.stopEvent=a.stop;return a})},"dojo/main":function(){define("./_base/kernel ./has require ./sniff ./_base/lang ./_base/array ./_base/config ./ready ./_base/declare ./_base/connect ./_base/Deferred ./_base/json ./_base/Color ./has!dojo-firebug?./_firebug/firebug ./_base/browser require".split(" "),function(f,c,k,l,d,a,m,n){m.isDebug&&k(["./_firebug/firebug"]);var g=m.require;g&&(g=a.map(d.isArray(g)?g:[g],function(a){return a.replace(/\./g,"/")}),f.isAsync?k(g):n(1,function(){k(g)}));
return f})},"dojo/sniff":function(){define(["./has"],function(f){var c=navigator,k=c.userAgent,c=c.appVersion,l=parseFloat(c);f.add("air",0<=k.indexOf("AdobeAIR"));f.add("wp",parseFloat(k.split("Windows Phone")[1])||void 0);f.add("msapp",parseFloat(k.split("MSAppHost/")[1])||void 0);f.add("khtml",0<=c.indexOf("Konqueror")?l:void 0);f.add("edge",parseFloat(k.split("Edge/")[1])||void 0);f.add("opr",parseFloat(k.split("OPR/")[1])||void 0);f.add("webkit",!f("wp")&&!f("edge")&&parseFloat(k.split("WebKit/")[1])||
void 0);f.add("chrome",!f("edge")&&!f("opr")&&parseFloat(k.split("Chrome/")[1])||void 0);f.add("android",!f("wp")&&parseFloat(k.split("Android ")[1])||void 0);f.add("safari",!(0<=c.indexOf("Safari"))||f("wp")||f("chrome")||f("android")||f("edge")||f("opr")?void 0:parseFloat(c.split("Version/")[1]));f.add("mac",0<=c.indexOf("Macintosh"));f.add("quirks","BackCompat"==document.compatMode);if(!f("wp")&&k.match(/(iPhone|iPod|iPad)/)){var d=RegExp.$1.replace(/P/,"p"),a=k.match(/OS ([\d_]+)/)?RegExp.$1:
"1",a=parseFloat(a.replace(/_/,".").replace(/_/g,""));f.add(d,a);f.add("ios",a)}f.add("bb",(0<=k.indexOf("BlackBerry")||0<=k.indexOf("BB10"))&&parseFloat(k.split("Version/")[1])||void 0);f.add("trident",parseFloat(c.split("Trident/")[1])||void 0);f.add("svg","undefined"!==typeof SVGAngle);f("webkit")||(0<=k.indexOf("Opera")&&f.add("opera",9.8<=l?parseFloat(k.split("Version/")[1])||l:l),!(0<=k.indexOf("Gecko"))||f("wp")||f("khtml")||f("trident")||f("edge")||f.add("mozilla",l),f("mozilla")&&f.add("ff",
parseFloat(k.split("Firefox/")[1]||k.split("Minefield/")[1])||void 0),document.all&&!f("opera")&&(k=parseFloat(c.split("MSIE ")[1])||void 0,(c=document.documentMode)&&5!=c&&Math.floor(k)!=c&&(k=c),f.add("ie",k)),f.add("wii","undefined"!=typeof opera&&opera.wiiremote));return f})},"dojo/request/handlers":function(){define(["../json","../_base/kernel","../_base/array","../has","../selector/_loader"],function(f,c,k,l){function d(b){var a=h[b.options.handleAs];b.data=a?a(b):b.data||b.text;return b}l.add("activex",
"undefined"!==typeof ActiveXObject);l.add("dom-parser",function(b){return"DOMParser"in b});var a;if(l("activex")){var m=["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML.DOMDocument"],n;a=function(b){function a(b){try{var a=new ActiveXObject(b);a.async=!1;a.loadXML(d);g=a;n=b}catch(z){return!1}return!0}var g=b.data,d=b.text;g&&l("dom-qsa2.1")&&!g.querySelectorAll&&l("dom-parser")&&(g=(new DOMParser).parseFromString(d,"application/xml"));g&&g.documentElement||n&&a(n)||
k.some(m,a);return g}}var g=function(b){return l("native-xhr2-blob")||"blob"!==b.options.handleAs||"undefined"===typeof Blob?b.xhr.response:new Blob([b.xhr.response],{type:b.xhr.getResponseHeader("Content-Type")})},h={javascript:function(b){return c.eval(b.text||"")},json:function(b){return f.parse(b.text||null)},xml:a,blob:g,arraybuffer:g,document:g};d.register=function(b,a){h[b]=a};return d})},"dojo/ready":function(){define(["./_base/kernel","./has","require","./domReady","./_base/lang"],function(f,
c,k,l,d){var a=0,m=[],n=0;c=function(){a=1;f._postLoad=f.config.afterOnLoad=!0;g()};var g=function(){if(!n){for(n=1;a&&(!l||0==l._Q.length)&&(k.idle?k.idle():1)&&m.length;){var b=m.shift();try{b()}catch(q){if(q.info=q.message,k.signal)k.signal("error",q);else throw q;}}n=0}};k.on&&k.on("idle",g);l&&(l._onQEmpty=g);var h=f.ready=f.addOnLoad=function(b,a,c){var e=d._toArray(arguments);"number"!=typeof b?(c=a,a=b,b=1E3):e.shift();c=c?d.hitch.apply(f,e):function(){a()};c.priority=b;for(e=0;e<m.length&&
b>=m[e].priority;e++);m.splice(e,0,c);g()},b=f.config.addOnLoad;if(b)h[d.isArray(b)?"apply":"call"](f,b);l?l(c):c();return h})},"dojo/aspect":function(){define([],function(){function f(a,d,g,c){var b=a[d],e="around"==d,h;if(e){var p=g(function(){return b.advice(this,arguments)});h={remove:function(){p&&(p=a=g=null)},advice:function(a,e){return p?p.apply(a,e):b.advice(a,e)}}}else h={remove:function(){if(h.advice){var b=h.previous,e=h.next;e||b?(b?b.next=e:a[d]=e,e&&(e.previous=b)):delete a[d];a=g=
h.advice=null}},id:a.nextId++,advice:g,receiveArguments:c};if(b&&!e)if("after"==d){for(;b.next&&(b=b.next););b.next=h;h.previous=b}else"before"==d&&(a[d]=h,h.next=b,b.previous=h);else a[d]=h;return h}function c(a){return function(d,g,c,b){var e=d[g],h;e&&e.target==d||(d[g]=h=function(){for(var b=h.nextId,a=arguments,e=h.before;e;)e.advice&&(a=e.advice.apply(this,a)||a),e=e.next;if(h.around)var g=h.around.advice(this,a);for(e=h.after;e&&e.id<b;){if(e.advice)if(e.receiveArguments)var d=e.advice.apply(this,
a),g=d===k?g:d;else g=e.advice.call(this,g,a);e=e.next}return g},e&&(h.around={advice:function(b,a){return e.apply(b,a)}}),h.target=d,h.nextId=h.nextId||0);d=f(h||e,a,c,b);c=null;return d}}var k,l=c("after"),d=c("before"),a=c("around");return{before:d,around:a,after:l}})},"dojo/_base/connect":function(){define("./kernel ../on ../topic ../aspect ./event ../mouse ./sniff ./lang ../keys".split(" "),function(f,c,k,l,d,a,m,n){function g(b,e,g,d,h){d=n.hitch(g,d);if(!b||!b.addEventListener&&!b.attachEvent)return l.after(b||
f.global,e,d,!0);"string"==typeof e&&"on"==e.substring(0,2)&&(e=e.substring(2));b||(b=f.global);if(!h)switch(e){case "keypress":e=p;break;case "mouseenter":e=a.enter;break;case "mouseleave":e=a.leave}return c(b,e,d,h)}function h(b){b.keyChar=b.charCode?String.fromCharCode(b.charCode):"";b.charOrCode=b.keyChar||b.keyCode}m.add("events-keypress-typed",function(){var b={charCode:0};try{b=document.createEvent("KeyboardEvent"),(b.initKeyboardEvent||b.initKeyEvent).call(b,"keypress",!0,!0,null,!1,!1,!1,
!1,9,3)}catch(z){}return 0==b.charCode&&!m("opera")});var b={106:42,111:47,186:59,187:43,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39,229:113},e=m("mac")?"metaKey":"ctrlKey",q=function(b,a){a=n.mixin({},b,a);h(a);a.preventDefault=function(){b.preventDefault()};a.stopPropagation=function(){b.stopPropagation()};return a},p;p=m("events-keypress-typed")?function(a,e){var g=c(a,"keydown",function(a){var g=a.keyCode,d=13!=g&&32!=g&&(27!=g||!m("ie"))&&(48>g||90<g)&&(96>g||111<g)&&(186>
g||192<g)&&(219>g||222<g)&&229!=g;if(d||a.ctrlKey){d=d?0:g;if(a.ctrlKey){if(3==g||13==g)return e.call(a.currentTarget,a);d=95<d&&106>d?d-48:!a.shiftKey&&65<=d&&90>=d?d+32:b[d]||d}g=q(a,{type:"keypress",faux:!0,charCode:d});e.call(a.currentTarget,g);if(m("ie"))try{a.keyCode=g.keyCode}catch(w){}}}),d=c(a,"keypress",function(b){var a=b.charCode;b=q(b,{charCode:32<=a?a:0,faux:!0});return e.call(this,b)});return{remove:function(){g.remove();d.remove()}}}:m("opera")?function(b,a){return c(b,"keypress",
function(b){var e=b.which;3==e&&(e=99);e=32>e&&!b.shiftKey?0:e;b.ctrlKey&&!b.shiftKey&&65<=e&&90>=e&&(e+=32);return a.call(this,q(b,{charCode:e}))})}:function(b,a){return c(b,"keypress",function(b){h(b);return a.call(this,b)})};var t={_keypress:p,connect:function(b,a,e,d,c){var h=arguments,p=[],q=0;p.push("string"==typeof h[0]?null:h[q++],h[q++]);var m=h[q+1];p.push("string"==typeof m||"function"==typeof m?h[q++]:null,h[q++]);for(m=h.length;q<m;q++)p.push(h[q]);return g.apply(this,p)},disconnect:function(b){b&&
b.remove()},subscribe:function(b,a,e){return k.subscribe(b,n.hitch(a,e))},publish:function(b,a){return k.publish.apply(k,[b].concat(a))},connectPublisher:function(b,a,e){var g=function(){t.publish(b,arguments)};return e?t.connect(a,e,g):t.connect(a,g)},isCopyKey:function(b){return b[e]}};t.unsubscribe=t.disconnect;n.mixin(f,t);return t})},"dojo/errors/CancelError":function(){define(["./create"],function(f){return f("CancelError",null,null,{dojoType:"cancel",log:!1})})}}});
require({cache:{"com/huayun/webgis/geometry/Geometry":function(){define([],function(){function f(){this.spatialReference=this.extent=null;this.type="";this.hasZ=this.hasM=!1}f.prototype.clone=function(){};f.prototype.update=function(){};return f})},"com/huayun/webgis/renderer/SimpleRenderer":function(){define(["./FillRenderer","./LineRenderer","./CircleRenderer","./ImageRenderer"],function(f,c,k,l){function d(){this.lineRenderer=new c;this.fillRenderer=new f;this.circleRenderer=new k;this.imageRenderer=
new l}d.prototype.add=function(a,d,c,g){switch(g.type){case "line":this.lineRenderer.add(a,d,c,g);break;case "polygon":this.fillRenderer.add(a,d,c,g);break;case "circle":this.circleRenderer.add(a,d,c,g);break;case "image":this.imageRenderer.add(a,d,c,g)}};d.prototype.draw=function(a,d,c,g,h,b){switch(g.type){case "line":this.lineRenderer.draw(a,d,c,g,h,b);break;case "polygon":this.fillRenderer.draw(a,d,c,g,h,b);break;case "circle":this.circleRenderer.draw(a,d,c,g,h,b);break;case "image":this.imageRenderer.draw(a,
d,c,g,h,b)}};d.prototype.calculateExtent=function(a,d,c,g,h){switch(g.type){case "line":this.lineRenderer.calculateExtent(a,d,c,g,h);break;case "polygon":this.fillRenderer.calculateExtent(a,d,c,g,h);break;case "circle":this.circleRenderer.calculateExtent(a,d,c,g,h);break;case "image":this.imageRenderer.calculateExtent(a,d,c,g,h)}};return d})},"com/huayun/webgis/data/bucket/ImageBucketSimplify":function(){define(["../ArrayType","../../gl/SegmentVector","../../geometry/Anchor","../../geometry/Point2D"],
function(f,c,k,l){var d=function(){this.layoutVertexArray=new f.StructArrayLayout2f4ib16;this.indexArray=new f.StructArrayLayout3ui6;this.segments=new c};d.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy())};d.prototype.addFeature=function(a,d,c,g){var h,b=g[0]-.5*d,e=g[1]-.5*c;g=e+c;h=b+d;for(var q=0;q<a.length;q+=1)for(var p=0,m=a[q];p<m.length;p+=1){var n=m[p],n=new k(n.x,n.y),f=d,y=c,u=e,r=b,x=g,A=h,w=void 0,
B=void 0,D=void 0,E=void 0,w=new l(r,u),B=new l(A,u),D=new l(A,x),E=new l(r,x);this.addSymbols([{tl:w,tr:B,bl:E,br:D,tex:{x:0,y:0,w:f,h:y}}],n)}};d.prototype.addSymbols=function(a,d){for(var c=this.indexArray,g=this.layoutVertexArray,h=this.segments.prepareSegment(4*a.length,this.layoutVertexArray,this.indexArray),b=0;b<a.length;b+=1){var e=a[b],q=e.tl,p=e.tr,m=e.bl,f=e.br,e=e.tex,k=h.vertexLength;g.emplaceBack(d.x,d.y,Math.round(32*q.x),Math.round(32*q.y),e.x,e.y);g.emplaceBack(d.x,d.y,Math.round(32*
p.x),Math.round(32*p.y),e.x+e.w,e.y);g.emplaceBack(d.x,d.y,Math.round(32*m.x),Math.round(32*m.y),e.x,e.y+e.h);g.emplaceBack(d.x,d.y,Math.round(32*f.x),Math.round(32*f.y),e.x+e.w,e.y+e.h);c.emplaceBack(k,k+1,k+2);c.emplaceBack(k+1,k+2,k+3);h.vertexLength+=4;h.primitiveLength+=2}};d.prototype.upload=function(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,[{name:"a_pos",type:"Float32",components:2,offset:0},{name:"a_data",type:"Int16",components:4,offset:8}]);this.indexBuffer=
a.createIndexBuffer(this.indexArray)};return d})},"dojo/text":function(){define(["./_base/kernel","require","./has","./request"],function(f,c,k,l){var d;d=function(a,b,e){l(a,{sync:!!b,headers:{"X-Requested-With":null}}).then(e)};var a={},m=function(a){if(a){a=a.replace(/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,"");var b=a.match(/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im);b&&(a=b[1])}else a="";return a},n={},g={};f.cache=function(g,b,e){var h;"string"==typeof g?/\//.test(g)?(h=g,e=b):
h=c.toUrl(g.replace(/\./g,"/")+(b?"/"+b:"")):(h=g+"",e=b);g=void 0!=e&&"string"!=typeof e?e.value:e;e=e&&e.sanitize;if("string"==typeof g)return a[h]=g,e?m(g):g;if(null===g)return delete a[h],null;h in a||d(h,!0,function(b){a[h]=b});return e?m(a[h]):a[h]};return{dynamic:!0,normalize:function(a,b){a=a.split("!");var e=a[0];return(/^\./.test(e)?b(e):e)+(a[1]?"!"+a[1]:"")},load:function(c,b,e){c=c.split("!");var h=1<c.length,p=c[0],f=b.toUrl(c[0]);c="url:"+f;var k=n,l=function(b){e(h?m(b):b)};p in a?
k=a[p]:b.cache&&c in b.cache?k=b.cache[c]:f in a&&(k=a[f]);if(k===n)if(g[f])g[f].push(l);else{var y=g[f]=[l];d(f,!b.async,function(b){a[p]=a[f]=b;for(var e=0;e<y.length;)y[e++](b);delete g[f]})}else l(k)}}})},"com/huayun/webgis/gl/uniform":function(){define(["exports","../utils/Color"],function(f,c){var k=function(b,a){this.gl=b.gl;this.location=a},l=function(b){function a(a,e){b.call(this,a,e);this.current=0}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.set=
function(b){this.current!==b&&(this.current=b,this.gl.uniform1i(this.location,b))};return a}(k),d=function(b){function a(a,e){b.call(this,a,e);this.current=0}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.set=function(b){this.current!==b&&(this.current=b,this.gl.uniform1f(this.location,b))};return a}(k),a=function(b){function a(a,e){b.call(this,a,e);this.current=[0,0]}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=
a;a.prototype.set=function(b){if(b[0]!==this.current[0]||b[1]!==this.current[1])this.current=b,this.gl.uniform2f(this.location,b[0],b[1])};return a}(k),m=function(b){function a(a,e){b.call(this,a,e);this.current=[0,0,0]}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.set=function(b){if(b[0]!==this.current[0]||b[1]!==this.current[1]||b[2]!==this.current[2])this.current=b,this.gl.uniform3f(this.location,b[0],b[1],b[2])};return a}(k),n=function(b){function a(a,
e){b.call(this,a,e);this.current=[0,0,0,0]}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.set=function(b){if(b[0]!==this.current[0]||b[1]!==this.current[1]||b[2]!==this.current[2]||b[3]!==this.current[3])this.current=b,this.gl.uniform4f(this.location,b[0],b[1],b[2],b[3])};return a}(k),g=function(b){function a(a,e){b.call(this,a,e);this.current=c.transparent}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.set=
function(b){if(b.r!==this.current.r||b.g!==this.current.g||b.b!==this.current.b||b.a!==this.current.a)this.current=b,this.gl.uniform4f(this.location,b.r,b.g,b.b,b.a)};return a}(k),h=new Float32Array(16),k=function(b){function a(a,e){b.call(this,a,e);this.current=h}b&&(a.__proto__=b);a.prototype=Object.create(b&&b.prototype);a.prototype.constructor=a;a.prototype.set=function(b){if(b[12]!==this.current[12]||b[0]!==this.current[0])this.current=b,this.gl.uniformMatrix4fv(this.location,!1,b);else for(var a=
1;16>a;a++)if(b[a]!==this.current[a]){this.current=b;this.gl.uniformMatrix4fv(this.location,!1,b);break}};return a}(k);f.Uniform1f=d;f.Uniform1i=l;f.Uniform2f=a;f.Uniform3f=m;f.Uniform4f=n;f.UniformMatrix4f=k;f.UniformColor=g})},"com/huayun/webgis/data/ArrayType":function(){define(["require","exports","./struct"],function(f,c,k){Object.defineProperty(c,"__esModule",{value:!0});f=function(){function d(){this.isTransferred=!1;this.capacity=-1;this.resize(0)}d.serialize=function(a,d){a._trim();d&&(a.isTransferred=
!0,d.push(a.arrayBuffer));return{length:a.length,arrayBuffer:a.arrayBuffer}};d.deserialize=function(a){var d=Object.create(this.prototype);d.arrayBuffer=a.arrayBuffer;d.length=a.length;d.capacity=a.arrayBuffer.byteLength/d.bytesPerElement;d._refreshViews();return d};d.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())};d.prototype.clear=function(){this.length=0};d.prototype.resize=
function(a){this.reserve(a);this.length=a};d.prototype.reserve=function(a){a>this.capacity&&(this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement),a=this.uint8,this._refreshViews(),a&&this.uint8.set(a))};d.prototype._refreshViews=function(){throw Error("_refreshViews() must be implemented by each concrete StructArray layout");};return d}();c.StructArray=f;var l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=
d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d){var g=this.length;this.resize(g+1);return this.emplace(g,a,d)};a.prototype.emplace=function(a,d,g){var c=2*a;this.int16[c]=d;this.int16[c+1]=g;return a};return a}(f);l.prototype.bytesPerElement=4;c.StructArrayLayout2i4=l;l=function(d){function a(){d.apply(this,arguments)}
d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d){var g=this.length;this.resize(g+1);return this.emplace(g,a,d)};a.prototype.emplace=function(a,d,g){var c=2*a;this.uint16[c]=d;this.uint16[c+1]=g;return a};return a}(f);l.prototype.bytesPerElement=4;c.StructArrayLayout2ui4=l;l=function(d){function a(){d.apply(this,
arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int32=new Int32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d){var g=this.length;this.resize(g+1);return this.emplace(g,a,d)};a.prototype.emplace=function(a,d,g){var c=2*a;this.int32[c]=d;this.int32[c+1]=g;return a};return a}(f);l.prototype.bytesPerElement=8;c.StructArrayLayout2i8=l;l=function(d){function a(){d.apply(this,
arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b,e){var h=this.length;this.resize(h+1);return this.emplace(h,a,d,g,c,b,e)};a.prototype.emplace=function(a,d,g,c,b,e,q){var h=4*a,m=8*a;this.int16[h]=d;this.int16[h+1]=g;this.uint8[m+4]=c;this.uint8[m+5]=b;this.uint8[m+6]=e;this.uint8[m+
7]=q;return a};return a}(f);l.prototype.bytesPerElement=8;c.StructArrayLayout2i4ub8=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b,e,q,p){var h=this.length;this.resize(h+1);return this.emplace(h,
a,d,g,c,b,e,q,p)};a.prototype.emplace=function(a,d,g,c,b,e,q,p,f){var h=8*a;this.int16[h+0]=d;this.int16[h+1]=g;this.int16[h+2]=c;this.int16[h+3]=b;this.uint16[h+4]=e;this.uint16[h+5]=q;this.uint16[h+6]=p;this.uint16[h+7]=f;return a};return a}(f);l.prototype.bytesPerElement=16;c.StructArrayLayout4i4ui16=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);
this.uint16=new Uint16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g){var c=this.length;this.resize(c+1);return this.emplace(c,a,d,g)};a.prototype.emplace=function(a,d,g,c){var b=3*a;this.uint16[b+0]=d;this.uint16[b+1]=g;this.uint16[b+2]=c;return a};return a}(f);l.prototype.bytesPerElement=6;c.StructArrayLayout3ui6=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=
new Uint8Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g){var c=this.length;this.resize(c+1);return this.emplace(c,a,d,g)};a.prototype.emplace=function(a,d,g,c){var b=3*a;this.uint32[b+0]=d;this.uint32[b+1]=g;this.uint32[b+2]=c;return a};return a}(f);l.prototype.bytesPerElement=12;c.StructArrayLayout3ui12=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=
a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g){var c=this.length;this.resize(c+1);return this.emplace(c,a,d,g)};a.prototype.emplace=function(a,d,g,c){var b=3*a;this.float32[b+0]=d;this.float32[b+1]=g;this.float32[b+2]=c;return a};return a}(f);l.prototype.bytesPerElement=12;c.StructArrayLayout3f12=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=
Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a){var d=this.length;this.resize(d+1);return this.emplace(d,a)};a.prototype.emplace=function(a,d){this.uint32[1*a+0]=d;return a};return a}(f);l.prototype.bytesPerElement=4;c.StructArrayLayout1ul4=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&
d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int32=new Float32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b,e){var h=this.length;this.resize(h+1);return this.emplace(h,a,d,g,c,b,e)};a.prototype.emplace=function(a,d,g,c,b,e,q){var h=3*a,m=12*a;this.int32[h]=d;this.int32[h+1]=g;this.uint8[m+8]=c;this.uint8[m+9]=b;this.uint8[m+10]=e;this.uint8[m+11]=q;return a};return a}(f);l.prototype.bytesPerElement=
12;c.StructArrayLayout2i4ub12=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b,e,q,p,f,k,l,y,u,r,x){var h=
this.length;this.resize(h+1);return this.emplace(h,a,d,g,c,b,e,q,p,f,k,l,y,u,r,x)};a.prototype.emplace=function(a,d,g,c,b,e,q,p,f,k,l,y,u,r,x,A){var h=22*a,m=11*a,n=44*a;this.int16[h+0]=d;this.int16[h+1]=g;this.uint16[h+2]=c;this.uint16[h+3]=b;this.uint32[m+2]=e;this.uint32[m+3]=q;this.uint32[m+4]=p;this.uint16[h+10]=f;this.uint16[h+11]=k;this.uint16[h+12]=l;this.float32[m+7]=y;this.float32[m+8]=u;this.uint8[n+36]=r;this.uint8[n+37]=x;this.uint32[m+10]=A;return a};return a}(f);l.prototype.bytesPerElement=
44;c.StructArrayLayout2i2ui3ul3ui2f2ub1ul44=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c){var b=this.length;this.resize(b+1);return this.emplace(b,a,d,g,c)};a.prototype.emplace=function(a,d,g,c,b){var e=12*a,h=3*a;this.uint8[e+0]=d;this.uint8[e+
1]=g;this.float32[h+1]=c;this.float32[h+2]=b;return a};return a}(f);l.prototype.bytesPerElement=12;c.StructArrayLayout2ub2f12=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b,e){var h=this.length;this.resize(h+1);return this.emplace(h,a,d,g,
c,b,e)};a.prototype.emplace=function(a,d,g,c,b,e,q){var h=6*a;this.int16[h+0]=d;this.int16[h+1]=g;this.int16[h+2]=c;this.int16[h+3]=b;this.int16[h+4]=e;this.int16[h+5]=q;return a};return a}(f);l.prototype.bytesPerElement=12;c.StructArrayLayout2i2i2i12=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Float32Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};
a.prototype.emplaceBack=function(a,d,g,c,b,e){var h=this.length;this.resize(h+1);return this.emplace(h,a,d,g,c,b,e)};a.prototype.emplace=function(a,d,g,c,b,e,q){var h=6*a;this.float32[h+0]=d;this.float32[h+1]=g;this.float32[h+2]=c;this.float32[h+3]=b;this.float32[h+4]=e;this.float32[h+5]=q;return a};return a}(f);l.prototype.bytesPerElement=24;c.StructArrayLayout6fb24=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=
a;a.prototype._refreshViews=function(){this.uint8=new Float32Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b,e,q,p){var h=this.length;this.resize(h+1);return this.emplace(h,a,d,g,c,b,e,q,p)};a.prototype.emplace=function(a,d,g,c,b,e,q,p,f){var h=7*a,m=14*a;this.float32[h+0]=d;this.float32[h+1]=g;this.float32[h+2]=c;this.float32[h+3]=b;this.float32[h+4]=e;this.float32[h+5]=q;this.int16[m+
12]=p;this.int16[m+13]=f;return a};return a}(f);l.prototype.bytesPerElement=28;c.StructArrayLayout6f2ib28=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Float32Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b,e,q,p,f){var h=this.length;this.resize(h+
1);return this.emplace(h,a,d,g,c,b,e,q,p,f)};a.prototype.emplace=function(a,d,g,c,b,e,q,p,f,k){var h=8*a,m=16*a;this.float32[h+0]=d;this.float32[h+1]=g;this.float32[h+2]=c;this.float32[h+3]=b;this.float32[h+4]=e;this.float32[h+5]=q;this.float32[h+6]=p;this.int16[m+14]=f;this.int16[m+15]=k;return a};return a}(f);l.prototype.bytesPerElement=32;c.StructArrayLayout7f2ib32=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=
a;a.prototype._refreshViews=function(){this.uint8=new Float32Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b,e,q){var h=this.length;this.resize(h+1);return this.emplace(h,a,d,g,c,b,e,q)};a.prototype.emplace=function(a,d,g,c,b,e,q,p){var h=7*a;this.float32[h+0]=d;this.float32[h+1]=g;this.float32[h+2]=c;this.float32[h+3]=b;this.float32[h+4]=e;this.float32[h+5]=q;this.float32[h+6]=p;return a};return a}(f);l.prototype.bytesPerElement=
28;c.StructArrayLayout7fb28=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b,e,q,p,f,k,l){var h=this.length;this.resize(h+1);return this.emplace(h,a,
d,g,c,b,e,q,p,f,k,l)};a.prototype.emplace=function(a,d,g,c,b,e,q,p,f,k,l,y){var h=12*a;this.int16[h+0]=d;this.int16[h+1]=g;this.int16[h+2]=c;this.int16[h+3]=b;this.int16[h+4]=e;this.int16[h+5]=q;this.uint32[6*a+3]=p;this.uint16[h+8]=f;this.uint16[h+9]=k;this.int16[h+10]=l;this.int16[h+11]=y;return a};return a}(f);l.prototype.bytesPerElement=24;c.StructArrayLayout6i1ul2ui2i24=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=
a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a){var d=this.length;this.resize(d+1);return this.emplace(d,a)};a.prototype.emplace=function(a,d){this.float32[1*a+0]=d;return a};return a}(f);l.prototype.bytesPerElement=4;c.StructArrayLayout1f4=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;
a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g){var c=this.length;this.resize(c+1);return this.emplace(c,a,d,g)};a.prototype.emplace=function(a,d,g,c){var b=3*a;this.int16[b+0]=d;this.int16[b+1]=g;this.int16[b+2]=c;return a};return a}(f);l.prototype.bytesPerElement=6;c.StructArrayLayout3i6=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&
d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b,e,q,p,f,k,l,y,u,r,x,A,w,B){var h=this.length;this.resize(h+1);return this.emplace(h,a,d,g,c,b,e,q,p,f,k,l,y,u,r,x,A,w,B)};a.prototype.emplace=function(a,
d,g,c,b,e,q,p,f,k,l,y,u,r,x,A,w,B,D){var h=22*a,m=11*a;this.int16[h+0]=d;this.int16[h+1]=g;this.int16[h+2]=c;this.int16[h+3]=b;this.int16[h+4]=e;this.int16[h+5]=q;this.uint16[h+6]=p;this.uint16[h+7]=f;this.uint16[h+8]=k;this.uint16[h+9]=l;this.uint16[h+10]=y;this.uint16[h+11]=u;this.uint16[h+12]=r;this.uint16[h+13]=x;this.uint16[h+14]=A;this.uint32[m+8]=w;this.float32[m+9]=B;this.float32[m+10]=D;return a};return a}(f);l.prototype.bytesPerElement=44;c.StructArrayLayout6i9ui1ul2f44=l;l=function(d){function a(){d.apply(this,
arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint32=new Uint32Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g){var c=this.length;this.resize(c+1);return this.emplace(c,a,d,g)};a.prototype.emplace=function(a,d,g,c){var b=4*a;this.uint32[2*a+0]=d;this.uint16[b+2]=g;this.uint16[b+3]=c;return a};return a}(f);
l.prototype.bytesPerElement=8;c.StructArrayLayout1ul2ui8=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b,e){var h=this.length;this.resize(h+1);return this.emplace(h,a,d,g,c,b,e)};a.prototype.emplace=
function(a,d,g,c,b,e,q){var h=4*a,f=8*a;this.float32[h+0]=d;this.float32[h+1]=g;this.int16[f+4]=c;this.int16[f+5]=b;this.int16[f+6]=e;this.int16[f+7]=q;return a};return a}(f);l.prototype.bytesPerElement=16;c.StructArrayLayout2f4ib16=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer);this.float32=
new Float32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c){var b=this.length;this.resize(b+1);return this.emplace(b,a,d,g,c)};a.prototype.emplace=function(a,d,g,c,b){var e=3*a,h=6*a;this.float32[e+0]=d;this.float32[e+1]=g;this.int16[h+4]=c;this.int16[h+5]=b;return a};return a}(f);l.prototype.bytesPerElement=12;c.StructArrayLayout2f2ib12=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype.get=
function(a){return new k.CollisionBoxStruct(this,a)};return a}(c.StructArrayLayout6i1ul2ui2i24);c.CollisionBoxArray=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype.getoffsetX=function(a){return this.float32[1*a+0]};a.prototype.get=function(a){return new GlyphOffsetStruct(this,a)};return a}(c.StructArrayLayout1f4);c.GlyphOffsetArray=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=
d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype.getx=function(a){return this.int16[3*a+0]};a.prototype.gety=function(a){return this.int16[3*a+1]};a.prototype.gettileUnitDistanceFromAnchor=function(a){return this.int16[3*a+2]};a.prototype.get=function(a){return new SymbolLineVertexStruct(this,a)};return a}(c.StructArrayLayout3i6);c.SymbolLineVertexArray=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);
a.prototype.constructor=a;a.prototype.get=function(a){return new k.SymbolInstanceStruct(this,a)};return a}(c.StructArrayLayout6i9ui1ul2f44);c.SymbolInstanceArray=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype.get=function(a){return new k.FeatureIndexStruct(this,a)};return a}(c.StructArrayLayout1ul2ui8);c.FeatureIndexArray=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);
a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d){var g=this.length;this.resize(g+1);return this.emplace(g,a,d)};a.prototype.emplace=function(a,d,g){var c=2*a;this.float32[c+0]=d;this.float32[c+1]=g;return a};return a}(f);l.prototype.bytesPerElement=8;c.StructArrayLayout2f8=l;l=function(d){function a(){d.apply(this,
arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b){var e=this.length;this.resize(e+1);return this.emplace(e,a,d,g,c,b)};a.prototype.emplace=function(a,d,g,c,b,e){var h=5*a;this.float32[h+0]=d;this.float32[h+1]=g;this.float32[h+2]=c;this.float32[h+3]=b;this.float32[h+4]=e;return a};
return a}(f);l.prototype.bytesPerElement=20;c.StructArrayLayout5fb20=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.float32=new Float32Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c){var b=this.length;this.resize(b+1);return this.emplace(b,a,d,g,c)};a.prototype.emplace=function(a,d,g,c,b){var e=4*a;this.float32[e+
0]=d;this.float32[e+1]=g;this.float32[e+2]=c;this.float32[e+3]=b;return a};return a}(f);l.prototype.bytesPerElement=16;c.StructArrayLayout4f16=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.uint16=new Uint16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b,e,f,p){var h=this.length;this.resize(h+1);return this.emplace(h,
a,d,g,c,b,e,f,p)};a.prototype.emplace=function(a,d,g,c,b,e,f,p,k){var h=8*a;this.uint16[h+0]=d;this.uint16[h+1]=g;this.uint16[h+2]=c;this.uint16[h+3]=b;this.uint16[h+4]=e;this.uint16[h+5]=f;this.uint16[h+6]=p;this.uint16[h+7]=k;return a};return a}(f);l.prototype.bytesPerElement=16;c.StructArrayLayout8ui16=l;c.PlacedSymbolArray=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype.get=function(a){return new k.PlacedSymbolStruct(this,
a)};return a}(c.StructArrayLayout2i2ui3ul3ui2f2ub1ul44);l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c,b,e){var h=this.length;this.resize(h+1);return this.emplace(h,a,d,g,c,b,e)};a.prototype.emplace=function(a,d,g,c,b,e,f){var h=6*a;this.int16[h+
0]=d;this.int16[h+1]=g;this.int16[h+2]=c;this.int16[h+3]=b;this.int16[h+4]=e;this.int16[h+5]=f;return a};return a}(f);l.prototype.bytesPerElement=12;c.StructArrayLayout2i4i12=l;l=function(d){function a(){d.apply(this,arguments)}d&&(a.__proto__=d);a.prototype=Object.create(d&&d.prototype);a.prototype.constructor=a;a.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer);this.int16=new Int16Array(this.arrayBuffer)};a.prototype.emplaceBack=function(a,d,g,c){var b=this.length;
this.resize(b+1);return this.emplace(b,a,d,g,c)};a.prototype.emplace=function(a,d,g,c,b){var e=4*a;this.int16[e+0]=d;this.int16[e+1]=g;this.int16[e+2]=c;this.int16[e+3]=b;return a};return a}(f);l.prototype.bytesPerElement=8;c.StructArrayLayout4i8=l})},"com/huayun/webgis/gl/GridIndex":function(){define([],function(){function f(c,f,l){var d=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var a=new Int32Array(this.arrayBuffer);c=a[0];f=a[1];l=a[2];this.d=f+2*l;for(var m=0;m<this.d*this.d;m++){var n=
a[3+m],g=a[3+m+1];d.push(n===g?null:a.subarray(n,g))}m=a[3+d.length+1];this.keys=a.subarray(a[3+d.length],m);this.bboxes=a.subarray(m);this.insert=this._insertReadonly}else{this.d=f+2*l;for(a=0;a<this.d*this.d;a++)d.push([]);this.keys=[];this.bboxes=[]}this.n=f;this.extent=c;this.padding=l;this.scale=f/c;this.uid=0;f=l/f*c;this.min=-f;this.max=c+f}f.prototype.insert=function(c,f,l,d,a){this._forEachCell(f,l,d,a,this._insertCell,this.uid++);this.keys.push(c);this.bboxes.push(f);this.bboxes.push(l);
this.bboxes.push(d);this.bboxes.push(a)};f.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer.";};f.prototype._insertCell=function(c,f,l,d,a,m){this.cells[a].push(m)};f.prototype.query=function(c,f,l,d,a){var m=this.min,n=this.max;if(c<=m&&f<=m&&n<=l&&n<=d&&!a)return Array.prototype.slice.call(this.keys);m=[];this._forEachCell(c,f,l,d,this._queryCell,m,{},a);return m};f.prototype._queryCell=function(c,f,l,d,a,m,n,g){a=this.cells[a];if(null!==a)for(var h=
this.keys,b=this.bboxes,e=0;e<a.length;e++){var q=a[e];if(void 0===n[q]){var p=4*q;(g?g(b[p+0],b[p+1],b[p+2],b[p+3]):c<=b[p+2]&&f<=b[p+3]&&l>=b[p+0]&&d>=b[p+1])?(n[q]=!0,m.push(h[q])):n[q]=!1}}};f.prototype._forEachCell=function(c,f,l,d,a,m,n,g){for(var h=this._convertToCellCoord(c),b=this._convertToCellCoord(f),e=this._convertToCellCoord(l),q=this._convertToCellCoord(d);h<=e;h++)for(var p=b;p<=q;p++){var k=this.d*p+h;if((!g||g(this._convertFromCellCoord(h),this._convertFromCellCoord(p),this._convertFromCellCoord(h+
1),this._convertFromCellCoord(p+1)))&&a.call(this,c,f,l,d,k,m,n,g))return}};f.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale};f.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))};f.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,f=3+this.cells.length+1+1,l=0,d=0;d<this.cells.length;d++)l+=this.cells[d].length;l=new Int32Array(f+l+this.keys.length+this.bboxes.length);
l[0]=this.extent;l[1]=this.n;l[2]=this.padding;for(d=0;d<c.length;d++){var a=c[d];l[3+d]=f;l.set(a,f);f+=a.length}l[3+c.length]=f;l.set(this.keys,f);f+=this.keys.length;l[3+c.length+1]=f;l.set(this.bboxes,f);f+=this.bboxes.length;return l.buffer};return f})},"com/huayun/webgis/gl/constantBinder":function(){define(["exports","./uniform","./dataTransfer","../layers/support/EvaluationParameters","../utils/utils"],function(f,c,k,l,d){var a=function(b,a,d){this.value=b;this.names=a;this.uniformNames=this.names.map(function(b){return"u_"+
b});this.type=d;this.maxValue=-Infinity};a.prototype.defines=function(){return this.names.map(function(b){return"#define HAS_UNIFORM_u_"+b})};a.prototype.setConstantPatternPositions=function(){};a.prototype.populatePaintArray=function(){};a.prototype.updatePaintArray=function(){};a.prototype.upload=function(){};a.prototype.destroy=function(){};a.prototype.setUniforms=function(b,a,d,g){a.set(g.constantOr(this.value))};a.prototype.setUniform=function(b,a,d){a.set(d)};a.prototype.getBinding=function(b,
a){return"color"===this.type?new c.UniformColor(b,a):new c.Uniform1f(b,a)};a.serialize=function(a){var b=a.names,d=a.type;return{value:k.serialize(a.value),names:b,type:d}};a.deserialize=function(b){var e=b.names,d=b.type;return new a(k.deserialize(b.value),e,d)};var m=function(a,e,d){this.value=a;this.names=e;this.uniformNames=this.names.map(function(a){return"u_"+a});this.type=d;this.maxValue=-Infinity;this.patternPositions={patternTo:null,patternFrom:null}};m.prototype.defines=function(){return this.names.map(function(a){return"#define HAS_UNIFORM_u_"+
a})};m.prototype.populatePaintArray=function(){};m.prototype.updatePaintArray=function(){};m.prototype.upload=function(){};m.prototype.destroy=function(){};m.prototype.setConstantPatternPositions=function(a,e){this.patternPositions.patternTo=a.tlbr;this.patternPositions.patternFrom=e.tlbr};m.prototype.setUniforms=function(a,e,d,g,c){a=this.patternPositions;"u_pattern_to"===c&&a.patternTo&&e.set(a.patternTo);"u_pattern_from"===c&&a.patternFrom&&e.set(a.patternFrom)};m.prototype.getBinding=function(a,
e){return new c.Uniform4f(a,e)};var n=function(a,e,d,g){this.expression=a;this.names=e;this.type=d;this.uniformNames=this.names.map(function(a){return"a_"+a});this.maxValue=-Infinity;this.paintVertexAttributes=e.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===d?2:1,offset:0}});this.paintVertexArray=new g};n.prototype.defines=function(){return[]};n.prototype.setConstantPatternPositions=function(){};n.prototype.populatePaintArray=function(a,e){var b=this.paintVertexArray,g=b.length;
b.reserve(a);e=this.expression.evaluate(new l(0),e,{});if("color"===this.type)for(e=d.packColor(e);g<a;g++)b.emplaceBack(e[0],e[1]);else{for(;g<a;g++)b.emplaceBack(e);this.maxValue=Math.max(this.maxValue,e)}};n.prototype.updatePaintArray=function(a,e,g,c){var b=this.paintVertexArray;g=this.expression.evaluate({zoom:0},g,c);if("color"===this.type)for(g=d.packColor(g);a<e;a++)b.emplace(a,g[0],g[1]);else{for(;a<e;a++)b.emplace(a,g);this.maxValue=Math.max(this.maxValue,g)}};n.prototype.upload=function(a){this.paintVertexArray&&
this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))};n.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};n.prototype.setUniforms=function(a,e){e.set(0)};n.prototype.getBinding=function(a,e){return new c.Uniform1f(a,e)};var g=function(a,e,d,g,
c,h){this.expression=a;this.names=e;this.uniformNames=this.names.map(function(a){return"u_"+a+"_t"});this.type=d;this.useIntegerZoom=g;this.zoom=c;this.maxValue=-Infinity;this.paintVertexAttributes=e.map(function(a){return{name:"a_"+a,type:"Float32",components:"color"===d?4:2,offset:0}});this.paintVertexArray=new h};g.prototype.defines=function(){return[]};g.prototype.setConstantPatternPositions=function(){};g.prototype.populatePaintArray=function(a,e){var b=this.paintVertexArray,g=b.length;b.reserve(a);
var c=this.expression.evaluate(new l(this.zoom),e,{});e=this.expression.evaluate(new l(this.zoom+1),e,{});if("color"===this.type)for(c=d.packColor(c),e=d.packColor(e);g<a;g++)b.emplaceBack(c[0],c[1],e[0],e[1]);else{for(;g<a;g++)b.emplaceBack(c,e);this.maxValue=Math.max(this.maxValue,c,e)}};g.prototype.updatePaintArray=function(a,e,g,c){var b=this.paintVertexArray,h=this.expression.evaluate({zoom:this.zoom},g,c);g=this.expression.evaluate({zoom:this.zoom+1},g,c);if("color"===this.type)for(h=d.packColor(h),
g=d.packColor(g);a<e;a++)b.emplace(a,h[0],h[1],g[0],g[1]);else{for(;a<e;a++)b.emplace(a,h,g);this.maxValue=Math.max(this.maxValue,h,g)}};g.prototype.upload=function(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))};g.prototype.destroy=function(){this.paintVertexBuffer&&
this.paintVertexBuffer.destroy()};g.prototype.interpolationFactor=function(a){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(a),this.zoom,this.zoom+1):this.expression.interpolationFactor(a,this.zoom,this.zoom+1)};g.prototype.setUniforms=function(a,e,d){e.set(this.interpolationFactor(d.zoom))};g.prototype.getBinding=function(a,e){return new c.Uniform1f(a,e)};var h=function(a,e,d,g,c,h,f){this.expression=a;this.names=e;this.type=d;this.uniformNames=this.names.map(function(a){return"u_"+
a+"_t"});this.useIntegerZoom=g;this.zoom=c;this.maxValue=-Infinity;this.layerId=f;this.paintVertexAttributes=e.map(function(a){return{name:"a_"+a,type:"Uint16",components:4,offset:0}});this.zoomInPaintVertexArray=new h;this.zoomOutPaintVertexArray=new h};h.prototype.defines=function(){return[]};h.prototype.setConstantPatternPositions=function(){};h.prototype.populatePaintArray=function(a,e,d){var b=this.zoomInPaintVertexArray,g=this.zoomOutPaintVertexArray,c=this.layerId,h=b.length;b.reserve(a);g.reserve(a);
if(d&&e.patterns&&e.patterns[c]){var f=e.patterns[c];e=d[f.min];c=d[f.mid];d=d[f.max];if(e&&c&&d)for(;h<a;h++)b.emplaceBack(c.tl[0],c.tl[1],c.br[0],c.br[1],e.tl[0],e.tl[1],e.br[0],e.br[1]),g.emplaceBack(c.tl[0],c.tl[1],c.br[0],c.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1])}};h.prototype.updatePaintArray=function(a,e,d,g,c){g=this.zoomInPaintVertexArray;var b=this.zoomOutPaintVertexArray,h=this.layerId;if(c&&d.patterns&&d.patterns[h]){var p=d.patterns[h];d=c[p.min];h=c[p.mid];c=c[p.max];if(d&&h&&c)for(;a<
e;a++)g.emplace(a,h.tl[0],h.tl[1],h.br[0],h.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1]),b.emplace(a,h.tl[0],h.tl[1],h.br[0],h.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1])}};h.prototype.upload=function(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=
a.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))};h.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy();this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};h.prototype.setUniforms=function(a,e){e.set(0)};h.prototype.getBinding=function(a,e){return new c.Uniform1f(a,e)};k.register("ConstantBinder",a);k.register("CrossFadedConstantBinder",m);k.register("SourceExpressionBinder",
n);k.register("CrossFadedCompositeBinder",h);k.register("CompositeExpressionBinder",g);f.ConstantBinder=a;f.CrossFadedConstantBinder=m;f.SourceExpressionBinder=n;f.CrossFadedCompositeBinder=h;f.CompositeExpressionBinder=g})},"com/huayun/webgis/layers/support/style/PossiblyEvaluatedPropertyValue":function(){define([],function(){var f=function(c,f,l){this.property=c;this.value=f;this.parameters=l};f.prototype.isConstant=function(){return"constant"===this.value.kind};f.prototype.constantOr=function(c){return"constant"===
this.value.kind?this.value.value:c};f.prototype.evaluate=function(c,f){return this.property.evaluate(this.value,this.parameters,c,f)};return f})},"com/huayun/webgis/BaseMap":function(){define([],1)},"com/huayun/webgis/facade/MapConfigFacade":function(){define(["dojo/_base/declare","dojo/request"],function(f,c){return f("com.huayun.webgis.facade.MapConfigFacade",null,{url:"",constructor:function(c){this._url=c.url},getMapConfigData:function(f,l){c.get(this._url,{handleAs:"json"}).then(function(d){f(d)},
function(d){l(d)})}})})},"dojo/request/default":function(){define(["exports","require","../has"],function(f,c,k){var l=k("config-requestProvider");l||(l="./xhr");f.getPlatformDefaultId=function(){return"./xhr"};f.load=function(d,a,f,n){c(["platform"==d?"./xhr":l],function(a){f(a)})}})},"com/huayun/webgis/data/FeaturePositionMap":function(){define(["../utils/utils"],function(f){var c=function(){this.ids=[];this.positions=[];this.indexed=!1};c.prototype.add=function(c,f,d,a){this.ids.push(c);this.positions.push(f,
d,a)};c.prototype.getPositions=function(c){for(var f=0,d=this.ids.length-1;f<d;){var a=f+d>>1;this.ids[a]>=c?d=a:f=a+1}for(d=[];this.ids[f]===c;)d.push({index:this.positions[3*f],start:this.positions[3*f+1],end:this.positions[3*f+2]}),f++;return d};c.serialize=function(c,l){var d=new Float64Array(c.ids);c=new Uint32Array(c.positions);f.sort(d,c,0,d.length-1);l.push(d.buffer,c.buffer);return{ids:d,positions:c}};c.deserialize=function(f){var k=new c;k.ids=f.ids;k.positions=f.positions;k.indexed=!0;
return k};return c})},"com/huayun/webgis/data/GraphicIndex":function(){define(["custom/rbush","./queryIntersects","./queryIntersectsEx","./captureIntersects"],function(f,c,k,l){function d(a){for(var d=Infinity,g=Infinity,c=-Infinity,b=-Infinity,e=0;e<a.length;e+=1){var f=a[e];if("point"===f.type)d=Math.min(d,f.x),g=Math.min(g,f.y),c=Math.max(c,f.x),b=Math.max(b,f.y);else if("polygon"===f.type)for(var p=0,f=f.path[0];p<f.length;p++)d=Math.min(d,f[p].x),g=Math.min(g,f[p].y),c=Math.max(c,f[p].x),b=Math.max(b,
f[p].y)}return{minx:d,miny:g,maxx:c,maxy:b}}var a=function(){this.tree=new f};a.prototype.insert=function(a,d){for(var g=[],c=0;c<a.length;c++){for(var b=a[c],e=[Infinity,Infinity,-Infinity,-Infinity],f=0;f<b.length;f++){var p=b[f];e[0]=Math.min(e[0],p.x);e[1]=Math.min(e[1],p.y);e[2]=Math.max(e[2],p.x);e[3]=Math.max(e[3],p.y)}g.push({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],id:d})}this.tree.load(g)};a.prototype.insertMsc=function(a,d){for(var g=[],c=0;c<a.length;c++){for(var b=a[c],e=[Infinity,Infinity,
-Infinity,-Infinity],f=0;f<b.length;f++){var p=b[f];e[0]=Math.min(e[0],p.x);e[1]=Math.min(e[1],p.y);e[2]=Math.max(e[2],p.x);e[3]=Math.max(e[3],p.y)}g.push({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],id:d})}this.tree.load(g)};a.prototype.query=function(a,f,g,h,b){var e=d(a);f=this.tree.search({minX:e.minx-f*h,minY:e.miny-f*h,maxX:e.maxx+f*h,maxY:e.maxy+f*h});for(var q=[],p=0;p<f.length;p++)for(var m=0;m<g.length;m++)if(f[p].id===g[m].id)if(e=g[m],"multipoint"===e.feature.geometry.type)for(var n=0,k=e.feature.geometry.points.length;n<
k;n++){if(c[e.symbol.type](a,e.feature.geometry.points[n],e.symbol,h,e.feature.geometry.radius,b)){q.push(e);break}}else c[e.symbol.type](a,e.feature.geometry,e.symbol,h,e.feature.geometry.radius,b)&&q.push(e);return q};a.prototype.roughQuery=function(a,c,g,h,b){a=d(a);c=this.tree.search({minX:a.minx-c*h,minY:a.miny-c*h,maxX:a.maxx+c*h,maxY:a.maxy+c*h});a=[];for(b=0;b<c.length;b++)for(var e=0;e<g.length;e++)c[b].id===g[e].id&&(h=g[e],a.push(h));return a};a.prototype.captureQuery=function(a,c,g,h,
b){for(var e=d(a),e=this.tree.search({minX:e.minx-c*h,minY:e.miny-c*h,maxX:e.maxx+c*h,maxY:e.maxy+c*h}),f,p=[],m=0;m<e.length;m++)for(var n=0;n<g.length;n++)e[m].id===g[n].id&&(f=g[n],l[f.symbol.type](a,f.feature.geometry,f.symbol,h,f.feature.geometry.radius,b,c)&&p.push(f));return p};a.prototype.queryMsc=function(a,c,g,h){var b=d(a);c=this.tree.search({minX:b.minx-c*g,minY:b.miny-c*g,maxX:b.maxx+c*g,maxY:b.maxy+c*g});for(var e=[],f={width:5},p,m=0;m<c.length;m++)b=c[m],p=b.id.feature.type+"ex",-1===
e.indexOf(b.id)&&k[p](a,b.id.geometry,f,g,5,h)&&e.push(b.id);return e};a.prototype.queryRender=function(a,f,g,h,b){var e=d(a);f=this.tree.search({minX:e.minx-f*h,minY:e.miny-f*h,maxX:e.maxx+f*h,maxY:e.maxy+f*h});for(var q=[],p=0;p<f.length;p++)for(var m=0;m<g.length;m++)f[p].id===g[m].id&&(e=g[m],e.visible&&c[e.symbol.type](a,e.feature.geometry,e.symbol,h,e.feature.geometry.radius,b)&&q.push(e));return q};a.prototype.clear=function(){this.tree.clear()};return a})},"com/huayun/webgis/layers/support/TileCache":function(){define([],
function(){var f=function(c,f){this.max=c;this.onRemove=f;this.reset()};f.prototype.reset=function(){for(var c in this.data)for(var f=0,l=this.data[c];f<l.length;f+=1){var d=l[f];d.timeout&&clearTimeout(d.timeout);this.onRemove(d.value)}this.data={};this.order=[];return this};f.prototype.add=function(c,f,l){var d=this,a=c.wrapped().key;void 0===this.data[a]&&(this.data[a]=[]);var m={value:f,timeout:void 0};void 0!==l&&(m.timeout=setTimeout(function(){d.remove(c,m)},l));this.data[a].push(m);this.order.push(a);
if(this.order.length>this.max&&(f=this._getAndRemoveByKey(this.order[0])))this.onRemove(f);return this};f.prototype.has=function(c){return c.wrapped().key in this.data};f.prototype.getAndRemove=function(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null};f.prototype._getAndRemoveByKey=function(c){var f=this.data[c].shift();f.timeout&&clearTimeout(f.timeout);0===this.data[c].length&&delete this.data[c];this.order.splice(this.order.indexOf(c),1);return f.value};f.prototype.get=function(c){return this.has(c)?
this.data[c.wrapped().key][0].value:null};f.prototype.remove=function(c,f){if(!this.has(c))return this;c=c.wrapped().key;f=void 0===f?0:this.data[c].indexOf(f);var l=this.data[c][f];this.data[c].splice(f,1);l.timeout&&clearTimeout(l.timeout);0===this.data[c].length&&delete this.data[c];this.onRemove(l.value);this.order.splice(this.order.indexOf(c),1);return this};f.prototype.setMaxSize=function(c){for(this.max=c;this.order.length>this.max;)if(c=this._getAndRemoveByKey(this.order[0]))this.onRemove(c);
return this};return f})},"com/huayun/webgis/data/bucket/LineBucketSimplify":function(){define(["../ArrayType","../../gl/SegmentVector"],function(f,c){function k(a,d,g,c,b,e,f){a.emplaceBack(d.x,d.y,d.z||0,Math.round(63*g.x)+128,Math.round(63*g.y)+128,(0===e?0:0>e?-1:1)+1|(.5*f&63)<<2,.5*f>>6,c?1:0,b?1:0)}var l=Math.pow(2,14)/.5,d=Math.cos(Math.PI/180*37.5),a=function(a){this.layoutVertexArray=new f.StructArrayLayout7f2ib32;this.indexArray=new f.StructArrayLayout3ui6;this.segments=new c};a.prototype.addFeature=
function(a,d,g,c,b){for(var e=0;e<a.length;e+=1)this.addLine(a[e],d,g,c,b)};a.prototype.upload=function(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,[{name:"a_pos",type:"Float32",components:3,offset:0},{name:"a_data",type:"Float32",components:4,offset:12},{name:"a_normal",type:"Int16",components:2,offset:28}]),this.indexBuffer=a.createIndexBuffer(this.indexArray));this.uploaded=!0};a.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),
this.indexBuffer.destroy(),this.segments.destroy())};a.prototype.addLine=function(a,c,g,h,b){for(var e=a.length;2<=e&&a[e-1].equals(a[e-2]);)a.splice(e-1),e--;for(var f=0;f<e-1&&a[f].equals(a[f+1]);)f++;"bevel"===c&&(h=1.05);var p=this.segments.prepareSegment(10*e,this.layoutVertexArray,this.indexArray);this.distance=0;var m=!0,n,l=void 0,k=void 0,u=void 0,r=void 0,x,A;this.e1=this.e2=this.e3=-1;for(var w=f;w<e;w++){k=a[w+1];r&&(u=r);n&&(l=n);n=a[w];r=k?k.sub(n)._unit()._perp():u;u=u||r;if(!u)break;
var B=u.add(r);0===B.x&&0===B.y||B._unit();var D=B.x*r.x+B.y*r.y;x=0!==D?1/D:Infinity;var E=D<d&&l&&k;if(E&&w>f){var F=n.dist(l);480<F&&(F=n.sub(n.sub(l)._mult(240/F)._round()),this.distance+=F.dist(l),this.addCurrentVertex(F,this.distance,u.mult(1),0,0,!1,p,null),l=F)}var G=(F=l&&k)?c:g;F&&"round"===G&&(x<b?G="miter":2>=x&&(G="fakeround"));"miter"===G&&x>h&&(G="bevel");"bevel"===G&&(2<x&&(G="flipbevel"),x<h&&(G="miter"));l&&(this.distance+=n.dist(l));if("miter"===G)B._mult(x),this.addCurrentVertex(n,
this.distance,B,0,0,!1,p,null);else if("flipbevel"===G)100<x?B=r.clone().mult(-1):(F=0<u.x*r.y-u.y*r.x?-1:1,m=x*u.add(r).mag()/u.sub(r).mag(),B._perp()._mult(m*F)),this.addCurrentVertex(n,this.distance,B,0,0,!1,p,null),this.addCurrentVertex(n,this.distance,B.mult(-1),0,0,!1,p,null);else if("bevel"===G||"fakeround"===G){var F=0<u.x*r.y-u.y*r.x,L=-Math.sqrt(x*x-1);F?(A=0,x=L):(x=0,A=L);m||this.addCurrentVertex(n,this.distance,u,x,A,!1,p,null);if("fakeround"===G){m=Math.floor(8*(.5-(D-.5)));D=void 0;
for(G=0;G<m;G++)D=r.mult((G+1)/(m+1))._add(u)._unit(),this.addPieSliceVertex(n,this.distance,D,F,p,null);this.addPieSliceVertex(n,this.distance,B,F,p,null);for(B=m-1;0<=B;B--)D=u.mult((B+1)/(m+1))._add(r)._unit(),this.addPieSliceVertex(n,this.distance,D,F,p,null)}k&&this.addCurrentVertex(n,this.distance,r,-x,-A,!1,p,null)}else"butt"===G?(m||this.addCurrentVertex(n,this.distance,u,0,0,!1,p,null),k&&this.addCurrentVertex(n,this.distance,r,0,0,!1,p,null)):"square"===G?(m||(this.addCurrentVertex(n,this.distance,
u,1,1,!1,p,null),this.e1=this.e2=-1),k&&this.addCurrentVertex(n,this.distance,r,-1,-1,!1,p,null)):"round"===G&&(m||(this.addCurrentVertex(n,this.distance,u,0,0,!1,p,null),this.addCurrentVertex(n,this.distance,u,1,1,!0,p,null),this.e1=this.e2=-1),k&&(this.addCurrentVertex(n,this.distance,r,-1,-1,!0,p,null),this.addCurrentVertex(n,this.distance,r,0,0,!1,p,null)));E&&w<e-1&&(E=n.dist(k),480<E&&(k=n.add(k.sub(n)._mult(240/E)._round()),this.distance+=k.dist(n),this.addCurrentVertex(k,this.distance,r.mult(1),
0,0,!1,p,null),n=k));m=!1}};a.prototype.addCurrentVertex=function(a,d,g,c,b,e,f,p){var h,m=this.layoutVertexArray,q=this.indexArray;h=g.clone();c&&h._sub(g.perp()._mult(c));k(m,a,h,e,!1,c,d);this.e3=f.vertexLength++;0<=this.e1&&0<=this.e2&&(q.emplaceBack(this.e1,this.e2,this.e3),f.primitiveLength++);this.e1=this.e2;this.e2=this.e3;h=g.mult(-1);b&&h._sub(g.perp()._mult(b));k(m,a,h,e,!0,-b,d);this.e3=f.vertexLength++;0<=this.e1&&0<=this.e2&&(q.emplaceBack(this.e1,this.e2,this.e3),f.primitiveLength++);
this.e1=this.e2;this.e2=this.e3;d>l/2&&!p&&(this.distance=0,this.addCurrentVertex(a,this.distance,g,c,b,e,f))};a.prototype.addPieSliceVertex=function(a,d,g,c,b){g=g.mult(c?-1:1);var e=this.indexArray;k(this.layoutVertexArray,a,g,!1,c,0,d);this.e3=b.vertexLength++;0<=this.e1&&0<=this.e2&&(e.emplaceBack(this.e1,this.e2,this.e3),b.primitiveLength++);c?this.e2=this.e3:this.e1=this.e3};return a})},"com/huayun/webgis/geometry/Polyline":function(){define(["./Geometry","./Extent"],function(f,c){var k=function(d,
a){f.call(this);this.type="line";this.path=d;this.spatialReference=a;this._extent=null};f&&(k.__proto__=f);k.prototype=Object.create(f&&f.prototype);k.prototype.constructor=k;var l={length:{configurable:!1},extent:{configurable:!1}};l.length.get=function(){return this.path.length};l.extent.get=function(){if(!this._extent){var d=this.path,a,f,n,g;a=n=d[0][0].x;f=g=d[0][0].y;for(var h=d.length,b=0;b<h;b++)for(var e=d[b],q=e.length,p=0;p<q;p++){var k=e[p];a=Math.min(a,k.x);f=Math.min(f,k.y);n=Math.max(n,
k.x);g=Math.max(g,k.y)}this._extent=new c(a,f,n,g)}return this._extent};k.prototype={setPath:function(d){this.path=d;this._extent=null},addPath:function(d){this.path.push(d);this._extent=null},update:function(d,a){this.path.forEach(function(c){c.forEach(function(c){c.update(d,a)})});this._extent=null}};Object.defineProperties(k.prototype,l);return k})},"com/huayun/webgis/gl/ProgramSimplify":function(){define(["./VertexArrayObject"],function(f){var c=function(c,f,d,a){var m=c.gl;this.program=m.createProgram();
var n=d.defines,g;n?(g=n.concat(f.fragmentSource).join("\n"),f=n.concat(f.vertexSource).join("\n")):(g=f.fragmentSource,f=f.vertexSource);n=m.createShader(m.FRAGMENT_SHADER);m.shaderSource(n,g);m.compileShader(n);m.attachShader(this.program,n);g=m.createShader(m.VERTEX_SHADER);m.shaderSource(g,f);m.compileShader(g);m.attachShader(this.program,g);d=d.layoutAttributes||[];for(g=0;g<d.length;g++)m.bindAttribLocation(this.program,g,d[g].name);m.linkProgram(this.program);this.numAttributes=m.getProgramParameter(this.program,
m.ACTIVE_ATTRIBUTES);this.attributes={};d={};for(g=0;g<this.numAttributes;g++)(f=m.getActiveAttrib(this.program,g))&&(this.attributes[f.name]=m.getAttribLocation(this.program,f.name));g=m.getProgramParameter(this.program,m.ACTIVE_UNIFORMS);for(f=0;f<g;f++)(n=m.getActiveUniform(this.program,f))&&(d[n.name]=m.getUniformLocation(this.program,n.name));this.fixedUniforms=a(c,d)};c.prototype.draw=function(c,l,d,a,m,n,g,h,b,e,q,p,t,v,z,y){var k;a=c.gl;c.program.set(this.program);c.setDepthMode(d);c.setColorMode(m);
c.setCullFace(n);for(var r in this.fixedUniforms)this.fixedUniforms[r].set(g[r]);d=(k={},k[a.LINES]=2,k[a.TRIANGLES]=3,k[a.LINE_STRIP]=1,k)[l];k=0;for(q=q.get();k<q.length;k+=1)m=q[k],n=m.vaos||(m.vaos={}),(n[h]||(n[h]=new f)).bind(c,this,b,[],e,m.vertexOffset,z,y),a.drawElements(l,m.primitiveLength*d,a.UNSIGNED_SHORT,m.primitiveOffset*d*2)};c.prototype.draw2=function(c,f,d,a,m,n,g,h,b,e){a=c.gl;c.program.set(this.program);c.setDepthMode(d);c.setColorMode(m);c.setCullFace(n);for(var q in this.fixedUniforms)this.fixedUniforms[q].set(g[q]);
c.bindVertexBuffer.set(b.buffer);a.drawArrays(f,0,e)};c.prototype.drawArray=function(c,l,d,a,m,n,g,h,b,e,q){a=c.gl;c.program.set(this.program);c.setDepthMode(d);c.setColorMode(m);c.setCullFace(n);for(var p in this.fixedUniforms)this.fixedUniforms[p].set(g[p]);d=0;for(q=q.get();d<q.length;d+=1)m=q[d],n=m.vaos||(m.vaos={}),(n[h]||(n[h]=new f)).bind(c,this,b,[],e,m.vertexOffset,void 0,void 0),a.drawArrays(l,m.primitiveOffset,m.vertexLength)};c.prototype.drawArraysInstancedANGLE=function(c,l,d,a,m,n,
g,h,b,e,q,p,t){c.program.set(this.program);c.setDepthMode(d);c.setColorMode(m);c.setCullFace(n);for(var k in this.fixedUniforms)this.fixedUniforms[k].set(g[k]);d=p.attributes;a=c.extInstancedArray;m=0;for(q=q.get();m<q.length;m+=1){n=q[m];g=n.vaos||(n.vaos={});(g[h]||(g[h]=new f)).bind(c,this,b,[p],e,n.vertexOffset,void 0,void 0);for(g=0;g<d.length;g++)a.vertexAttribDivisorANGLE(this.attributes[d[g].name],1);a.drawArraysInstancedANGLE(l,n.primitiveOffset,n.vertexLength,t)}};c.prototype.drawInstancedANGLE=
function(c,l,d,a,m,n,g,h,b,e,q,p,t){a=c.gl;c.program.set(this.program);c.setDepthMode(d);c.setColorMode(m);c.setCullFace(n);for(var k in this.fixedUniforms)this.fixedUniforms[k].set(g[k]);d=p.attributes;m=c.extInstancedArray;n=0;for(q=q.get();n<q.length;n+=1){g=q[n];k=g.vaos||(g.vaos={});(k[h]||(k[h]=new f)).bind(c,this,b,[p],e,g.vertexOffset,void 0,void 0);for(k=0;k<d.length;k++)m.vertexAttribDivisorANGLE(this.attributes[d[k].name],1);m.drawElementsInstancedANGLE(l,3*g.primitiveLength,a.UNSIGNED_SHORT,
6*g.primitiveOffset,t)}};c.prototype.drawMassive=function(c,l,d,a,m,n,g,h,b,e,q,p,t,v,z,y){var k;a=c.gl;c.program.set(this.program);c.setDepthMode(d);c.setColorMode(m);c.setCullFace(n);for(var r in this.fixedUniforms)this.fixedUniforms[r].set(g[r]);v&&v.setUniforms(c,this.binderUniforms,p,{zoom:t});d=(k={},k[a.LINES]=2,k[a.TRIANGLES]=3,k[a.LINE_STRIP]=1,k)[l];k=0;for(q=q.get();k<q.length;k+=1)m=q[k],n=m.vaos||(m.vaos={}),(n[h]||(n[h]=new f)).bind(c,this,b,v?v.getPaintVertexBuffers():[],e,m.vertexOffset,
z,y),a.drawElements(l,m.primitiveLength*d,a.UNSIGNED_INT,m.primitiveOffset*d*2)};return c})},"com/huayun/webgis/renderer/Renderer":function(){define([],function(){function f(){}f.prototype.getRealScale=function(c,f,l){if(c.isFixed||0===l)return 1;if(0===c.addratio)return f/l;if(0<c.addratio)return 1+f/l*c.addratio};f.prototype.calculateExtent=function(){};return f})},"com/huayun/webgis/geometry/Multipoint":function(){define(["./Geometry","./Extent"],function(f,c){var k=function(d,a){f.call(this);
this.type="multipoint";this.points=void 0===d?[]:d;this.spatialReference=a;this._extent=null};f&&(k.__proto__=f);k.prototype=Object.create(f&&f.prototype);k.prototype.constructor=k;var l={length:{configurable:!1},extent:{configurable:!1}};l.length.get=function(){return this.points.length};l.extent.get=function(){if(!this._extent){var d=this.points,a,f,n,g;a=n=d[0].x;f=g=d[0].y;for(var h=d.length,b=0;b<h;b++){var e=d[b];a=Math.min(a,e.x);f=Math.min(f,e.y);n=Math.max(n,e.x);g=Math.max(g,e.y)}this._extent=
new c(a,f,n,g)}return this._extent};k.prototype={setPoints:function(d){this.points=d;this._extent=null},addPoint:function(d){this.points.push(d);this._extent=null},update:function(d,a){this.points.forEach(function(c){c.update(d,a)});this._extent=null}};Object.defineProperties(k.prototype,l);return k})},"com/huayun/webgis/renderer/CircleRenderer":function(){define(["./Renderer","../gl/mode","../data/bucket/CircleBucketSimplify","../geometry/Point","../gl/programCache"],function(f,c,k,l,d){function a(){}
f&&(a.__proto__=f);a.prototype=Object.create(f&&f.prototype);a.prototype.constructor=a;a.prototype.add=function(a,d,g,c){c=new k;var b=d.position||a.viewpoint.center||[0,0],e=b[0],b=b[1];if("multipoint"===g.type){for(var h=[],f=0;f<g.points.length;f++)h.push(new l(g.points[f].x-e,g.points[f].y-b,0));c.addFeature([h])}else"point"===g.type&&c.addFeature([[new l(g.x-e,g.y-b,0)]]);c.upload(a.context);d.buckets.push(c);d.position=[e,b]};a.prototype.draw=function(a,f,g,h,b,e,q){void 0===e&&(e=0);g=a.context;
var p=g.gl;b=b?b.depthModeForSublayer(0,c.DepthMode.ReadOnly):new c.DepthMode(p.LEQUAL,c.DepthMode.ReadOnly,[.9,.9]);var m=c.StencilMode.disabled,n=c.ColorMode.alphaBlended,k=d.useProgramSimplify(g,"circle",{layoutAttributes:[{name:"a_pos",type:"Float32",components:2,offset:0},{name:"a_data",type:"Int16",components:2,offset:8}]}),l=h.uniforms,u=f.position,r=this.getRealScale(h.fixed,a.scale,h.minScale),x=void 0,A=a.resolution;h.markerSize?(r*=f.markerScaleFactor||1,x=h.markerSize/h.radius,r*=x):f.symbol.size&&
void 0===f.symbol.tempW?(f.scaleFactor=f.scaleFactor||1,r*=f.scaleFactor,x=f.symbol.size/h.radius,f.symbol.tempW=x,r*=x):f.symbol.size&&void 0!==f.symbol.tempW?r*=f.symbol.tempW:(f.scaleFactor=f.scaleFactor||1,r*=f.scaleFactor);q||(l.radius=h.radius*r);l.u_radian=f.rotation?h.angle+f.rotation:h.angle;var x=h.dx*r*A,A=h.dy*r*A,w=Math.sin(l.u_radian),B=Math.cos(l.u_radian);q=x*B-A*w;x=A*B+x*w;l.u_matrix=a.viewpoint.getMatrixForPoint(u[0]+q,u[1]+x);u=h.strokeWidth*r;l.stroke_width=1>u?1:u;l.u_camera_to_center_distance=
a.viewpoint.cameraToCenterDistance;l.u_extrude_scale=a.viewpoint.pixelsToGLUnits;f["_circleOffset"+e]={dx:q,dy:x,size:h.uniforms.radius+h.uniforms.stroke_width};l.color=h.color;l.stroke_color=h.strokeColor;a=f.buckets[e];k.draw(g,p.TRIANGLES,b,m,n,c.CullFaceMode.disabled,l,f.id+"-circle"+e,a.layoutVertexBuffer,a.indexBuffer,a.segments,null)};a.prototype.drawGlow=function(a,f,g,h,b,e,q){var p=f.glow;if(p){void 0===e&&(e=0);g=a.context;var m=g.gl;b=b?b.depthModeForSublayer(0,c.DepthMode.ReadOnly):new c.DepthMode(m.LEQUAL,
c.DepthMode.ReadOnly,[.9,.9]);var n=c.StencilMode.disabled,l=c.ColorMode.alphaBlended,k=d.useProgramSimplify(g,"circle",{layoutAttributes:[{name:"a_pos",type:"Float32",components:2,offset:0},{name:"a_data",type:"Int16",components:2,offset:8}]}),u=h.uniforms,r=f.position,x=this.getRealScale(h.fixed,a.scale,h.minScale),A=1,w=a.resolution;h.markerSize?(x*=f.markerScaleFactor,A=h.markerSize/h.radius,x*=A):f.symbol.size?(f.scaleFactor=f.scaleFactor||1,x*=f.scaleFactor,A=f.symbol.size/h.radius,x*=A):(f.scaleFactor=
f.scaleFactor||1,x*=f.scaleFactor);q||(u.radius=h.radius*x);u.u_radian=f.rotation?h.angle+f.rotation:h.angle;q=h.dx*x*w;var w=h.dy*x*w,A=Math.sin(u.u_radian),B=Math.cos(u.u_radian);u.u_matrix=a.viewpoint.getMatrixForPoint(r[0]+(q*B-w*A),r[1]+(w*B+q*A));h=h.strokeWidth*x;u.stroke_width=1>h?1:h;u.u_camera_to_center_distance=a.viewpoint.cameraToCenterDistance;u.u_extrude_scale=a.viewpoint.pixelsToGLUnits;a=p.color;u.color=a;u.stroke_color=a;a=f.buckets[e];k.draw(g,m.TRIANGLES,b,n,l,c.CullFaceMode.disabled,
u,f.id+"-circle"+e,a.layoutVertexBuffer,a.indexBuffer,a.segments,null)}};a.prototype.calculateExtent=function(a,d,c,h,b,e){e||(e=0);a=a.resolution;e=d["_circleOffset"+e];h=e.size;var g=c.x;c=c.y;var f=e.dy,g=g+e.dx;c+=f;b.push({id:d.id,g:d,minX:g-h*a,minY:c-h*a,maxX:g+h*a,maxY:c+h*a})};return a})},"com/huayun/webgis/gl/Texture":function(){define([],function(){var f=function(c,f,l,d){this.context=c;this.format=l;this.texture=c.gl.createTexture();this.update(f,d)};f.prototype.update=function(c,f,l){var d=
c.width,a=c.height,m=(!this.size||this.size[0]!==d||this.size[1]!==a)&&!l,n=this.context,g=n.gl;this.useMipmap=!(!f||!f.useMipmap);g.bindTexture(g.TEXTURE_2D,this.texture);n.pixelStoreUnpackFlipY.set(!1);n.pixelStoreUnpack.set(1);n.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA&&(!f||!1!==f.premultiply));m?(this.size=[d,a],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData?g.texImage2D(g.TEXTURE_2D,0,this.format,this.format,
g.UNSIGNED_BYTE,c):g.texImage2D(g.TEXTURE_2D,0,this.format,d,a,0,this.format,g.UNSIGNED_BYTE,c.data)):(l=l||{x:0,y:0},f=l.x,l=l.y,c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData?g.texSubImage2D(g.TEXTURE_2D,0,f,l,g.RGBA,g.UNSIGNED_BYTE,c):g.texSubImage2D(g.TEXTURE_2D,0,f,l,d,a,g.RGBA,g.UNSIGNED_BYTE,c.data));this.useMipmap&&this.isSizePowerOfTwo()&&g.generateMipmap(g.TEXTURE_2D)};f.prototype.bind=function(c,f,l){var d=this.context.gl;
d.bindTexture(d.TEXTURE_2D,this.texture);l!==d.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(l=d.LINEAR);c!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,c),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,l||c),this.filter=c);f!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,f),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,f),this.wrap=f)};f.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&0===Math.log(this.size[0])/Math.LN2%1};f.prototype.destroy=
function(){this.context.gl.deleteTexture(this.texture);this.texture=null};return f})},"com/huayun/webgis/views/SceneView":function(){define("dojo/topic dojo/on dojo/DeferredList dojo/promise/Promise dojo/dom-construct ./View ../Viewpoint ../geometry/Extent ../geometry/Point ../geometry/Polygon ../geometry/MapPoint ../layers/GraphicLayer ../handler/PanHandler ../handler/TouchHandler com/huayun/webgis/gl/Context com/huayun/webgis/layers/support/ZoomHistory com/huayun/webgis/gl/VertexFragShader com/huayun/webgis/gl/programConfig com/huayun/webgis/gl/Program com/huayun/webgis/gl/ProgramSimplify ../utils/utils ../utils/Color ../utils/TaskQueue com/huayun/webgis/gl/LineAtlas ../data/GraphicsIndex ../data/queryIntersects ../gl/draw/drawBackground ../utils/Resource ../gl/Texture".split(" "),
function(f,c,k,l,d,a,m,n,g,h,b,e,q,p,t,v,z,y,u,r,x,A,w,B,D,E,F,G,L){var C=function(b){a.call(this,b);this._offsetLeft=this.container.getBoundingClientRect().left;this._offsetTop=this.container.getBoundingClientRect().top;this._clearBit=17664;this._extentDirty=this._nochanging=!0;this.backgroundColor=A.parse(b.backgroundColor||"#FFFFFF");this.numSublayers=C.maxUnderzooming+C.maxOverzooming+1;this.depthEpsilon=1/Math.pow(2,16);this.currentLayer=0;this.viewStates=[];this.backViewStates=[];this.viewStatesLength=
10;this._initState=null;this.antialias=!!b.antialias;var e=b.pitch?b.pitch:b.is3DVision?50:0,d=b.angle?b.angle:0,c=this.container.clientWidth,g=this.container.clientHeight,h=b.maxPitch||50;this._setupContainer(c,g);this._setupContext();this.viewpoint=new m(c,g,e,d,b.maxLevel,b.minLevel,h,this);this._tileTextures={};this.zoomHistory=new v;this.zoomEnabled=this.panEnabled=!0;this.rotateEnabled=void 0===b.rotateEnabled?!0:b.rotateEnabled;this.resizeEnabled=this.selectEnabled=!0;this.emptyProgramConfiguration=
new y.ProgramConfiguration;this.lineAtlas=new B(256,512);this._offsetLeft=this.container.getBoundingClientRect().left;this._offsetTop=this.container.getBoundingClientRect().top;this.graphicsIndex=new D;new q(this);new p(this);this._handleAddedLayer();this._handleEvent();if(b.center)if(b.level)this.setCenter(b.center,b.level);else if(b.resolution)this.setCenter(b.center,null,b.resolution);else throw Error("\u901a\u8fc7\u4e2d\u5fc3\u70b9\u8bbe\u7f6e\u521d\u59cb\u72b6\u6001\u5fc5\u987b\u5305\u542b\u5c42\u7ea7\u6216\u5206\u8fa8\u7387");
else b.extent&&this.setExtent(b.extent);this.numSublayers=14;this.depthEpsilon=1/Math.pow(2,16);var f=this;b.backgroundImage&&G.loadImage(b.backgroundImage,function(a,b){if(b){a=f.context;var e=a.gl;f._backgroundTexture=new L(a,b,e.RGBA,{useMipmap:!0});f._backgroundTexture.bind(e.LINEAR,e.CLAMP_TO_EDGE,e.LINEAR_MIPMAP_NEAREST);a.extTextureFilterAnisotropic&&e.texParameterf(e.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax);f.threeRender()}});this.zoomEnd=
[];this._renderTaskQueue=new w};a&&(C.__proto__=a);C.prototype=Object.create(a&&a.prototype);C.prototype.constructor=C;h={width:{configurable:!0},height:{configurable:!0},resolution:{configurable:!0},level:{configurable:!0},center:{configurable:!0},is3DVision:{configurable:!0},extent:{configurable:!0},nearestResolution:{configurable:!0},scale:{configurable:!0}};h.width.get=function(){return this.viewpoint.width};h.height.get=function(){return this.viewpoint.height};h.resolution.get=function(){return this.viewpoint.resolution};
h.scale.get=function(){return.0254000508001016/(96*this.resolution)};h.level.get=function(){return this.viewpoint.level};h.center.get=function(){var a=this.viewpoint.center;return new g(a[0],a[1],0)};h.is3DVision.get=function(){return 0!==this.viewpoint.pitch};h.extent.get=function(){if(this._extentDirty){var a=this._bound;return this._bound?(this._extent=new n(Math.min(a[0].x,a[1].x,a[2].x,a[3].x),Math.min(a[0].y,a[1].y,a[2].y,a[3].y),Math.max(a[0].x,a[1].x,a[2].x,a[3].x),Math.max(a[0].y,a[1].y,
a[2].y,a[3].y)),this._extentDirty=!1,this._extent):null}return this._extent};C.prototype._setupContainer=function(a,b){this.domNode=document.createElement("div");this.domNode.classList.add("webgis-root");var e=document.createElement("canvas");e.width=a;e.height=b;this._canvas=e;this._canvas.setAttribute("tabindex","0");this._canvas.setAttribute("aria-label","Map");this.domNode.appendChild(e);this.container.appendChild(this.domNode)};C.prototype._setupContext=function(){var a={alpha:!0,antialias:this.antialias,
depth:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,stencil:!0};this._gl=this._canvas.getContext("webgl",a)||this._canvas.getContext("experimental-webgl",a);this.context=new t(this._gl)};C.prototype._handleAddedLayer=function(){if(0<this.map.allLayers.length){var a=this.map.allLayers[0].type;if(!a||0>a.indexOf("Tile"))this._load=!0;else if(a=this.map.allLayers[0].tileInfo)this.viewpoint.setTileInfo(a),this._load=!0;this.map.allLayers.forEach(function(a){this.allLayerViews.push(a.createLayerView(this))}.bind(this))}};
C.prototype.setTileInfo=function(){var a=this.map.allLayers[0].tileInfo;a&&(this.viewpoint.tileInfo?this.setCenter(this.center):(this.viewpoint.setTileInfo(a),this._load=!0,(this.viewpoint.level||this.viewpoint.resolution)&&this.setCenter(this.viewpoint.center,this.viewpoint.level,this.viewpoint.resolution),f.publish("mapLoadComplete")))};C.prototype._handleEvent=function(){this.map.on("addLayers",function(a,b,e){var d=this.map.allLayers[0].type;if(!d||0>d.indexOf("Tile"))this._load=!0;else if(d=
this.map.allLayers[0].tileInfo)this.viewpoint.setTileInfo(d),this._load=!0;for(d=0;d<a.length;d++)b?this.allLayerViews.splice(e,0,a[d].createLayerView(this)):this.allLayerViews.push(a[d].createLayerView(this))}.bind(this));this.map.on("removeLayers",function(a){for(var b=0;b<a.length;b++)for(var e=a[b],d=this.allLayerViews.length-1;-1<d;d--)if(this.allLayerViews[d].id===e){this.allLayerViews.splice(d,1);break}}.bind(this));c(this.domNode,"mousewheel",this._zoomMap.bind(this));c(window,"resize",this._onResize.bind(this))};
C.prototype._onResize=function(){if(this.resizeEnabled){var a=this.container.clientWidth,b=this.container.clientHeight;a&&b&&(this.resizeEnabled=!1,setTimeout(function(){this.resizeEnabled=!0}.bind(this),100),this._canvas.width=a,this._canvas.height=b,this._canvas.style.width=a+"px",this._canvas.style.height=b+"px",this.context.viewport.set([0,0,this._canvas.width,this._canvas.height]),this.viewpoint.resize(a,b),this._offsetLeft=this.container.getBoundingClientRect().left,this._offsetTop=this.container.getBoundingClientRect().top,
this.allLayerViews.forEach(function(a){a.resize()}),this.refresh())}};C.prototype.expand=function(a){var b=this.width/2*a*this.resolution;a=this.height/2*a*this.resolution;b=new n(this.center.x-b,this.center.y-a,this.center.x+b,this.center.y+a);this.setExtent(b)};C.prototype.setCenter=function(a,b,e){if(b){var d=this.viewpoint.level;this.viewpoint.setLevel(b);this.viewpoint.setCenter(a);a=this.viewpoint.level;d!==a&&f.publish("changeLevel",{level:this.viewpoint.level})}else e?(d=this.viewpoint.level,
this.viewpoint.setResolution(e,this._load),this.viewpoint.setCenter(a),a=this.viewpoint.level,d!==a&&f.publish("changeLevel",{level:this.viewpoint.level})):this.viewpoint.setCenter(a);this.refresh()};C.prototype.setExtent=function(a,b){if(a instanceof n){var e=a.getCenter(),d=a.getWidth();a=a.getHeight();var c=this.viewpoint.width,g=this.viewpoint.height,h=this.viewpoint.level;this.viewpoint.setCenter([e.x,e.y]);this.viewpoint.setResolution(Math.max(d/c,a/g),!0);this._extentDirty=!0;h!==this.viewpoint.level&&
f.publish("changeLevel",{level:this.viewpoint.level});this.refresh(!1,b)}};C.prototype.getExtent=function(){if(this._extentDirty){var a=this._bound;return this._bound?(this._extent=new n(Math.min(a[0].x,a[1].x,a[2].x,a[3].x),Math.min(a[0].y,a[1].y,a[2].y,a[3].y),Math.max(a[0].x,a[1].x,a[2].x,a[3].x),Math.max(a[0].y,a[1].y,a[2].y,a[3].y)),this._extentDirty=!1,this._extent):null}return this._extent};C.prototype.setView=function(a){prev instanceof Object?(prev.level!==this.level&&f.publish("changeLevel",
{level:prev.level}),this.viewpoint.setView(prev),this.refresh(!0)):prev&&1<this.viewStates.length?(this.backViewStates.push(this.viewStates.pop()),a=this.viewStates[this.viewStates.length-1],this.viewpoint.setView(a),this.refresh(!0)):!prev&&0<this.backViewStates.length&&(this.viewStates.push(this.backViewStates.pop()),a=this.viewStates[this.viewStates.length-1],this.viewpoint.setView(a),this.refresh(!0))};C.prototype.refresh=function(a,b){if(this._load){if(this.viewpoint.matrixDirty){var e=this.container.clientWidth,
d=this.container.clientHeight;if(0===e||0===d)return;this.viewpoint.resize(e,d);this.viewpoint.matrixDirty=!1}this.zoomHistory.update(this.viewpoint.level,x.now());this.viewpoint.calcMatrix(!0);this._bound=this.viewpoint.calcBounds();this._extentDirty=!0;f.publish("extentChangeEvent",this);this._initState||(this._initState={level:this.viewpoint.level,center:[this.viewpoint.center[0],this.viewpoint.center[1]],pitch:this.viewpoint.pitch,angle:this.viewpoint.angle});a||this.handlePushViewState();this.allLayerViews.forEach(function(a){a.refresh(b)});
this.threeRender()}};C.prototype.handlePushViewState=function(){this.viewStates.length<this.viewStatesLength||this.viewStates.shift();this.viewStates.push({pitch:this.viewpoint.pitch,angle:this.viewpoint.angle,level:this.viewpoint.targetZoom||this.viewpoint.level,center:this.viewpoint.center});this.backViewStates=[]};C.prototype.centerAt=function(a,b,e){e&&e!==this.viewpoint.level&&this.viewpoint.setLevel(e);this.viewpoint.setCenter([a,b]);this.refresh()};C.prototype.setLevel=function(a){this.viewpoint.setLevel(a);
this.viewpoint.calcMatrix(!0);this.refresh()};C.prototype.findLayerViewById=function(a){for(var b=this.allLayerViews.length-1;-1<b;b--)if(this.allLayerViews[b].id===a)return this.allLayerViews[b]};C.prototype.screenToGeometry=function(a,b){a-=this._offsetLeft;b-=this._offsetTop;a=this.viewpoint.screenToGeometry(a,b);return new g(a.x,a.y,0)};C.prototype.geometryToScreen=function(a,b){b=this.viewpoint.geometryToScreen(a,b);a=b.x+this._offsetLeft;b=b.y+this._offsetTop;return new g(a,b)};C.prototype.getTileTexture=
function(a){return(a=this._tileTextures[a])&&0<a.length?a.pop():null};C.prototype.saveTileTexture=function(a){var b=this._tileTextures[a.size[0]];b?b.push(a):this._tileTextures[a.size[0]]=[a]};C.prototype.useProgram=function(a,b,e){void 0===b&&(b=this.emptyProgramConfiguration);this.cache=this.cache||{};var d=""+a+(b.cacheKey||"");this.cache[d]||(this.cache[d]=new u(this.context,z[a],b,z.programUniforms[a],e));return this.cache[d]};C.prototype.useProgramSimplify=function(a,b){this.simplifyCache=this.simplifyCache||
{};this.simplifyCache[a]||(this.simplifyCache[a]=new r(this.context,z[a],b,z.programUniforms[a]));return this.simplifyCache[a]};C.prototype._drawBackgroundImage=function(){this._backgroundTexture&&this.viewpoint.rasterBoundsBuffer&&F(this)};Object.defineProperties(C.prototype,h);C.prototype._zoomMap=function(a){0<a.wheelDelta?this.zoomInWheel(a.clientX,a.clientY):0>a.wheelDelta&&this.zoomOutWheel(a.clientX,a.clientY)};C.prototype.zoomInWheel=function(a,b){this.zoomEnabled&&(null!==this.viewpoint.level&&
this.viewpoint.level<this.viewpoint.maxLevel?(this.zoomEnabled=!1,setTimeout(function(){this.zoomEnabled=!0}.bind(this),400),this.viewpoint.startZoom=this.viewpoint.level,this.viewpoint.targetZoom=this.viewpoint.level+1,this.viewpoint.level=this.viewpoint.targetZoom,a=this.screenToGeometry(a,b),b=this.viewpoint.center,this.deltaX=a.x-b[0],this.deltaY=a.y-b[1],this.viewpoint.readyMatrix(b[0]+this.deltaX/2,b[1]+this.deltaY/2,this.viewpoint.targetZoom),this._bound=this.viewpoint.calcBounds(),this._extentDirty=
!0,f.publish("changeLevel",{level:this.viewpoint.targetZoom}),f.publish("extentChangeEvent",this),this._handleZoomWheel(!0)):null===this.viewpoint.level&&(this.zoomEnabled=!1,this.graphicsIndex.clear(),setTimeout(function(){this.zoomEnabled=!0}.bind(this),400),this.viewpoint.targetResolution=this.viewpoint.resolution,a=this.screenToGeometry(a,b),b=this.viewpoint.center,this.deltaX=a.x-b[0],this.deltaY=a.y-b[1],this.viewpoint.readyMatrix(b[0]+this.deltaX/2,b[1]+this.deltaY/2,null,null,this.viewpoint.resolution/
2),this._bound=this.viewpoint.calcBounds(),this._extentDirty=!0,f.publish("extentChangeEvent",this),this._handleZoomWheel(!0)))};C.prototype.zoomOutWheel=function(a,b){this.zoomEnabled&&(null!==this.viewpoint.level&&this.viewpoint.level>this.viewpoint.minLevel?(this.zoomEnabled=!1,setTimeout(function(){this.zoomEnabled=!0}.bind(this),400),this.viewpoint.startZoom=this.viewpoint.level,this.viewpoint.targetZoom=this.viewpoint.level-1,this.viewpoint.level=this.viewpoint.targetZoom,a=this.screenToGeometry(a,
b),b=this.viewpoint.center,this.deltaX=a.x-b[0],this.deltaY=a.y-b[1],this.viewpoint.readyMatrix(b[0]-this.deltaX,b[1]-this.deltaY,this.viewpoint.targetZoom),this._bound=this.viewpoint.calcBounds(),this._extentDirty=!0,f.publish("changeLevel",{level:this.viewpoint.targetZoom}),f.publish("extentChangeEvent",this),this._handleZoomWheel(!1)):null===this.viewpoint.level&&(this.zoomEnabled=!1,this.graphicsIndex.clear(),setTimeout(function(){this.zoomEnabled=!0}.bind(this),400),this.viewpoint.targetResolution=
this.viewpoint.resolution,a=this.screenToGeometry(a,b),b=this.viewpoint.center,this.deltaX=a.x-b[0],this.deltaY=a.y-b[1],this.viewpoint.readyMatrix(b[0]+this.deltaX/2,b[1]+this.deltaY/2,null,null,2*this.viewpoint.resolution),this._bound=this.viewpoint.calcBounds(),this._extentDirty=!0,f.publish("extentChangeEvent",this),this._handleZoomWheel(!1)))};C.prototype.zoomIn=function(){if(this.zoomEnabled&&this.viewpoint.level<this.viewpoint.maxLevel){this.zoomEnabled=!1;setTimeout(function(){this.zoomEnabled=
!0}.bind(this),300);this.viewpoint.startZoom=this.viewpoint.level;this.viewpoint.targetZoom=this.viewpoint.level+1;this.viewpoint.level=this.viewpoint.targetZoom;var a=this.viewpoint.center;this.viewpoint.readyMatrix(a[0],a[1],this.viewpoint.targetZoom);this._bound=this.viewpoint.calcBounds();this._extentDirty=!0;f.publish("extentChangeEvent",this);f.publish("changeLevel",{level:this.viewpoint.targetZoom});this._handleZoom(!0)}};C.prototype.zoomOut=function(){if(this.zoomEnabled&&this.viewpoint.level>
this.viewpoint.minLevel){this.zoomEnabled=!1;setTimeout(function(){this.zoomEnabled=!0}.bind(this),300);this.viewpoint.startZoom=this.viewpoint.level;this.viewpoint.targetZoom=this.viewpoint.level-1;this.viewpoint.level=this.viewpoint.targetZoom;var a=this.viewpoint.center;this.viewpoint.readyMatrix(a[0],a[1],this.viewpoint.targetZoom);this._bound=this.viewpoint.calcBounds();this._extentDirty=!0;f.publish("changeLevel",{level:this.viewpoint.targetZoom});f.publish("extentChangeEvent",this);this._handleZoom(!1)}};
C.prototype._handleZoom=function(a){this.allLayerViews.forEach(function(a){a._readyData()});this._nochanging=!1;a?this._zoomAnimateIn(null,1):this._zoomAnimateOut(null,1)};C.prototype._handleZoomWheel=function(a){this.allLayerViews.forEach(function(a){a._readyData()});this._nochanging=!1;a?this._zoomWheelAnimateIn(null,null!==this.viewpoint.level):this._zoomWheelAnimateOut(null,null!==this.viewpoint.level)};C.prototype._zoomWheelAnimateOut=function(a,b){a||(a=performance.now());var e=performance.now()-
a,d=this.viewpoint.center;if(300<=e)window.cancelAnimationFrame(this._animateRaf),this._nochanging=!0,this.viewpoint.setCenter([d[0]-this.deltaX,d[1]-this.deltaY]),b?(this.viewpoint.setLevel(this.viewpoint.targetZoom),this.viewpoint.targetZoom=null):(this.viewpoint.resolution=2*this.viewpoint.targetResolution,this.viewpoint.targetResolution=null),this.viewpoint.calcMatrix(!0),this.handlePushViewState(),this._renderRaf=null,this.callHooks("zoomEnd"),this.threeRender();else{var e=e/300,c;b?(c=1/Math.pow(2,
-e)-1,this.viewpoint.updateMatrix(d[0]-this.deltaX*c,d[1]-this.deltaY*c,this.viewpoint.startZoom-e)):(c=e,this.viewpoint.resolution=this.viewpoint.targetResolution*(1+e),this.viewpoint.updateMatrix(d[0]-this.deltaX*c,d[1]-this.deltaY*c,null,this.viewpoint.resolution));this.animate();this._animateRaf=window.requestAnimationFrame(this._zoomWheelAnimateOut.bind(this,a,b))}};C.prototype._zoomAnimateOut=function(a){a||(a=performance.now());var b=performance.now()-a,e=this.viewpoint.center;300<=b?(window.cancelAnimationFrame(this._animateRaf),
this._nochanging=!0,this.viewpoint.setCenter([e[0],e[1]]),this.viewpoint.setLevel(this.viewpoint.targetZoom),this.viewpoint.calcMatrix(!0),this.viewpoint.targetZoom=null,this.handlePushViewState(),this._renderRaf=null,this.callHooks("zoomEnd"),this.threeRender()):(this.viewpoint.updateMatrix(e[0],e[1],this.viewpoint.startZoom-b/300),this.animate(),this._animateRaf=window.requestAnimationFrame(this._zoomAnimateOut.bind(this,a)))};C.prototype._zoomWheelAnimateIn=function(a,b){a||(a=performance.now());
var e=performance.now()-a,d=this.viewpoint.center;if(300<=e)window.cancelAnimationFrame(this._animateRaf),this._nochanging=!0,this.viewpoint.setCenter([d[0]+this.deltaX/2,d[1]+this.deltaY/2]),b?(this.viewpoint.setLevel(this.viewpoint.targetZoom),this.viewpoint.targetZoom=null):(this.viewpoint.resolution=this.viewpoint.targetResolution/2,this.viewpoint.targetResolution=null),this.viewpoint.calcMatrix(!0),this._renderRaf=null,this.callHooks("zoomEnd"),this.handlePushViewState(),this.threeRender();else{var e=
e/300,c;b?(c=1-1/Math.pow(2,e),this.viewpoint.updateMatrix(d[0]+this.deltaX*c,d[1]+this.deltaY*c,this.viewpoint.startZoom+e)):(c=1-1/(1+e),this.viewpoint.resolution=this.viewpoint.targetResolution/(1+e),this.viewpoint.updateMatrix(d[0]+this.deltaX*c,d[1]+this.deltaY*c,null,this.viewpoint.resolution));this.animate();this._animateRaf=window.requestAnimationFrame(this._zoomWheelAnimateIn.bind(this,a,b))}};C.prototype._zoomAnimateIn=function(a){a||(a=performance.now());var b=performance.now()-a,e=this.viewpoint.center;
300<=b?(window.cancelAnimationFrame(this._animateRaf),this._nochanging=!0,this.viewpoint.setCenter([e[0],e[1]]),this.viewpoint.setLevel(this.viewpoint.targetZoom),this.viewpoint.calcMatrix(!0),this._renderRaf=null,this.viewpoint.targetZoom=null,this.handlePushViewState(),this.callHooks("zoomEnd"),this.threeRender()):(this.viewpoint.updateMatrix(e[0],e[1],this.viewpoint.startZoom+b/300),this.animate(),this._animateRaf=window.requestAnimationFrame(this._zoomAnimateIn.bind(this,a)))};C.prototype.mapMove=
function(a,b){if(this.panEnabled){var e=-this.viewpoint.angle/180*Math.PI,d=Math.sin(e),e=Math.cos(e),c=this.viewpoint.resolution,g=this.viewpoint.center;this.viewpoint.setCenter([g[0]-c*(a*e-b*d),g[1]+c*(a*d+b*e)]);this.viewpoint.calcMatrix(!0);this.threeRender()}};C.prototype.stopMove=function(){this.panEnabled&&this.refresh(!0)};C.prototype.pan=function(a,b){var e=this.viewpoint.center;this.viewpoint.setCenter([e[0]+a,e[1]+b]);this.viewpoint.calcMatrix(!0);this.zoomHistory.update(this.viewpoint.level,
x.now());this.viewpoint.calcMatrix(!0);this._bound=this.viewpoint.calcBounds();this._extentDirty=!0;this.allLayerViews.forEach(function(a){a.refresh()});this.threeRender()};C.prototype._mouseRotate=function(a){this.rotateEnabled&&(this.viewpoint.angle=(this.viewpoint.angle-a/1080*180)%360,this.viewpoint.updateBaseMatrix(),this.threeRender(),f.publish("mapRotateAngle",this.viewpoint.angle))};C.prototype._stopMouseRotate=function(){this.rotateEnabled&&this.refresh(!0)};C.prototype.rotateMap=function(a){this.rotateEnabled&&
(this.viewpoint.oldAngle=this.viewpoint.angle,this.viewpoint.angle=(this.viewpoint.angle+a)%360,this.viewpoint.deltaAngle=a,f.publish("mapRotateAngle",this.viewpoint.angle),this.viewpoint.updateBaseMatrix(),this._bound=this.viewpoint.calcBounds(),this._extentDirty=!0,this._handleRotate())};C.prototype._handleRotate=function(){this.allLayerViews.forEach(function(a){a._readyData()});this._nochanging=!1;this._rotateAnimation(null,this.viewpoint.deltaAngle,0)};C.prototype._rotateAnimation=function(a,
b,e){a||(a=performance.now());e=performance.now()-a;300<=e?(window.cancelAnimationFrame(this._animateRaf),this._nochanging=!0,this.viewpoint.angle=this.viewpoint.oldAngle+b,this.viewpoint.updateBaseMatrix(),this.handlePushViewState(),this.threeRender()):(this.viewpoint.angle=this.viewpoint.oldAngle+b*e/300,this.viewpoint.updateBaseMatrix(),this.animate(),this._animateRaf=window.requestAnimationFrame(this._rotateAnimation.bind(this,a,b,e)))};C.prototype._mouseSwitchDip=function(a){this.rotateEnabled&&
(this.viewpoint.updatePitch(-a/20),this.threeRender())};C.prototype._stopSwitch=function(){this.rotateEnabled&&this.refresh(!0)};C.prototype.setDimensions=function(a){2===a&&0!==this.viewpoint.pitch?(this.viewpoint.oldPitch=this.viewpoint.pitch,this.viewpoint.pitch=0,this.viewpoint.deltaPitch=this.viewpoint.pitch-this.viewpoint.oldPitch,f.publish("mapSwitchDimension",2),this.viewpoint.updateBaseMatrix(),this._bound=this.viewpoint.calcBounds(),this._extentDirty=!0,this._handleSwitch2D()):3===a&&50!==
this.viewpoint.pitch&&(this.viewpoint.oldPitch=this.viewpoint.pitch,this.viewpoint.pitch=50,this.viewpoint.deltaPitch=this.viewpoint.pitch-this.viewpoint.oldPitch,f.publish("mapSwitchDimension",3),this.viewpoint.updateBaseMatrix(),this._bound=this.viewpoint.calcBounds(),this._extentDirty=!0,this._handleSwitch3D())};C.prototype._handleSwitch2D=function(){this.allLayerViews.forEach(function(a){a._readyData()});this._nochanging=!1;this._switchAnimation(null,this.viewpoint.deltaPitch)};C.prototype._handleSwitch3D=
function(){this.allLayerViews.forEach(function(a){a._readyData()});this._nochanging=!1;this._switchAnimation(null,this.viewpoint.deltaPitch)};C.prototype._switchAnimation=function(a,b){a||(a=performance.now());var e=performance.now()-a;500<=e?(window.cancelAnimationFrame(this._animateRaf),this._nochanging=!0,this.viewpoint.pitch=this.viewpoint.oldPitch+b,this.viewpoint.updateBaseMatrix(),this.handlePushViewState(),this.threeRender()):(this.viewpoint.pitch=this.viewpoint.oldPitch+b*e/500,this.viewpoint.updateBaseMatrix(),
this.animate(),this._animateRaf=window.requestAnimationFrame(this._switchAnimation.bind(this,a,b)))};C.prototype.animate=function(){this._renderRaf||(this._renderRaf=requestAnimationFrame(function(){this._renderRaf=null;this._gl.clearColor(this.backgroundColor.r,this.backgroundColor.g,this.backgroundColor.b,this.backgroundColor.a);this._gl.clear(this._clearBit);this.currentLayer=0;this.context.setDefault();this._drawBackgroundImage();this.allLayerViews.forEach(function(a){a.zoom()})}.bind(this)))};
C.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO();this.context.cullFace.setDefault();this.context.activeTexture.setDefault();this.context.pixelStoreUnpack.setDefault();this.context.pixelStoreUnpackPremultiplyAlpha.setDefault();this.context.pixelStoreUnpackFlipY.setDefault()};C.prototype.setBaseState=function(){var a=this.context.gl;this.context.cullFace.set(!1);this.context.viewport.set([0,0,this.width,this.height]);this.context.blendEquation.set(a.FUNC_ADD)};C.prototype.queryFeaturesByGeometry=
function(a,b,e){var d=[],c={},g=[];this.map.allLayers.forEach(function(e){if(e.selectEnabled){var h=e.queryFeaturesByGeometry(a,b);h instanceof l?(d.push(h),g.push(e.id)):c[e.id]=h}});0<d.length?(new k(d)).then(function(a){a.forEach(function(a,b){a[0]&&(c[g[b]]=a[1].results)});e&&e(c)}):e&&e(c)};C.prototype.queryRenderFeaturesByGeometry=function(a,b,e){var d=[],c={},g=[];this.map.allLayers.forEach(function(e){if(e.selectEnabled){var h=e.queryRenderFeaturesByGeometry(a,b);h instanceof l?(d.push(h),
g.push(e.id)):c[e.id]=h}});0<d.length?(new k(d)).then(function(a){a.forEach(function(a,b){a[0]&&(c[g[b]]=a[1].results)});e&&e(c)}):e&&e(c)};C.prototype.addTask=function(a){this._renderRaf=requestAnimationFrame(function(){this._renderRaf=null;this._gl.clear(this._clearBit);this.currentLayer=0;this.depthRangeFor3D=[0,1-3*this.numSublayers*this.depthEpsilon];this.context.setDefault();this.allLayerViews.forEach(function(a){a._render()});this.allLayerViews[0]._fadeDirty?(this.allLayerViews[0]._fadeDirty=
!1,this.threeRender()):a()}.bind(this))};C.prototype.resetExtent=function(){this._initState&&(this.viewpoint.setView(this._initState),this.refresh(!0))};C.prototype.calcBounds=function(a,b,e,d){return this.viewpoint.calcBound(a,b,e,d)};C.prototype.callHooks=function(a){this[a].forEach(function(a){a()})};C.prototype.loadItem=function(a){this.graphicsIndex.load(a)};C.prototype.insertItems=function(a){for(var b=0,e=a.length;b<e;b++)this.graphicsIndex.insert(a[b])};C.prototype.queryGraphicsByGeometry=
function(a,b){switch(a.type){case "point":a=[a]}var e={};b=this.graphicsIndex.query(a,b||0,this.resolution);for(var d=[],c=0,g=b.length;c<g;c++){var h=b[c];if(h.g.selectEnabled)if(h.hasOwnProperty("symbol")){var f=h.g,p=f.feature.geometry;if("multipolygon"===p.type)for(var p=p.polygons,q=0;q<p.length;q++){if(E[h.symbol.type](a,p[q],h.symbol,this.resolution,f.feature.geometry.radius,this.viewpoint)){e.hasOwnProperty(h.id)||(d.push(h.g),e[h.id]=!0);break}}else E[h.symbol.type](a,h.g.feature.geometry,
h.symbol,this.resolution,f.feature.geometry.radius,this.viewpoint)&&!e.hasOwnProperty(h.id)&&(d.push(h.g),e[h.id]=!0)}else e.hasOwnProperty(h.id)||(d.push(h.g),e[h.id]=!0)}return d};C.prototype.queryGraphicByDevId=function(a){for(var b,e=0,d=this.allLayerViews;e<d.length;e++)if(0<d[e].layer.graphics.length&&"labelLayer"!==d[e].graphicsLayerView.id)for(var c=0,g=d[e].layer.graphics;c<g.length;c++)g[c].feature.attributes.forEach(function(e){"dev_id"===e.name&&e.value===a&&(b=g[c])});return void 0!==
b?b:null};C.prototype.queryGraphicSizeByPoint=function(a,b){a=this.graphicsIndex.query([a],0,this.resolution);var e=Infinity,d=Infinity,c=-Infinity,g=-Infinity;b=!b;for(var h=0,f=a.length;h<f;h++){var p=a[h];p.symbol&&b||(p.minX<e&&(e=p.minX),p.minY<d&&(d=p.minY),p.maxX>c&&(c=p.maxX),p.maxY>g&&(g=p.maxY))}return{xmin:e,ymin:d,xmax:c,ymax:g,width:Math.abs(c-e),height:Math.abs(g-d)}};C.prototype.checkExtentState=function(a,b,e,d,c){void 0===c&&(c=!0);var h=this.graphicsIndex.checkExtentState(a,b,e,
d);a=[new g(a,d),new g(e,d),new g(e,b),new g(a,b)];b=0;for(e=h.length;b<e;b++)if(d=h[b],d.hasOwnProperty("symbol")){var f=d.g;if(c&&E.line(a,f.feature.geometry,d.symbol,this.resolution,f.feature.geometry.radius,this.viewpoint))return!0}else return!0;return!1};C.prototype.clear=function(){this.graphicsIndex.clear();this.map.clear();this.allLayerViews=[];this.threeRender()};C.prototype.setBackgroundColor=function(a){this.backgroundColor=A.parse(a);this.threeRender()};C.prototype.destroy=function(){this.graphicsIndex.clear();
this.map.clear();this.allLayerViews=[];d.destroy(this.domNode)};C.prototype.requestRenderFrame=function(a){return this._renderTaskQueue.add(a)};C.prototype.cancelRenderFrame=function(a){this._renderTaskQueue.remove(a)};C.prototype.threeRender=function(){this._renderRaf||!this._nochanging||this.viewpoint.matrixDirty||(this._renderRaf=requestAnimationFrame(function(){this._renderRaf=null;this._nochanging&&(this._renderTaskQueue.run(this),this._gl.clearColor(this.backgroundColor.r,this.backgroundColor.g,
this.backgroundColor.b,this.backgroundColor.a),this._gl.clear(this._clearBit),this.context.setDefault(),this.currentLayer=0,this.depthRangeFor3D=[0,1-3*this.numSublayers*this.depthEpsilon],this.allLayerViews.forEach(function(a){a._render()}),this._drawBackgroundImage(),0<this.allLayerViews.length&&this.allLayerViews[0]._fadeDirty&&(this.allLayerViews[0]._fadeDirty=!1,this.threeRender()))}.bind(this)))};C.maxOverzooming=10;C.maxUnderzooming=3;return C})},"com/huayun/webgis/layers/support/OverscaledTileID":function(){define(["./CanonicalTileID",
"./funcUtils"],function(f,c){var k=function(d,a){this.wrap=d;this.canonical=a;this.key=c.calculateKey(d,a.z,a.x,a.y)},l=function(d,a,m,n,g){this.overscaledZ=d;this.wrap=a;this.canonical=new f(m,+n,+g);this.key=c.calculateKey(a,d,n,g)};l.prototype.equals=function(d){return this.overscaledZ===d.overscaledZ&&this.wrap===d.wrap&&this.canonical.equals(d.canonical)};l.prototype.scaledTo=function(d){var a=this.canonical.z-d;return d>this.canonical.z?new l(d,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):
new l(d,this.wrap,d,this.canonical.x>>a,this.canonical.y>>a)};l.prototype.isChildOf=function(d){if(d.wrap!==this.wrap)return!1;var a=this.canonical.z-d.canonical.z;return 0===d.overscaledZ||d.overscaledZ<this.overscaledZ&&d.canonical.x===this.canonical.x>>a&&d.canonical.y===this.canonical.y>>a};l.prototype.children=function(d){if(this.overscaledZ>=d)return[new l(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];d=this.canonical.z+1;var a=2*this.canonical.x,c=2*this.canonical.y;
return[new l(d,this.wrap,d,a,c),new l(d,this.wrap,d,a+1,c),new l(d,this.wrap,d,a,c+1),new l(d,this.wrap,d,a+1,c+1)]};l.prototype.isLessThan=function(d){return this.wrap<d.wrap?!0:this.wrap>d.wrap?!1:this.overscaledZ<d.overscaledZ?!0:this.overscaledZ>d.overscaledZ?!1:this.canonical.x<d.canonical.x?!0:this.canonical.x>d.canonical.x?!1:this.canonical.y<d.canonical.y?!0:!1};l.prototype.wrapped=function(){return new l(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)};l.prototype.unwrapTo=
function(d){return new l(this.overscaledZ,d,this.canonical.z,this.canonical.x,this.canonical.y)};l.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)};l.prototype.toUnwrapped=function(){return new k(this.wrap,this.canonical)};l.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y};l.prototype.getTilePoint=function(d){return this.canonical.getTilePoint(new MercatorCoordinate(d.x-this.wrap,d.y))};return l})},"com/huayun/webgis/data/struct":function(){define(["exports"],
function(f){var c=function(a,d){this._structArray=a;this._pos1=d*this.size;this._pos2=this._pos1/2;this._pos4=this._pos1/4;this._pos8=this._pos1/8},k=function(a){function d(){a.apply(this,arguments)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},
key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},radialTextOffset:{configurable:!0}};c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]};c.anchorX.set=function(a){this._structArray.int16[this._pos2+
0]=a};c.anchorY.get=function(){return this._structArray.int16[this._pos2+1]};c.anchorY.set=function(a){this._structArray.int16[this._pos2+1]=a};c.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]};c.rightJustifiedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+2]=a};c.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]};c.centerJustifiedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+
3]=a};c.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]};c.leftJustifiedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+4]=a};c.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]};c.verticalPlacedTextSymbolIndex.set=function(a){this._structArray.int16[this._pos2+5]=a};c.key.get=function(){return this._structArray.uint16[this._pos2+6]};c.key.set=function(a){this._structArray.uint16[this._pos2+6]=a};c.textBoxStartIndex.get=
function(){return this._structArray.uint16[this._pos2+7]};c.textBoxStartIndex.set=function(a){this._structArray.uint16[this._pos2+7]=a};c.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+8]};c.textBoxEndIndex.set=function(a){this._structArray.uint16[this._pos2+8]=a};c.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]};c.iconBoxStartIndex.set=function(a){this._structArray.uint16[this._pos2+9]=a};c.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+
10]};c.iconBoxEndIndex.set=function(a){this._structArray.uint16[this._pos2+10]=a};c.featureIndex.get=function(){return this._structArray.uint16[this._pos2+11]};c.featureIndex.set=function(a){this._structArray.uint16[this._pos2+11]=a};c.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+12]};c.numHorizontalGlyphVertices.set=function(a){this._structArray.uint16[this._pos2+12]=a};c.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+13]};
c.numVerticalGlyphVertices.set=function(a){this._structArray.uint16[this._pos2+13]=a};c.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+14]};c.numIconVertices.set=function(a){this._structArray.uint16[this._pos2+14]=a};c.crossTileID.get=function(){return this._structArray.uint32[this._pos4+8]};c.crossTileID.set=function(a){this._structArray.uint32[this._pos4+8]=a};c.textBoxScale.get=function(){return this._structArray.float32[this._pos4+9]};c.textBoxScale.set=function(a){this._structArray.float32[this._pos4+
9]=a};c.radialTextOffset.get=function(){return this._structArray.float32[this._pos4+10]};c.radialTextOffset.set=function(a){this._structArray.float32[this._pos4+10]=a};Object.defineProperties(d.prototype,c);return d}(c);k.prototype.size=44;var l=function(a){function d(){a.apply(this,arguments)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;var c={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},
vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0}};c.anchorX.get=function(){return this._structArray.int16[this._pos2+0]};c.anchorX.set=function(a){this._structArray.int16[this._pos2+0]=a};c.anchorY.get=function(){return this._structArray.int16[this._pos2+
1]};c.anchorY.set=function(a){this._structArray.int16[this._pos2+1]=a};c.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]};c.glyphStartIndex.set=function(a){this._structArray.uint16[this._pos2+2]=a};c.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]};c.numGlyphs.set=function(a){this._structArray.uint16[this._pos2+3]=a};c.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]};c.vertexStartIndex.set=function(a){this._structArray.uint32[this._pos4+
2]=a};c.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]};c.lineStartIndex.set=function(a){this._structArray.uint32[this._pos4+3]=a};c.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]};c.lineLength.set=function(a){this._structArray.uint32[this._pos4+4]=a};c.segment.get=function(){return this._structArray.uint16[this._pos2+10]};c.segment.set=function(a){this._structArray.uint16[this._pos2+10]=a};c.lowerSize.get=function(){return this._structArray.uint16[this._pos2+
11]};c.lowerSize.set=function(a){this._structArray.uint16[this._pos2+11]=a};c.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]};c.upperSize.set=function(a){this._structArray.uint16[this._pos2+12]=a};c.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]};c.lineOffsetX.set=function(a){this._structArray.float32[this._pos4+7]=a};c.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]};c.lineOffsetY.set=function(a){this._structArray.float32[this._pos4+
8]=a};c.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]};c.writingMode.set=function(a){this._structArray.uint8[this._pos1+36]=a};c.hidden.get=function(){return this._structArray.uint8[this._pos1+37]};c.hidden.set=function(a){this._structArray.uint8[this._pos1+37]=a};c.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]};c.crossTileID.set=function(a){this._structArray.uint32[this._pos4+10]=a};Object.defineProperties(d.prototype,c);return d}(c);l.prototype.size=
44;var d=function(a){function d(){a.apply(this,arguments)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;var c={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};c.anchorPointX.get=
function(){return this._structArray.int16[this._pos2+0]};c.anchorPointX.set=function(a){this._structArray.int16[this._pos2+0]=a};c.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]};c.anchorPointY.set=function(a){this._structArray.int16[this._pos2+1]=a};c.x1.get=function(){return this._structArray.int16[this._pos2+2]};c.x1.set=function(a){this._structArray.int16[this._pos2+2]=a};c.y1.get=function(){return this._structArray.int16[this._pos2+3]};c.y1.set=function(a){this._structArray.int16[this._pos2+
3]=a};c.x2.get=function(){return this._structArray.int16[this._pos2+4]};c.x2.set=function(a){this._structArray.int16[this._pos2+4]=a};c.y2.get=function(){return this._structArray.int16[this._pos2+5]};c.y2.set=function(a){this._structArray.int16[this._pos2+5]=a};c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]};c.featureIndex.set=function(a){this._structArray.uint32[this._pos4+3]=a};c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]};c.sourceLayerIndex.set=
function(a){this._structArray.uint16[this._pos2+8]=a};c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]};c.bucketIndex.set=function(a){this._structArray.uint16[this._pos2+9]=a};c.radius.get=function(){return this._structArray.int16[this._pos2+10]};c.radius.set=function(a){this._structArray.int16[this._pos2+10]=a};c.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]};c.signedDistanceFromAnchor.set=function(a){this._structArray.int16[this._pos2+
11]=a};c.anchorPoint.get=function(){return new pointGeometry(this.anchorPointX,this.anchorPointY)};Object.defineProperties(d.prototype,c);return d}(c);d.prototype.size=24;c=function(a){function d(){a.apply(this,arguments)}a&&(d.__proto__=a);d.prototype=Object.create(a&&a.prototype);d.prototype.constructor=d;var c={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};c.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]};c.featureIndex.set=
function(a){this._structArray.uint32[this._pos4+0]=a};c.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]};c.sourceLayerIndex.set=function(a){this._structArray.uint16[this._pos2+2]=a};c.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]};c.bucketIndex.set=function(a){this._structArray.uint16[this._pos2+3]=a};Object.defineProperties(d.prototype,c);return d}(c);c.prototype.size=8;f.SymbolInstanceStruct=k;f.PlacedSymbolStruct=l;f.CollisionBoxStruct=d;
f.FeatureIndexStruct=c})},"com/huayun/webgis/views/3d/layers/GraphicLayerView3D":function(){define("dojo/_base/declare ./LayerView3D com/huayun/webgis/gl/mode com/huayun/webgis/data/ArrayType com/huayun/webgis/gl/SegmentVector com/huayun/webgis/gl/glUtils".split(" "),function(f,c,k,l,d,a){return f("com.huayun.webgis.views.3d.layers.GraphicLayerView3D",[c],{constructor:function(a){f.safeMixin(this,a);this.visible=a.visible;this.renderer=a.renderer;this.glow=a.glow;a=new l.StructArrayLayout4i8;a.emplaceBack(-1,
-1,0,0);a.emplaceBack(1,-1,1,0);a.emplaceBack(-1,1,0,1);a.emplaceBack(1,1,1,1);this.viewportBuffer=this.view.context.createVertexBuffer(a,[{name:"aPos",type:"Int16",components:4,offset:0}]);this.viewportSegments=d.simpleSegment(0,0,4,2);a=new l.StructArrayLayout3ui6;a.emplaceBack(0,1,2);a.emplaceBack(2,1,3);this.quadTriangleIndexBuffer=this.view.context.createIndexBuffer(a)},_readyData:function(){},_render:function(){var a=this.view.viewpoint.targetZoom||this.view.viewpoint.level,d=!0;this.layer.minLevel&&
a<this.layer.minLevel&&(d=!1);this.layer.maxLevel&&a>=this.layer.maxLevel&&(d=!1);if(this.visible&&d){this.view.currentLayer++;this.depthRangeFor3D=[0,1-(1+this.view.currentLayer)*this.view.numSublayers*this.view.depthEpsilon];for(var a=this.layer.graphics,c,h,d=[],b=0;b<a.length;b++)c=a[b],c.glow&&c.visible&&c.symbol&&d.push(c);try{if(0<d.length){var e=this.view.context,f=this.view.width,p=this.view.height;this.bindFramebuffer(e,"renderFBO",f,p);var l=e.gl;l.clearColor(0,0,0,0);l.clear(l.COLOR_BUFFER_BIT|
l.DEPTH_BUFFER_BIT);for(b=0;b<d.length;b++)c=d[b],h=c.symbol,this.renderer.drawGlow(this.view,c,c.feature.geometry,h,this);this.renderBlur(e,f,p);e.bindFramebuffer.set(null);e.viewport.set([0,0,f,p]);this.renderTextureToMap(e)}for(b=0;b<a.length;b++)c=a[b],h=c.symbol,c.visible&&h&&(this.renderer.draw(this.view,c,c.feature.geometry,h,this),c.addHook&&(c.addHook(c,this),c.addHook=null))}catch(v){}}},bindFramebuffer:function(d,c,g,h){var b=this[c];if(!b||1<Math.abs(b.width-g)||1<Math.abs(b.height-h))b=
this[c]=a.generateFBO(d,g,h);d.bindFramebuffer.set(b.framebuffer)},renderBlur:function(a,d,c){var g=a.gl,b=this.layer.glowRatio;d=Math.ceil(d/b);c=Math.ceil(c/b);this.bindFramebuffer(a,"blurFBO",d,c);a.activeTexture.set(g.TEXTURE0);g.bindTexture(g.TEXTURE_2D,this.renderFBO.colorAttachment.get());g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT);a.viewport.set([0,0,d,c]);this.view.useProgramSimplify("gaussianBlur",{layoutAttributes:{name:"aPos",type:"Int16",components:4,offset:0}}).draw(a,g.TRIANGLES,
k.DepthMode.disabled,k.StencilMode.disabled,k.ColorMode.alphaBlended,k.CullFaceMode.disabled,{uSize:[d,c],uTexture:0,uHorizontal:0,u_kernel:[.8,.15,.1,.05,.01]},this.id,this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments);this.bindFramebuffer(a,"blurFBO2",d,c);g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT);g.bindTexture(g.TEXTURE_2D,this.blurFBO.colorAttachment.get());this.view.useProgramSimplify("gaussianBlur",{layoutAttributes:{name:"aPos",type:"Int16",components:4,offset:0}}).draw(a,
g.TRIANGLES,k.DepthMode.disabled,k.StencilMode.disabled,k.ColorMode.alphaBlended,k.CullFaceMode.disabled,{uSize:[d,c],uTexture:0,uHorizontal:1,u_kernel:[.8,.15,.1,.05,.01]},this.id,this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},renderTextureToMap:function(a){var d=a.gl,c=this.blurFBO2;c&&(a.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,c.colorAttachment.get()),this.view.useProgramSimplify("screen",{layoutAttributes:{name:"aPos",type:"Int16",components:4,offset:0}}).draw(a,
d.TRIANGLES,k.DepthMode.disabled,k.StencilMode.disabled,k.ColorMode.alphaBlended,k.CullFaceMode.disabled,{uTexture:0},this.id,this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments))},refresh:function(){this.view.threeRender()},addGraphic:function(a){a.position||(a.position=this.view.viewpoint.center);a.symbol&&(a.added=!0,this.renderer.add(this.view,a,a.feature.geometry,a.symbol),a.addHook=function(a,d){var c=[];d.renderer.calculateExtent(d.view,a,a.feature.geometry,a.symbol,c);d.view.insertItems(c)})},
zoom:function(){this.visible&&this._render()},depthModeForSublayer:function(a,d,c){return new k.DepthMode(this.view.context.gl.LEQUAL,d,this.view.depthRangeFor3D)},setVisible:function(a){this.visible=a;this.view.threeRender()}})})},"com/huayun/webgis/symbols/LineSymbol":function(){define(["./Symbol","../utils/Color"],function(f,c){var k=function(d){if(d){f.call(this,d);this.type="line";this.join=d.lineJoin||d.join||"miter";this.cap=d.lineCap||d.cap||"butt";var a=c.parse(d.color||"#FF0000"),l=void 0===
d.opacity?1:d.opacity;this.width=Number(d.width);this.length=d.length||8;this._color=[a.r,a.g,a.b,a.a];this.opacity=l;this.gapwidth=void 0===d.gapwidth?0:d.gapwidth;this.offset=void 0===d.offset?0:d.offset;this.minScale=d.minScale;this.maxScale=d.maxScale;"dash"===d.style?d.dasharray=[5,5]:"solid"===d.style&&(d.dasharray=null);d.dasharray?(this.dasharray={from:d.dasharray,to:d.dasharray},this.scaleDirty=!0,this.uniforms={u_ratio:1,u_color:this.color,u_opacity:this.opacity,u_gapwidth:0,u_width:this.width,
u_blur:0,u_offset:this.offset,u_floorwidth:1,u_mix:1,ratio:.5}):this.uniforms={u_ratio:1,u_color:[a.r,a.g,a.b,a.a],u_blur:0,u_opacity:this.opacity,u_gapwidth:this.gapwidth,u_offset:this.offset,u_width:this.width,ratio:.5}}};f&&(k.__proto__=f);k.prototype=Object.create(f&&f.prototype);k.prototype.constructor=k;k.prototype.setWidth=function(d){this.uniforms.u_width=d};k.prototype.clone=function(){var d=new k;d.type="line";d.join=this.join;d.cap=this.cap;d.width=this.width;d.length=this.length;d.opacity=
this.opacity;d.gapwidth=this.gapwidth;d.offset=this.offset;d.minScale=this.minScale;d.maxScale=this.maxScale;this.dasharray&&(d.dasharray=this.dasharray,d.scaleDirty=this.scaleDirty);d.uniforms=this.uniforms;d.color=this.color;d.fixedSize=this.fixedSize;d.fixed={isFixed:d.fixedSize,addratio:0};return d};var l={color:{configurable:!0}};l.color.set=function(d){d=c.parse(d);this._color=[d.r,d.g,d.b,d.a];this.uniforms&&(this.uniforms.u_color=this._color)};l.color.get=function(){return this._color};Object.defineProperties(k.prototype,
l);return k})},"com/huayun/webgis/data/bucket/FillBucketSimplify":function(){define("../ArrayType ../../gl/SegmentVector ../../utils/earcut ../../utils/utils ../../utils/Constant ../../utils/classifyRings".split(" "),function(f,c,k,l,d,a){function m(){this.layoutVertexArray=new f.StructArrayLayout2f8;this.indexArray=new f.StructArrayLayout3ui6;this.segments=new c}m.prototype.addFeatures=function(a,d){a=0;for(var c=this.features;a<c.length;a+=1){var b=c[a];this.addFeature(b,b.geometry,b.index,d)}};
m.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy())};m.prototype.addFeature=function(c){var g=0;for(c=a(c,d.layout.EARCUT_MAX_RINGS);g<c.length;g+=1){for(var h=c[g],b=0,e=0,f=h;e<f.length;e+=1)b+=f[e].length;for(var e=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),f=e.vertexLength,p=[],l=[],m=0,n=h;m<n.length;m+=1){var y=n[m];if(0!==y.length){y!==h[0]&&l.push(p.length/2);this.layoutVertexArray.emplaceBack(y[0].x,
y[0].y);p.push(y[0].x);p.push(y[0].y);for(var u=1;u<y.length;u++)this.layoutVertexArray.emplaceBack(y[u].x,y[u].y),p.push(y[u].x),p.push(y[u].y)}}h=k.earcut(p,l);for(p=0;p<h.length;p+=3)this.indexArray.emplaceBack(f+h[p],f+h[p+1],f+h[p+2]);e.vertexLength+=b;e.primitiveLength+=h.length/3}};m.prototype.upload=function(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,[{name:"a_pos",type:"Float32",components:2,offset:0}]);this.indexBuffer=a.createIndexBuffer(this.indexArray)};return m})},
"com/huayun/core/EventEmitter":function(){define([],function(){function f(a,c){for(var b=Array(c),e=0;e<c;++e)b[e]=a[e];return b}function c(a,c,b,e){var d,g;if("function"!==typeof b)throw Error("listener must be function");d=a._events;void 0===d?(d=a._events=Object.create(null),a._eventsCount=0):(void 0!==d.newListener&&(a.emit("newListener",c,b.listener?b.listener:b),d=a._events),g=d[c]);void 0===g?(g=d[c]=b,++a._eventsCount):"function"===typeof g?g=d[c]=e?[b,g]:[g,b]:e?g.unshift(b):g.push(b);return a}
function k(a,c,b){a={fired:!1,wrapFn:void 0,target:a,type:c,listener:b};c=l.bind(a);c.listener=b;return a.wrapFn=c}function l(){this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,this.listener.apply(this.target,Array.prototype.slice.call(arguments,0)))}function d(a,c,b){a=a._events;if(void 0===a)return[];c=a[c];if(void 0===c)return[];if("function"===typeof c)return b?[c.listener||c]:[c];if(b)for(b=Array(c.length),a=0;a<b.length;++a)b[a]=c[a].listener||c[a];else b=f(c,c.length);
return b}function a(){a.init.call(this)}function m(a){var c=this._events;if(void 0!==c){a=c[a];if("function"===typeof a)return 1;if(void 0!==a)return a.length}return 0}var n=10;Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return n},set:function(a){if("number"!==typeof a||0>a||Number.isNaN(a))throw Error("defaultMaxListeners must be a positive number!");n=a}});a.prototype._events=void 0;a.prototype._eventsCount=0;a.prototype._maxListeners=void 0;a.init=function(){if(void 0===
this._events||this._events===Object.getPrototypeOf(this)._events)this._events=Object.create(null),this._eventsCount=0;this._maxListeners=this._maxListeners||void 0};a.prototype.setMaxListeners=function(a){if("number"!==typeof a||0>a||Number.isNaN(a))throw Error("defaultMaxListeners must be a positive number!");this._maxListeners=a;return this};a.prototype.getMaxListeners=function(){return void 0===this._maxListeners?a.defaultMaxListeners:this._maxListeners};a.prototype.emit=function(a){var c="error"===
a,b=this._events;if(void 0!==b)c=c&&void 0===b.error;else if(!c)return!1;if(c){var e;1<arguments.length&&(e=arguments[1]);if(e instanceof Error)throw e;}b=b[a];if(void 0===b)return!1;if("function"===typeof b)b.apply(this,Array.prototype.slice.call(arguments,1));else for(c=b.length,b=f(b,c),e=0;e<c;++e)b[e].apply(this,Array.prototype.slice.call(arguments,1));return!0};a.prototype.addListener=function(a,d){return c(this,a,d,!1)};a.prototype.on=a.prototype.addListener;a.prototype.prependListener=function(a,
d){return c(this,a,d,!0)};a.prototype.once=function(a,c){if("function"!==typeof c)throw Error("listener must be function!");this.on(a,k(this,a,c));return this};a.prototype.prependOnceListener=function(a,c){if("function"!==typeof c)throw Error("listener must be function!");this.prependListener(a,k(this,a,c));return this};a.prototype.removeListener=function(a,c){var b,e,d,g,h;if("function"!==typeof c)throw Error("listener must be function!");e=this._events;if(void 0===e)return this;b=e[a];if(void 0===
b)return this;if(b===c||b.listener===c)0===--this._eventsCount?this._events=Object.create(null):(delete e[a],e.removeListener&&this.emit("removeListener",a,b.listener||c));else if("function"!==typeof b){d=-1;for(g=b.length-1;0<=g;g--)if(b[g]===c||b[g].listener===c){h=b[g].listener;d=g;break}if(0>d)return this;0===d?b.shift():b.splice(d,1);1===b.length&&(e[a]=b[0]);void 0!==e.removeListener&&this.emit("removeListener",a,h||c)}return this};a.prototype.off=a.prototype.removeListener;a.prototype.removeAllListeners=
function(a){var c,b;b=this._events;if(void 0===b)return this;if(void 0===b.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==b[a]&&(0===--this._eventsCount?this._events=Object.create(null):delete b[a]),this;if(0===arguments.length){c=Object.keys(b);var e;for(b=0;b<c.length;++b)e=c[b],"removeListener"!==e&&this.removeAllListeners(e);this.removeAllListeners("removeListener");this._events=Object.create(null);this._eventsCount=0;return this}c=b[a];
if("function"===typeof c)this.removeListener(a,c);else if(void 0!==c)for(b=c.length-1;0<=b;b--)this.removeListener(a,c[b]);return this};a.prototype.listeners=function(a){return d(this,a,!0)};a.prototype.rawListeners=function(a){return d(this,a,!1)};a.listenerCount=function(a,c){return"function"===typeof a.listenerCount?a.listenerCount(c):m.call(a,c)};a.prototype.listenerCount=m;a.prototype.eventNames=function(){return 0<this._eventsCount?Object.keys(this._events):[]};return a})},"com/huayun/webgis/views/3d/layers/LayerView3D":function(){define(["../../layers/LayerView",
"../../../utils/extendClazz"],function(f,c){function k(c){f.call(this,c)}c(k,f);k.prototype.resize=function(){};return k})},"com/huayun/webgis/utils/image":function(){define(["exports"],function(f){function c(a,c,d,h){var b=c.width;c=c.height;if(!h)h=new Uint8Array(b*c*d);else if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==b*c*d)throw new RangeError("mismatched image size");a.width=b;a.height=c;a.data=h;return a}function k(a,d,g){var h=d.width;d=d.height;if(h!==a.width||
d!==a.height){var b=c({},{width:h,height:d},g);l(a,b,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,h),height:Math.min(a.height,d)},g);a.width=h;a.height=d;a.data=b.data}}function l(a,c,d,h,b,e){if(0===b.width||0===b.height)return c;if(b.width>a.width||b.height>a.height||d.x>a.width-b.width||d.y>a.height-b.height)throw new RangeError("out of range source coordinates for image copy");if(b.width>c.width||b.height>c.height||h.x>c.width-b.width||h.y>c.height-b.height)throw new RangeError("out of range destination coordinates for image copy");
for(var g=a.data,f=c.data,l=0;l<b.height;l++)for(var k=((d.y+l)*a.width+d.x)*e,m=((h.y+l)*c.width+h.x)*e,n=0;n<b.width*e;n++)f[m+n]=g[k+n];return c}var d=function(a,d){c(this,a,1,d)};d.prototype.resize=function(a){k(this,a,1)};d.prototype.clone=function(){return new d({width:this.width,height:this.height},new Uint8Array(this.data))};d.copy=function(a,c,d,h,b){l(a,c,d,h,b,1)};f.AlphaImage=d;var a=function(a,d){c(this,a,4,d)};a.prototype.resize=function(a){k(this,a,4)};a.prototype.replace=function(a,
c){c?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a};a.prototype.clone=function(){return new a({width:this.width,height:this.height},new Uint8Array(this.data))};a.copy=function(a,c,d,h,b){l(a,c,d,h,b,4)};f.RGBAImage=a;f.renderColorRamp=function(c,d){for(var g=new Uint8Array(1024),h={},b=0,e=0;256>b;b++,e+=4){h[d]=b/255;var f=c.evaluate(h);g[e+0]=Math.floor(255*f.r/f.a);g[e+1]=Math.floor(255*f.g/f.a);g[e+2]=Math.floor(255*f.b/f.a);g[e+3]=Math.floor(255*f.a)}return new a({width:256,
height:1},g)}})},"com/huayun/webgis/symbols/Symbol":function(){define([],function(){function f(c){c&&(this.minScale=void 0===c.minScale?1:c.minScale,this.maxScale=void 0===c.maxScale?1:c.maxScale,this.dx=void 0===c.dx?0:c.dx,this.dy=void 0===c.dy?0:c.dy,this.isFixed=!1===c.isFixed?!1:void 0===c.symbol?!0:void 0===c.isFixed,this.renderer=void 0===c.renderer?null:c.renderer,this.fixed={isFixed:this.isFixed,addratio:0})}f.prototype.clone=function(){};return f})},"com/huayun/webgis/layers/support/CanonicalTileID":function(){define(["./funcUtils"],
function(f){var c=function(c,l,d){this.z=c;this.x=l;this.y=d;this.key=f.calculateKey(0,c,l,d)};c.prototype.equals=function(c){return this.z===c.z&&this.x===c.x&&this.y===c.y};c.prototype.url=function(c,f){return c[(this.x+this.y)%c.length].replace("{z}",String(Math.round(this.z))).replace("{x}",String(this.x)).replace("{y}",String("tms"===f?Math.pow(2,this.z)-this.y-1:this.y))};c.prototype.getTilePoint=function(c){};return c})},"com/huayun/webgis/layers/support/expression/Interpolate":function(){define(["../style/styleUtils",
"../../../utils/colorSpaces","../UnitBezier"],function(f,c,k){function l(a,c,d,g){g-=d;a-=d;return 0===g?0:1===c?a/g:(Math.pow(c,a)-1)/(Math.pow(c,g)-1)}var d=function(a,c,d,g,h){this.type=a;this.operator=c;this.interpolation=d;this.input=g;this.labels=[];this.outputs=[];for(a=0;a<h.length;a+=1)c=h[a],d=c[1],this.labels.push(c[0]),this.outputs.push(d)};d.interpolationFactor=function(a,c,d,g){var h=0;"exponential"===a.name?h=l(c,a.base,d,g):"linear"===a.name?h=l(c,1,d,g):"cubic-bezier"===a.name&&(a=
a.controlPoints,h=(new k(a[0],a[1],a[2],a[3])).solve(l(c,1,d,g)));return h};d.parse=function(a,c){var l=a[0],g=a[1],h=a[2],b=a.slice(3);if(!Array.isArray(g)||0===g.length)return c.error("Expected an interpolation type expression.",1);if("linear"===g[0])g={name:"linear"};else if("exponential"===g[0]){g=g[1];if("number"!==typeof g)return c.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:g}}else if("cubic-bezier"===g[0]){g=g.slice(1);if(4!==g.length||g.some(function(a){return"number"!==
typeof a||0>a||1<a}))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:g}}else return c.error("Unknown interpolation type "+String(g[0]),1,0);if(4>a.length-1)return c.error("Expected at least 4 arguments, but found only "+(a.length-1)+".");if(0!==(a.length-1)%2)return c.error("Expected an even number of arguments.");h=c.parse(h,2,{kind:"number"});if(!h)return null;a=[];var e=null;"interpolate-hcl"===l||
"interpolate-lab"===l?e={kind:"color"}:c.expectedType&&"value"!==c.expectedType.kind&&(e=c.expectedType);for(var q=0;q<b.length;q+=2){var p=b[q],k=b[q+1],m=q+3,z=q+4;if("number"!==typeof p)return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',m);if(a.length&&a[a.length-1][0]>=p)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',
m);k=c.parse(k,z,e);if(!k)return null;e=e||k.type;a.push([p,k])}return"number"===e.kind||"color"===e.kind||"array"===e.kind&&"number"===e.itemType.kind&&"number"===typeof e.N?new d(e,l,g,h,a):c.error("Type "+f.toString(e)+" is not interpolatable.")};d.prototype.evaluate=function(a){var l=this.labels,k=this.outputs;if(1===l.length)return k[0].evaluate(a);var g=this.input.evaluate(a);if(g<=l[0])return k[0].evaluate(a);var h=l.length;if(g>=l[h-1])return k[h-1].evaluate(a);h=f.findStopLessThanOrEqualTo(l,
g);l=d.interpolationFactor(this.interpolation,g,l[h],l[h+1]);g=k[h].evaluate(a);a=k[h+1].evaluate(a);if("interpolate"===this.operator)return f.interpolate[this.type.kind.toLowerCase()](g,a,l);if("interpolate-hcl"===this.operator)return k=c.hcl,k.reverse(k.interpolate(k.forward(g),k.forward(a),l));k=c.lab;return k.reverse(k.interpolate(k.forward(g),k.forward(a),l))};d.prototype.eachChild=function(a){a(this.input);for(var c=0,d=this.outputs;c<d.length;c+=1)a(d[c])};d.prototype.possibleOutputs=function(){var a;
return(a=[]).concat.apply(a,this.outputs.map(function(a){return a.possibleOutputs()}))};d.prototype.serialize=function(){var a;a="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);a=[this.operator,a,this.input.serialize()];for(var c=0;c<this.labels.length;c++)a.push(this.labels[c],this.outputs[c].serialize());return a};return d})},
"com/huayun/webgis/gl/ImageAtlas":function(){define(["./potpack","./ImagePosition","../utils/image","../utils/Constant"],function(f,c,k,l){var d=function(a,c){var d={},g={};this.haveRenderCallbacks=[];var h=[];this.addImages(a,d,h);this.addImages(c,g,h);var h=f(h),h=new k.RGBAImage({width:h.w||1,height:h.h||1}),b;for(b in a){var e=a[b],q=d[b].paddedRect;k.RGBAImage.copy(e.data,h,{x:0,y:0},{x:q.x+l.layout.padding,y:q.y+l.layout.padding},e.data)}for(var p in c){a=c[p];e=g[p].paddedRect;b=e.x+l.layout.padding;
var e=e.y+l.layout.padding,q=a.data.width,m=a.data.height;k.RGBAImage.copy(a.data,h,{x:0,y:0},{x:b,y:e},a.data);k.RGBAImage.copy(a.data,h,{x:0,y:m-1},{x:b,y:e-1},{width:q,height:1});k.RGBAImage.copy(a.data,h,{x:0,y:0},{x:b,y:e+m},{width:q,height:1});k.RGBAImage.copy(a.data,h,{x:q-1,y:0},{x:b-1,y:e},{width:1,height:m});k.RGBAImage.copy(a.data,h,{x:0,y:0},{x:b+q,y:e},{width:1,height:m})}this.image=h;this.iconPositions=d;this.patternPositions=g};d.prototype.addImages=function(a,d,f){for(var g in a){var h=
a[g],b={x:0,y:0,w:h.data.width+2*l.layout.padding,h:h.data.height+2*l.layout.padding};f.push(b);d[g]=new c(b,h);h.hasRenderCallback&&this.haveRenderCallbacks.push(g)}};d.prototype.patchUpdatedImages=function(a,c){a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(var d in a.updatedImages)this.patchUpdatedImage(this.iconPositions[d],a.getImage(d),c),this.patchUpdatedImage(this.patternPositions[d],a.getImage(d),c)};d.prototype.patchUpdatedImage=function(a,c,d){a&&c&&a.version!==c.version&&(a.version=
c.version,a=a.tl,d.update(c.data,void 0,{x:a[0],y:a[1]}))};return d})},"com/huayun/webgis/gl/SegmentVector":function(){define([],function(){var f=function(c){void 0===c&&(c=[]);this.segments=c};f.prototype.prepareSegment=function(c,k,l,d){var a=this.segments[this.segments.length-1];if(!a||a.vertexLength+c>f.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==d)a={vertexOffset:k.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},void 0!==d&&(a.sortKey=d),this.segments.push(a);return a};f.prototype.get=
function(){return this.segments};f.prototype.destroy=function(){for(var c=0,f=this.segments;c<f.length;c+=1){var l=f[c],d;for(d in l.vaos)l.vaos[d].destroy()}};f.simpleSegment=function(c,k,l,d){return new f([{vertexOffset:c,primitiveOffset:k,vertexLength:l,primitiveLength:d,vaos:{},sortKey:0}])};f.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;return f})},"com/huayun/webgis/gl/VertexArrayObject":function(){define([],function(){function f(){this.boundLayoutVertexBuffer=this.boundProgram=null;this.boundPaintVertexBuffers=
[];this.vao=this.boundDynamicVertexBuffer=this.boundVertexOffset=this.boundIndexBuffer=null}f.prototype.bind=function(c,f,l,d,a,m,n,g){this.context=c;for(var h=this.boundPaintVertexBuffers.length!==d.length,b=0;!h&&b<d.length;b++)this.boundPaintVertexBuffers[b]!==d[b]&&(h=!0);h=!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==l||h||this.boundIndexBuffer!==a||this.boundVertexOffset!==m||this.boundDynamicVertexBuffer!==n||this.boundDynamicVertexBuffer2!==g;!c.extVertexArrayObject||h?
this.freshBind(f,l,d,a,m,n,g):(c.bindVertexArrayOES.set(this.vao),n&&n.bind(),a&&a.dynamicDraw&&a.bind(),g&&g.bind())};f.prototype.freshBind=function(c,f,l,d,a,m,n){var g,h=c.numAttributes,b=this.context,e=b.gl;if(b.extVertexArrayObject)this.vao&&this.destroy(),this.vao=b.extVertexArrayObject.createVertexArrayOES(),b.bindVertexArrayOES.set(this.vao),g=0,this.boundProgram=c,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=d,this.boundVertexOffset=a,this.boundDynamicVertexBuffer=
m,this.boundDynamicVertexBuffer2=n;else{g=b.currentNumAttributes||0;for(var q=h;q<g;q++)e.disableVertexAttribArray(q)}f.enableAttributes(e,c);for(g=0;g<l.length;g+=1)l[g].enableAttributes(e,c);m&&m.enableAttributes(e,c);n&&n.enableAttributes(e,c);f.bind();f.setVertexAttribPointers(e,c,a);for(f=0;f<l.length;f+=1)g=l[f],g.bind(),g.setVertexAttribPointers(e,c,a);m&&(m.bind(),m.setVertexAttribPointers(e,c,a));d&&d.bind();n&&(n.bind(),n.setVertexAttribPointers(e,c,a));b.currentNumAttributes=h};f.prototype.destroy=
function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};return f})},"com/huayun/webgis/layers/support/style/styleUtils":function(){define("exports ../expression/Formatted ../expression/Var ../../../utils/utils ../../../utils/Color ../../../geometry/Point".split(" "),function(f,c,k,l,d,a){function m(a){if("array"===a.kind){var b=m(a.itemType);return"number"===typeof a.N?"array\x3c"+b+", "+a.N+"\x3e":"value"===a.itemType.kind?"array":"array\x3c"+b+"\x3e"}return a.kind}
function n(a,c){if("error"===c.kind)return null;if("array"===a.kind){if("array"===c.kind&&(0===c.N&&"value"===c.itemType.kind||!n(a.itemType,c.itemType))&&("number"!==typeof a.N||a.N===c.N))return null}else{if(a.kind===c.kind)return null;if("value"===a.kind)for(var e=0,d=b;e<d.length;e+=1)if(!n(d[e],c))return null}return"Expected "+m(a)+" but found "+m(c)+" instead."}function g(a){if(null===a)return{kind:"null"};if("string"===typeof a)return{kind:"string"};if("boolean"===typeof a)return{kind:"boolean"};
if("number"===typeof a)return{kind:"number"};if(Array.isArray(a)){for(var b=a.length,e,c=0;c<a.length;c+=1){var d=g(a[c]);if(e){if(e!==d){e={kind:"value"};break}}else e=d}return{kind:"array",itemType:e||{kind:"value"},N:b}}return{kind:"object"}}function h(a){if(null===a||"string"===typeof a||"boolean"===typeof a||"number"===typeof a)return!0;if(Array.isArray(a)){for(var b=0;b<a.length;b+=1)if(!h(a[b]))return!1;return!0}if("object"===typeof a){for(b in a)if(!h(a[b]))return!1;return!0}return!1}var b=
[{kind:"null"},{kind:"number"},{kind:"string"},{kind:"boolean"},{kind:"color"},{kind:"formatted"},{kind:"object"},{kind:"array",itemType:{kind:"value"},N:void 0}];f.supportsInterpolation=function(a){return!!a.expression&&a.expression.interpolated};f.findStopLessThanOrEqualTo=function(a,b){for(var e=a.length-1,c=0,d=e,g=0,h,f;c<=d;)if(g=Math.floor((c+d)/2),h=a[g],f=a[g+1],h<=b){if(g===e||b<f)return g;c=g+1}else if(h>b)d=g-1;else throw Error("Input is not a number.");return 0};f.interpolationFactor=
function(a,b,c,d){d-=c;a-=c;return 0===d?0:1===b?a/d:(Math.pow(b,a)-1)/(Math.pow(b,d)-1)};f.interpolate=Object.freeze({number:l.number,color:function(a,b,c){return new d(l.number(a.r,b.r,c),l.number(a.g,b.g,c),l.number(a.b,b.b,c),l.number(a.a,b.a,c))},array:function(a,b,c){return a.map(function(a,e){return l.number(a,b[e],c)})}});f.toString=m;f.checkSubtype=n;f.supportsPropertyExpression=function(a){return"data-driven"===a["property-type"]||"cross-faded-data-driven"===a["property-type"]};f.supportsZoomExpression=
function(a){return!!a.expression&&-1<a.expression.parameters.indexOf("zoom")};f.translate=function(b,c,d,g,h){if(!c[0]&&!c[1])return b;c=a.convert(c)._mult(h);"viewport"===d&&c._rotate(-g);d=[];for(g=0;g<b.length;g++)d.push(b[g].sub(c));return d};f.getMaximumPaintValue=function(a,b,c){var e=b.paint.get(a).value;return"constant"===e.kind?e.value:c.programConfigurations.get(b.id).binders[a].maxValue};f.typeOf=g;f.isValue=h;f.toString$1=function(a){var b=typeof a;return null===a?"":"string"===b||"number"===
b||"boolean"===b?String(a):a instanceof d||a instanceof c?a.toString():JSON.stringify(a)};f.array=function(a,b){return{kind:"array",itemType:a,N:b}};f.success=function(a){return{result:"success",value:a}};f.error=function(a){return{result:"error",value:a}};f.emitValidationErrors=function(a,b){a=!1;if(b&&b.length)for(var c=0;c<b.length;c+=1)a=!0;return a};f.translateDistance=function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}})},"com/huayun/webgis/views/3d/layers/TileLayerView3D":function(){define("./LayerView3D ../../../utils/utils ../../../utils/extendClazz ../../../gl/draw/drawRaster ../../../gl/mode ../../../data/ArrayType ../../../utils/Constant ../../../gl/members ../../../gl/SegmentVector".split(" "),
function(f,c,k,l,d,a,m,n,g){function h(b){f.call(this,b);this.visible=b.visible;this.id=b.id;this.layer=b.layer;this.view=b.view;this._tileTextures={};this._fadeDirty=this._sourcesDirty=!0;b=new a.StructArrayLayout3ui6;b.emplaceBack(0,1,2);b.emplaceBack(2,1,3);this.quadTriangleIndexBuffer=this.view.context.createIndexBuffer(b);b=m.layout.EXTENT;var c=new a.StructArrayLayout4i8;c.emplaceBack(0,0,0,0);c.emplaceBack(b,0,b,0);c.emplaceBack(0,b,0,b);c.emplaceBack(b,b,b,b);this.rasterBoundsBuffer=this.view.context.createVertexBuffer(c,
n.rasterBoundsAttributes.members);this.rasterBoundsSegments=g.simpleSegment(0,0,4,2)}k(h,f);h.prototype.refresh=function(){this._readyData();this.view.threeRender()};h.prototype._readyData=function(){if(this.visible){var a=this.layer.tileInfo,c=this.layer.maxLevel?Math.min(this.view.viewpoint.targetZoom||this.view.viewpoint.level,this.layer.maxLevel):this.view.viewpoint.targetZoom||this.view.viewpoint.level,d=this.view.viewpoint.center,g=a.getResolution(c),h=this.view._bound.map(function(b){return{x:a.getColForX(b.x,
g),y:a.getRowForY(b.y,g)}}),f=a.getColRange(g),l=a.getColForX(d[0],g),d=a.getRowForY(d[1],g);this.layer.sourceCache.updateTile(c,h,f,l,d);this._sourcesDirty=!0;this.zoomedBounds=h;this.range=f;this.cx=l;this.cy=d}};h.prototype._render=function(){if(this.visible&&this.zoomedBounds){this.view.currentLayer++;var a=this.layer.maxLevel?Math.min(this.view.viewpoint.level,this.layer.maxLevel):this.view.viewpoint.level;this._sourcesDirty&&(this.layer.sourceCache.update(a,this.zoomedBounds,this.range,this.cx,
this.cy),this._fadeDirty=this._sourcesDirty=!1);this.renderPass="translucent";a=this.layer.sourceCache.getVisibleCoordinates(!1,this.transform).slice().reverse();this.renderLayer(this,this.layer.sourceCache,null,a)}};h.prototype.renderLayer=function(a,c,d,g,h){g.length&&l(a,c,d,g)};h.prototype.setVisible=function(a){(this.visible=a)?this.refresh():this.view.threeRender()};h.prototype.zoom=function(){if(this.visible){this.transform=this.view.viewpoint;this.renderPass="translucent";var a=this.layer.sourceCache.updateTileMatrix(!1,
this.transform).slice().reverse();this.renderLayer(this,this.layer.sourceCache,null,a)}};h.prototype.depthModeForSublayer=function(a,c,g){a=1-((1+this.view.currentLayer)*this.view.numSublayers+a)*this.view.depthEpsilon;return new d.DepthMode(g||this.view.context.gl.LEQUAL,c,[a,a])};h.prototype.getTileTexture=function(a){return(a=this._tileTextures[a])&&0<a.length?a.pop():null};h.prototype.saveTileTexture=function(a){var b=this._tileTextures[a.size[0]];b?b.push(a):this._tileTextures[a.size[0]]=[a]};
return h})},"com/huayun/webgis/layers/support/TileSourceCache":function(){define("./RasterTileSource ./tileCover ./Tile ./funcUtils ./TileCache ./SourceFeatureState com/huayun/webgis/geometry/Point2D ../../utils/utils".split(" "),function(f,c,k,l,d,a,m,n){function g(a,c,g,f,l,k,m){this.id=a;this._source=new h[c.type](a,c,l,k,m);this._tiles={};this._cache=new d(0,this._unloadTile.bind(this));this._timers={};this._cacheTimers={};this._maxTileCacheSize=null;this._coveredTiles={};this.layer=k;this.view=
k.layerView.view;this.updateCacheSize(g,f)}var h={raster:f};g.prototype.updateTileSize=function(a){this._source.setSize(a)};g.prototype.onRemove=function(a){if(this._source&&this._source.onRemove)this._source.onRemove(a)};g.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var a in this._tiles){var c=this._tiles[a];if("loaded"!==c.state&&"errored"!==c.state)return!1}return!0};g.prototype.getSource=function(){return this._source};g.prototype.pause=function(){this._paused=
!0};g.prototype.resume=function(){if(this._paused){var a=this._shouldReloadOnResume;this._shouldReloadOnResume=this._paused=!1;a&&this.reload();this.transform&&this.update(this.transform)}};g.prototype._loadTile=function(a,c){return this._source.loadTile(a,c)};g.prototype._unloadTile=function(a){if(this._source.unloadTile)return this._source.unloadTile(a,function(){})};g.prototype._abortTile=function(a){if(this._source.abortTile)return this._source.abortTile(a,function(){})};g.prototype.serialize=
function(){return this._source.serialize()};g.prototype.getIds=function(){var a=[],c;for(c in this._tiles)a.push(this._tiles[c].tileID);return a};g.prototype.getRenderableIds=function(){var a=[],c;for(c in this._tiles)this._isIdRenderable(c)&&a.push(c);return a.sort(n.compareKeyZoom)};g.prototype.hasRenderableParent=function(a){return(a=this.findLoadedParent(a,0))?this._isIdRenderable(a.tileID.key):!1};g.prototype._isIdRenderable=function(a){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&
!this._tiles[a].holdingForFade()};g.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(var a in this._tiles)"errored"!==this._tiles[a].state&&this._reloadTile(a,"reloading")}};g.prototype._reloadTile=function(a,c){var b=this._tiles[a];b&&("loading"!==b.state&&(b.state=c),this._loadTile(b,this._tileLoaded.bind(this,b,a,c)))};g.prototype.updateTileUrl=function(a){this._source.updateTileUrl(a)};g.prototype._tileLoaded=function(a,c,d,g){g?(a.state="errored",
404===g.status&&this.update(this.transform)):(a.timeAdded=n.now(),this._setTileReloadTimer(c,a),this.layer.layerView._sourcesDirty=!0,this.view.threeRender())};g.prototype.getTile=function(a){return this.getTileByID(a.key)};g.prototype.getTileByID=function(a){return this._tiles[a]};g.prototype.getZoom=function(a){return a.level+a.scaleZoom(a.tileSize/this._source.tileSize)};g.prototype._retainLoadedChildren=function(a,c,d,g){for(var b in this._tiles){var e=this._tiles[b];if(!(g[b]||!e.hasData()||
e.tileID.overscaledZ<=c||e.tileID.overscaledZ>d)){for(var h=e.tileID;e&&e.tileID.overscaledZ>c+1;){var f=e.tileID.scaledTo(e.tileID.overscaledZ-1);(e=this._tiles[f.key])&&e.hasData()&&(h=f)}for(e=h;e.overscaledZ>c;)if(e=e.scaledTo(e.overscaledZ-1),a[e.key]){g[h.key]=h;break}}}};g.prototype.findLoadedParent=function(a,c){for(var b=a.overscaledZ-1;b>=c;b--){var e=a.scaledTo(b);if(!e)break;var d=this._tiles[String(e.key)];if(d&&d.hasData())return d;if(this._cache.has(e))return this._cache.get(e)}};g.prototype.updateCacheSize=
function(a,c){a=Math.floor((Math.ceil(a/this._source.tileSize)+1)*(Math.ceil(c/this._source.tileSize)+1)*3);this._cache.setMaxSize("number"===typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,a):a)};g.prototype.update=function(a,e,d,g,h){this._coveredTiles={};e=c(a,e,d);e=e.sort(function(a,b){a=a.canonical;b=b.canonical;return Math.sqrt((g-a.x)*(g-a.x)+(h-a.y)*(h-a.y))-Math.sqrt((g-b.x)*(g-b.x)+(h-b.y)*(h-b.y))});a=this._updateRetainedTiles(e,a);for(var b in a)this._tiles[b].clearFadeHold();
b=0;for(a=n.keysDifference(this._tiles,a);b<a.length;b+=1)this._removeTile(a[b])};g.prototype.updateTile=function(a,e,d,g,h){this._coveredTiles={};e=c(a,e,d);e=e.sort(function(a,b){a=a.canonical;b=b.canonical;return Math.sqrt((g-a.x)*(g-a.x)+(h-a.y)*(h-a.y))-Math.sqrt((g-b.x)*(g-b.x)+(h-b.y)*(h-b.y))});this._updateRetainedTiles(e,a);return e};g.prototype.releaseSymbolFadeTiles=function(){for(var a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(a)};g.prototype._updateRetainedTiles=
function(a,c){for(var b={},e={},d=Math.max(c-g.maxOverzooming,this._source.minzoom),h=Math.max(c+g.maxUnderzooming,this._source.minzoom),f={},l=0;l<a.length;l+=1){var k=a[l],m=this._addTile(k);b[k.key]=k;m.hasData()||c<this._source.maxzoom&&(f[k.key]=k)}this._retainLoadedChildren(f,c,h,b);for(h=0;h<a.length;h+=1)if(f=a[h],l=this._tiles[f.key],!l.hasData()){if(c+1>this._source.maxzoom){if(k=f.children(this._source.maxzoom)[0],(m=this.getTile(k))&&m.hasData()){b[k.key]=k;continue}}else if(k=f.children(this._source.maxzoom),
b[k[0].key]&&b[k[1].key]&&b[k[2].key]&&b[k[3].key])continue;k=l.wasRequested();for(m=f.overscaledZ-1;m>=d;--m){var n=f.scaledTo(m);if(e[n.key])break;e[n.key]=!0;l=this.getTile(n);!l&&k&&(l=this._addTile(n));if(l&&(b[n.key]=n,k=l.wasRequested(),l.hasData()))break}}return b};g.prototype._reAddTile=function(a){var b=new k(a,this._source.tileSize*a.overscaleFactor());this._loadTile(b,this._tileReAddLoaded.bind(this,b,a.key,b.state))};g.prototype._tileReAddLoaded=function(a,c,d,g){this._removeTile(c);
this._tiles[a.tileID.key]=a;g?(a.state="errored",404===g.status&&this.update(this.transform)):(a.timeAdded=n.now(),this._setTileReloadTimer(c,a),this.layer.layerView._sourcesDirty=!0,this.view.threeRender())};g.prototype._addTile=function(a){var b=this._tiles[a.key];if(b)return b;if(b=this._cache.getAndRemove(a))this._setTileReloadTimer(a.key,b),b.tileID=a,this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,b));b||(b=new k(a,
this._source.tileSize*a.overscaleFactor()),this._loadTile(b,this._tileLoaded.bind(this,b,a.key,b.state)));if(!b)return null;b.uses++;return this._tiles[a.key]=b};g.prototype._setTileReloadTimer=function(a,c){var b=this;a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);(c=c.getExpiryTimeout())&&(this._timers[a]=setTimeout(function(){b._reloadTile(a,"expired");delete b._timers[a]},c))};g.prototype._removeTile=function(a){var b=this._tiles[a];b&&(b.uses--,delete this._tiles[a],
this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),0<b.uses||b.hasData()||(b.aborted=!0,this._abortTile(b),this._unloadTile(b)))};g.prototype.clearTiles=function(){this._paused=this._shouldReloadOnResume=!1;for(var a in this._tiles)this._removeTile(a);this._cache.reset()};g.prototype.clearOtherLevel=function(a){this._paused=this._shouldReloadOnResume=!1;for(var b in this._tiles)this._tiles[b].tileID.canonical.z!==a&&this._removeTile(b)};g.prototype.tilesIn=function(a,c,d){var b=
this,e=[],g=this.transform;if(!g)return e;d=d?g.getCameraQueryGeometry(a):a;var h=a.map(function(a){return g.pointCoordinate(a)}),f=d.map(function(a){return g.pointCoordinate(a)}),l=this.getIds(),k=Infinity,q=Infinity,m=-Infinity,n=-Infinity;for(a=0;a<f.length;a+=1)d=f[a],k=Math.min(k,d.x),q=Math.min(q,d.y),m=Math.max(m,d.x),n=Math.max(n,d.y);a=function(a){a=b._tiles[l[a]];if(!a.holdingForFade()){var d=a.tileID,p=Math.pow(2,g.level-a.tileID.overscaledZ),A=c*a.queryPadding*__chunk_1.EXTENT/a.tileSize/
p,t=[d.getTilePoint(new __chunk_1.MercatorCoordinate(k,q)),d.getTilePoint(new __chunk_1.MercatorCoordinate(m,n))];t[0].x-A<__chunk_1.EXTENT&&t[0].y-A<__chunk_1.EXTENT&&0<=t[1].x+A&&0<=t[1].y+A&&(A=h.map(function(a){return d.getTilePoint(a)}),t=f.map(function(a){return d.getTilePoint(a)}),e.push({tile:a,tileID:d,queryGeometry:A,cameraQueryGeometry:t,scale:p}))}};for(d=0;d<l.length;d++)a(d);return e};g.prototype.getVisibleCoordinates=function(a,c){var b=this;a=this.getRenderableIds().map(function(a){return b._tiles[a].tileID});
this.currentCoords=[];for(var d=0;d<a.length;d+=1){var e=a[d],g=e.toUnwrapped();e.geometry||(e.geometry=this.layer.tileInfo.getGeometry(g));e.posMatrix=c.calculatePosMatrix(g,e.geometry,!0);this.currentCoords.push(e)}return a};g.prototype.updateTileMatrix=function(a,c){a=this.currentCoords;for(var b=0;b<a.length;b+=1){var d=a[b];d.posMatrix=c.updatePosMatrix(d.toUnwrapped(),d.geometry,!0)}return a};g.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;for(var a in this._tiles){var c=
this._tiles[a];if(void 0!==c.fadeEndTime&&c.fadeEndTime>=n.now())return!0}return!1};g.maxOverzooming=10;g.maxUnderzooming=3;return g})},"com/huayun/webgis/layers/support/Tile":function(){define(["com/huayun/webgis/data/bucket/SymbolBucket","com/huayun/webgis/gl/Texture","../../utils/utils","./EvaluationParameters","com/huayun/webgis/data/GeoJSONFeature"],function(f,c,k,l,d){function a(a){var b={};a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,
function(a,c,d,g){a=d||g;b[c]=a?a.toLowerCase():!0;return""});b["max-age"]&&(a=parseInt(b["max-age"],10),isNaN(a)?delete b["max-age"]:b["max-age"]=a);return b}function m(a,b){for(var c={},d=0;d<a.length;d+=1){var g=a[d],h=g.layerIds.map(function(a){return b[a]}).filter(Boolean);if(0===h.length)return;g.layers=h;g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(function(a){return h.filter(function(b){return b.id===a})[0]}));for(var f=0,l=h;f<l.length;f+=1)c[l[f].id]=g}return c}
var n=1,g=function(a,b){this.tileID=a;this.uid=n++;this.uses=0;this.tileSize=256;this.buckets={};this.expirationTime=null;this.queryPadding=0;this.hasSymbolBuckets=!1;this.expiredRequestCount=0;this.state="loading"};g.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state};g.prototype.setExpiryData=function(c){var b=this.expirationTime;c.cacheControl&&(c=a(c.cacheControl),c["max-age"]&&(this.expirationTime=Date.now()+1E3*c["max-age"]));if(this.expirationTime){c=
Date.now();var d=!1;this.expirationTime>c?d=!1:b?this.expirationTime<b?d=!0:(b=this.expirationTime-b)?this.expirationTime=c+Math.max(b,3E4):d=!0:d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}};g.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1E3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)};g.prototype.registerFadeDuration=function(a){a+=this.timeAdded;
a<k.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)};g.prototype.loadVectorData=function(a,b,c){this.hasData()&&this.unloadVectorData();this.state="loaded";if(a){a.featureIndex&&(this.latestFeatureIndex=a.featureIndex,a.rawTileData?(this.latestRawTileData=a.rawTileData,this.latestFeatureIndex.rawTileData=a.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData));this.collisionBoxArray=a.collisionBoxArray;this.buckets=m(a.buckets,b._layers);
this.hasSymbolBuckets=!1;for(var d in this.buckets){var e=this.buckets[d];if(e instanceof f)if(this.hasSymbolBuckets=!0,c)e.justReloaded=!0;else break}this.queryPadding=0;for(var g in this.buckets)this.queryPadding=Math.max(this.queryPadding,b._layers[g].queryRadius(this.buckets[g]));a.imageAtlas&&(this.imageAtlas=a.imageAtlas);a.glyphAtlasImage&&(this.glyphAtlasImage=a.glyphAtlasImage)}else this.collisionBoxArray=new CollisionBoxArray};g.prototype.unloadVectorData=function(){for(var a in this.buckets)this.buckets[a].destroy();
this.buckets={};this.imageAtlasTexture&&this.imageAtlasTexture.destroy();this.imageAtlas&&(this.imageAtlas=null);this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy();this.latestFeatureIndex=null;this.state="unloaded"};g.prototype.getBucket=function(a){return this.buckets[a.id]};g.prototype.upload=function(a){for(var b in this.buckets){var d=this.buckets[b];d.uploadPending()&&d.upload(a)}b=a.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c(a,this.imageAtlas.image,b.RGBA),
this.imageAtlas.uploaded=!0);this.glyphAtlasImage&&(this.glyphAtlasTexture=new c(a,this.glyphAtlasImage,b.ALPHA),this.glyphAtlasImage=null)};g.prototype.prepare=function(a){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(a,this.imageAtlasTexture)};g.prototype.queryRenderedFeatures=function(a,b,c,d,g,f,l,k,m){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:c,cameraQueryGeometry:d,scale:g,tileSize:this.tileSize,pixelPosMatrix:m,transform:l,
params:f,queryPadding:this.queryPadding*k},a,b):{}};g.prototype.querySourceFeatures=function(a,b){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var c=this.latestFeatureIndex.loadVTLayers(),g=b?b.sourceLayer:"";if(c=c._geojsonTileLayer||c[g]){b=createFilter(b&&b.filter);for(var h=this.tileID.canonical,g=h.z,f=h.x,h=h.y,k={z:g,x:f,y:h},m=0;m<c.length;m++){var n=c.feature(m);b(new l(this.tileID.overscaledZ),n)&&(n=new d(n,g,f,h),n.tile=k,a.push(n))}}}};g.prototype.clearMask=function(){this.segments&&
(this.segments.destroy(),delete this.segments);this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer);this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)};g.prototype.setMask=function(a,b){if(!deepEqual(this.mask,a)&&(this.mask=a,this.clearMask(),!deepEqual(a,{0:!0}))){var c=new StructArrayLayout4i8,d=new StructArrayLayout3ui6;this.segments=new SegmentVector;this.segments.prepareSegment(0,c,d);for(var g=Object.keys(a),h=0;h<
g.length;h++){var f=a[+g[h]],l=EXTENT>>f.z,f=new pointGeometry(f.x*l,f.y*l),k=new pointGeometry(f.x+l,f.y+l),l=this.segments.prepareSegment(4,c,d);c.emplaceBack(f.x,f.y,f.x,f.y);c.emplaceBack(k.x,f.y,k.x,f.y);c.emplaceBack(f.x,k.y,f.x,k.y);c.emplaceBack(k.x,k.y,k.x,k.y);f=l.vertexLength;d.emplaceBack(f,f+1,f+2);d.emplaceBack(f+1,f+2,f+3);l.vertexLength+=4;l.primitiveLength+=2}this.maskedBoundsBuffer=b.createVertexBuffer(c,rasterBoundsAttributes.members);this.maskedIndexBuffer=b.createIndexBuffer(d)}};
g.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state};g.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length};g.prototype.setFeatureState=function(a,b){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(a).length){var c=this.latestFeatureIndex.loadVTLayers(),d;for(d in this.buckets){var g=this.buckets[d],h=g.layers[0].sourceLayer||"_geojsonTileLayer",
f=c[h],h=a[h];f&&h&&0!==Object.keys(h).length&&(g.update(h,f,this.imageAtlas&&this.imageAtlas.patternPositions||{}),b&&b.style&&(this.queryPadding=Math.max(this.queryPadding,b.style.getLayer(d).queryRadius(g))))}}};g.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil};g.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<k.now()};g.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0};g.prototype.setHoldDuration=
function(a){this.symbolFadeHoldUntil=exported.now()+a};return g})},"com/huayun/webgis/symbols/support/glyphManager":function(){define("require exports dojo/request ../../gl/TinySDF ../../utils/image ../../data/Pbf".split(" "),function(f,c,k,l,d,a){function m(a,b,c){1===a?b.id=c.readVarint():2===a?b.bitmap=c.readBytes():3===a?b.width=c.readVarint():4===a?b.height=c.readVarint():5===a?b.left=c.readSVarint():6===a?b.top=c.readSVarint():7===a&&(b.advance=c.readVarint())}function n(a,b,c){if(3===a){a=
c.readMessage(m,{});c=a.width;var e=a.height,g=a.left,h=a.top,f=a.advance;b.push({id:a.id,bitmap:new d.AlphaImage({width:c+6,height:e+6},a.bitmap),metrics:{width:c,height:e,left:g,top:h,advance:f}})}}function g(a,b,c){1===a&&c.readMessage(n,b)}function h(b,c,d){c*=256;var e=c+255;b="font/{fontstack}/{range}.pbf".replace("{fontstack}",b).replace("{range}",c+"-"+e);k(f.toUrl(b),{handleAs:"arraybuffer"}).then(function(b){var c={},e=0;for(b=(new a(b)).readFields(g,[]);e<b.length;e+=1){var h=b[e];c[h.id]=
h}d(null,c)}).catch(function(a){d(a)})}var b={};c.getGlyphs=function(a){var c={},e;for(e in a){c[e]={};for(var g=0,h=a[e];g<h.length;g++){var f=h[g],k=b[e];k||(k=b[e]={glyphs:{}});var m=k.glyphs[f];if(!m){var m=k,n=e,k=f,x;var A=n,w=A.split(" ");x=1===w.length?{fontWeight:"400",fontFamily:A}:2===w.length?{fontWeight:w[0],fontFamily:w[1]}:void 0;A=x.fontFamily;w=m.tinySDF;w||(w=x.fontWeight,/bold/i.test(n)?w="900":/medium/i.test(n)?w="500":/light/i.test(n)&&(w="200"),w=m.tinySDF=new l(24,1,8,.25,A,
w));m=String.fromCharCode(k);m=255>k?{id:k,bitmap:new d.AlphaImage({width:26,height:26},w.draw(m)),metrics:{width:24,height:24,left:0,top:-8,advance:w.measureText(m).width}}:{id:k,bitmap:new d.AlphaImage({width:26,height:26},w.draw(m)),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}c[e][f]=m}}return c};c.getGlyphsFromPbf=function(a,c){for(var d in a)for(var e=0,g=a[d];e<g.length;e++){var f=g[e],l=b[d];l||(l=b[d]={glyphs:{},requests:{}});var k=l.glyphs[f];if(k)c(null,{stack:d,id:f,glyph:k});
else{var m=Math.floor(f/256),q=l.requests[m];q||(q=l.requests[m]=[],h(d,m,function(a,b){if(b)for(var c in b)l.glyphs[+c]=b[+c];c=0;for(var d=q;c<d.length;c+=1)(0,d[c])(a,b);delete l.requests[m]}));q.push(function(a,b){a?c(a):b&&c(null,{stack:d,id:f,glyph:b[f]||null})})}}}})},"com/huayun/webgis/utils/Constant":function(){define(["exports"],function(f){f.ONE_EM=24;f.MAX_GLYPHS=65535;f.glConstant={ALWAYS:519,LEQUAL:515,BACK:1029,CCW:2305,ZERO:0,ONE:1,ONE_MINUS_SRC_ALPHA:771,SRC_ALPHA:770,KEEP:7680};
f.viewTypes={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};f.AttributeType={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};f.types={string:{kind:"string"},number:{kind:"number"},boolean:{kind:"boolean"},object:{kind:"object"}};f.geometryTypes=["Unknown","Point","LineString","Polygon"];f.layout={EXTENT:8192,border:3,EXTRUDE_SCALE:63,LINE_DISTANCE_BUFFER_BITS:15,
LINE_DISTANCE_SCALE:.5,MAX_LINE_DISTANCE:Math.pow(2,14)/.5,SHARP_CORNER_OFFSET:15,COS_HALF_SHARP_CORNER:Math.cos(Math.PI/180*37.5),EARCUT_MAX_RINGS:500,padding:1};f.collisionBoxLayout=[{name:"a_pos",components:2,type:"Int16",offset:0},{name:"a_anchor_pos",components:2,type:"Int16",offset:4},{name:"a_extrude",components:2,type:"Int16",offset:8}];f.collisionCircleLayout=[{name:"a_pos",components:2,type:"Int16",offset:0},{name:"a_anchor_pos",components:2,type:"Int16",offset:4},{name:"a_extrude",components:2,
type:"Int16",offset:8}];f.whitespace={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0};f.verticalizedCharacterMap={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","\x26":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","\x3c":"\ufe3f","\x3d":"\uff1d","\x3e":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e",
"\u00a2":"\uffe0","\u00a3":"\uffe1","\u00a5":"\uffe5","\u00a6":"\uffe4","\u00ac":"\uffe2","\u00af":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39",
"\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};f.unicodeBlockLookup={"Latin-1 Supplement":function(c){return 128<=
c&&255>=c},Arabic:function(c){return 1536<=c&&1791>=c},"Arabic Supplement":function(c){return 1872<=c&&1919>=c},"Arabic Extended-A":function(c){return 2208<=c&&2303>=c},"Hangul Jamo":function(c){return 4352<=c&&4607>=c},"Unified Canadian Aboriginal Syllabics":function(c){return 5120<=c&&5759>=c},Khmer:function(c){return 6016<=c&&6143>=c},"Unified Canadian Aboriginal Syllabics Extended":function(c){return 6320<=c&&6399>=c},"General Punctuation":function(c){return 8192<=c&&8303>=c},"Letterlike Symbols":function(c){return 8448<=
c&&8527>=c},"Number Forms":function(c){return 8528<=c&&8591>=c},"Miscellaneous Technical":function(c){return 8960<=c&&9215>=c},"Control Pictures":function(c){return 9216<=c&&9279>=c},"Optical Character Recognition":function(c){return 9280<=c&&9311>=c},"Enclosed Alphanumerics":function(c){return 9312<=c&&9471>=c},"Geometric Shapes":function(c){return 9632<=c&&9727>=c},"Miscellaneous Symbols":function(c){return 9728<=c&&9983>=c},"Miscellaneous Symbols and Arrows":function(c){return 11008<=c&&11263>=
c},"CJK Radicals Supplement":function(c){return 11904<=c&&12031>=c},"Kangxi Radicals":function(c){return 12032<=c&&12255>=c},"Ideographic Description Characters":function(c){return 12272<=c&&12287>=c},"CJK Symbols and Punctuation":function(c){return 12288<=c&&12351>=c},Hiragana:function(c){return 12352<=c&&12447>=c},Katakana:function(c){return 12448<=c&&12543>=c},Bopomofo:function(c){return 12544<=c&&12591>=c},"Hangul Compatibility Jamo":function(c){return 12592<=c&&12687>=c},Kanbun:function(c){return 12688<=
c&&12703>=c},"Bopomofo Extended":function(c){return 12704<=c&&12735>=c},"CJK Strokes":function(c){return 12736<=c&&12783>=c},"Katakana Phonetic Extensions":function(c){return 12784<=c&&12799>=c},"Enclosed CJK Letters and Months":function(c){return 12800<=c&&13055>=c},"CJK Compatibility":function(c){return 13056<=c&&13311>=c},"CJK Unified Ideographs Extension A":function(c){return 13312<=c&&19903>=c},"Yijing Hexagram Symbols":function(c){return 19904<=c&&19967>=c},"CJK Unified Ideographs":function(c){return 19968<=
c&&40959>=c},"Yi Syllables":function(c){return 40960<=c&&42127>=c},"Yi Radicals":function(c){return 42128<=c&&42191>=c},"Hangul Jamo Extended-A":function(c){return 43360<=c&&43391>=c},"Hangul Syllables":function(c){return 44032<=c&&55215>=c},"Hangul Jamo Extended-B":function(c){return 55216<=c&&55295>=c},"Private Use Area":function(c){return 57344<=c&&63743>=c},"CJK Compatibility Ideographs":function(c){return 63744<=c&&64255>=c},"Arabic Presentation Forms-A":function(c){return 64336<=c&&65023>=c},
"Vertical Forms":function(c){return 65040<=c&&65055>=c},"CJK Compatibility Forms":function(c){return 65072<=c&&65103>=c},"Small Form Variants":function(c){return 65104<=c&&65135>=c},"Arabic Presentation Forms-B":function(c){return 65136<=c&&65279>=c},"Halfwidth and Fullwidth Forms":function(c){return 65280<=c&&65519>=c}}})},"com/huayun/webgis/geometry/Extent":function(){define(["./Geometry"],function(f){var c=function(c,d,a,k,n){f.call(this);this.spatialReference=n;this.xmin=c;this.ymin=d;this.xmax=
a;this.ymax=k};f&&(c.__proto__=f);c.prototype=Object.create(f&&f.prototype);c.prototype.constructor=c;var k={minx:{configurable:!0},miny:{configurable:!0},maxx:{configurable:!0},maxy:{configurable:!0},width:{configurable:!1},height:{configurable:!1},center:{configurable:!1}};k.minx.get=function(){return this.xmin};k.minx.set=function(c){this.xmin=c};k.miny.get=function(){return this.ymin};k.miny.set=function(c){this.ymin=c};k.maxx.get=function(){return this.xmax};k.maxx.set=function(c){this.xmax=
c};k.maxy.get=function(){return this.ymax};k.maxy.set=function(c){this.ymax=c};k.width.get=function(){return Math.abs(this.xmax-this.xmin)};k.height.get=function(){return Math.abs(this.ymax-this.ymin)};k.center.get=function(){return{x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),z:0,type:"point"}};c.prototype={getCenter:function(){return{x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),z:0,type:"point"}},getWidth:function(){return Math.abs(this.xmax-this.xmin)},getHeight:function(){return Math.abs(this.ymax-
this.ymin)},equals:function(c){return c?this.xmin===c.xmin&&this.ymin===c.ymin&&this.xmax===c.xmax&&this.ymax===c.ymax:!1}};Object.defineProperties(c.prototype,k);return c})},"com/huayun/webgis/utils/classifyRings":function(){define(["./utils","./quickselect"],function(f,c){function k(c,d){return d.area-c.area}return function(l,d){var a=l.length;if(1>=a)return[l];for(var m=[],n,g,h=0;h<a;h++){var b=f.calculateSignedArea(l[h]);0!==b&&(l[h].area=Math.abs(b),void 0===g&&(g=0>b),g===0>b?(n&&m.push(n),
n=[l[h]]):n.push(l[h]))}n&&m.push(n);if(1<d)for(l=0;l<m.length;l++)m[l].length<=d||(c(m[l],d,1,m[l].length-1,k),m[l]=m[l].slice(0,d));return m}})},"com/huayun/webgis/layers/support/expression/FormattedSection":function(){define([],function(){return function(f,c,k){this.text=f;this.scale=c;this.fontStack=k}})},"com/huayun/webgis/Feature":function(){define(["./utils/Color"],function(f){return function(c){this.attributes=void 0===c.attributes||null===c.attributes?{}:c.attributes;this.type=c.type;this.geometry=
c.geometry;this.attributes.hasOwnProperty("color")&&(c=this.attributes.color,c instanceof Array?this.attributes.color=c:(c=f.parse(c),this.attributes.color=[c.r,c.g,c.b,c.a]))}})},"com/huayun/webgis/layers/support/expression/Formatted":function(){define(["./FormattedSection"],function(f){var c=function(c){this.sections=c};c.fromString=function(k){return new c([new f(k,null,null)])};c.prototype.toString=function(){return this.sections.map(function(c){return c.text}).join("")};c.prototype.serialize=
function(){for(var c=["format"],f=0,d=this.sections;f<d.length;f+=1){var a=d[f];c.push(a.text);var m={};a.fontStack&&(m["text-font"]=["literal",a.fontStack.split(",")]);a.scale&&(m["font-scale"]=a.scale);c.push(m)}return c};return c})},"com/huayun/webgis/utils/quickselect":function(){define([],function(){function f(c,d){return c<d?-1:c>d?1:0}function c(c,d,a){var f=c[d];c[d]=c[a];c[a]=f}function k(f,d,a,m,n){for(;m>a;){if(600<m-a){var g=m-a+1,h=d-a+1,b=Math.log(g),e=.5*Math.exp(2*b/3),b=.5*Math.sqrt(b*
e*(g-e)/g)*(0>h-g/2?-1:1);k(f,d,Math.max(a,Math.floor(d-h*e/g+b)),Math.min(m,Math.floor(d+(g-h)*e/g+b)),n)}g=f[d];h=a;e=m;c(f,a,d);for(0<n(f[m],g)&&c(f,a,m);h<e;){c(f,h,e);h++;for(e--;0>n(f[h],g);)h++;for(;0<n(f[e],g);)e--}0===n(f[a],g)?c(f,a,e):(e++,c(f,e,m));e<=d&&(a=e+1);d<=e&&(m=e-1)}}return function(c,d,a,m,n){k(c,d,a||0,m||c.length-1,n||f)}})},"com/huayun/webgis/gl/programCache":function(){define(["exports","./ProgramSimplify","./VertexFragShader"],function(f,c,k){var l={};f.useProgramSimplify=
function(d,a,f){var m=a+"-"+d.id;l[m]||(l[m]=new c(d,k[a],f,k.programUniforms[a]));return l[m]}})},"com/huayun/webgis/gl/dataTransfer":function(){define("require exports ../layers/support/OverscaledTileID ../layers/support/CanonicalTileID ../layers/support/expression/Formatted ../utils/Color ../utils/image ./GridIndex ../data/ArrayType ./SegmentVector ../geometry/Anchor ./ImagePosition ./ImageAtlas".split(" "),function(f,c,k,l,d,a,m,n,g,h,b,e,q){function p(a,b,c){void 0===c&&(c={});Object.defineProperty(b,
"_classRegistryKey",{value:a,writeable:!1});z[a]={klass:b,omit:c.omit||[],shallow:c.shallow||[]}}function t(a,b){if(null===a||void 0===a||"boolean"===typeof a||"number"===typeof a||"string"===typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(a instanceof ArrayBuffer)return b&&b.push(a),a;if(ArrayBuffer.isView(a))return b&&b.push(a.buffer),a;if(a instanceof ImageData)return b&&b.push(a.data.buffer),a;if(Array.isArray(a)){for(var c=
[],d=0;d<a.length;d+=1)c.push(t(a[d],b));return c}if("object"===typeof a){var e=a.constructor,c=e._classRegistryKey;if(!c)throw Error("can't serialize object of unregistered class");d=e.serialize?e.serialize(a,b):{};if(!e.serialize){for(var g in a)!a.hasOwnProperty(g)||0<=z[c].omit.indexOf(g)||(e=a[g],d[g]=0<=z[c].shallow.indexOf(g)?e:t(e,b));a instanceof Error&&(d.message=a.message)}if(d.$name)throw Error("$name property is reserved for worker serialization logic.");"Object"!==c&&(d.$name=c);return d}throw Error("can't serialize object of type "+
typeof a);}function v(a){if(null===a||void 0===a||"boolean"===typeof a||"number"===typeof a||"string"===typeof a||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof ArrayBuffer||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(v);if("object"===typeof a){var b=a.$name||"Object",c=z[b].klass;if(!c)throw Error("can't deserialize unregistered class "+b);if(c.deserialize)return c.deserialize(a);for(var c=
Object.create(c.prototype),d=0,e=Object.keys(a);d<e.length;d+=1){var g=e[d];if("$name"!==g){var h=a[g];c[g]=0<=z[b].shallow.indexOf(g)?h:v(h)}}return c}throw Error("can't deserialize object of type "+typeof a);}var z={};c.register=p;p("Object",Object);p("StructArrayLayout2i4",g.StructArrayLayout2i4);p("StructArrayLayout3ui6",g.StructArrayLayout3ui6);p("StructArrayLayout2ui4",g.StructArrayLayout2ui4);p("StructArrayLayout2i4ub8",g.StructArrayLayout2i4ub8);p("StructArrayLayout4i4ui16",g.StructArrayLayout4i4ui16);
p("StructArrayLayout3f12",g.StructArrayLayout3f12);p("StructArrayLayout1ul4",g.StructArrayLayout1ul4);p("StructArrayLayout2i2i2i12",g.StructArrayLayout2i2i2i12);p("StructArrayLayout2ub2f12",g.StructArrayLayout2ub2f12);p("GlyphOffsetArray",g.GlyphOffsetArray);p("SymbolInstanceArray",g.SymbolInstanceArray);p("SymbolLineVertexArray",g.SymbolLineVertexArray);p("StructArrayLayout2f8",g.StructArrayLayout2f8);p("PlacedSymbolArray",g.PlacedSymbolArray);p("StructArrayLayout2i4i12",g.StructArrayLayout2i4i12);
p("StructArrayLayout1f4",g.StructArrayLayout1f4);p("StructArrayLayout3i6",g.StructArrayLayout3i6);p("SegmentVector",h);p("CollisionBoxArray",g.CollisionBoxArray);p("Grid",n);p("FeatureIndexArray",g.FeatureIndexArray);p("CanonicalTileID",l);p("OverscaledTileID",k,{omit:["posMatrix"]});p("Anchor",b);p("ImagePosition",e);p("ImageAtlas",q);p("Color",a);p("AlphaImage",m.AlphaImage);p("RGBAImage",m.RGBAImage);p("Error",Error);c.serialize=t;c.deserialize=v})},"com/huayun/webgis/data/queryIntersects":function(){define(["exports",
"../utils/utils","custom/gl-matrix-min"],function(f,c,k){function l(a,c){for(var b=!1,d=0,e=a.length-1;d<a.length;e=d++){var g=a[d],e=a[e];g.y>c.y!==e.y>c.y&&c.x<(e.x-g.x)*(c.y-g.y)/(e.y-g.y)+g.x&&(b=!b)}return b}function d(a,d){if(0===a.length||0===d.length)return!1;for(var b=0;b<a.length-1;b++)for(var e=a[b],g=a[b+1],h=0;h<d.length-1;h++){var f=e,l=g,k=d[h],m=d[h+1];if(c.isCounterClockwise(f,k,m)!==c.isCounterClockwise(l,k,m)&&c.isCounterClockwise(f,l,k)!==c.isCounterClockwise(f,l,m))return!0}return!1}
function a(a,c,d){d*=d;if(1===c.length)return a.distSqr(c[0])<d;for(var b=1;b<c.length;b++){var e;e=a;var g=c[b-1],h=c[b],f=g.distSqr(h);0===f?e=e.distSqr(g):(f=((e.x-g.x)*(h.x-g.x)+(e.y-g.y)*(h.y-g.y))/f,e=0>f?e.distSqr(g):1<f?e.distSqr(h):e.distSqr(h.sub(g)._mult(f)._add(g)));if(e<d)return!0}return!1}function m(a,c){for(var b=!1,d,e,g,h=0;h<a.length;h++){d=a[h];var f=0;for(g=d.length-1;f<d.length;g=f++)e=d[f],g=d[g],e.y>c.y!==g.y>c.y&&c.x<(g.x-e.x)*(c.y-e.y)/(g.y-e.y)+e.x&&(b=!b)}return b}function n(a,
c){c=c.path;if(1===a.length)return m(c,a[0]);for(var b=0;b<c.length;b++)for(var e=c[b],g=0;g<e.length;g++)if(l(a,e[g]))return!0;for(b=0;b<a.length;b++)if(m(c,a[b]))return!0;for(b=0;b<c.length;b++)if(d(a,c[b]))return!0;return!1}function g(a,c){var b=k.mat4.identity([]);k.mat4.translate(b,b,[1,1,0]);k.mat4.scale(b,b,[.5*a.width,.5*a.height,1]);return k.mat4.multiply(b,b,c)}function h(a,d,h,f,l,k){f=g(k,h.uniforms.u_matrix);a=c.projectQueryGeometry(a,f);d=c.projectPoint(d,f);f=h.width/2;h=h.height/2;
if(n(a,{path:[[{x:d.x-f,y:d.y-h},{x:d.x+f,y:d.y-h},{x:d.x+f,y:d.y+h},{x:d.x-f,y:d.y+h}]]}))return!0}f.line=function(b,c,g,h){c=c.path;g=((g.uniforms.u_width||1)+4)*h/2;for(h=0;h<c.length;h++){var e=c[h];if(3<=b.length)for(var f=0;f<e.length;f++)if(l(b,e[f]))return!0;a:{var f=b,p=g;if(1<f.length){if(d(f,e)){f=!0;break a}for(var k=0;k<e.length;k++)if(a(e[k],f,p)){f=!0;break a}}for(k=0;k<f.length;k++)if(a(f[k],e,p)){f=!0;break a}f=!1}if(f)return!0}return!1};f.polygon=n;f.imageFill=n;f.circle=function(b,
d,h,f,m,n){d=d.center;var e=g(n,h.uniforms.u_matrix),p=h.strokeWidth,q=h.pitchWithMap;b=q?b:c.projectQueryGeometry(b,e);f=m+p*f;m=d;d=q?m:c.projectPoint(m,e);e=k.vec4.transformMat4([],[m.x,m.y,0,1],e);!h.scaleWithPitch&&q?f*=e[3]/n.cameraToCenterDistance:h.scaleWithPitch&&!q&&(f*=n.cameraToCenterDistance/e[3]);h=f;if(l(b,d)||a(d,b,h))return!0};f.point=function(b,d,h,f,m,n){var e=g(n,h.uniforms.u_matrix),p=h.strokeWidth||0;m=h.uniforms.radius;b=(f=h.pitchWithMap)?b:c.projectQueryGeometry(b,e);p=m+
p;m=f?d:c.projectPoint(d,e);d=k.vec4.transformMat4([],[d.x,d.y,0,1],e);!h.scaleWithPitch&&f?p*=d[3]/n.cameraToCenterDistance:h.scaleWithPitch&&!f&&(p*=n.cameraToCenterDistance/d[3]);h=p;if(l(b,m)||a(m,b,h))return!0};f.image=h;f.canvas=h;f.text=function(){return!1}})},"com/huayun/webgis/utils/utils":function(){define("exports custom/gl-matrix-min ./Constant ./Color ../layers/support/expression/Formatted ../data/ArrayType ../layers/support/UnitBezier ../geometry/Point".split(" "),function(f,c,k,l,d,
a,m,n){function g(a){return Array.isArray(a)?a.map(g):"object"===typeof a&&a?b(a,g):a}function h(a,b,c,d){var e=new m(a,b,c,d);return function(a){return e.solve(a)}}function b(a,b,c){var d={},e;for(e in a)d[e]=b.call(c||this,a[e],e,a);return d}function e(a,b){a=c.vec4.transformMat4([],[a.x,a.y,0,1],b);return new n(a[0]/a[3],a[1]/a[3])}function q(a,b){for(var c=!1,d=0,e=a.length-1;d<a.length;e=d++){var g=a[d],e=a[e];g.y>b.y!==e.y>b.y&&b.x<(e.x-g.x)*(b.y-g.y)/(e.y-g.y)+g.x&&(c=!c)}return c}function p(a,
b,c,d){if(!(c>=d)){for(var e=a[c+d>>1],g=c-1,h=d+1;;){do g++;while(a[g]<e);do h--;while(a[h]>e);if(g>=h)break;t(a,g,h);t(b,3*g,3*h);t(b,3*g+1,3*h+1);t(b,3*g+2,3*h+2)}p(a,b,c,h);p(a,b,h+1,d)}}function t(a,b,c){var d=a[b];a[b]=a[c];a[c]=d}function v(a,b){if(Array.isArray(a)){if(!Array.isArray(b)||a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(!v(a[c],b[c]))return!1;return!0}if("object"===typeof a&&null!==a&&null!==b){if("object"!==typeof b||Object.keys(a).length!==Object.keys(b).length)return!1;
for(c in a)if(!v(a[c],b[c]))return!1;return!0}return a===b}function z(b){return{"line-pattern":{source:a.StructArrayLayout8ui16,composite:a.StructArrayLayout8ui16},"fill-pattern":{source:a.StructArrayLayout8ui16,composite:a.StructArrayLayout8ui16},"fill-extrusion-pattern":{source:a.StructArrayLayout8ui16,composite:a.StructArrayLayout8ui16}}[b]}function y(a,b,c){return Math.min(c,Math.max(b,a))}function u(a,b){a=y(Math.floor(a),0,255);b=y(Math.floor(b),0,255);return 256*a+b}function r(a){return 746===
a||747===a?!0:4352>a?!1:k.unicodeBlockLookup["Bopomofo Extended"](a)||k.unicodeBlockLookup.Bopomofo(a)||k.unicodeBlockLookup["CJK Compatibility Forms"](a)&&!(65097<=a&&65103>=a)||k.unicodeBlockLookup["CJK Compatibility Ideographs"](a)||k.unicodeBlockLookup["CJK Compatibility"](a)||k.unicodeBlockLookup["CJK Radicals Supplement"](a)||k.unicodeBlockLookup["CJK Strokes"](a)||k.unicodeBlockLookup["CJK Symbols and Punctuation"](a)&&!(12296<=a&&12305>=a||12308<=a&&12319>=a)&&12336!==a||k.unicodeBlockLookup["CJK Unified Ideographs Extension A"](a)||
k.unicodeBlockLookup["CJK Unified Ideographs"](a)||k.unicodeBlockLookup["Enclosed CJK Letters and Months"](a)||k.unicodeBlockLookup["Hangul Compatibility Jamo"](a)||k.unicodeBlockLookup["Hangul Jamo Extended-A"](a)||k.unicodeBlockLookup["Hangul Jamo Extended-B"](a)||k.unicodeBlockLookup["Hangul Jamo"](a)||k.unicodeBlockLookup["Hangul Syllables"](a)||k.unicodeBlockLookup.Hiragana(a)||k.unicodeBlockLookup["Ideographic Description Characters"](a)||k.unicodeBlockLookup.Kanbun(a)||k.unicodeBlockLookup["Kangxi Radicals"](a)||
k.unicodeBlockLookup["Katakana Phonetic Extensions"](a)||k.unicodeBlockLookup.Katakana(a)&&12540!==a||k.unicodeBlockLookup["Halfwidth and Fullwidth Forms"](a)&&!(65288===a||65289===a||65293===a||65306<=a&&65310>=a||65339===a||65341===a||65343===a||65371<=a&&65503>=a||65507===a||65512<=a&&65519>=a)||k.unicodeBlockLookup["Small Form Variants"](a)&&!(65112<=a&&65118>=a||65123<=a&&65126>=a)||k.unicodeBlockLookup["Unified Canadian Aboriginal Syllabics"](a)||k.unicodeBlockLookup["Unified Canadian Aboriginal Syllabics Extended"](a)||
k.unicodeBlockLookup["Vertical Forms"](a)||k.unicodeBlockLookup["Yijing Hexagram Symbols"](a)||k.unicodeBlockLookup["Yi Syllables"](a)?!0:!!k.unicodeBlockLookup["Yi Radicals"](a)}var x=k.layout.EXTENT;f.now=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date);f.extend=Object.assign?Object.assign:function(a){for(var b=[],c=arguments.length-1;0<c--;)b[c]=arguments[c+1];for(c=0;c<b.length;c+=1){var d=b[c],e;for(e in d)a[e]=d[e]}return a};f.isFunction=
function(a){return"object"===typeof a&&null!==a&&!Array.isArray(a)};f.clone=g;f.asyncAll=function(a,b,c){if(!a.length)return c(null,[]);var d=a.length,e=Array(a.length),g=null;a.forEach(function(a,h){b(a,function(a,b){a&&(g=a);e[h]=b;0===--d&&c(g,e)})})};f.values=function(a){var b=[],c;for(c in a)b.push(a[c]);return b};f.isCounterClockwise=function(a,b,c){return(c.y-a.y)*(b.x-a.x)>(b.y-a.y)*(c.x-a.x)};f.number=function(a,b,c){return a*(1-c)+b*c};f.getType=function(a){return a instanceof Number?"number":
a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":null===a?"null":typeof a};f.coalesce=function(){for(var a=0;a<arguments.length;a++)if(void 0!==arguments[a])return arguments[a]};f.easeCubicInOut=function(a){if(0>=a)return 0;if(1<=a)return 1;var b=a*a,c=b*a;return 4*(.5>a?c:3*(a-b)+c-.75)};f.endsWith=function(a,b){return-1!==a.indexOf(b,a.length-b.length)};f.validateRGBA=function(a,b,c,d){return"number"===typeof a&&0<=a&&255>=a&&"number"===typeof b&&0<=b&&255>=b&&
"number"===typeof c&&0<=c&&255>=c?"undefined"===typeof d||"number"===typeof d&&0<=d&&1>=d?null:"Invalid rgba value ["+[a,b,c,d].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"===typeof d?[a,b,c,d]:[a,b,c]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."};f.bezier=h;f.topDownFeatureComparator=function(a,b){return b-a};f.loadGeometry=function(a){var b=x/a.extent;a=a.loadGeometry();for(var c=0;c<a.length;c++)for(var d=a[c],e=0;e<d.length;e++){var g=d[e];g.x=
Math.round(g.x*b);g.y=Math.round(g.y*b)}return a};f.arraysIntersect=function(a,b){for(var c=0;c<a.length;c++)if(0<=b.indexOf(a[c]))return!0;return!1};f.mapObject=b;f.calculateSignedArea=function(a){for(var b=0,c=0,d=a.length,e=d-1,g=void 0,h=void 0;c<d;e=c++)g=a[c],h=a[e],b+=(h.x-g.x)*(g.y+h.y);return b};f.keysDifference=function(a,b){var c=[],d;for(d in a)d in b||c.push(d);return c};f.projectPoint=e;f.projectQueryGeometry=function(a,b){return a.map(function(a){return e(a,b)})};f.bindAll=function(a,
b){a.forEach(function(a){b[a]&&(b[a]=b[a].bind(b))})};f.getPixelPosMatrix=function(a,b){var d=c.mat4.identity([]);c.mat4.translate(d,d,[1,1,0]);c.mat4.scale(d,d,[.5*a.width,.5*a.height,1]);return c.mat4.multiply(d,d,a.calculatePosMatrix(b.toUnwrapped()))};f.polygonIntersectsBufferedPoint=function(a,b,c){if(q(a,b))return!0;a:if(c*=c,1===a.length)a=b.distSqr(a[0])<c;else{for(var d=1;d<a.length;d++){var e;e=b;var g=a[d-1],h=a[d],f=g.distSqr(h);0===f?e=e.distSqr(g):(f=((e.x-g.x)*(h.x-g.x)+(e.y-g.y)*(h.y-
g.y))/f,e=0>f?e.distSqr(g):1<f?e.distSqr(h):e.distSqr(h.sub(g)._mult(f)._add(g)));if(e<c){a=!0;break a}}a=!1}return a?!0:!1};f.polygonContainsPoint=q;f.sortTilesIn=function(a,b){a=a.tileID;b=b.tileID;return a.overscaledZ-b.overscaledZ||a.canonical.y-b.canonical.y||a.wrap-b.wrap||a.canonical.x-b.canonical.x};f.ease=h(.25,.1,.25,1);f.isEntirelyOutside=function(a){return a.every(function(a){return 0>a.x})||a.every(function(a){return a.x>x})||a.every(function(a){return 0>a.y})||a.every(function(a){return a.y>
x})};f.isBoundaryEdge=function(a,b){return a.x===b.x&&(0>a.x||a.x>x)||a.y===b.y&&(0>a.y||a.y>x)};f.pick=function(a,b){for(var c={},d=0;d<b.length;d++){var e=b[d];e in a&&(c[e]=a[e])}return c};f.align=function(a,b){return Math.ceil(a/b)*b};f.sort=p;f.swap=t;f.deepEqual=v;f.supportsPropertyExpression=function(a){return"data-driven"===a["property-type"]||"cross-faded-data-driven"===a["property-type"]};f.supportsZoomExpression=function(a){return!!a.expression&&-1<a.expression.parameters.indexOf("zoom")};
f.supportsInterpolation=function(a){return!!a.expression&&a.expression.interpolated};f.findStopLessThanOrEqualTo=function(a,b){for(var c=a.length-1,d=0,e=c,g=0,h,f;d<=e;)if(g=Math.floor((d+e)/2),h=a[g],f=a[g+1],h<=b){if(g===c||b<f)return g;d=g+1}else if(h>b)e=g-1;else throw Error("Input is not a number.");return 0};f.pixelsToTileUnits=function(a,b,c){return k.layout.EXTENT/(a.tileSize*Math.pow(2,c-a.tileID.overscaledZ))*b};f.paintAttributeNames=function(a,b){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],
"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]}[a]||[a.replace(b+"-","").replace(/-/g,"_")]};f.getLayoutException=z;f.layoutType=
function(b,c,d){var e={color:{source:a.StructArrayLayout2f8,composite:a.StructArrayLayout4f16},number:{source:a.StructArrayLayout1f4,composite:a.StructArrayLayout2f8}};return(b=z(b))&&b[d]||e[c][d]};f.clamp=y;f.packUint8ToFloat=u;f.packColor=function(a){return[u(255*a.r,255*a.g),u(255*a.b,255*a.a)]};f.charHasUprightVerticalOrientation=r;f.allowsVerticalWritingMode=function(a){for(var b=0;b<a.length;b+=1)if(r(a[b].charCodeAt(0)))return!0;return!1};f.compareKeyZoom=function(a,b){return a%32-b%32||b-
a}})},"com/huayun/webgis/layers/support/RasterTileSource":function(){define(["../../facade/TileFacade","../../gl/Texture"],function(f,c){function k(c,d,a,f){this.id=c;this.type="raster";this.minzoom=d.minzoom;this.maxzoom=d.maxzoom;this.roundZoom=!0;this.scheme="xyz";this.tileSize=d.tileSize||256;this.url=a;this.layer=f}k.prototype.hasTile=function(c){};k.prototype.updateTileUrl=function(c){this.url=c};k.prototype.loadTile=function(k,d){var a=this,l=k.tileID.canonical.url([this.url]);k.request=f.loadTile(l,
function(f,g){delete k.request;if(k.aborted)k.state="unloaded",d(null);else if(f)k.state="errored",d(f);else if(g){f=a.layer.layerView.view.context;var h=f.gl;k.texture=a.layer.layerView.getTileTexture(g.width);k.texture?k.texture.update(g,{useMipmap:!0}):(k.texture=new c(f,g,h.RGBA,{useMipmap:!0}),k.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE,h.LINEAR_MIPMAP_NEAREST),f.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,f.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,f.extTextureFilterAnisotropicMax));
k.state="loaded";d(null)}})};k.prototype.abortTile=function(c,d){c.request&&(c.request.cancel(),delete c.request);d()};k.prototype.unloadTile=function(c,d){c.texture&&this.layer.layerView.saveTileTexture(c.texture);d()};k.prototype.hasTransition=function(){return!1};return k})},"com/huayun/webgis/data/GeoJSONFeature":function(){define([],function(){var f=function(c,f,d,a){this.type="GeoJSONFeature";this._vectorTileFeature=c;c._z=f;c._x=d;c._y=a;this.properties=c.properties;null!=c.id&&(this.id=c.id)},
c={geometry:{configurable:!0}};c.geometry.get=function(){void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry);return this._geometry};c.geometry.set=function(c){this._geometry=c};f.prototype.toJSON=function(){var c={geometry:this.geometry},f;for(f in this)"_geometry"!==f&&"_vectorTileFeature"!==f&&(c[f]=this[f]);return c};Object.defineProperties(f.prototype,c);return f})},"com/huayun/webgis/layers/support/ZoomHistory":function(){define([],
function(){var f=function(){this.first=!0};f.prototype.update=function(c,f){var k=Math.floor(c);if(this.first)return this.first=!1,this.lastIntegerZoom=k,this.lastIntegerZoomTime=0,this.lastZoom=c,this.lastFloorZoom=k,!0;this.lastFloorZoom>k?(this.lastIntegerZoom=k+1,this.lastIntegerZoomTime=f):this.lastFloorZoom<k&&(this.lastIntegerZoom=k,this.lastIntegerZoomTime=f);return c!==this.lastZoom?(this.lastZoom=c,this.lastFloorZoom=k,!0):!1};return f})},"com/huayun/webgis/gl/mode":function(){define(["exports",
"../utils/Color","../utils/Constant"],function(f,c,k){var l=function(a,c,d){this.func=a;this.mask=c;this.range=d};l.ReadOnly=!1;l.ReadWrite=!0;l.disabled=new l(k.glConstant.ALWAYS,l.ReadOnly,[0,1]);l.opaque=new l(k.glConstant.LEQUAL,l.ReadWrite,[0,1]);var d=function(a,c,d){this.enable=a;this.mode=c;this.frontFace=d};d.disabled=new d(!1,k.glConstant.BACK,k.glConstant.CCW);d.backCCW=new d(!0,k.glConstant.BACK,k.glConstant.CCW);var a=function(a,c,d){this.blendFunction=a;this.blendColor=c;this.mask=d};
a.Replace=[k.glConstant.ONE,k.glConstant.ZERO];a.disabled=new a(a.Replace,c.transparent,[!1,!1,!1,!1]);a.unblended=new a(a.Replace,c.transparent,[!0,!0,!0,!0]);a.alphaBlended=new a([k.glConstant.ONE,k.glConstant.ONE_MINUS_SRC_ALPHA],c.transparent,[!0,!0,!0,!0]);a.srcBlended=new a([k.glConstant.SRC_ALPHA,k.glConstant.ONE_MINUS_SRC_ALPHA],c.transparent,[!0,!0,!0,!0]);c=function(a,c,d,h,b,e){this.test=a;this.ref=c;this.mask=d;this.fail=h;this.depthFail=b;this.pass=e};c.disabled=new c({func:k.glConstant.ALWAYS,
mask:0},0,0,k.glConstant.KEEP,k.glConstant.KEEP,k.glConstant.KEEP);f.DepthMode=l;f.CullFaceMode=d;f.ColorMode=a;f.StencilMode=c})},"dojo/request":function(){define(["./request/default!"],function(f){return f})},"com/huayun/webgis/symbols/PointSymbol":function(){define(["./Symbol","../utils/Color"],function(f,c){var k=function(k){f.call(this,k);this.type="point";var d=c.parse(k.color||"#FF0000"),a=void 0===k.opacity?1:k.opacity,l=k.radius||5,n=c.parse(k.strokeColor||"#FFFFFF"),g=k.strokeWidth||0,h=
k.strokeOpacity||1;this.color=d;this.opacity=a;this.radius=l;this.strokeWidth=g;this.pitchWithMap=!!k.pitchWithMap;this.scaleWithPitch=!!k.scaleWithPitch;this.uniforms={color:[d.r,d.g,d.b,d.a],opacity:a,u_device_pixel_ratio:1,u_pitch_with_map:this.pitchWithMap,u_scale_with_map:this.scaleWithPitch,blur:0,radius:l,stroke_color:[n.r,n.g,n.b,n.a],stroke_width:g,stroke_opacity:h}};f&&(k.__proto__=f);k.prototype=Object.create(f&&f.prototype);return k.prototype.constructor=k})},"com/huayun/webgis/layers/support/TileInfo":function(){define(["dojo/_base/declare",
"../../geometry/MapPoint","./LOD","../../geometry/Extent"],function(f,c,k,l){return f("com.huayun.webgis.layers.support.TileInfo",[],{size:256,dpi:96,format:"PNG8",origin:null,lods:[],fullExtent:null,constructor:function(c){this.lods=c.lods;this.origin=c.origin;this.size=c.size?c.size:256;this.dpi=c.dpi?c.dpi:96;this.fullExtent=c.fullExtent;this.lods.forEach(function(a){0===a.level&&(this.baseResolution=a.resolution)}.bind(this))},toString:function(){return"size: "+this.size+" dpi: "+this.dpi},getResolution:function(c){return this.baseResolution/
Math.pow(2,c)},getLevel:function(c){return Math.log2(this.baseResolution/c)},findNestZoom:function(c){for(var a=this.lods,d=a.length,f=0,g=d-1;-1<g;g--)if(f=a[g].resolution/c,1.9>f&&.95<f)return{resolution:a[g].resolution,level:g};return{level:d-1,resolution:a[d-1].resolution}},getColForX:function(c,a){return(c-this.origin.x)/(a*this.size)},getRowForY:function(c,a){return(this.origin.y-c)/(a*this.size)},getColRange:function(c){return[Math.floor((this.origin.y-this.fullExtent.maxy)/(c*this.size)),
Math.ceil((this.origin.y-this.fullExtent.miny)/(c*this.size))]},getXForCol:function(c,a){return a*this.size*c+this.origin.x},getYForRow:function(c,a){return this.origin.y-a*this.size*c},getColForSceneX:function(c,a){return(c-this.origin.x/a)/this.size},getRowForSceneY:function(c,a){return(this.origin.y/a-c)/this.size},getSceneXForCol:function(c,a){return this.size*c+this.origin.x/a},getSceneYForRow:function(c,a){return this.origin.y/a-this.size*c},getSceneXForCol2:function(c,a,f){return(this.size*
a*c+this.origin.x)/f},getSceneYForRow2:function(c,a,f){return(this.origin.y-this.size*a*c)/f},getGeometry:function(c,a){c=c.canonical;var d=this.getResolution(a||c.z);a=this.getXForCol(c.x,d);c=this.getYForRow(c.y,d);return[a,c]},getSceneXForX:function(c,a){return c/this.getResolution(a)},getSceneYForY:function(c,a){return c/this.getResolution(a)},tileXYToRectangle:function(c,a,f){var d=this.getResolution(f);f=this.getXForCol(c,d);c=this.getXForCol(c+1,d);var g=this.getYForRow(a,d);a=this.getYForRow(a+
1,d);return{west:f,east:c,north:g,south:a}}})})},"com/huayun/webgis/gl/ImagePosition":function(){define([],function(){var f=function(c,f){var d=f.pixelRatio;f=f.version;this.paddedRect=c;this.pixelRatio=d;this.version=f},c={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};c.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]};c.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]};c.tlbr.get=
function(){return this.tl.concat(this.br)};c.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]};Object.defineProperties(f.prototype,c);return f})},"com/huayun/webgis/utils/extendClazz":function(){define([],function(){return function(f,c){c&&(f.__proto__=c);f.prototype=Object.create(c&&c.prototype);f.prototype.constructor=f}})},"com/huayun/webgis/gl/VertexFragShader":function(){define("exports ../data/uniform dojo/text!./shaders/rect.vertex.glsl dojo/text!./shaders/rect.fragment.glsl dojo/text!./shaders/terrain.vertex.glsl dojo/text!./shaders/terrain.fragment.glsl dojo/text!./shaders/height_map.vertex.glsl dojo/text!./shaders/height_map.fragment.glsl dojo/text!./shaders/tiffTerrain.vertex.glsl dojo/text!./shaders/tifTerrain.fragment.glsl dojo/text!./shaders/water.vertex.glsl dojo/text!./shaders/water.fragment.glsl dojo/text!./shaders/fill_extrusion.vertex.glsl dojo/text!./shaders/fill_extrusion.fragment.glsl dojo/text!./shaders/background.vertex.glsl dojo/text!./shaders/background.fragment.glsl dojo/text!./shaders/mesh.vertex.glsl dojo/text!./shaders/mesh.fragment.glsl dojo/text!./shaders/cylinder.vertex.glsl dojo/text!./shaders/cylinder.fragment.glsl dojo/text!./shaders/cone.vertex.glsl dojo/text!./shaders/cone.fragment.glsl dojo/text!./shaders/line.vertex.glsl dojo/text!./shaders/line.fragment.glsl".split(" "),
function(f,c,k,l,d,a,m,n,g,h,b,e,q,p,t,v,z,y,u,r,x,A,w,B){f.line={vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue \x3d int(packedValue);\n    int v0 \x3d packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\nvec4 unpack_mix_color(const vec4 packedColors, const float t) {\n    vec4 minColor \x3d decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor \x3d decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n#define scale 0.015873016\n\nattribute vec2 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_units_to_pixels;\nuniform lowp float u_device_pixel_ratio;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_linesofar;\n\n\n#ifndef HAS_UNIFORM_u_color\nuniform lowp float u_color_t;\nattribute highp vec4 a_color;\nvarying highp vec4 color;\n#else\nuniform highp vec4 u_color;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_blur\nuniform lowp float u_blur_t;\nattribute lowp vec2 a_blur;\nvarying lowp float blur;\n#else\nuniform lowp float u_blur;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_opacity\nuniform lowp float u_opacity_t;\nattribute lowp vec2 a_opacity;\nvarying lowp float opacity;\n#else\nuniform lowp float u_opacity;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_gapwidth\nuniform lowp float u_gapwidth_t;\nattribute mediump vec2 a_gapwidth;\n#else\nuniform mediump float u_gapwidth;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_offset\nuniform lowp float u_offset_t;\nattribute lowp vec2 a_offset;\n#else\nuniform lowp float u_offset;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_width\nuniform lowp float u_width_t;\nattribute mediump vec2 a_width;\n#else\nuniform mediump float u_width;\n#endif\n\n\nvoid main() {\n\n    #ifndef HAS_UNIFORM_u_color\n        color \x3d unpack_mix_color(a_color, u_color_t);\n    #else\n        highp vec4 color \x3d u_color;\n    #endif\n\n\n    #ifndef HAS_UNIFORM_u_blur\n        blur \x3d unpack_mix_vec2(a_blur, u_blur_t);\n    #else\n        lowp float blur \x3d u_blur;\n    #endif\n\n\n    #ifndef HAS_UNIFORM_u_opacity\n        opacity \x3d unpack_mix_vec2(a_opacity, u_opacity_t);\n    #else\n        lowp float opacity \x3d u_opacity;\n    #endif\n\n\n    #ifndef HAS_UNIFORM_u_gapwidth\n        mediump float gapwidth \x3d unpack_mix_vec2(a_gapwidth, u_gapwidth_t);\n    #else\n        mediump float gapwidth \x3d u_gapwidth;\n    #endif\n\n\n    #ifndef HAS_UNIFORM_u_offset\n        lowp float offset \x3d unpack_mix_vec2(a_offset, u_offset_t);\n    #else\n        lowp float offset \x3d u_offset;\n    #endif\n\n\n    #ifndef HAS_UNIFORM_u_width\n        mediump float width \x3d unpack_mix_vec2(a_width, u_width_t);\n    #else\n        mediump float width \x3d u_width;\n    #endif\n\n\n    // the distance over which the line edge fades out.\n    // Retina devices need a smaller distance to avoid aliasing.\n    float ANTIALIASING \x3d 1.0 / u_device_pixel_ratio / 2.0;\n\n    vec2 a_extrude \x3d a_data.xy - 128.0;\n    float a_direction \x3d mod(a_data.z, 4.0) - 1.0;\n\n    v_linesofar \x3d (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0;\n\n    vec2 pos \x3d floor(a_pos_normal * 0.5);\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    // We store these in the least significant bit of a_pos_normal\n    mediump vec2 normal \x3d a_pos_normal - 2.0 * pos;\n    normal.y \x3d normal.y * 2.0 - 1.0;\n    v_normal \x3d normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth \x3d gapwidth / 2.0;\n    float halfwidth \x3d width / 2.0;\n    offset \x3d -1.0 * offset;\n\n    float inset \x3d gapwidth + (gapwidth \x3e 0.0 ? ANTIALIASING : 0.0);\n    float outset \x3d gapwidth + halfwidth * (gapwidth \x3e 0.0 ? 2.0 : 1.0) + (halfwidth \x3d\x3d 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist \x3d outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction \x3d -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u \x3d 0.5 * a_direction;\n    mediump float t \x3d 1.0 - abs(u);\n    mediump vec2 offset2 \x3d offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude \x3d u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position \x3d u_matrix * vec4(pos + offset2 / u_ratio, 1.1, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective \x3d length(dist);\n    float extrude_length_with_perspective \x3d length(projected_extrude.xy / gl_Position.w * u_units_to_pixels);\n    v_gamma_scale \x3d extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 \x3d vec2(outset, inset);\n}",
fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nuniform lowp float u_device_pixel_ratio;\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n#ifndef HAS_UNIFORM_u_color\nvarying highp vec4 color;\n#else\nuniform highp vec4 u_color;\n#endif\n#ifndef HAS_UNIFORM_u_blur\nvarying lowp float blur;\n#else\nuniform lowp float u_blur;\n#endif\n#ifndef HAS_UNIFORM_u_opacity\nvarying lowp float opacity;\n#else\nuniform lowp float u_opacity;\n#endif\nvoid main() {\n    #ifdef HAS_UNIFORM_u_color\n        highp vec4 color \x3d u_color;\n    #endif\n    #ifdef HAS_UNIFORM_u_blur\n        lowp float blur \x3d u_blur;\n    #endif\n    #ifdef HAS_UNIFORM_u_opacity\n        lowp float opacity \x3d u_opacity;\n    #endif\n        float dist \x3d length(v_normal) * v_width2.s;\n        float blur2 \x3d (blur + 1.0 / u_device_pixel_ratio) * v_gamma_scale;\n        float alpha \x3d clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n        gl_FragColor \x3d color * (alpha * opacity);\n    #ifdef OVERDRAW_INSPECTOR\n        gl_FragColor \x3d vec4(1.0);\n    #endif\n}\n"};
var D=function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_ratio:new c.Uniform1f(a,b.u_ratio),u_units_to_pixels:new c.Uniform2f(a,b.u_units_to_pixels),u_color:new c.Uniform4f(a,b.u_color),u_blur:new c.Uniform1f(a,b.u_blur),u_opacity:new c.Uniform1f(a,b.u_opacity),u_gapwidth:new c.Uniform1f(a,b.u_gapwidth),u_offset:new c.Uniform1f(a,b.u_offset),u_width:new c.Uniform1f(a,b.u_width)}};f.clippingMask={vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nattribute vec2 a_pos;\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position \x3d u_matrix * vec4(a_pos, 0, 1);\n}",
fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\nvoid main() {\n    gl_FragColor \x3d vec4(1.0);\n}"};f.background={vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n\nattribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position \x3d u_matrix * vec4(a_pos, -1, 1);\n}",
fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main() {\n    gl_FragColor \x3d u_color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor \x3d vec4(1.0);\n#endif\n}"};f.fill={vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue \x3d int(packedValue);\n    int v0 \x3d packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\nvec4 unpack_mix_color(const vec4 packedColors, const float t) {\n    vec4 minColor \x3d decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor \x3d decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\nattribute vec2 a_pos;\nuniform mat4 u_matrix;\n#ifndef HAS_UNIFORM_u_color\nuniform lowp float u_color_t;\nattribute highp vec4 a_color;\nvarying highp vec4 color;\n#else\nuniform highp vec4 u_color;\n#endif\n\n#ifndef HAS_UNIFORM_u_opacity\nuniform lowp float u_opacity_t;\nattribute lowp vec2 a_opacity;\nvarying lowp float opacity;\n#else\nuniform lowp float u_opacity;\n#endif\n\nvoid main() {\n    #ifndef HAS_UNIFORM_u_color\n        color \x3d unpack_mix_color(a_color, u_color_t);\n    #else\n        highp vec4 color \x3d u_color;\n    #endif\n\n    #ifndef HAS_UNIFORM_u_opacity\n        opacity \x3d unpack_mix_vec2(a_opacity, u_opacity_t);\n    #else\n        lowp float opacity \x3d u_opacity;\n    #endif\n\n    gl_Position \x3d u_matrix * vec4(a_pos, 0, 1);\n}",
fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n#ifndef HAS_UNIFORM_u_color\nvarying highp vec4 color;\n#else\nuniform highp vec4 u_color;\n#endif\n\n#ifndef HAS_UNIFORM_u_opacity\nvarying lowp float opacity;\n#else\nuniform lowp float u_opacity;\n#endif\n\nvoid main() {\n    #ifdef HAS_UNIFORM_u_color\n        highp vec4 color \x3d u_color;\n    #endif\n\n    #ifdef HAS_UNIFORM_u_opacity\n        lowp float opacity \x3d u_opacity;\n    #endif\n\n    gl_FragColor \x3d color * opacity;\n    #ifdef OVERDRAW_INSPECTOR\n        gl_FragColor \x3d vec4(1.0);\n    #endif\n}"};
f.fillExtrusion={vertexSource:q,fragmentSource:p};f.lineSDF={vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue \x3d int(packedValue);\n    int v0 \x3d packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\nvec4 unpack_mix_color(const vec4 packedColors, const float t) {\n    vec4 minColor \x3d decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor \x3d decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\n\nattribute vec2 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform lowp float u_device_pixel_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#ifndef HAS_UNIFORM_u_color\nuniform lowp float u_color_t;\nattribute highp vec4 a_color;\nvarying highp vec4 color;\n#else\nuniform highp vec4 u_color;\n#endif\n\n#ifndef HAS_UNIFORM_u_blur\nuniform lowp float u_blur_t;\nattribute lowp vec2 a_blur;\nvarying lowp float blur;\n#else\nuniform lowp float u_blur;\n#endif\n\n#ifndef HAS_UNIFORM_u_opacity\nuniform lowp float u_opacity_t;\nattribute lowp vec2 a_opacity;\nvarying lowp float opacity;\n#else\nuniform lowp float u_opacity;\n#endif\n\n#ifndef HAS_UNIFORM_u_gapwidth\nuniform lowp float u_gapwidth_t;\nattribute mediump vec2 a_gapwidth;\n#else\nuniform mediump float u_gapwidth;\n#endif\n\n#ifndef HAS_UNIFORM_u_offset\nuniform lowp float u_offset_t;\nattribute lowp vec2 a_offset;\n#else\nuniform lowp float u_offset;\n#endif\n\n#ifndef HAS_UNIFORM_u_width\nuniform lowp float u_width_t;\nattribute mediump vec2 a_width;\nvarying mediump float width;\n#else\nuniform mediump float u_width;\n#endif\n\n#ifndef HAS_UNIFORM_u_floorwidth\nuniform lowp float u_floorwidth_t;\nattribute lowp vec2 a_floorwidth;\nvarying lowp float floorwidth;\n#else\nuniform lowp float u_floorwidth;\n#endif\n\nvoid main() {\n    #ifndef HAS_UNIFORM_u_color\n        color \x3d unpack_mix_color(a_color, u_color_t);\n    #else\n        highp vec4 color \x3d u_color;\n    #endif\n\n    #ifndef HAS_UNIFORM_u_blur\n        blur \x3d unpack_mix_vec2(a_blur, u_blur_t);\n    #else\n        lowp float blur \x3d u_blur;\n    #endif\n\n    #ifndef HAS_UNIFORM_u_opacity\n        opacity \x3d unpack_mix_vec2(a_opacity, u_opacity_t);\n    #else\n        lowp float opacity \x3d u_opacity;\n    #endif\n\n    #ifndef HAS_UNIFORM_u_gapwidth\n        mediump float gapwidth \x3d unpack_mix_vec2(a_gapwidth, u_gapwidth_t);\n    #else\n        mediump float gapwidth \x3d u_gapwidth;\n    #endif\n\n    #ifndef HAS_UNIFORM_u_offset\n        lowp float offset \x3d unpack_mix_vec2(a_offset, u_offset_t);\n    #else\n        lowp float offset \x3d u_offset;\n    #endif\n\n    #ifndef HAS_UNIFORM_u_width\n        width \x3d unpack_mix_vec2(a_width, u_width_t);\n    #else\n        mediump float width \x3d u_width;\n    #endif\n\n    #ifndef HAS_UNIFORM_u_floorwidth\n        floorwidth \x3d unpack_mix_vec2(a_floorwidth, u_floorwidth_t);\n    #else\n        lowp float floorwidth \x3d u_floorwidth;\n    #endif\n\n    float ANTIALIASING \x3d 1.0 / u_device_pixel_ratio / 2.0;\n    vec2 a_extrude \x3d a_data.xy - 128.0;\n    float a_direction \x3d mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar \x3d (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos \x3d floor(a_pos_normal * 0.5);\n\n    mediump vec2 normal \x3d a_pos_normal - 2.0 * pos;\n    normal.y \x3d normal.y * 2.0 - 1.0;\n    v_normal \x3d normal;\n\n    gapwidth \x3d gapwidth / 2.0;\n    float halfwidth \x3d width / 2.0;\n    offset \x3d -1.0 * offset;\n    float inset \x3d gapwidth + (gapwidth \x3e 0.0 ? ANTIALIASING : 0.0);\n    float outset \x3d gapwidth + halfwidth * (gapwidth \x3e 0.0 ? 2.0 : 1.0) + (halfwidth \x3d\x3d 0.0 ? 0.0 : ANTIALIASING);\n    mediump vec2 dist \x3doutset * a_extrude * scale;\n    mediump float u \x3d 0.5 * a_direction;\n    mediump float t \x3d 1.0 - abs(u);\n    mediump vec2 offset2 \x3d offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n    vec4 projected_extrude \x3d u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position \x3d u_matrix * vec4(pos + offset2 / u_ratio, 1.1, 1.0) + projected_extrude;\n    float extrude_length_without_perspective \x3d length(dist);\n    float extrude_length_with_perspective \x3d length(projected_extrude.xy / gl_Position.w * u_units_to_pixels);\n    v_gamma_scale \x3d extrude_length_without_perspective / extrude_length_with_perspective;\n    v_tex_a \x3d vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b \x3d vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n    v_width2 \x3d vec2(outset, inset);\n}",
fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nuniform lowp float u_device_pixel_ratio;\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#ifndef HAS_UNIFORM_u_color\nvarying highp vec4 color;\n#else\nuniform highp vec4 u_color;\n#endif\n\n#ifndef HAS_UNIFORM_u_blur\nvarying lowp float blur;\n#else\nuniform lowp float u_blur;\n#endif\n\n#ifndef HAS_UNIFORM_u_opacity\nvarying lowp float opacity;\n#else\nuniform lowp float u_opacity;\n#endif\n\n#ifndef HAS_UNIFORM_u_width\nvarying mediump float width;\n#else\nuniform mediump float u_width;\n#endif\n\n#ifndef HAS_UNIFORM_u_floorwidth\nvarying lowp float floorwidth;\n#else\nuniform lowp float u_floorwidth;\n#endif\n\nvoid main() {\n    #ifdef HAS_UNIFORM_u_color\n        highp vec4 color \x3d u_color;\n    #endif\n\n    #ifdef HAS_UNIFORM_u_blur\n        lowp float blur \x3d u_blur;\n    #endif\n\n    #ifdef HAS_UNIFORM_u_opacity\n        lowp float opacity \x3d u_opacity;\n    #endif\n\n    #ifdef HAS_UNIFORM_u_width\n        mediump float width \x3d u_width;\n    #endif\n\n    #ifdef HAS_UNIFORM_u_floorwidth\n        lowp float floorwidth \x3d u_floorwidth;\n    #endif\n    float dist \x3d length(v_normal) * v_width2.s;\n\n    float blur2 \x3d (blur + 1.0 / u_device_pixel_ratio) * v_gamma_scale;\n    float alpha \x3d clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n    float sdfdist_a \x3d texture2D(u_image, v_tex_a).a;\n    float sdfdist_b \x3d texture2D(u_image, v_tex_b).a;\n    float sdfdist \x3d mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *\x3d smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor \x3d color * (alpha * opacity);\n\n    #ifdef OVERDRAW_INSPECTOR\n        gl_FragColor \x3d vec4(1.0);\n    #endif\n}"};
f.symbolSDF={vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue \x3d int(packedValue);\n    int v0 \x3d packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\nvec2 unpack_opacity(const float packedOpacity) {\n    int intOpacity \x3d int(packedOpacity) / 2;\n    return vec2(float(intOpacity) / 127.0, mod(packedOpacity, 2.0));\n}\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\nvec4 unpack_mix_color(const vec4 packedColors, const float t) {\n    vec4 minColor \x3d decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor \x3d decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\nconst float PI \x3d 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; \nuniform highp float u_size; \nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_coord_matrix;\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform float u_fade_change;\nuniform vec2 u_texsize;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\n#ifndef HAS_UNIFORM_u_fill_color\nuniform lowp float u_fill_color_t;\nattribute highp vec4 a_fill_color;\nvarying highp vec4 fill_color;\n#else\nuniform highp vec4 u_fill_color;\n#endif\n\n#ifndef HAS_UNIFORM_u_halo_color\nuniform lowp float u_halo_color_t;\nattribute highp vec4 a_halo_color;\nvarying highp vec4 halo_color;\n#else\nuniform highp vec4 u_halo_color;\n#endif\n\n#ifndef HAS_UNIFORM_u_opacity\nuniform lowp float u_opacity_t;\nattribute lowp vec2 a_opacity;\nvarying lowp float opacity;\n#else\nuniform lowp float u_opacity;\n#endif\n\n#ifndef HAS_UNIFORM_u_halo_width\nuniform lowp float u_halo_width_t;\nattribute lowp vec2 a_halo_width;\nvarying lowp float halo_width;\n#else\nuniform lowp float u_halo_width;\n#endif\n\n#ifndef HAS_UNIFORM_u_halo_blur\nuniform lowp float u_halo_blur_t;\nattribute lowp vec2 a_halo_blur;\nvarying lowp float halo_blur;\n#else\nuniform lowp float u_halo_blur;\n#endif\n\nvoid main() { \n    #ifndef HAS_UNIFORM_u_fill_color\n        fill_color \x3d unpack_mix_color(a_fill_color, u_fill_color_t);\n    #else\n        highp vec4 fill_color \x3d u_fill_color;\n    #endif\n    \n        \n    #ifndef HAS_UNIFORM_u_halo_color\n        halo_color \x3d unpack_mix_color(a_halo_color, u_halo_color_t);\n    #else\n        highp vec4 halo_color \x3d u_halo_color;\n    #endif\n    \n        \n    #ifndef HAS_UNIFORM_u_opacity\n        opacity \x3d unpack_mix_vec2(a_opacity, u_opacity_t);\n    #else\n        lowp float opacity \x3d u_opacity;\n    #endif\n    \n        \n    #ifndef HAS_UNIFORM_u_halo_width\n        halo_width \x3d unpack_mix_vec2(a_halo_width, u_halo_width_t);\n    #else\n        lowp float halo_width \x3d u_halo_width;\n    #endif\n    \n        \n    #ifndef HAS_UNIFORM_u_halo_blur\n        halo_blur \x3d unpack_mix_vec2(a_halo_blur, u_halo_blur_t);\n    #else\n        lowp float halo_blur \x3d u_halo_blur;\n    #endif\n    vec2 a_pos \x3d a_pos_offset.xy;\n    vec2 a_offset \x3d a_pos_offset.zw;\n\n    vec2 a_tex \x3d a_data.xy;\n    vec2 a_size \x3d a_data.zw;\n\n    highp float segment_angle \x3d -a_projected_pos[2];\n    float size;\n    if (!u_is_size_zoom_constant \x26\x26 !u_is_size_feature_constant) {\n        size \x3d mix(a_size[0], a_size[1], u_size_t) / 256.0;\n    } else if (u_is_size_zoom_constant \x26\x26 !u_is_size_feature_constant) {\n        size \x3d a_size[0] / 256.0;\n    } else if (!u_is_size_zoom_constant \x26\x26 u_is_size_feature_constant) {\n        size \x3d u_size;\n    } else {\n        size \x3d u_size;\n    }\n    vec4 projectedPoint \x3d u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance \x3d projectedPoint.w;\n    highp float distance_ratio \x3d u_pitch_with_map ? camera_to_anchor_distance / u_camera_to_center_distance : u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio \x3d clamp( 0.5 + 0.5 * distance_ratio, 0.0, 4.0);\n    size *\x3d perspective_ratio;\n    float fontScale \x3d u_is_text ? size / 24.0 : size;\n    highp float symbol_rotation \x3d 0.0;\n    if (u_rotate_symbol) {\n        vec4 offsetProjectedPoint \x3d u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n        vec2 a \x3d projectedPoint.xy / projectedPoint.w;\n        vec2 b \x3d offsetProjectedPoint.xy / offsetProjectedPoint.w;\n        symbol_rotation \x3d atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n    highp float angle_sin \x3d sin(segment_angle + symbol_rotation);\n    highp float angle_cos \x3d cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix \x3d mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n    vec4 projected_pos \x3d u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position \x3d u_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n    float gamma_scale \x3d gl_Position.w;\n    vec2 tex \x3d a_tex / u_texsize;\n    vec2 fade_opacity \x3d unpack_opacity(a_fade_opacity);\n    float fade_change \x3d fade_opacity[1] \x3e 0.5 ? u_fade_change : -u_fade_change;\n    float interpolated_fade_opacity \x3d max(0.0, min(1.0, fade_opacity[0] + fade_change));\n    v_data0 \x3d vec2(tex.x, tex.y);\n    v_data1 \x3d vec3(gamma_scale, size, interpolated_fade_opacity);\n}",
fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n#define SDF_PX 8.0\nuniform bool u_is_halo;\nuniform sampler2D u_texture;\nuniform highp float u_gamma_scale;\nuniform lowp float u_device_pixel_ratio;\nuniform bool u_is_text;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\n#ifndef HAS_UNIFORM_u_fill_color\nvarying highp vec4 fill_color;\n#else\nuniform highp vec4 u_fill_color;\n#endif\n\n#ifndef HAS_UNIFORM_u_halo_color\nvarying highp vec4 halo_color;\n#else\nuniform highp vec4 u_halo_color;\n#endif\n\n#ifndef HAS_UNIFORM_u_opacity\nvarying lowp float opacity;\n#else\nuniform lowp float u_opacity;\n#endif\n\n#ifndef HAS_UNIFORM_u_halo_width\nvarying lowp float halo_width;\n#else\nuniform lowp float u_halo_width;\n#endif\n\n#ifndef HAS_UNIFORM_u_halo_blur\nvarying lowp float halo_blur;\n#else\nuniform lowp float u_halo_blur;\n#endif\nvoid main() {\n    #ifdef HAS_UNIFORM_u_fill_color\n        highp vec4 fill_color \x3d u_fill_color;\n    #endif\n    #ifdef HAS_UNIFORM_u_halo_color\n        highp vec4 halo_color \x3d u_halo_color;\n    #endif\n    #ifdef HAS_UNIFORM_u_opacity\n        lowp float opacity \x3d u_opacity;\n    #endif\n    #ifdef HAS_UNIFORM_u_halo_width\n        lowp float halo_width \x3d u_halo_width;\n    #endif\n    #ifdef HAS_UNIFORM_u_halo_blur\n        lowp float halo_blur \x3d u_halo_blur;\n    #endif\n\n    float EDGE_GAMMA \x3d 0.105 / u_device_pixel_ratio;\n    vec2 tex \x3d v_data0.xy;\n    float gamma_scale \x3d v_data1.x;\n    float size \x3d v_data1.y;\n    float fade_opacity \x3d v_data1[2];\n    float fontScale \x3d u_is_text ? size / 24.0 : size;\n    lowp vec4 color \x3d fill_color;\n    highp float gamma \x3d EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff \x3d (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color \x3d halo_color;\n        gamma \x3d (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff \x3d (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n    lowp float dist \x3d texture2D(u_texture, tex).a;\n    highp float gamma_scaled \x3d gamma * gamma_scale;\n    highp float alpha \x3d smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n    gl_FragColor \x3d color * (alpha * opacity * fade_opacity);\n    #ifdef OVERDRAW_INSPECTOR\n        gl_FragColor \x3d vec4(1.0);\n    #endif\n}"};
f.symbolIcon={vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nvec2 unpack_opacity(const float packedOpacity) {\n    int intOpacity \x3d int(packedOpacity) / 2;\n    return vec2(float(intOpacity) / 127.0, mod(packedOpacity, 2.0));\n}\n\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\nconst float PI \x3d 3.141592653589793;\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t;\nuniform highp float u_size;\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform float u_fade_change;\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\n#ifndef HAS_UNIFORM_u_opacity\nuniform lowp float u_opacity_t;\nattribute lowp vec2 a_opacity;\nvarying lowp float opacity;\n#else\nuniform lowp float u_opacity;\n#endif\n\nvoid main() {\n    \n    #ifndef HAS_UNIFORM_u_opacity\n        opacity \x3d unpack_mix_vec2(a_opacity, u_opacity_t);\n    #else\n        lowp float opacity \x3d u_opacity;\n    #endif\n\n    vec2 a_pos \x3d a_pos_offset.xy;\n    vec2 a_offset \x3d a_pos_offset.zw;\n\n    vec2 a_tex \x3d a_data.xy;\n    vec2 a_size \x3d a_data.zw;\n\n    highp float segment_angle \x3d -a_projected_pos[2];\n\n    float size;\n    if (!u_is_size_zoom_constant \x26\x26 !u_is_size_feature_constant) {\n        size \x3d mix(a_size[0], a_size[1], u_size_t) / 256.0;\n    } else if (u_is_size_zoom_constant \x26\x26 !u_is_size_feature_constant) {\n        size \x3d a_size[0] / 256.0;\n    } else if (!u_is_size_zoom_constant \x26\x26 u_is_size_feature_constant) {\n        size \x3d u_size;\n    } else {\n        size \x3d u_size;\n    }\n\n    vec4 projectedPoint \x3d u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance \x3d projectedPoint.w;\n    highp float distance_ratio \x3d u_pitch_with_map ? camera_to_anchor_distance / u_camera_to_center_distance : u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio \x3d clamp(0.5 + 0.5 * distance_ratio, 0.0, 4.0);\n\n    size *\x3d perspective_ratio;\n\n    float fontScale \x3d u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation \x3d 0.0;\n    if (u_rotate_symbol) {\n        vec4 offsetProjectedPoint \x3d u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n        vec2 a \x3d projectedPoint.xy / projectedPoint.w;\n        vec2 b \x3d offsetProjectedPoint.xy / offsetProjectedPoint.w;\n        symbol_rotation \x3d atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n    highp float angle_sin \x3d sin(segment_angle + symbol_rotation);\n    highp float angle_cos \x3d cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix \x3d mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n    vec4 projected_pos \x3d u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position \x3d u_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.99, 1.0);\n    v_tex \x3d a_tex / u_texsize;\n    vec2 fade_opacity \x3d unpack_opacity(a_fade_opacity);\n    float fade_change \x3d fade_opacity[1] \x3e 0.5 ? u_fade_change : -u_fade_change;\n    v_fade_opacity \x3d max(0.0, min(1.0, fade_opacity[0] + fade_change));\n}",
fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\nuniform sampler2D u_texture;\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\n#ifndef HAS_UNIFORM_u_opacity\nvarying lowp float opacity;\n#else\nuniform lowp float u_opacity;\n#endif\n\nvoid main() {\n    #ifdef HAS_UNIFORM_u_opacity\n        lowp float opacity \x3d u_opacity;\n    #endif\n    lowp float alpha \x3d opacity * v_fade_opacity;\n    gl_FragColor \x3d texture2D(u_texture, v_tex) * alpha;\n\n    #ifdef OVERDRAW_INSPECTOR\n        gl_FragColor \x3d vec4(1.0);\n    #endif\n}"};
f.heatmap={vertexSource:"#define HAS_UNIFORM_u_radius\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\nuniform mat4 u_matrix;\nuniform float u_extrude_scale;\nuniform float u_opacity;\nuniform float u_intensity;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_extrude;\n\n\n#ifndef HAS_UNIFORM_u_weight\nuniform lowp float u_weight_t;\nattribute highp vec2 a_weight;\nvarying highp float weight;\n#else\nuniform highp float u_weight;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_radius\nuniform lowp float u_radius_t;\nattribute mediump vec2 a_radius;\n#else\nuniform mediump float u_radius;\n#endif\n\n\nconst highp float ZERO \x3d 1.0 / 255.0 / 16.0;\n\n// #define GAUSS_COEF 0.3989422804014327\n#define GAUSS_COEF 1.0\n\nvoid main(void) {\n\n    #ifndef HAS_UNIFORM_u_weight\n    weight \x3d unpack_mix_vec2(a_weight, u_weight_t);\n    #else\n    highp float weight \x3d u_weight;\n    #endif\n\n\n    #ifndef HAS_UNIFORM_u_radius\n    mediump float radius \x3d unpack_mix_vec2(a_radius, u_radius_t);\n    #else\n    mediump float radius \x3d u_radius;\n    #endif\n\n\n    vec2 unscaled_extrude \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // S \x3d sqrt(-2.0 * log(ZERO / (weight * u_intensity * GAUSS_COEF))) / 3.0\n    float S \x3d sqrt(-2.0 * log(ZERO / weight / u_intensity / GAUSS_COEF)) / 3.0;\n\n    // Pass the varying in units of radius\n    v_extrude \x3d S * unscaled_extrude;\n\n    // Scale by radius and the zoom-based scale factor to produce actual\n    // mesh position\n    vec2 extrude \x3d v_extrude * radius * u_extrude_scale;\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec4 pos \x3d vec4(floor(a_pos * 0.5) + extrude, 0, 1);\n\n    gl_Position \x3d u_matrix * pos;\n}",
fragmentSource:"#define HAS_UNIFORM_u_radius\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nuniform highp float u_intensity;\n\nvarying vec2 v_extrude;\n\n\n#ifndef HAS_UNIFORM_u_weight\nvarying highp float weight;\n#else\nuniform highp float u_weight;\n#endif\n\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main() {\n\n    #ifdef HAS_UNIFORM_u_weight\n    highp float weight \x3d u_weight;\n    #endif\n\n\n    // Kernel density estimation with a Gaussian kernel of size 5x5\n    float d \x3d -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);\n    float val \x3d weight * u_intensity * GAUSS_COEF * exp(d);\n\n    gl_FragColor \x3d vec4(val, 1.0, 1.0, 1.0);\n\n    #ifdef OVERDRAW_INSPECTOR\n    gl_FragColor \x3d vec4(1.0);\n    #endif\n}"};
f.heatmapTexture={vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position \x3d u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x \x3d a_pos.x;\n    v_pos.y \x3d 1.0 - a_pos.y;\n}",fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nuniform sampler2D u_image;\nuniform sampler2D u_color_ramp;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    float t \x3d texture2D(u_image, v_pos).r;\n    vec4 color \x3d texture2D(u_color_ramp, vec2(t, 0.5));\n    gl_FragColor \x3d color * u_opacity;\n\n    #ifdef OVERDRAW_INSPECTOR\n    gl_FragColor \x3d vec4(0.0);\n    #endif\n}"};
f.raster={vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nuniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position \x3d u_matrix * vec4(a_pos, 0, 1);\n    v_pos0 \x3d (((a_texture_pos / 8192.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 \x3d (v_pos0 * u_scale_parent) + u_tl_parent;\n}",
fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nuniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n    vec4 color0 \x3d texture2D(u_image0, v_pos0);\n    vec4 color1 \x3d texture2D(u_image1, v_pos1);\n    if (color0.a \x3e 0.0) {\n        color0.rgb \x3d color0.rgb / color0.a;\n    }\n    if (color1.a \x3e 0.0) {\n        color1.rgb \x3d color1.rgb / color1.a;\n    }\n    vec4 color \x3d mix(color0, color1, u_fade_t);\n    color.a *\x3d u_opacity;\n    vec3 rgb \x3d color.rgb;\n\n    // spin\n    rgb \x3d vec3(\n    dot(rgb, u_spin_weights.xyz),\n    dot(rgb, u_spin_weights.zxy),\n    dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average \x3d (color.r + color.g + color.b) / 3.0;\n    rgb +\x3d (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb \x3d (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec \x3d vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec \x3d vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor \x3d vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n}"};
f.image={vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nuniform mat4 u_matrix;\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    // gl_Position \x3d u_matrix * vec4(a_pos, 0.0, 1.0);\n    gl_Position \x3d u_matrix * vec4(a_pos, 0.1, 1.0);\n    v_pos \x3d a_texture_pos/8192.0;\n}",fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nuniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    vec4 color \x3d texture2D(u_image, v_pos);\n    gl_FragColor \x3d color * u_opacity;\n}"};
f.circle={vertexSource:"uniform mat4 u_matrix;\n  uniform bool u_scale_with_map;\n  uniform bool u_pitch_with_map;\n  uniform vec2 u_extrude_scale;\n  uniform lowp float u_device_pixel_ratio;\n  uniform highp float u_camera_to_center_distance;\n  attribute vec2 a_pos;\n  attribute vec2 a_data;\n  varying vec3 v_data;\n  varying vec4 v_color;\n  uniform mediump float radius;\n  uniform mediump float stroke_width;\n  void main(void) {\n    vec2 extrude \x3d a_data;\n    vec2 circle_center \x3d a_pos;\n    if (u_pitch_with_map) {\n      vec2 corner_position \x3d circle_center;\n      if (u_scale_with_map) {\n        corner_position +\x3d extrude * (radius + stroke_width) * u_extrude_scale;\n      } else {\n        vec4 projected_center \x3d u_matrix * vec4(circle_center, 0, 1);\n        corner_position +\x3d extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n      }\n\n      gl_Position \x3d u_matrix * vec4(corner_position, 0, 1);\n    } else {\n      gl_Position \x3d u_matrix * vec4(circle_center, 0, 1);\n\n      if (u_scale_with_map) {\n        gl_Position.xy +\x3d extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n      } else {\n        gl_Position.xy +\x3d extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n      }\n    }\n    lowp float antialiasblur \x3d 1.0 / u_device_pixel_ratio / (radius + stroke_width);\n\n    v_data \x3d vec3(extrude.x, extrude.y, antialiasblur);\n  }",
fragmentSource:"precision mediump float;\n  varying vec3 v_data;\n  uniform highp vec4 color;\n  uniform mediump float radius;\n  uniform lowp float blur;\n  uniform lowp float opacity;\n  uniform highp vec4 stroke_color;\n  uniform mediump float stroke_width;\n  uniform lowp float stroke_opacity;\n\n  void main() {\n\n    vec2 extrude \x3d v_data.xy;\n    float extrude_length \x3d length(extrude);\n\n    lowp float antialiasblur \x3d v_data.z;\n    float antialiased_blur \x3d -max(blur, antialiasblur);\n\n    float opacity_t \x3d smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t \x3d stroke_width \x3c 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor \x3d opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n  }"};
f.circles={vertexSource:"#define HAS_UNIFORM_u_stroke_color\n#define HAS_UNIFORM_u_stroke_width\n#define HAS_UNIFORM_u_opacity\n#define HAS_UNIFORM_u_blur\n#define HAS_UNIFORM_u_stroke_opacity\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue \x3d int(packedValue);\n    int v0 \x3d packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n    unpack_float(encodedColor[0]) / 255.0,\n    unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\nvec4 unpack_mix_color(const vec4 packedColors, const float t) {\n    vec4 minColor \x3d decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor \x3d decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\nuniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform lowp float u_device_pixel_ratio;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\nvarying vec3 v_data;\n\n\n#ifndef HAS_UNIFORM_u_color\nuniform lowp float u_color_t;\nattribute highp vec4 a_color;\nvarying highp vec4 color;\n#else\nuniform highp vec4 u_color;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_radius\nuniform lowp float u_radius_t;\nattribute mediump vec2 a_radius;\nvarying mediump float radius;\n#else\nuniform mediump float u_radius;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_blur\nuniform lowp float u_blur_t;\nattribute lowp vec2 a_blur;\nvarying lowp float blur;\n#else\nuniform lowp float u_blur;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_opacity\nuniform lowp float u_opacity_t;\nattribute lowp vec2 a_opacity;\nvarying lowp float opacity;\n#else\nuniform lowp float u_opacity;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_stroke_color\nuniform lowp float u_stroke_color_t;\nattribute highp vec4 a_stroke_color;\nvarying highp vec4 stroke_color;\n#else\nuniform highp vec4 u_stroke_color;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_stroke_width\nuniform lowp float u_stroke_width_t;\nattribute mediump vec2 a_stroke_width;\nvarying mediump float stroke_width;\n#else\nuniform mediump float u_stroke_width;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_stroke_opacity\nuniform lowp float u_stroke_opacity_t;\nattribute lowp vec2 a_stroke_opacity;\nvarying lowp float stroke_opacity;\n#else\nuniform lowp float u_stroke_opacity;\n#endif\n\n\nvoid main(void) {\n\n    #ifndef HAS_UNIFORM_u_color\n    color \x3d unpack_mix_color(a_color, u_color_t);\n    #else\n    highp vec4 color \x3d u_color;\n    #endif\n\n\n    #ifndef HAS_UNIFORM_u_radius\n    radius \x3d unpack_mix_vec2(a_radius, u_radius_t);\n    #else\n    mediump float radius \x3d u_radius;\n    #endif\n\n\n    #ifndef HAS_UNIFORM_u_blur\n    blur \x3d unpack_mix_vec2(a_blur, u_blur_t);\n    #else\n    lowp float blur \x3d u_blur;\n    #endif\n\n\n    #ifndef HAS_UNIFORM_u_opacity\n    opacity \x3d unpack_mix_vec2(a_opacity, u_opacity_t);\n    #else\n    lowp float opacity \x3d u_opacity;\n    #endif\n\n\n    #ifndef HAS_UNIFORM_u_stroke_color\n    stroke_color \x3d unpack_mix_color(a_stroke_color, u_stroke_color_t);\n    #else\n    highp vec4 stroke_color \x3d u_stroke_color;\n    #endif\n\n\n    #ifndef HAS_UNIFORM_u_stroke_width\n    stroke_width \x3d unpack_mix_vec2(a_stroke_width, u_stroke_width_t);\n    #else\n    mediump float stroke_width \x3d u_stroke_width;\n    #endif\n\n\n    #ifndef HAS_UNIFORM_u_stroke_opacity\n    stroke_opacity \x3d unpack_mix_vec2(a_stroke_opacity, u_stroke_opacity_t);\n    #else\n    lowp float stroke_opacity \x3d u_stroke_opacity;\n    #endif\n\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center \x3d floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position \x3d circle_center;\n        if (u_scale_with_map) {\n            corner_position +\x3d extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center \x3d u_matrix * vec4(circle_center, 0, 1);\n            corner_position +\x3d extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position \x3d u_matrix * vec4(corner_position, 2, 1);\n    } else {\n        gl_Position \x3d u_matrix * vec4(circle_center, 2, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy +\x3d extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy +\x3d extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n        // This is a minimum blur distance that serves as a faux-antialiasing for\n        // the circle. since blur is a ratio of the circle's size and the intent is\n        // to keep the blur at roughly 1px, the two are inversely related.\n        lowp float antialiasblur \x3d 1.0 / u_device_pixel_ratio / (radius + stroke_width);\n\n    v_data \x3d vec3(extrude.x, extrude.y, antialiasblur);\n}",
fragmentSource:"#define HAS_UNIFORM_u_stroke_color\n#define HAS_UNIFORM_u_stroke_width\n#define HAS_UNIFORM_u_opacity\n#define HAS_UNIFORM_u_blur\n#define HAS_UNIFORM_u_stroke_opacity\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\nvarying vec3 v_data;\n\n\n#ifndef HAS_UNIFORM_u_color\nvarying highp vec4 color;\n#else\nuniform highp vec4 u_color;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_radius\nvarying mediump float radius;\n#else\nuniform mediump float u_radius;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_blur\nvarying lowp float blur;\n#else\nuniform lowp float u_blur;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_opacity\nvarying lowp float opacity;\n#else\nuniform lowp float u_opacity;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_stroke_color\nvarying highp vec4 stroke_color;\n#else\nuniform highp vec4 u_stroke_color;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_stroke_width\nvarying mediump float stroke_width;\n#else\nuniform mediump float u_stroke_width;\n#endif\n\n\n#ifndef HAS_UNIFORM_u_stroke_opacity\n#ifndef HAS_UNIFORM_u_stroke_opacity\nvarying lowp float stroke_opacity;\n#else\nuniform lowp float u_stroke_opacity;\n#endif\n\n\nvoid main() {\n\n    #ifdef HAS_UNIFORM_u_color\n    highp vec4 color \x3d u_color;\n    #endif\n\n\n    #ifdef HAS_UNIFORM_u_radius\n    mediump float radius \x3d u_radius;\n    #endif\n\n\n    #ifdef HAS_UNIFORM_u_blur\n    lowp float blur \x3d u_blur;\n    #endif\n\n\n    #ifdef HAS_UNIFORM_u_opacity\n    lowp float opacity \x3d u_opacity;\n    #endif\n\n\n    #ifdef HAS_UNIFORM_u_stroke_color\n    highp vec4 stroke_color \x3d u_stroke_color;\n    #endif\n\n\n    #ifdef HAS_UNIFORM_u_stroke_width\n    mediump float stroke_width \x3d u_stroke_width;\n    #endif\n\n\n    #ifdef HAS_UNIFORM_u_stroke_opacity\n    lowp float stroke_opacity \x3d u_stroke_opacity;\n    #endif\n\n\n    vec2 extrude \x3d v_data.xy;\n    float extrude_length \x3d length(extrude);\n\n    lowp float antialiasblur \x3d v_data.z;\n    float antialiased_blur \x3d -max(blur, antialiasblur);\n\n    float opacity_t \x3d smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t \x3d stroke_width \x3c 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor \x3d opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n}"};
f.basicLine={vertexSource:"precision highp float;\n\n    #define scale 0.01587301\n    // #define scale 0.007936508\n\n    attribute vec2 a_pos;\n    attribute vec4 a_data;\n    attribute vec2 a_normal;\n\n    uniform mat4 u_matrix;\n    uniform mediump float u_ratio;\n    uniform vec2 u_units_to_pixels;\n\n    varying vec2 v_normal;\n    varying vec2 v_width2;\n    varying float v_gamma_scale;\n    varying highp float v_linesofar;\n\n    uniform highp vec4 u_color;\n    uniform lowp float u_blur;\n    uniform lowp float u_opacity;\n    uniform mediump float u_gapwidth;\n    uniform lowp float u_offset;\n    uniform mediump float u_width;\n\n    void main() {\n        highp vec4 color \x3d u_color;\n        lowp float blur \x3d u_blur;\n        lowp float opacity \x3d u_opacity;\n        mediump float gapwidth \x3d u_gapwidth;\n        lowp float offset \x3d u_offset;\n        mediump float width \x3d u_width;\n\n        // the distance over which the line edge fades out.\n        // Retina devices need a smaller distance to avoid aliasing.\n        float ANTIALIASING \x3d 0.5;\n\n        vec2 a_extrude \x3d a_data.xy - 128.0;\n        float a_direction \x3d mod(a_data.z, 4.0) - 1.0;\n\n        v_linesofar \x3d (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0;\n\n        vec2 pos \x3d a_pos;\n\n        mediump vec2 normal \x3d a_normal;\n        normal.y \x3d normal.y * 2.0 - 1.0;\n        v_normal \x3d normal;\n\n        // these transformations used to be applied in the JS and native code bases.\n        // moved them into the shader for clarity and simplicity.\n        gapwidth \x3d gapwidth / 2.0;\n        float halfwidth \x3d width / 2.0;\n        offset \x3d -1.0 * offset;\n\n        float inset \x3d gapwidth + (gapwidth \x3e 0.0 ? ANTIALIASING : 0.0);\n        float outset \x3d gapwidth + halfwidth * (gapwidth \x3e 0.0 ? 2.0 : 1.0) + (halfwidth \x3d\x3d 0.0 ? 0.0 : ANTIALIASING);\n\n        // Scale the extrusion vector down to a normal and then up by the line width\n        // of this vertex.\n        mediump vec2 dist \x3d outset * a_extrude * scale;\n\n        // Calculate the offset when drawing a line that is to the side of the actual line.\n        // We do this by creating a vector that points towards the extrude, but rotate\n        // it when we're drawing round end points (a_direction \x3d -1 or 1) since their\n        // extrude vector points in another direction.\n        mediump float u \x3d 0.5 * a_direction;\n        mediump float t \x3d 1.0 - abs(u);\n        mediump vec2 offset2 \x3d offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n        vec4 projected_extrude \x3d u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n        gl_Position \x3d u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n        // calculate how much the perspective view squishes or stretches the extrude\n        float extrude_length_without_perspective \x3d length(dist);\n        float extrude_length_with_perspective \x3d length(projected_extrude.xy / gl_Position.w * u_units_to_pixels);\n        v_gamma_scale \x3d extrude_length_without_perspective / extrude_length_with_perspective;\n\n        v_width2 \x3d vec2(outset, inset);\n    }",
fragmentSource:"precision mediump float;\n\n    varying vec2 v_width2;\n    varying vec2 v_normal;\n    varying float v_gamma_scale;\n    uniform highp vec4 u_color;\n    uniform lowp float u_opacity;\n\n    void main() {\n\n\n        highp vec4 color \x3d u_color;\n        lowp float blur \x3d 0.0;\n        lowp float opacity \x3d u_opacity;\n        lowp float u_device_pixel_ratio \x3d 1.0;\n\n        float dist \x3d length(v_normal) * v_width2.s;\n\n        float blur2 \x3d (blur + 1.0 / u_device_pixel_ratio) * v_gamma_scale;\n        float alpha \x3d clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n        gl_FragColor \x3d color * (alpha * opacity);\n        // gl_FragColor \x3d vec4(0.0, 1.0, 0.0, 1.0);\n    }"};
f.basicFill={vertexSource:"attribute vec2 a_pos;\n    uniform mat4 u_matrix;\n    void main() {\n        gl_Position \x3d u_matrix * vec4(a_pos, 0.0, 1.0);\n    }",fragmentSource:"precision mediump float;\n    uniform highp vec4 u_color;\n    uniform lowp float u_opacity;\n    void main() {\n        gl_FragColor \x3d u_color * u_opacity;\n    }"};f.basicLineSDF={vertexSource:"#define scale 0.015873016\n  #define LINE_DISTANCE_SCALE 2.0\n  attribute vec2 a_pos;\n  attribute vec4 a_data;\n  attribute vec2 a_normal;\n\n  uniform mat4 u_matrix;\n  uniform mediump float u_ratio;\n  uniform vec2 u_patternscale_a;\n  uniform float u_tex_y_a;\n  uniform vec2 u_patternscale_b;\n  uniform float u_tex_y_b;\n  uniform vec2 u_units_to_pixels;\n\n  varying vec2 v_normal;\n  varying vec2 v_width2;\n  varying vec2 v_tex_a;\n  varying vec2 v_tex_b;\n  varying float v_gamma_scale;\n\n  uniform highp vec4 u_color;\n  uniform lowp float u_blur;\n  uniform lowp float u_opacity;\n  uniform mediump float u_gapwidth;\n  uniform lowp float u_offset;\n  uniform mediump float u_width;\n  uniform lowp float u_floorwidth;\n\n  void main() {\n    highp vec4 color \x3d u_color;\n    lowp float blur \x3d u_blur;\n    lowp float opacity \x3d u_opacity;\n    mediump float gapwidth \x3d u_gapwidth;\n    lowp float offset \x3d u_offset;\n    mediump float width \x3d u_width;\n    lowp float floorwidth \x3d u_floorwidth;\n\n    float ANTIALIASING \x3d 1.0 / 1.0 / 2.0;\n\n    vec2 a_extrude \x3d a_data.xy - 128.0;\n    float a_direction \x3d mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar \x3d (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos \x3d a_pos;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    // We store these in the least significant bit of position\n    mediump vec2 normal \x3d a_normal;\n    normal.y \x3d normal.y * 2.0 - 1.0;\n    v_normal \x3d normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth \x3d gapwidth / 2.0;\n    float halfwidth \x3d width / 2.0;\n    offset \x3d -1.0 * offset;\n\n    float inset \x3d gapwidth + (gapwidth \x3e 0.0 ? ANTIALIASING : 0.0);\n    float outset \x3d gapwidth + halfwidth * (gapwidth \x3e 0.0 ? 2.0 : 1.0) + (halfwidth \x3d\x3d 0.0 ? 0.0 : ANTIALIASING);\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist \x3doutset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction \x3d -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u \x3d 0.5 * a_direction;\n    mediump float t \x3d 1.0 - abs(u);\n    mediump vec2 offset2 \x3d offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude \x3d u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position \x3d u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective \x3d length(dist);\n    float extrude_length_with_perspective \x3d length(projected_extrude.xy / gl_Position.w * u_units_to_pixels);\n    v_gamma_scale \x3d extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a \x3d vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b \x3d vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 \x3d vec2(outset, inset);\n  }",
fragmentSource:"precision mediump float;\n\n  uniform sampler2D u_image;\n  uniform float u_sdfgamma;\n  uniform float u_mix;\n\n  varying vec2 v_normal;\n  varying vec2 v_width2;\n  varying vec2 v_tex_a;\n  varying vec2 v_tex_b;\n  varying float v_gamma_scale;\n\n  uniform highp vec4 u_color;\n  uniform lowp float u_blur;\n  uniform lowp float u_opacity;\n  uniform mediump float u_width;\n  uniform lowp float u_floorwidth;\n\n  void main() {\n\n    highp vec4 color \x3d u_color;\n    lowp float blur \x3d u_blur;\n    lowp float opacity \x3d u_opacity;\n    mediump float width \x3d u_width;\n    lowp float floorwidth \x3d u_floorwidth;\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist \x3d length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 \x3d (blur + 1.0 / 1.0) * v_gamma_scale;\n    float alpha \x3d clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a \x3d texture2D(u_image, v_tex_a).a;\n    float sdfdist_b \x3d texture2D(u_image, v_tex_b).a;\n    float sdfdist \x3d mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *\x3d smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor \x3d color * (alpha * opacity);\n\n    #ifdef OVERDRAW_INSPECTOR\n    gl_FragColor \x3d vec4(1.0);\n    #endif\n  }"};
f.basicSymbol={vertexSource:"const float PI \x3d 3.141592653589793;\n    attribute vec4 a_pos_offset;\n    attribute vec4 a_data;\n    attribute vec3 a_projected_pos;\n\n    uniform highp float u_size; // used when size is both zoom and feature constant\n    uniform mat4 u_matrix;\n    uniform mat4 u_label_plane_matrix;\n    uniform mat4 u_coord_matrix;\n    uniform bool u_is_text;\n    uniform bool u_pitch_with_map;\n    uniform highp float u_pitch;\n    uniform bool u_rotate_symbol;\n    uniform highp float u_aspect_ratio;\n    uniform highp float u_camera_to_center_distance;\n    uniform float u_fade_change;\n    uniform vec2 u_texsize;\n\n    varying vec2 v_data0;\n    varying vec3 v_data1;\n\n    uniform highp vec4 u_fill_color;\n    uniform highp vec4 u_halo_color;\n    uniform lowp float u_opacity;\n    uniform lowp float u_halo_width;\n    uniform lowp float u_halo_blur;\n\n    void main() {\n        highp vec4 fill_color \x3d u_fill_color;\n        highp vec4 halo_color \x3d u_halo_color;\n        lowp float opacity \x3d u_opacity;\n        lowp float halo_width \x3d u_halo_width;\n        lowp float halo_blur \x3d u_halo_blur;\n\n        vec2 a_pos \x3d a_pos_offset.xy;\n        vec2 a_offset \x3d a_pos_offset.zw;\n        vec2 a_tex \x3d a_data.xy;\n        vec2 a_size \x3d a_data.zw;\n        highp float segment_angle \x3d -a_projected_pos[2];\n        float size \x3d u_size;\n\n        vec4 projectedPoint \x3d u_matrix * vec4(a_pos, 0, 1);\n        highp float camera_to_anchor_distance \x3d projectedPoint.w;\n        highp float distance_ratio \x3d u_pitch_with_map ? camera_to_anchor_distance / u_camera_to_center_distance : u_camera_to_center_distance / camera_to_anchor_distance;\n        highp float perspective_ratio \x3d clamp(\n        0.5 + 0.5 * distance_ratio,\n        0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n        4.0);\n\n        size *\x3d perspective_ratio;\n        float fontScale \x3d u_is_text ? size / 24.0 : size;\n        highp float symbol_rotation \x3d 0.0;\n        if (u_rotate_symbol) {\n            vec4 offsetProjectedPoint \x3d u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n            vec2 a \x3d projectedPoint.xy / projectedPoint.w;\n            vec2 b \x3d offsetProjectedPoint.xy / offsetProjectedPoint.w;\n            symbol_rotation \x3d atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n        }\n\n        highp float angle_sin \x3d sin(segment_angle + symbol_rotation);\n        highp float angle_cos \x3d cos(segment_angle + symbol_rotation);\n        mat2 rotation_matrix \x3d mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n        vec4 projected_pos \x3d u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n        gl_Position \x3d u_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n        float gamma_scale \x3d gl_Position.w;\n\n        vec2 tex \x3d a_tex / u_texsize;\n        float interpolated_fade_opacity \x3d 1.0;\n\n        v_data0 \x3d vec2(tex.x, tex.y);\n        v_data1 \x3d vec3(gamma_scale, size, interpolated_fade_opacity);\n    }",
fragmentSource:"precision mediump float;\n\n    #define SDF_PX 8.0\n\n    uniform bool u_is_halo;\n    uniform sampler2D u_texture;\n    uniform highp float u_gamma_scale;\n    uniform lowp float u_device_pixel_ratio;\n    uniform bool u_is_text;\n\n    varying vec2 v_data0;\n    varying vec3 v_data1;\n\n    uniform highp vec4 u_fill_color;\n    uniform highp vec4 u_halo_color;\n    uniform lowp float u_opacity;\n    uniform lowp float u_halo_width;\n    uniform lowp float u_halo_blur;\n\n    void main() {\n        highp vec4 fill_color \x3d u_fill_color;\n        highp vec4 halo_color \x3d u_halo_color;\n        lowp float opacity \x3d u_opacity;\n        lowp float halo_width \x3d u_halo_width;\n        lowp float halo_blur \x3d u_halo_blur;\n\n        float EDGE_GAMMA \x3d 0.105 / u_device_pixel_ratio;\n\n        vec2 tex \x3d v_data0.xy;\n        float gamma_scale \x3d v_data1.x;\n        float size \x3d v_data1.y;\n        float fade_opacity \x3d v_data1[2];\n\n        float fontScale \x3d u_is_text ? size / 24.0 : size;\n\n        lowp vec4 color \x3d fill_color;\n        highp float gamma \x3d EDGE_GAMMA / (fontScale * u_gamma_scale);\n        lowp float buff \x3d (256.0 - 64.0) / 256.0;\n        if (u_is_halo) {\n            color \x3d halo_color;\n            gamma \x3d (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n            buff \x3d (6.0 - halo_width / fontScale) / SDF_PX;\n        }\n        lowp float dist \x3d texture2D(u_texture, tex).a;\n        highp float gamma_scaled \x3d gamma * gamma_scale;\n        highp float alpha \x3d smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n        gl_FragColor \x3d color * (alpha * opacity * fade_opacity);\n    }"};
f.multiPoints={vertexSource:" attribute vec2 a_pos;\n    uniform mat4 u_matrix;\n    void main() {\n        gl_Position \x3d u_matrix * vec4(a_pos.xy,0.0, 1.0);\n        gl_PointSize \x3d 30.0;\n    }",fragmentSource:"precision mediump float;\n    void main() {\n        gl_FragColor \x3d vec4(1.0, 0.0, 0.0, 1.0);\n    }"};f.images={vertexSource:"attribute vec2 a_pos;\n    attribute vec4 a_data;\n\n    uniform highp float u_size;\n    uniform highp float u_camera_to_center_distance;\n    uniform mat4 u_matrix;\n    uniform mat4 u_label_plane_matrix;\n    uniform mat4 u_coord_matrix;\n    uniform bool u_pitch_with_map;\n    uniform vec2 u_texsize;\n    uniform lowp float u_opacity;\n    uniform bool u_rotate_symbol;\n    uniform float u_radian;\n    uniform mat4 u_modelMatrix;\n\n    varying vec2 v_tex;\n    void main() {\n        lowp float opacity \x3d u_opacity;\n        vec2 a_offset \x3d a_data.xy;\n        vec2 a_tex \x3d a_data.zw;\n        float size \x3d u_size;\n        vec4 projectedPoint \x3d u_matrix * vec4(a_pos, 10.0, 1);\n        highp float camera_to_anchor_distance \x3d projectedPoint.w;\n\n        highp float distance_ratio \x3d u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance\n        :u_camera_to_center_distance / camera_to_anchor_distance;\n        highp float perspective_ratio \x3d clamp(0.5 + 0.5 * distance_ratio, 0.0, 4.0);\n        size *\x3d perspective_ratio;\n        float fontScale \x3d size;\n        highp float symbol_rotation \x3d 0.0;\n        if (u_rotate_symbol) {\n            symbol_rotation \x3d u_radian;\n        }\n    highp float angle_sin \x3d sin(symbol_rotation);\n    highp float angle_cos \x3d cos(symbol_rotation);\n    mat2 rotation_matrix \x3d mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n        vec4 projected_pos \x3d u_label_plane_matrix * vec4(a_pos, 0.0, 1.0);\n        vec4 glP \x3d u_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n        gl_Position \x3d u_modelMatrix * glP;\n        v_tex \x3d a_tex / u_texsize;\n    }",
fragmentSource:"precision mediump float;\n    uniform sampler2D u_texture;\n    varying vec2 v_tex;\n    uniform lowp float u_opacity;\n    void main() {\n        gl_FragColor \x3d texture2D(u_texture, v_tex) * u_opacity;\n    }"};f.text={vertexSource:"attribute vec2 a_pos;\n    attribute vec4 a_data;\n\n    uniform highp float u_size;\n    uniform mat4 u_matrix;\n    uniform mat4 u_label_plane_matrix;\n    uniform mat4 u_coord_matrix;\n    uniform bool u_pitch_with_map;\n    uniform highp float u_camera_to_center_distance;\n    uniform vec2 u_texsize;\n    varying vec2 v_data0;\n\n    uniform highp vec4 u_fill_color;\n    uniform lowp float u_opacity;\n    uniform bool u_rotate_symbol;\n    uniform float u_radian;\n\n    void main() {\n        highp vec4 fill_color \x3d u_fill_color;\n        lowp float opacity \x3d u_opacity;\n        vec2 a_offset \x3d a_data.xy;\n        vec2 a_tex \x3d a_data.zw;\n        float size \x3d u_size;\n\n        vec4 projectedPoint \x3d u_matrix * vec4(a_pos, 0, 1);\n        highp float camera_to_anchor_distance \x3d projectedPoint.w;\n        highp float distance_ratio \x3d u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n        highp float perspective_ratio \x3d clamp(\n        0.5 + 0.5 * distance_ratio,\n        0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n        4.0);\n        size *\x3d perspective_ratio;\n        float fontScale \x3d size / 24.0;\n        highp float symbol_rotation \x3d 0.0;\n        if (u_rotate_symbol) {\n            symbol_rotation \x3d u_radian;\n        }\n    highp float angle_sin \x3d sin(symbol_rotation);\n    highp float angle_cos \x3d cos(symbol_rotation);\n    mat2 rotation_matrix \x3d mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n        vec4 projected_pos \x3d u_label_plane_matrix * vec4(a_pos, 0.0, 1.0);\n        gl_Position \x3d u_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n        float gamma_scale \x3d gl_Position.w;\n\n        vec2 tex \x3d a_tex / u_texsize;\n        float interpolated_fade_opacity \x3d 1.0;\n\n        v_data0 \x3d vec2(tex.x, tex.y);\n    }",
fragmentSource:"precision mediump float;\n    #define SDF_PX 8.0\n    uniform sampler2D u_texture;\n    uniform highp float u_gamma_scale;\n\n    varying vec2 v_data0;\n\n    uniform highp vec4 u_fill_color;\n    uniform lowp float u_opacity;\n    uniform highp float u_size;\n    uniform highp vec4 u_halo_color;\n    uniform lowp float u_halo_width;\n    uniform lowp float u_halo_blur;\n    uniform bool u_is_halo;\n\n    void main() {\n        highp vec4 fill_color \x3d u_fill_color;\n        lowp float opacity \x3d u_opacity;\n\n        float EDGE_GAMMA \x3d 0.105;\n\n        vec2 tex \x3d v_data0.xy;\n        float gamma_scale \x3d 1.0;\n        float size \x3d u_size;\n        float fade_opacity \x3d 1.0;\n        float fontScale \x3d size / 24.0;\n\n        lowp vec4 color \x3d fill_color;\n        highp float gamma \x3d EDGE_GAMMA / (fontScale * u_gamma_scale);\n        lowp float buff \x3d (256.0 - 64.0) / 256.0;\n        if (u_is_halo) {\n            color \x3d u_halo_color;\n            gamma \x3d (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n            buff \x3d (6.0 - u_halo_width / fontScale) / SDF_PX;\n        }\n        lowp float dist \x3d texture2D(u_texture, tex).a;\n        highp float gamma_scaled \x3d gamma * gamma_scale;\n        highp float alpha \x3d smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n        gl_FragColor \x3d color * (alpha * opacity * fade_opacity);\n    }"};
f.arc={vertexSource:"attribute vec3 a_pos;\n  attribute vec3 source;\n  attribute vec3 target;\n  uniform mat4 u_matrix;\n  uniform vec2 u_units_to_pixels;\n  uniform float u_device_pixel_ratio;\n\n  uniform float width;\n  uniform float height;\n  uniform float tilts;\n  uniform float numSegments;\n\n  float paraboloid(vec3 source, vec3 target, float ratio) {\n    vec3 delta \x3d target - source;\n    float dh \x3d length(delta.xy) * height;\n    float unitZ \x3d delta.z / dh;\n    float p2 \x3d unitZ * unitZ + 1.0;\n    float dir \x3d step(delta.z, 0.0);\n    float z0 \x3d mix(source.z, target.z, dir);\n    float r \x3d mix(ratio, 1.0 - ratio, dir);\n    return sqrt(r * (p2 - r)) * dh + z0;\n  }\n  vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n    vec2 dir_screenspace \x3d normalize(line_clipspace);\n    dir_screenspace \x3d vec2(-dir_screenspace.y, dir_screenspace.x);\n    return dir_screenspace * offset_direction * width;\n  }\n\n  float getSegmentRatio(float index) {\n    return smoothstep(0.0, 1.0, index / (numSegments - 1.0));\n  }\n\n  vec3 getPos(vec3 source, vec3 target, float segmentRatio) {\n    float z \x3d paraboloid(source, target, segmentRatio);\n    float tiltAngle \x3d radians(tilts);\n    vec2 tiltDirection \x3d normalize(target.xy - source.xy);\n    vec2 tilt \x3d vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n    return vec3(mix(source.xy, target.xy, segmentRatio) + tilt,z * cos(tiltAngle));\n  }\n\n  vec2 project_pixel_size_to_clipspace(vec2 pixels) {\n    vec2 offset \x3d pixels / u_units_to_pixels * u_device_pixel_ratio * 2.0;\n    return offset;\n  }\n\n  void main(void) {\n    float segmentIndex \x3d a_pos.x;\n    float segmentRatio \x3d getSegmentRatio(segmentIndex);\n    float indexDir \x3d mix(-1.0, 1.0, step(segmentIndex, 0.0));\n    float nextSegmentRatio \x3d getSegmentRatio(segmentIndex + indexDir);\n\n    vec3 currPos \x3d getPos(source, target, segmentRatio);\n    vec3 nextPos \x3d getPos(source, target, nextSegmentRatio);\n    vec4 curr \x3d u_matrix * vec4(currPos, 1.0);\n    vec4 next \x3d u_matrix * vec4(nextPos, 1.0);\n\n    float widthPixels \x3d width;\n\n    vec3 offset \x3d vec3(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_pos.y, widthPixels), 0.0);\n    gl_Position \x3d curr + vec4(offset.xy, 0.0, 0.0);\n  }",
fragmentSource:"precision highp float;\n  uniform vec4 color;\n  uniform float opacity;\n  void main(void) {\n    gl_FragColor \x3d vec4(color.xyz, opacity);\n  }"};f.multiCircles={vertexSource:"uniform mat4 u_matrix;\n  uniform bool u_scale_with_map;\n  uniform bool u_pitch_with_map;\n  uniform vec2 u_extrude_scale;\n  uniform lowp float u_device_pixel_ratio;\n  uniform highp float u_camera_to_center_distance;\n  attribute vec2 a_pos;\n  attribute vec4 a_color;\n  varying vec3 v_data;\n  varying vec4 v_color;\n  uniform mediump float radius;\n  uniform mediump float stroke_width;\n  void main(void) {\n    vec2 extrude \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n    vec2 circle_center \x3d floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n      vec2 corner_position \x3d circle_center;\n      if (u_scale_with_map) {\n        corner_position +\x3d extrude * (radius + stroke_width) * u_extrude_scale;\n      } else {\n        vec4 projected_center \x3d u_matrix * vec4(circle_center, 0, 1);\n        corner_position +\x3d extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n      }\n\n      gl_Position \x3d u_matrix * vec4(corner_position, 0, 1);\n    } else {\n      gl_Position \x3d u_matrix * vec4(circle_center, 0, 1);\n\n      if (u_scale_with_map) {\n        gl_Position.xy +\x3d extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n      } else {\n        gl_Position.xy +\x3d extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n      }\n    }\n    lowp float antialiasblur \x3d 1.0 / u_device_pixel_ratio / (radius + stroke_width);\n\n    v_data \x3d vec3(extrude.x, extrude.y, antialiasblur);\n    v_color \x3d a_color;\n  }",
fragmentSource:"precision mediump float;\n  varying vec3 v_data;\n  varying vec4 v_color;\n  uniform mediump float radius;\n  uniform lowp float blur;\n  uniform lowp float opacity;\n  uniform highp vec4 stroke_color;\n  uniform mediump float stroke_width;\n  uniform lowp float stroke_opacity;\n\n  void main() {\n\n    vec2 extrude \x3d v_data.xy;\n    float extrude_length \x3d length(extrude);\n\n    lowp float antialiasblur \x3d v_data.z;\n    float antialiased_blur \x3d -max(blur, antialiasblur);\n\n    float opacity_t \x3d smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t \x3d stroke_width \x3c 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor \x3d opacity_t * mix(v_color * opacity, stroke_color * stroke_opacity, color_t);\n  }"};
f.multiPolygon={vertexSource:"attribute vec2 a_pos;\n    attribute vec4 a_color;\n    uniform mat4 u_matrix;\n    varying vec4 v_color;\n    void main() {\n        gl_Position \x3d u_matrix * vec4(a_pos, 0.0, 1.0);\n        v_color \x3d a_color;\n    }",fragmentSource:"precision mediump float;\n    varying vec4 v_color;\n    uniform lowp float u_opacity;\n    void main() {\n        gl_FragColor \x3d v_color * u_opacity;\n    }"};f.fan={vertexSource:"uniform mat4 u_matrix;\n  uniform bool u_scale_with_map;\n  uniform bool u_pitch_with_map;\n  uniform vec2 u_extrude_scale;\n  uniform lowp float u_device_pixel_ratio;\n  uniform highp float u_camera_to_center_distance;\n  attribute vec2 a_pos;\n  varying vec3 v_data;\n  uniform mediump float radius;\n  uniform mediump float stroke_width;\n  void main(void) {\n    vec2 extrude \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n    vec2 circle_center \x3d floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n      vec2 corner_position \x3d circle_center;\n      if (u_scale_with_map) {\n        corner_position +\x3d extrude * (radius + stroke_width) * u_extrude_scale;\n      } else {\n        vec4 projected_center \x3d u_matrix * vec4(circle_center, 0, 1);\n        corner_position +\x3d extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n      }\n\n      gl_Position \x3d u_matrix * vec4(corner_position, 0, 1);\n    } else {\n      gl_Position \x3d u_matrix * vec4(circle_center, 0, 1);\n\n      if (u_scale_with_map) {\n        gl_Position.xy +\x3d extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n      } else {\n        gl_Position.xy +\x3d extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n      }\n    }\n    lowp float antialiasblur \x3d 1.0 / u_device_pixel_ratio / (radius + stroke_width);\n\n    v_data \x3d vec3(extrude.x, extrude.y, antialiasblur);\n  }",
fragmentSource:"precision mediump float;\n  varying vec3 v_data;\n  uniform highp vec4 color;\n  uniform mediump float radius;\n  uniform lowp float blur;\n  uniform lowp float opacity;\n  uniform highp vec4 stroke_color;\n  uniform mediump float stroke_width;\n  uniform lowp float stroke_opacity;\n  uniform int quadrant;\n  uniform bool border;\n  uniform float start;\n  uniform float end;\n  uniform float gap;\n  void main() {\n    vec2 extrude \x3d v_data.xy;\n    float extrude_length \x3d length(extrude);\n\n    lowp float antialiasblur \x3d v_data.z;\n    float antialiased_blur \x3d -max(blur, antialiasblur);\n\n    // \u5b9e\u73b0\u5706\u5f62\u6548\u679c\n    float opacity_t \x3d smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n    // \u5b9e\u73b0\u8fb9\u754c\u7ebf\u6548\u679c\n    float color_t \x3d stroke_width \x3c 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    extrude_length - radius / (radius + stroke_width)\n    );\n\n    float tana \x3d v_data.y/v_data.x;\n    float opacity_fan \x3d 0.0;\n    if (quadrant \x3d\x3d 1) {\n      opacity_fan \x3d  step(0.0, -tana) * step(0.0, v_data.x);\n      if (border) {\n        if ((v_data.y \x3e -gap \x26\x26 v_data.x \x3e start) || (v_data.x \x3c gap \x26\x26 v_data.y \x3c -end)) {\n          color_t \x3d 1.0;\n        }\n      }\n    } else if (quadrant \x3d\x3d 2) {\n      opacity_fan \x3d  step(0.0, tana) * step(0.0, -v_data.x);\n      if (border) {\n        if ((v_data.x \x3e -gap \x26\x26 v_data.y \x3c -start) || (v_data.y \x3e -gap \x26\x26 v_data.x \x3c -end)) {\n          color_t \x3d 1.0;\n        }\n      }\n    } else if (quadrant \x3d\x3d 3) {\n      opacity_fan \x3d  step(0.0, -tana) * step(0.0, -v_data.x);\n      if (border) {\n        if ((v_data.y \x3c gap \x26\x26 v_data.x \x3c -start) || (v_data.x \x3e -gap \x26\x26 v_data.y \x3e end)) {\n          color_t \x3d 1.0;\n        }\n      }\n    } else {\n      opacity_fan \x3d step(0.0, tana) * step(0.0, v_data.x);\n      if (border) {\n        if ((v_data.x \x3c gap \x26\x26 v_data.y \x3e start) || (v_data.y \x3c gap \x26\x26 v_data.x\x3eend)) {\n          color_t \x3d 1.0;\n        }\n      }\n    }\n    gl_FragColor \x3d opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t) * opacity_fan;\n  }"};
f.arcParticle={vertexSource:"attribute float a_ratio;\n  attribute vec3 source;\n  attribute vec3 target;\n  uniform mat4 u_matrix;\n  uniform float height;\n  uniform float tilts;\n  uniform float offset;\n\n  float paraboloid(vec3 source, vec3 target, float ratio) {\n    vec3 delta \x3d target - source;\n    float dh \x3d length(delta.xy) * height;\n    float unitZ \x3d delta.z / dh;\n    float p2 \x3d unitZ * unitZ + 1.0;\n    float dir \x3d step(delta.z, 0.0);\n    float z0 \x3d mix(source.z, target.z, dir);\n    float r \x3d mix(ratio, 1.0 - ratio, dir);\n    return sqrt(r * (p2 - r)) * dh + z0;\n  }\n\n  vec3 getPos(vec3 source, vec3 target, float segmentRatio) {\n    float z \x3d paraboloid(source, target, segmentRatio);\n    float tiltAngle \x3d radians(tilts);\n    vec2 tiltDirection \x3d normalize(target.xy - source.xy);\n    vec2 tilt \x3d vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n    return vec3(mix(source.xy, target.xy, segmentRatio) + tilt,z * cos(tiltAngle));\n  }\n\n  void main(void) {\n    float segmentRatio \x3d a_ratio + offset;\n    segmentRatio \x3d segmentRatio \x3e 1.0?segmentRatio-1.0:segmentRatio;\n    vec3 currPos \x3d getPos(source, target, segmentRatio);\n    gl_Position \x3d u_matrix * vec4(currPos, 1.0);\n    gl_PointSize \x3d 20.0;\n  }",
fragmentSource:"precision highp float;\n  uniform vec4 color;\n  void main(void) {\n    float d \x3d distance(gl_PointCoord, vec2(0.5, 0.5));\nif (d \x3c 0.1) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 1.0, 1.0);\n  } else if (d \x3c 0.5) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 1.0, 0.5 - d);\n  } else {\n    discard;\n  }\n  }"};f.lineParticle={vertexSource:"attribute float a_ratio;\n  uniform vec3 u_source_position;\n  uniform vec3 u_target_position;\n  uniform mat4 u_matrix;\n  vec3 getPos(vec3 source, vec3 target, float segmentRatio) {\n    return source * (1.0 - segmentRatio) + target * segmentRatio;\n  }\n\n  void main(void) {\n    vec3 source \x3d u_source_position;\n    vec3 target \x3d u_target_position;\n    vec3 currPos \x3d getPos(source, target, a_ratio);\n    gl_Position \x3d u_matrix * vec4(currPos, 1.0);\n    gl_PointSize \x3d 20.0;\n  }",
fragmentSource:"precision highp float;\n  uniform vec4 color;\n  void main(void) {\n    float d \x3d distance(gl_PointCoord, vec2(0.5, 0.5));\nif (d \x3c 0.1) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 1.0, 1.0);\n  } else if (d \x3c 0.5) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 1.0, 0.5 - d);\n  } else {\n    discard;\n  }\n  }"};f.sprite={vertexSource:"attribute vec2 position;\n  attribute vec2 uv;\n\n  uniform vec2 scale;\n  uniform mat4 modelViewMatrix;\n  uniform mat4 projectionMatrix;\n  uniform float rotation;\n  uniform vec2 center;\n\n  varying vec2 vUv;\n\n  void main() {\n    vUv \x3d uv;\n    position \x3d position/2.0;\n    vec4 mvPosition \x3d modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0);\n\n    bool isPerspective \x3d ( projectionMatrix[ 2 ][ 3 ] \x3d\x3d - 1.0 );\n    if ( isPerspective ) scale *\x3d - mvPosition.z;\n\n    vec2 alignedPosition \x3d (position - (center - vec2(0.5))) * scale;\n    vec2 rotatedPosition;\n    rotatedPosition.x \x3d cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y;\n    rotatedPosition.y \x3d sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y;\n    mvPosition.xy +\x3d rotatedPosition;\n    gl_Position \x3d projectionMatrix * mvPosition;\n  }",
fragmentSource:"precision highp float;\n\n  varying vec2 vUv;\n  uniform sampler2D map;\n\n  void main() {\n    gl_FragColor \x3d texture2D(map, vUv);\n  }"};f.lineExtrusion={vertexSource:"attribute vec3 a_pos;\n  uniform mat4 u_matrix;\n  uniform float u_fill_extrusion_base;\n  uniform float u_fill_extrusion_height;\n\n  void main() {\n    highp float base \x3d u_fill_extrusion_base;\n    highp float height \x3d u_fill_extrusion_height;\n    base \x3d max(0.0, base);\n    height \x3d max(0.0, height);\n    gl_Position \x3d u_matrix * vec4(a_pos.xy, a_pos.z\x3e0.0 ? height : base, 1.0);\n  }",
fragmentSource:"precision mediump float;\n  uniform vec4 u_fill_extrusion_color;\n  void main() {\n    gl_FragColor \x3d u_fill_extrusion_color;\n  }"};f.moveLine={vertexSource:"attribute vec3 a_data;\n  attribute vec2 source;\n  attribute vec2 middle;\n  attribute vec2 target;\n  uniform float ratio;\n  uniform float u_len;\n  uniform float segment;\n  uniform mat4 u_matrix;\n  uniform float u_width;\n  varying float v_opacity;\n\n  vec2 getPos(float t) {\n    float left \x3d 1.0 - t;\n    return left * left * source + 2.0 * t * left * middle + t * t * target;\n  }\n\n  vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n    vec2 dir_screenspace \x3d normalize(line_clipspace);\n    dir_screenspace \x3d vec2(-dir_screenspace.y, dir_screenspace.x);\n    return dir_screenspace * offset_direction * width / 2.0;\n  }\n\n  void main() {\n    vec2 currPos \x3d getPos(ratio);\n    vec2 nextPos \x3d getPos(max(ratio - 1.0/segment, 0.0));\n    vec2 normal \x3d normalize(nextPos - currPos)* u_len * a_data.x;\n    vec4 curr \x3d u_matrix * vec4(currPos - normal, 0.0, 1.0);\n    vec4 next \x3d u_matrix * vec4(nextPos, 0.0, 1.0);\n\n    vec2 offsetPos \x3d getExtrusionOffset(next.xy - curr.xy, a_data.y, u_width);\n    gl_Position \x3d curr + vec4(offsetPos, 0.0, 1.0);\n    v_opacity \x3d a_data.z;\n//    gl_Position \x3d u_matrix * vec4(source, 0.0, 1.0);\n  }",
fragmentSource:"precision mediump float;\n  varying float v_opacity;\n  uniform vec4 u_color;\n  void main() {\n    gl_FragColor \x3d vec4(u_color.xyz, mix(0.0, 1.0, v_opacity));\n  }"};f.moveArc={vertexSource:"attribute vec3 a_pos;\n  attribute vec3 source;\n  attribute vec3 target;\n  uniform float u_ratio;\n  uniform float u_len;\n  uniform mat4 u_matrix;\n  uniform float u_device_pixel_ratio;\n\n  uniform float width;\n  uniform float height;\n  uniform float tilts;\n  uniform float numSegments;\n  varying float v_opacity;\n\n  float paraboloid(vec3 source, vec3 target, float ratio) {\n    vec3 delta \x3d target - source;\n    float dh \x3d length(delta.xy) * height;\n    float unitZ \x3d delta.z / dh;\n    float p2 \x3d unitZ * unitZ + 1.0;\n    float dir \x3d step(delta.z, 0.0);\n    float z0 \x3d mix(source.z, target.z, dir);\n    float r \x3d mix(ratio, 1.0 - ratio, dir);\n    return sqrt(r * (p2 - r)) * dh + z0;\n  }\n  vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {\n    vec2 dir_screenspace \x3d normalize(line_clipspace);\n    dir_screenspace \x3d vec2(-dir_screenspace.y, dir_screenspace.x);\n    return dir_screenspace * offset_direction * width;\n  }\n\n  vec3 getPos(vec3 source, vec3 target, float segmentRatio) {\n    float z \x3d paraboloid(source, target, segmentRatio);\n    float tiltAngle \x3d radians(tilts);\n    vec2 tiltDirection \x3d normalize(target.xy - source.xy);\n    vec2 tilt \x3d vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);\n    return vec3(mix(source.xy, target.xy, segmentRatio) + tilt,z * cos(tiltAngle));\n  }\n\n  void main(void) {\n    vec3 currPos \x3d getPos(source, target, u_ratio);\n    vec3 nextPos \x3d getPos(source, target, max(u_ratio - 0.5/numSegments, 0.0));\n    vec3 normal \x3d normalize(nextPos - currPos)* u_len * a_pos.x;\n    vec4 curr \x3d u_matrix * vec4(currPos - normal , 1.0);\n    vec4 next \x3d u_matrix * vec4(nextPos, 1.0);\n\n    float widthPixels \x3d width;\n\n    vec3 offsetPos \x3d vec3(getExtrusionOffset(next.xy - curr.xy, a_pos.y, widthPixels), 0.0);\n    gl_Position \x3d curr + vec4(offsetPos.xy, 0.0, 0.0);\n    v_opacity \x3d a_pos.z;\n  }",
fragmentSource:"precision highp float;\n  uniform vec4 color;\n  varying float v_opacity;\n  void main(void) {\n    gl_FragColor \x3d vec4(color.xyz, v_opacity*0.8);\n  }"};f.blur={vertexSource:"attribute vec4 aPos;\n  varying vec2 vUv;\n  void main() {\n    vUv \x3d aPos.zw;\n    gl_Position \x3d vec4(aPos.xy, 0.0, 1.0);\n  }",fragmentSource:"precision mediump float;\n  varying vec2 vUv;\n  uniform sampler2D colorTexture;\n  uniform vec2 texSize;\n  uniform vec2 direction;\n\n  uniform float SIGMA;\n\n  float gaussianPdf(in float x, in float sigma) {\n    return 0.39894 * exp(-0.5 * x * x/(sigma * sigma))/sigma;\n  }\n  void main() {\n    vec2 invSize \x3d 1.0 / texSize;\n    float fSigma \x3d float(SIGMA);\n    float weightSum \x3d gaussianPdf(0.0, fSigma);\n    vec4 diffuseSum \x3d texture2D(colorTexture, vUv) * weightSum;\n    for (int i \x3d 1; i \x3c 8; i ++) {\n      float x \x3d float(i);\n      float w \x3d gaussianPdf(x, fSigma);\n      vec2 uvOffset \x3d direction * invSize * x;\n      vec4 sample1 \x3d texture2D(colorTexture, vUv + uvOffset);\n      vec4 sample2 \x3d texture2D(colorTexture, vUv - uvOffset);\n      diffuseSum +\x3d (sample1 + sample2) * w;\n      weightSum +\x3d 2.0 * w;\n    }\n    //    gl_FragColor \x3d vec4(diffuseSum/weightSum, 1.0);\n    // gl_FragColor \x3d vec4(diffuseSum/weightSum, 1.0);\n    gl_FragColor \x3d diffuseSum/weightSum;\n  }"};
f.bloom={vertexSource:"attribute vec4 aPos;\n  varying vec2 vUv;\n  void main() {\n    vUv \x3d aPos.zw;\n    gl_Position \x3d vec4(aPos.xy, 0.0, 1.0);\n  }",fragmentSource:"precision mediump float;\n  varying vec2 vUv;\n  uniform sampler2D blurTexture1;\n  uniform float bloomStrength;\n  uniform float bloomRadius;\n  float lerpBloomFactor(const in float factor) {\n    float mirrorFactor \x3d 1.2 - factor;\n    return mix(factor, mirrorFactor, bloomRadius);\n  }\n\n  void main() {\n    gl_FragColor \x3d bloomStrength * (lerpBloomFactor(1.0) * vec4(1.0, 1.0, 1.0, 1.0) * texture2D(blurTexture1, vUv));// +\n  }"};
f.imageFill={vertexSource:"vec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n  const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset \x3d mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n  }\n\n  uniform mat4 u_matrix;\n  uniform vec2 u_pixel_coord_upper;\n  uniform vec2 u_pixel_coord_lower;\n  uniform vec4 u_scale;\n\n  attribute vec2 a_pos;\n\n  varying vec2 v_pos_a;\n  varying vec2 v_pos_b;\n\n\n  uniform lowp float u_opacity;\n  uniform lowp vec4 u_pattern_from;\n  uniform lowp vec4 u_pattern_to;\n\n  void main() {\n    lowp float opacity \x3d u_opacity;\n    mediump vec4 pattern_from \x3d u_pattern_from;\n    mediump vec4 pattern_to \x3d u_pattern_to;\n\n    vec2 pattern_tl_a \x3d pattern_from.xy;\n    vec2 pattern_br_a \x3d pattern_from.zw;\n    vec2 pattern_tl_b \x3d pattern_to.xy;\n    vec2 pattern_br_b \x3d pattern_to.zw;\n\n    float pixelRatio \x3d u_scale.x;\n    float tileZoomRatio \x3d u_scale.y;\n    float fromScale \x3d u_scale.z;\n    float toScale \x3d u_scale.w;\n\n    vec2 display_size_a \x3d vec2((pattern_br_a.x - pattern_tl_a.x) / pixelRatio, (pattern_br_a.y - pattern_tl_a.y) / pixelRatio);\n    vec2 display_size_b \x3d vec2((pattern_br_b.x - pattern_tl_b.x) / pixelRatio, (pattern_br_b.y - pattern_tl_b.y) / pixelRatio);\n    gl_Position \x3d u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a \x3d get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, fromScale * display_size_a, tileZoomRatio, a_pos);\n    v_pos_b \x3d get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, toScale * display_size_b, tileZoomRatio, a_pos);\n  }",
fragmentSource:"precision mediump float;\n\n  uniform vec2 u_texsize;\n  uniform float u_fade;\n  uniform sampler2D u_image;\n\n  varying vec2 v_pos_a;\n  varying vec2 v_pos_b;\n\n  uniform lowp float u_opacity;\n  uniform lowp vec4 u_pattern_from;\n  uniform lowp vec4 u_pattern_to;\n\n  void main() {\n    lowp float opacity \x3d u_opacity;\n    mediump vec4 pattern_from \x3d u_pattern_from;\n    mediump vec4 pattern_to \x3d u_pattern_to;\n\n\n    vec2 pattern_tl_a \x3d pattern_from.xy;\n    vec2 pattern_br_a \x3d pattern_from.zw;\n    vec2 pattern_tl_b \x3d pattern_to.xy;\n    vec2 pattern_br_b \x3d pattern_to.zw;\n\n    vec2 imagecoord \x3d mod(v_pos_a, 1.0);\n    vec2 pos \x3d mix(pattern_tl_a / u_texsize, pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 \x3d texture2D(u_image, pos);\n\n    vec2 imagecoord_b \x3d mod(v_pos_b, 1.0);\n    vec2 pos2 \x3d mix(pattern_tl_b / u_texsize, pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 \x3d texture2D(u_image, pos2);\n\n    gl_FragColor \x3d mix(color1, color2, u_fade) * opacity;\n  }"};
f.gaussianBlur={vertexSource:"attribute vec4 aPos;\n  varying vec2 vUV;\n  void main() {\n    gl_Position \x3d vec4(aPos.xy, 0.0, 1.0);\n    vUV \x3d aPos.zw;\n  }",fragmentSource:"precision mediump float;\n  uniform sampler2D uTexture;\n  uniform bool uHorizontal;\n  // uniform float uSampleStep;\n  uniform vec2 uSize;\n  varying vec2 vUV;\n\n  uniform float u_kernel[5];\n  void main() {\n    vec2 onePixel \x3d vec2(1.0) / uSize;\n    vec2 offset \x3d (uHorizontal? vec2(1, 0):vec2(0, 1));\n    vec4 colorSum \x3d\n    texture2D(uTexture, vUV) * u_kernel[0] +\n    texture2D(uTexture, vUV + onePixel * offset) * u_kernel[1] +\n    texture2D(uTexture, vUV - onePixel * offset) * u_kernel[1] +\n    texture2D(uTexture, vUV + onePixel * 2.0*offset) * u_kernel[2] +\n    texture2D(uTexture, vUV - onePixel * 2.0*offset) * u_kernel[2] +\n    texture2D(uTexture, vUV + onePixel * 3.0*offset) * u_kernel[3] +\n    texture2D(uTexture, vUV - onePixel * 3.0*offset) * u_kernel[3] +\n    texture2D(uTexture, vUV + onePixel * 4.0*offset) * u_kernel[4] +\n    texture2D(uTexture, vUV - onePixel * 4.0*offset) * u_kernel[4];\n    gl_FragColor \x3d vec4(colorSum.rgb / 0.7, colorSum.a);\n\n  }"};
f.screen={vertexSource:"attribute vec4 aPos;\n  varying vec2 vUV;\n  void main() {\n    gl_Position \x3d vec4(aPos.xy, 0.0, 1.0);\n    vUV \x3d aPos.zw;\n  }",fragmentSource:"precision highp float;\n  uniform sampler2D uTexture;\n  varying vec2 vUV;\n\n  void main() {\n    gl_FragColor \x3d texture2D(uTexture, vUV);\n  }"};f.basicFillImage={vertexSource:"attribute vec4 a_pos;\n    uniform mat4 u_matrix;\n    varying vec2 v_tex;\n    void main() {\n        v_tex \x3d a_pos.zw;\n        gl_Position \x3d u_matrix * vec4(a_pos.xy, 0.0, 1.0);\n    }",
fragmentSource:"precision mediump float;\n    uniform sampler2D u_texture;\n    varying vec2 v_tex;\n    uniform lowp float u_opacity;\n    void main() {\n        gl_FragColor \x3d texture2D(u_texture, v_tex) * u_opacity;\n    }"};f.ztText={vertexSource:"attribute vec2 a_pos;\n    attribute vec4 a_data;\n\n    uniform highp float u_size;\n    uniform mat4 u_matrix;\n    uniform mat4 u_label_plane_matrix;\n    uniform mat4 u_coord_matrix;\n    uniform bool u_pitch_with_map;\n    uniform highp float u_camera_to_center_distance;\n    uniform vec2 u_texsize;\n    varying vec2 v_data0;\n\n    uniform highp vec4 u_fill_color;\n    uniform lowp float u_opacity;\n    uniform bool u_rotate_symbol;\n    uniform float u_radian;\n\n    void main() {\n        highp vec4 fill_color \x3d u_fill_color;\n        lowp float opacity \x3d u_opacity;\n        vec2 a_offset \x3d a_data.xy;\n        vec2 a_tex \x3d a_data.zw;\n        float size \x3d u_size;\n\n        vec4 projectedPoint \x3d u_matrix * vec4(a_pos, 0, 1);\n        highp float camera_to_anchor_distance \x3d projectedPoint.w;\n        highp float distance_ratio \x3d u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n        highp float perspective_ratio \x3d clamp(\n        0.5 + 0.5 * distance_ratio,\n        0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n        4.0);\n        size *\x3d perspective_ratio;\n        float fontScale \x3d size / 96.0;\n        highp float symbol_rotation \x3d 0.0;\n        if (u_rotate_symbol) {\n            symbol_rotation \x3d u_radian;\n        }\n    highp float angle_sin \x3d sin(symbol_rotation);\n    highp float angle_cos \x3d cos(symbol_rotation);\n    mat2 rotation_matrix \x3d mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n        vec4 projected_pos \x3d u_label_plane_matrix * vec4(a_pos, 0.0, 1.0);\n        gl_Position \x3d u_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n        float gamma_scale \x3d gl_Position.w;\n\n        vec2 tex \x3d a_tex / u_texsize;\n        float interpolated_fade_opacity \x3d 1.0;\n\n        v_data0 \x3d vec2(tex.x, tex.y);\n    }",
fragmentSource:"precision mediump float;\n    #define SDF_PX 8.0\n    uniform sampler2D u_texture;\n    uniform highp float u_gamma_scale;\n\n    varying vec2 v_data0;\n\n    uniform highp vec4 u_fill_color;\n    uniform lowp float u_opacity;\n    uniform highp float u_size;\n    uniform highp vec4 u_halo_color;\n    uniform lowp float u_halo_width;\n    uniform lowp float u_halo_blur;\n    uniform bool u_is_halo;\n    uniform lowp float u_buff;\n\n    void main() {\n        highp vec4 fill_color \x3d u_fill_color;\n        lowp float opacity \x3d u_opacity;\n        lowp float buff \x3d u_buff;\n\n        float EDGE_GAMMA \x3d 0.105;\n\n        vec2 tex \x3d v_data0.xy;\n        float gamma_scale \x3d 1.0;\n        float size \x3d u_size;\n        float fade_opacity \x3d 1.0;\n        float fontScale \x3d size / 96.0;\n\n        lowp vec4 color \x3d fill_color;\n        highp float gamma \x3d EDGE_GAMMA / (fontScale * u_gamma_scale);\n        // lowp float buff \x3d 0.45; //(256.0 - 64.0) / 256.0;\n        lowp float dist \x3d texture2D(u_texture, tex).a;\n        highp float gamma_scaled \x3d gamma * gamma_scale;\n        highp float alpha \x3d smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n        gl_FragColor \x3d color * (alpha * opacity * fade_opacity);\n        // gl_FragColor \x3d vec4(dist/255.0, dist/255.0, dist/255.0, 1.0);\n    }"};
f.rect={vertexSource:k,fragmentSource:l};f.terrain={vertexSource:d,fragmentSource:a};f.tifTerrain={vertexSource:g,fragmentSource:h};f.heightMap={vertexSource:m,fragmentSource:n};f.water={vertexSource:b,fragmentSource:e};f.bg={vertexSource:t,fragmentSource:v};f.mesh={vertexSource:z,fragmentSource:y};f.cylinder={vertexSource:u,fragmentSource:r};f.cone={vertexSource:x,fragmentSource:A};f.myline={vertexSource:w,fragmentSource:B};f.fillExtrusion2={vertexSource:q,fragmentSource:p};f.programUniforms={fill:function(a,
b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix)}},line:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_ratio:new c.Uniform1f(a,b.u_ratio),u_device_pixel_ratio:new c.Uniform1f(a,b.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(a,b.u_units_to_pixels)}},symbolIcon:function(a,b){return{u_is_size_zoom_constant:new c.Uniform1i(a,b.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(a,b.u_is_size_feature_constant),u_size_t:new c.Uniform1f(a,b.u_size_t),
u_size:new c.Uniform1f(a,b.u_size),u_camera_to_center_distance:new c.Uniform1f(a,b.u_camera_to_center_distance),u_pitch:new c.Uniform1f(a,b.u_pitch),u_rotate_symbol:new c.Uniform1i(a,b.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(a,b.u_aspect_ratio),u_fade_change:new c.Uniform1f(a,b.u_fade_change),u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(a,b.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(a,b.u_coord_matrix),u_is_text:new c.Uniform1f(a,
b.u_is_text),u_pitch_with_map:new c.Uniform1i(a,b.u_pitch_with_map),u_texsize:new c.Uniform2f(a,b.u_texsize),u_texture:new c.Uniform1i(a,b.u_texture)}},symbolSDF:function(a,b){return{u_is_size_zoom_constant:new c.Uniform1i(a,b.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(a,b.u_is_size_feature_constant),u_size_t:new c.Uniform1f(a,b.u_size_t),u_size:new c.Uniform1f(a,b.u_size),u_camera_to_center_distance:new c.Uniform1f(a,b.u_camera_to_center_distance),u_pitch:new c.Uniform1f(a,
b.u_pitch),u_rotate_symbol:new c.Uniform1i(a,b.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(a,b.u_aspect_ratio),u_fade_change:new c.Uniform1f(a,b.u_fade_change),u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(a,b.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(a,b.u_coord_matrix),u_is_text:new c.Uniform1f(a,b.u_is_text),u_pitch_with_map:new c.Uniform1i(a,b.u_pitch_with_map),u_texsize:new c.Uniform2f(a,b.u_texsize),u_texture:new c.Uniform1i(a,b.u_texture),
u_gamma_scale:new c.Uniform1f(a,b.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(a,b.u_device_pixel_ratio),u_is_halo:new c.Uniform1f(a,b.u_is_halo)}},lineSDF:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_ratio:new c.Uniform1f(a,b.u_ratio),u_device_pixel_ratio:new c.Uniform1f(a,b.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(a,b.u_units_to_pixels),u_patternscale_a:new c.Uniform2f(a,b.u_patternscale_a),u_patternscale_b:new c.Uniform2f(a,b.u_patternscale_b),u_sdfgamma:new c.Uniform1f(a,
b.u_sdfgamma),u_image:new c.Uniform1i(a,b.u_image),u_tex_y_a:new c.Uniform1f(a,b.u_tex_y_a),u_tex_y_b:new c.Uniform1f(a,b.u_tex_y_b),u_mix:new c.Uniform1f(a,b.u_mix)}},fillExtrusion:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_lightpos:new c.Uniform3f(a,b.u_lightpos),u_lightintensity:new c.Uniform1f(a,b.u_lightintensity),u_lightcolor:new c.Uniform3f(a,b.u_lightcolor),u_vertical_gradient:new c.Uniform1f(a,b.u_vertical_gradient),u_opacity:new c.Uniform1f(a,b.u_opacity),u_height_image:new c.Uniform1i(a,
b.u_height_image),u_min_height:new c.Uniform1f(a,b.u_min_height),u_delta_height:new c.Uniform1f(a,b.u_delta_height)}},fillExtrusion2:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_lightpos:new c.Uniform3f(a,b.u_lightpos),u_lightintensity:new c.Uniform1f(a,b.u_lightintensity),u_lightcolor:new c.Uniform3f(a,b.u_lightcolor),u_vertical_gradient:new c.Uniform1f(a,b.u_vertical_gradient),u_opacity:new c.Uniform1f(a,b.u_opacity),u_color:new c.Uniform4f(a,b.u_color),u_height:new c.Uniform1f(a,
b.u_height),u_base:new c.Uniform1f(a,b.u_base)}},lineExtrusion:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix)}},clippingMask:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix)}},background:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_opacity:new c.Uniform1f(a,b.u_opacity),u_color:new c.UniformColor(a,b.u_color)}},heatmap:function(a,b){return{u_extrude_scale:new c.Uniform1f(a,b.u_extrude_scale),u_intensity:new c.Uniform1f(a,b.u_intensity),u_matrix:new c.UniformMatrix4f(a,
b.u_matrix)}},heatmapTexture:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_world:new c.Uniform2f(a,b.u_world),u_image:new c.Uniform1i(a,b.u_image),u_color_ramp:new c.Uniform1i(a,b.u_color_ramp),u_opacity:new c.Uniform1f(a,b.u_opacity)}},raster:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_tl_parent:new c.Uniform2f(a,b.u_tl_parent),u_scale_parent:new c.Uniform1f(a,b.u_scale_parent),u_buffer_scale:new c.Uniform1f(a,b.u_buffer_scale),u_fade_t:new c.Uniform1f(a,
b.u_fade_t),u_opacity:new c.Uniform1f(a,b.u_opacity),u_image0:new c.Uniform1i(a,b.u_image0),u_image1:new c.Uniform1i(a,b.u_image1),u_brightness_low:new c.Uniform1f(a,b.u_brightness_low),u_brightness_high:new c.Uniform1f(a,b.u_brightness_high),u_saturation_factor:new c.Uniform1f(a,b.u_saturation_factor),u_contrast_factor:new c.Uniform1f(a,b.u_contrast_factor),u_spin_weights:new c.Uniform3f(a,b.u_spin_weights)}},image:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_image:new c.Uniform1i(a,
b.u_image),u_opacity:new c.Uniform1f(a,b.u_opacity)}},circles:function(a,b){return{u_camera_to_center_distance:new c.Uniform1f(a,b.u_camera_to_center_distance),u_scale_with_map:new c.Uniform1i(a,b.u_scale_with_map),u_pitch_with_map:new c.Uniform1i(a,b.u_pitch_with_map),u_extrude_scale:new c.Uniform2f(a,b.u_extrude_scale),u_device_pixel_ratio:new c.Uniform1f(a,b.u_device_pixel_ratio),u_matrix:new c.UniformMatrix4f(a,b.u_matrix)}},circle:function(a,b){return{u_camera_to_center_distance:new c.Uniform1f(a,
b.u_camera_to_center_distance),u_scale_with_map:new c.Uniform1i(a,b.u_scale_with_map),u_pitch_with_map:new c.Uniform1i(a,b.u_pitch_with_map),u_extrude_scale:new c.Uniform2f(a,b.u_extrude_scale),u_device_pixel_ratio:new c.Uniform1f(a,b.u_device_pixel_ratio),u_matrix:new c.UniformMatrix4f(a,b.u_matrix),radius:new c.Uniform1f(a,b.radius),stroke_width:new c.Uniform1f(a,b.stroke_width),color:new c.Uniform4f(a,b.color),stroke_color:new c.Uniform4f(a,b.stroke_color),blur:new c.Uniform1f(a,b.blue),opacity:new c.Uniform1f(a,
b.opacity),stroke_opacity:new c.Uniform1f(a,b.stroke_opacity)}},basicFill:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_color:new c.Uniform4f(a,b.u_color),u_opacity:new c.Uniform1f(a,b.u_opacity)}},basicLine:D,basicSymbol:function(a,b){return{u_size:new c.Uniform1f(a,b.u_size),u_camera_to_center_distance:new c.Uniform1f(a,b.u_camera_to_center_distance),u_pitch:new c.Uniform1f(a,b.u_pitch),u_rotate_symbol:new c.Uniform1i(a,b.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(a,b.u_aspect_ratio),
u_fade_change:new c.Uniform1f(a,b.u_fade_change),u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(a,b.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(a,b.u_coord_matrix),u_is_text:new c.Uniform1f(a,b.u_is_text),u_pitch_with_map:new c.Uniform1i(a,b.u_pitch_with_map),u_texsize:new c.Uniform2f(a,b.u_texsize),u_texture:new c.Uniform1i(a,b.u_texture),u_gamma_scale:new c.Uniform1f(a,b.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(a,b.u_device_pixel_ratio),
u_is_halo:new c.Uniform1f(a,b.u_is_halo),u_fill_color:new c.Uniform4f(a,b.u_fill_color),u_halo_color:new c.Uniform4f(a,b.u_halo_color),u_opacity:new c.Uniform1f(a,b.u_opacity),u_halo_width:new c.Uniform1f(a,b.u_halo_width),u_halo_blur:new c.Uniform1f(a,b.u_halo_blur)}},multiPoints:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix)}},basicLineSDF:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_ratio:new c.Uniform1f(a,b.u_ratio),u_units_to_pixels:new c.Uniform2f(a,
b.u_units_to_pixels),u_patternscale_a:new c.Uniform2f(a,b.u_patternscale_a),u_patternscale_b:new c.Uniform2f(a,b.u_patternscale_b),u_tex_y_a:new c.Uniform1f(a,b.u_tex_y_a),u_tex_y_b:new c.Uniform1f(a,b.u_tex_y_b),u_color:new c.Uniform4f(a,b.u_color),u_blur:new c.Uniform1f(a,b.u_blur),u_opacity:new c.Uniform1f(a,b.u_opacity),u_gapwidth:new c.Uniform1f(a,b.u_gapwidth),u_offset:new c.Uniform1f(a,b.u_offset),u_width:new c.Uniform1f(a,b.u_width),u_floorwidth:new c.Uniform1f(a,b.u_floorwidth),u_image:new c.Uniform1i(a,
b.u_image),u_sdfgamma:new c.Uniform1f(a,b.u_sdfgamma),u_mix:new c.Uniform1f(a,b.u_mix)}},images:function(a,b){return{u_size:new c.Uniform1f(a,b.u_size),u_camera_to_center_distance:new c.Uniform1f(a,b.u_camera_to_center_distance),u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(a,b.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(a,b.u_coord_matrix),u_pitch_with_map:new c.Uniform1i(a,b.u_pitch_with_map),u_texsize:new c.Uniform2f(a,b.u_texsize),u_opacity:new c.Uniform1f(a,
b.u_opacity),u_texture:new c.Uniform1i(a,b.u_texture),u_rotate_symbol:new c.Uniform1i(a,b.u_rotate_symbol),u_radian:new c.Uniform1f(a,b.u_radian),u_modelMatrix:new c.UniformMatrix4f(a,b.u_modelMatrix)}},text:function(a,b){return{u_size:new c.Uniform1f(a,b.u_size),u_camera_to_center_distance:new c.Uniform1f(a,b.u_camera_to_center_distance),u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(a,b.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(a,b.u_coord_matrix),
u_pitch_with_map:new c.Uniform1i(a,b.u_pitch_with_map),u_texsize:new c.Uniform2f(a,b.u_texsize),u_opacity:new c.Uniform1f(a,b.u_opacity),u_texture:new c.Uniform1i(a,b.u_texture),u_fill_color:new c.Uniform4f(a,b.u_fill_color),u_gamma_scale:new c.Uniform1f(a,b.u_gamma_scale),u_rotate_symbol:new c.Uniform1i(a,b.u_rotate_symbol),u_radian:new c.Uniform1f(a,b.u_radian),u_halo_color:new c.Uniform4f(a,b.u_halo_color),u_halo_width:new c.Uniform1f(a,b.u_halo_width),u_halo_blur:new c.Uniform1f(a,b.u_halo_blur),
u_is_halo:new c.Uniform1i(a,b.u_is_halo)}},ztText:function(a,b){return{u_size:new c.Uniform1f(a,b.u_size),u_camera_to_center_distance:new c.Uniform1f(a,b.u_camera_to_center_distance),u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(a,b.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(a,b.u_coord_matrix),u_pitch_with_map:new c.Uniform1i(a,b.u_pitch_with_map),u_texsize:new c.Uniform2f(a,b.u_texsize),u_opacity:new c.Uniform1f(a,b.u_opacity),u_texture:new c.Uniform1i(a,
b.u_texture),u_fill_color:new c.Uniform4f(a,b.u_fill_color),u_gamma_scale:new c.Uniform1f(a,b.u_gamma_scale),u_rotate_symbol:new c.Uniform1i(a,b.u_rotate_symbol),u_radian:new c.Uniform1f(a,b.u_radian),u_halo_color:new c.Uniform4f(a,b.u_halo_color),u_halo_width:new c.Uniform1f(a,b.u_halo_width),u_halo_blur:new c.Uniform1f(a,b.u_halo_blur),u_is_halo:new c.Uniform1i(a,b.u_is_halo),u_buff:new c.Uniform1f(a,b.u_buff)}},arc:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),height:new c.Uniform1f(a,
b.height),tilts:new c.Uniform1f(a,b.tilts),numSegments:new c.Uniform1f(a,b.numSegments),width:new c.Uniform1f(a,b.width),u_units_to_pixels:new c.Uniform2f(a,b.u_units_to_pixels),u_device_pixel_ratio:new c.Uniform1f(a,b.u_device_pixel_ratio),color:new c.Uniform4f(a,b.color),opacity:new c.Uniform1f(a,b.opacity)}},multiCircles:function(a,b){return{u_camera_to_center_distance:new c.Uniform1f(a,b.u_camera_to_center_distance),u_scale_with_map:new c.Uniform1i(a,b.u_scale_with_map),u_pitch_with_map:new c.Uniform1i(a,
b.u_pitch_with_map),u_extrude_scale:new c.Uniform2f(a,b.u_extrude_scale),u_device_pixel_ratio:new c.Uniform1f(a,b.u_device_pixel_ratio),u_matrix:new c.UniformMatrix4f(a,b.u_matrix),radius:new c.Uniform1f(a,b.radius),stroke_width:new c.Uniform1f(a,b.stroke_width),stroke_color:new c.Uniform4f(a,b.stroke_color),blur:new c.Uniform1f(a,b.blue),opacity:new c.Uniform1f(a,b.opacity),stroke_opacity:new c.Uniform1f(a,b.stroke_opacity)}},multiPolygon:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),
u_opacity:new c.Uniform1f(a,b.u_opacity)}},fan:function(a,b){return{u_camera_to_center_distance:new c.Uniform1f(a,b.u_camera_to_center_distance),u_scale_with_map:new c.Uniform1i(a,b.u_scale_with_map),u_pitch_with_map:new c.Uniform1i(a,b.u_pitch_with_map),u_extrude_scale:new c.Uniform2f(a,b.u_extrude_scale),u_device_pixel_ratio:new c.Uniform1f(a,b.u_device_pixel_ratio),u_matrix:new c.UniformMatrix4f(a,b.u_matrix),radius:new c.Uniform1f(a,b.radius),stroke_width:new c.Uniform1f(a,b.stroke_width),stroke_color:new c.Uniform4f(a,
b.stroke_color),blur:new c.Uniform1f(a,b.blue),opacity:new c.Uniform1f(a,b.opacity),stroke_opacity:new c.Uniform1f(a,b.stroke_opacity),color:new c.Uniform4f(a,b.color),quadrant:new c.Uniform1i(a,b.quadrant),border:new c.Uniform1i(a,b.border),start:new c.Uniform1f(a,b.start),end:new c.Uniform1f(a,b.end),gap:new c.Uniform1f(a,b.gap)}},arcParticle:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),height:new c.Uniform1f(a,b.height),tilts:new c.Uniform1f(a,b.tilts),color:new c.Uniform4f(a,
b.color),offset:new c.Uniform1f(a,b.offset)}},lineParticle:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_source_position:new c.Uniform3f(a,b.u_source_position),u_target_position:new c.Uniform3f(a,b.u_target_position),color:new c.Uniform4f(a,b.color)}},sprite:function(a,b){return{modelViewMatrix:new c.UniformMatrix4f(a,b.modelViewMatrix),projectionMatrix:new c.UniformMatrix4f(a,b.projectionMatrix),scale:new c.Uniform2f(a,b.scale),center:new c.Uniform2f(a,b.center),rotation:new c.Uniform1f(a,
b.rotation),map:new c.Uniform1i(a,b.map)}},moveLine:function(a,b){return{ratio:new c.Uniform1f(a,b.ratio),u_len:new c.Uniform1f(a,b.u_len),segment:new c.Uniform1f(a,b.segment),u_width:new c.Uniform1f(a,b.u_width),u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_color:new c.Uniform4f(a,b.u_color)}},moveArc:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),height:new c.Uniform1f(a,b.height),tilts:new c.Uniform1f(a,b.tilts),numSegments:new c.Uniform1f(a,b.numSegments),width:new c.Uniform1f(a,
b.width),u_device_pixel_ratio:new c.Uniform1f(a,b.u_device_pixel_ratio),color:new c.Uniform4f(a,b.color),u_ratio:new c.Uniform1f(a,b.u_ratio),u_len:new c.Uniform1f(a,b.u_len)}},blur:function(a,b){return{colorTexture:new c.Uniform1i(a,b.colorTexture),texSize:new c.Uniform2f(a,b.texSize),direction:new c.Uniform2f(a,b.direction),SIGMA:new c.Uniform1f(a,b.SIGMA)}},bloom:function(a,b){return{blurTexture1:new c.Uniform1i(a,b.blurTexture1),bloomStrength:new c.Uniform1f(a,b.bloomStrength),bloomRadius:new c.Uniform1f(a,
b.bloomRadius)}},imageFill:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_pixel_coord_upper:new c.Uniform2f(a,b.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(a,b.u_pixel_coord_lower),u_texsize:new c.Uniform2f(a,b.u_texsize),u_scale:new c.Uniform4f(a,b.u_scale),u_pattern_from:new c.Uniform4f(a,b.u_pattern_from),u_pattern_to:new c.Uniform4f(a,b.u_pattern_to),u_opacity:new c.Uniform1f(a,b.u_opacity),u_fade:new c.Uniform1f(a,b.u_fade),u_image:new c.Uniform1i(a,b.u_image)}},
gaussianBlur:function(a,b){return{uSize:new c.Uniform2f(a,b.uSize),uTexture:new c.Uniform1i(a,b.uTexture),uHorizontal:new c.Uniform1i(a,b.uHorizontal),u_kernel:new c.Uniform1fv(a,b["u_kernel[0]"])}},screen:function(a,b){return{uTexture:new c.Uniform1i(a,b.uTexture)}},basicFillImage:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_texture:new c.Uniform1i(a,b.u_texture),u_opacity:new c.Uniform1f(a,b.u_opacity)}},rect:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),
u_device_pixel_ratio:new c.Uniform1f(a,b.u_device_pixel_ratio),u_camera_to_center_distance:new c.Uniform1f(a,b.u_camera_to_center_distance),u_extrude_scale:new c.Uniform2f(a,b.u_extrude_scale),u_size:new c.Uniform1f(a,b.u_size),u_radian:new c.Uniform1f(a,b.u_radian),u_is_stroke:new c.Uniform1i(a,b.u_is_stroke),u_color:new c.Uniform4f(a,b.u_color)}},terrain:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_color:new c.Uniform4f(a,b.u_color),u_tileRectangle:new c.Uniform4f(a,b.u_tileRectangle),
u_image:new c.Uniform1i(a,b.u_image)}},heightMap:function(a,b){return{u_min_height:new c.Uniform1f(a,b.u_min_height),u_delta_height:new c.Uniform1f(a,b.u_delta_height)}},tifTerrain:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_image:new c.Uniform1i(a,b.u_image)}},water:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_water_depth:new c.Uniform1f(a,b.u_water_depth)}},bg:function(a,b){return{}},mesh:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),
u_model:new c.UniformMatrix4f(a,b.u_model),u_color:new c.Uniform3f(a,b.u_color)}},cylinder:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix),u_texture:new c.Uniform1i(a,b.u_texture),u_size:new c.Uniform1f(a,b.u_size),u_opacity:new c.Uniform1f(a,b.u_opacity),u_color:new c.Uniform4f(a,b.u_color)}},cone:function(a,b){return{u_matrix:new c.UniformMatrix4f(a,b.u_matrix)}},myline:D}})},"com/huayun/webgis/symbols/support/CustomGlyphAtlas":function(){define(["../../gl/potpack","../../utils/image"],
function(f,c){return function(f){var k={},d=0,a=-Infinity,m=0,n;for(n in f){var g=f[n],h=k[n]={},b;for(b in g){var e=g[+b];if(e&&0!==e.bitmap.width&&0!==e.bitmap.height){var q={x:d,y:0,w:e.bitmap.width+2,h:e.bitmap.height+2},d=d+q.w,m=m+e.metrics.advance;q.h>a&&(a=q.h);h[b]={rect:q,metrics:e.metrics}}}}var d=new c.AlphaImage({width:d||1,height:a||1}),p;for(p in f){var a=f[p],t;for(t in a)(n=a[+t])&&0!==n.bitmap.width&&0!==n.bitmap.height&&(g=k[p][t].rect,c.AlphaImage.copy(n.bitmap,d,{x:0,y:0},{x:g.x+
1,y:g.y+1},n.bitmap))}this.image=d;this.positions=k;this.textWidth=m}})},"com/huayun/webgis/gl/glUtils":function(){define(["exports"],function(f){f.generateFBO=function(c,f,l){var d=c.gl,a=d.createTexture();d.bindTexture(d.TEXTURE_2D,a);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR);var k=c.createFramebuffer(f,
l);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,f,l,0,d.RGBA,c.extTextureHalfFloat?c.extTextureHalfFloat.HALF_FLOAT_OES:d.UNSIGNED_BYTE,null);k.colorAttachment.set(a);return k}})},"com/huayun/webgis/utils/earcut":function(){define(["exports"],function(f){function c(a,b,c){c=c||2;var e=b&&b.length,g=e?b[0]*c:a.length,f=k(a,0,g,c,!0),p=[];if(!f||f.next===f.prev)return p;var q,t,x,y;if(e){var u=c,e=[],A,w,z;y=0;for(A=b.length;y<A;y++)w=b[y]*u,z=y<A-1?b[y+1]*u:a.length,w=k(a,w,z,u,!1),w===w.next&&(w.steiner=!0),
e.push(h(w));e.sort(m);for(y=0;y<e.length;y++){b=e[y];u=f;if(u=n(b,u))b=v(u,b),l(b,b.next);f=l(f,f.next)}}if(a.length>80*c){q=x=a[0];t=e=a[1];for(u=c;u<g;u+=c)y=a[u],b=a[u+1],y<q&&(q=y),b<t&&(t=b),y>x&&(x=y),b>e&&(e=b);x=Math.max(x-q,e-t);x=0!==x?1/x:0}d(f,p,c,q,t,x);return p}function k(a,b,c,d,e){var g;if(e===0<r(a,b,c,d))for(e=b;e<c;e+=d)g=z(e,a[e],a[e+1],g);else for(e=c-d;e>=b;e-=d)g=z(e,a[e],a[e+1],g);g&&q(g,g.next)&&(y(g),g=g.next);return g}function l(a,b){if(!a)return a;b||(b=a);var c;do if(c=
!1,a.steiner||!q(a,a.next)&&0!==e(a.prev,a,a.next))a=a.next;else{y(a);a=b=a.prev;if(a===a.next)break;c=!0}while(c||a!==b);return b}function d(c,h,f,k,m,n,u){if(c){if(!u&&n){var x=c,w=x;do null===w.z&&(w.z=g(w.x,w.y,k,m,n)),w.prevZ=w.prev,w=w.nextZ=w.next;while(w!==x);w.prevZ.nextZ=null;w.prevZ=null;var x=w,z,A,r,B,D,E,F=1;do{w=x;r=x=null;for(B=0;w;){B++;A=w;for(z=D=0;z<F&&(D++,A=A.nextZ,A);z++);for(E=F;0<D||0<E&&A;)0!==D&&(0===E||!A||w.z<=A.z)?(z=w,w=w.nextZ,D--):(z=A,A=A.nextZ,E--),r?r.nextZ=z:x=
z,z.prevZ=r,r=z;w=A}r.nextZ=null;F*=2}while(1<B)}for(x=c;c.prev!==c.next;){w=c.prev;A=c.next;if(n)r=a(c,k,m,n);else a:if(r=c,B=r.prev,D=r,F=r.next,0<=e(B,D,F))r=!1;else{for(z=r.next.next;z!==r.prev;){if(b(B.x,B.y,D.x,D.y,F.x,F.y,z.x,z.y)&&0<=e(z.prev,z,z.next)){r=!1;break a}z=z.next}r=!0}if(r)h.push(w.i/f),h.push(c.i/f),h.push(A.i/f),y(c),x=c=A.next;else if(c=A,c===x){if(!u)d(l(c),h,f,k,m,n,1);else if(1===u){u=h;x=f;w=c;do A=w.prev,r=w.next.next,!q(A,r)&&p(A,w,w.next,r)&&t(A,r)&&t(r,A)&&(u.push(A.i/
x),u.push(w.i/x),u.push(r.i/x),y(w),y(w.next),w=c=r),w=w.next;while(w!==c);c=w;d(c,h,f,k,m,n,2)}else if(2===u)a:{u=c;do{for(x=u.next.next;x!==u.prev;){if(w=u.i!==x.i){w=u;A=x;r=void 0;if(r=w.next.i!==A.i&&w.prev.i!==A.i){r=void 0;b:{r=w;do{if(r.i!==w.i&&r.next.i!==w.i&&r.i!==A.i&&r.next.i!==A.i&&p(r,r.next,w,A)){r=!0;break b}r=r.next}while(r!==w);r=!1}r=!r}B=void 0;if(B=r&&t(w,A)&&t(A,w)){r=w;B=!1;D=(w.x+A.x)/2;A=(w.y+A.y)/2;do r.y>A!==r.next.y>A&&r.next.y!==r.y&&D<(r.next.x-r.x)*(A-r.y)/(r.next.y-
r.y)+r.x&&(B=!B),r=r.next;while(r!==w)}w=B}if(w){c=v(u,x);u=l(u,u.next);c=l(c,c.next);d(u,h,f,k,m,n);d(c,h,f,k,m,n);break a}x=x.next}u=u.next}while(u!==c)}break}}}}function a(a,c,d,h){var f=a.prev,p=a.next;if(0<=e(f,a,p))return!1;var k=f.x>a.x?f.x>p.x?f.x:p.x:a.x>p.x?a.x:p.x,l=f.y>a.y?f.y>p.y?f.y:p.y:a.y>p.y?a.y:p.y,m=g(f.x<a.x?f.x<p.x?f.x:p.x:a.x<p.x?a.x:p.x,f.y<a.y?f.y<p.y?f.y:p.y:a.y<p.y?a.y:p.y,c,d,h);c=g(k,l,c,d,h);d=a.prevZ;for(h=a.nextZ;d&&d.z>=m&&h&&h.z<=c;){if(d!==a.prev&&d!==a.next&&b(f.x,
f.y,a.x,a.y,p.x,p.y,d.x,d.y)&&0<=e(d.prev,d,d.next))return!1;d=d.prevZ;if(h!==a.prev&&h!==a.next&&b(f.x,f.y,a.x,a.y,p.x,p.y,h.x,h.y)&&0<=e(h.prev,h,h.next))return!1;h=h.nextZ}for(;d&&d.z>=m;){if(d!==a.prev&&d!==a.next&&b(f.x,f.y,a.x,a.y,p.x,p.y,d.x,d.y)&&0<=e(d.prev,d,d.next))return!1;d=d.prevZ}for(;h&&h.z<=c;){if(h!==a.prev&&h!==a.next&&b(f.x,f.y,a.x,a.y,p.x,p.y,h.x,h.y)&&0<=e(h.prev,h,h.next))return!1;h=h.nextZ}return!0}function m(a,b){return a.x-b.x}function n(a,c){var d=c,e=a.x,g=a.y,h=-Infinity,
f;do{if(g<=d.y&&g>=d.next.y&&d.next.y!==d.y){var p=d.x+(g-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(p<=e&&p>h){h=p;if(p===e){if(g===d.y)return d;if(g===d.next.y)return d.next}f=d.x<d.next.x?d:d.next}}d=d.next}while(d!==c);if(!f)return null;if(e===h)return f.prev;c=f;for(var p=f.x,k=f.y,l=Infinity,m,d=f.next;d!==c;)e>=d.x&&d.x>=p&&e!==d.x&&b(g<k?e:h,g,p,k,g<k?h:e,g,d.x,d.y)&&(m=Math.abs(g-d.y)/(e-d.x),(m<l||m===l&&d.x>f.x)&&t(d,a)&&(f=d,l=m)),d=d.next;return f}function g(a,b,c,d,e){a=32767*(a-c)*e;b=32767*
(b-d)*e;a=(a|a<<8)&16711935;a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;b=(b|b<<8)&16711935;b=(b|b<<4)&252645135;b=(b|b<<2)&858993459;return(a|a<<1)&1431655765|((b|b<<1)&1431655765)<<1}function h(a){var b=a,c=a;do{if(b.x<c.x||b.x===c.x&&b.y<c.y)c=b;b=b.next}while(b!==a);return c}function b(a,b,c,d,e,g,h,f){return 0<=(e-h)*(b-f)-(a-h)*(g-f)&&0<=(a-h)*(d-f)-(c-h)*(b-f)&&0<=(c-h)*(g-f)-(e-h)*(d-f)}function e(a,b,c){return(b.y-a.y)*(c.x-b.x)-(b.x-a.x)*(c.y-b.y)}function q(a,b){return a.x===b.x&&a.y===b.y}
function p(a,b,c,d){return q(a,b)&&q(c,d)||q(a,d)&&q(c,b)?!0:0<e(a,b,c)!==0<e(a,b,d)&&0<e(c,d,a)!==0<e(c,d,b)}function t(a,b){return 0>e(a.prev,a,a.next)?0<=e(a,b,a.next)&&0<=e(a,a.prev,b):0>e(a,b,a.prev)||0>e(a,a.next,b)}function v(a,b){var c=new u(a.i,a.x,a.y),d=new u(b.i,b.x,b.y),e=a.next,g=b.prev;a.next=b;b.prev=a;c.next=e;e.prev=c;d.next=c;c.prev=d;g.next=d;d.prev=g;return d}function z(a,b,c,d){a=new u(a,b,c);d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a}function y(a){a.next.prev=
a.prev;a.prev.next=a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function u(a,b,c){this.i=a;this.x=b;this.y=c;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function r(a,b,c,d){for(var e=0,g=c-d;b<c;b+=d)e+=(a[g]-a[b])*(a[b+1]+a[g+1]),g=b;return e}c.deviation=function(a,b,c,d){var e=b&&b.length,g=Math.abs(r(a,0,e?b[0]*c:a.length,c));if(e)for(var e=0,h=b.length;e<h;e++)g-=Math.abs(r(a,b[e]*c,e<h-1?b[e+1]*c:a.length,c));for(e=b=0;e<d.length;e+=3){var h=
d[e]*c,f=d[e+1]*c,p=d[e+2]*c;b+=Math.abs((a[h]-a[p])*(a[f+1]-a[h+1])-(a[h]-a[f])*(a[p+1]-a[h+1]))}return 0===g&&0===b?0:Math.abs((b-g)/g)};c.flatten=function(a){for(var b=a[0][0].length,c={vertices:[],holes:[],dimensions:b},d=0,e=0;e<a.length;e++){for(var g=0;g<a[e].length;g++)for(var h=0;h<b;h++)c.vertices.push(a[e][g][h]);0<e&&(d+=a[e-1].length,c.holes.push(d))}return c};f.earcut=c})},"com/huayun/webgis/layers/Layer":function(){define([],function(){function f(c){c=void 0===c?{}:c;this.id=c.id||
"layer";this.opacity=void 0===c.opacity?1:c.opacity;this.visible=void 0===c.visible?!0:c.visible;this.selectEnabled=void 0===c.selectEnabled?!0:c.selectEnabled;this.controlEnabled=void 0===c.controlEnabled?!0:c.controlEnabled}f.prototype.createLayerView=function(c,f){throw Error("\u4e0d\u80fd\u8c03\u7528\u57fa\u7c7b\u7684createLayerView\u65b9\u6cd5");};f.prototype.refresh=function(){};f.prototype.setVisible=function(){};return f})},"com/huayun/webgis/geometry/Polygon":function(){define(["./Geometry",
"./Extent"],function(f,c){var k=function(c,a){f.call(this);this.type="polygon";this.path=c;this.spatialReference=a;this._area=this._extent=null};f&&(k.__proto__=f);k.prototype=Object.create(f&&f.prototype);k.prototype.constructor=k;var l={length:{configurable:!1},extent:{configurable:!1},area:{configurable:!1}};l.length.get=function(){return this.path.length};l.extent.get=function(){if(!this._extent){var d=this.path,a,f,k,g;a=k=d[0][0].x;f=g=d[0][0].y;for(var h=d.length,b=0;b<h;b++)for(var e=d[b],
l=e.length,p=0;p<l;p++){var t=e[p];a=Math.min(a,t.x);f=Math.min(f,t.y);k=Math.max(k,t.x);g=Math.max(g,t.y)}this._extent=new c(a,f,k,g)}return this._extent};l.area.get=function(){this._area||(this._area=this.calculateArea());return this._area};k.prototype={setPath:function(c){this.path=c;this._extent=null},addRing:function(c){this.path.push(c);this._extent=null},update:function(c,a){this.path.forEach(function(d){d.forEach(function(d){d.update(c,a)})});this._extent=null},calculateArea:function(){for(var c=
0,a=0,f=this.path,k=0;k<f.length;k++){for(var g=f[k],h=0;h<g.length-1;h++)c=.5*(g[h+1].x-g[h].x)*(g[h+1].y+g[h].y),a+=c;c=.5*(g[0].x-g[g.length-1].x)*(g[0].y+g[g.length-1].y);a+=c}return Math.abs(a)}};Object.defineProperties(k.prototype,l);return k})},"com/huayun/webgis/layers/support/funcUtils":function(){define(["exports","com/huayun/webgis/geometry/Point2D","./expression/Interpolate","custom/gl-matrix-min"],function(f,c,k,l){function d(b,c,e,g){if(!(e>=g)){for(var h=b[e+g>>1],f=e-1,p=g+1;;){do f++;
while(b[f]<h);do p--;while(b[p]>h);if(f>=p)break;a(b,f,p);a(c,3*f,3*p);a(c,3*f+1,3*p+1);a(c,3*f+2,3*p+2)}d(b,c,e,p);d(b,c,p+1,g)}}function a(a,b,c){var d=a[b];a[b]=a[c];a[c]=d}function m(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[4]*b+c[12];a[1]=c[1]*d+c[5]*b+c[13];a[3]=c[3]*d+c[7]*b+c[15];return a}function n(a,b,c,d){return a===q.horizontal&&Math.abs(c.y-b.y)>Math.abs(c.x-b.x)*d?{useVertical:!0}:(a===q.vertical?b.y<c.y:b.x>c.x)?{needsFlipping:!0}:null}function g(a,b){a=[a.x,a.y,0,1];m(a,a,b);b=a[3];
return{point:new c(a[0]/b,a[1]/b),signedDistanceFromCamera:b}}function h(a,d,e,h,f,k,l,m,q,n,B,D,E){var p=h?a-d:a+d;a=0<p?1:-1;d=0;h&&(a*=-1,d=Math.PI);0>a&&(d+=Math.PI);l=h=0<a?m+l:m+l+1;for(var t=f,y=0,v=0,p=Math.abs(p);y+v<=p;){h+=a;if(h<m||h>=q)return null;f=t;t=D[h];if(void 0===t){var t=new c(n.getx(h),n.gety(h)),u=g(t,B);0<u.signedDistanceFromCamera?t=D[h]=u.point:(u=h-a,u=0===y?k:new c(n.getx(u),n.gety(u)),t=b(u,t,f,p-y+1,B))}y+=v;v=f.dist(t)}m=(p-y)/v;k=t.sub(f);m=k.mult(m)._add(f);m._add(k._unit()._perp()._mult(e*
a));return{point:m,angle:d+Math.atan2(t.y-f.y,t.x-f.x),tileDistance:E?{prevTileDistance:h-a===l?0:n.gettileUnitDistanceFromAnchor(h-a),lastSegmentViewportDistance:p-y}:null}}function b(a,b,c,d,e){a=g(a.add(a.sub(b)._unit()),e).point;a=c.sub(a);return c.add(a._mult(d/a.mag()))}f.pick=function(a,b){for(var c={},d=0;d<b.length;d++){var e=b[d];e in a&&(c[e]=a[e])}return c};f.bindAll=function(a,b){a.forEach(function(a){b[a]&&(b[a]=b[a].bind(b))})};f.asyncAll=function(a,b,c){if(!a.length)return c(null,
[]);var d=a.length,e=Array(a.length),g=null;a.forEach(function(a,h){b(a,function(a,b){a&&(g=a);e[h]=b;0===--d&&c(g,e)})})};f.calculateKey=function(a,b,c,d){return b+"/"+c+"/"+d};f.now=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date);var e={"Latin-1 Supplement":function(a){return 128<=a&&255>=a},Arabic:function(a){return 1536<=a&&1791>=a},"Arabic Supplement":function(a){return 1872<=a&&1919>=a},"Arabic Extended-A":function(a){return 2208<=a&&2303>=
a},"Hangul Jamo":function(a){return 4352<=a&&4607>=a},"Unified Canadian Aboriginal Syllabics":function(a){return 5120<=a&&5759>=a},Khmer:function(a){return 6016<=a&&6143>=a},"Unified Canadian Aboriginal Syllabics Extended":function(a){return 6320<=a&&6399>=a},"General Punctuation":function(a){return 8192<=a&&8303>=a},"Letterlike Symbols":function(a){return 8448<=a&&8527>=a},"Number Forms":function(a){return 8528<=a&&8591>=a},"Miscellaneous Technical":function(a){return 8960<=a&&9215>=a},"Control Pictures":function(a){return 9216<=
a&&9279>=a},"Optical Character Recognition":function(a){return 9280<=a&&9311>=a},"Enclosed Alphanumerics":function(a){return 9312<=a&&9471>=a},"Geometric Shapes":function(a){return 9632<=a&&9727>=a},"Miscellaneous Symbols":function(a){return 9728<=a&&9983>=a},"Miscellaneous Symbols and Arrows":function(a){return 11008<=a&&11263>=a},"CJK Radicals Supplement":function(a){return 11904<=a&&12031>=a},"Kangxi Radicals":function(a){return 12032<=a&&12255>=a},"Ideographic Description Characters":function(a){return 12272<=
a&&12287>=a},"CJK Symbols and Punctuation":function(a){return 12288<=a&&12351>=a},Hiragana:function(a){return 12352<=a&&12447>=a},Katakana:function(a){return 12448<=a&&12543>=a},Bopomofo:function(a){return 12544<=a&&12591>=a},"Hangul Compatibility Jamo":function(a){return 12592<=a&&12687>=a},Kanbun:function(a){return 12688<=a&&12703>=a},"Bopomofo Extended":function(a){return 12704<=a&&12735>=a},"CJK Strokes":function(a){return 12736<=a&&12783>=a},"Katakana Phonetic Extensions":function(a){return 12784<=
a&&12799>=a},"Enclosed CJK Letters and Months":function(a){return 12800<=a&&13055>=a},"CJK Compatibility":function(a){return 13056<=a&&13311>=a},"CJK Unified Ideographs Extension A":function(a){return 13312<=a&&19903>=a},"Yijing Hexagram Symbols":function(a){return 19904<=a&&19967>=a},"CJK Unified Ideographs":function(a){return 19968<=a&&40959>=a},"Yi Syllables":function(a){return 40960<=a&&42127>=a},"Yi Radicals":function(a){return 42128<=a&&42191>=a},"Hangul Jamo Extended-A":function(a){return 43360<=
a&&43391>=a},"Hangul Syllables":function(a){return 44032<=a&&55215>=a},"Hangul Jamo Extended-B":function(a){return 55216<=a&&55295>=a},"Private Use Area":function(a){return 57344<=a&&63743>=a},"CJK Compatibility Ideographs":function(a){return 63744<=a&&64255>=a},"Arabic Presentation Forms-A":function(a){return 64336<=a&&65023>=a},"Vertical Forms":function(a){return 65040<=a&&65055>=a},"CJK Compatibility Forms":function(a){return 65072<=a&&65103>=a},"Small Form Variants":function(a){return 65104<=
a&&65135>=a},"Arabic Presentation Forms-B":function(a){return 65136<=a&&65279>=a},"Halfwidth and Fullwidth Forms":function(a){return 65280<=a&&65519>=a}};f.isChar=e;f.allowsLetterSpacing=function(a){for(var b=0;b<a.length;b+=1){var c=a[b].charCodeAt(0);if(e.Arabic(c)||e["Arabic Supplement"](c)||e["Arabic Extended-A"](c)||e["Arabic Presentation Forms-A"](c)||e["Arabic Presentation Forms-B"](c))return!1}return!0};f.charHasUprightVerticalOrientation=function(a){return 746===a||747===a?!0:4352>a?!1:e["Bopomofo Extended"](a)||
e.Bopomofo(a)||e["CJK Compatibility Forms"](a)&&!(65097<=a&&65103>=a)||e["CJK Compatibility Ideographs"](a)||e["CJK Compatibility"](a)||e["CJK Radicals Supplement"](a)||e["CJK Strokes"](a)||e["CJK Symbols and Punctuation"](a)&&!(12296<=a&&12305>=a||12308<=a&&12319>=a)&&12336!==a||e["CJK Unified Ideographs Extension A"](a)||e["CJK Unified Ideographs"](a)||e["Enclosed CJK Letters and Months"](a)||e["Hangul Compatibility Jamo"](a)||e["Hangul Jamo Extended-A"](a)||e["Hangul Jamo Extended-B"](a)||e["Hangul Jamo"](a)||
e["Hangul Syllables"](a)||e.Hiragana(a)||e["Ideographic Description Characters"](a)||e.Kanbun(a)||e["Kangxi Radicals"](a)||e["Katakana Phonetic Extensions"](a)||e.Katakana(a)&&12540!==a||e["Halfwidth and Fullwidth Forms"](a)&&!(65288===a||65289===a||65293===a||65306<=a&&65310>=a||65339===a||65341===a||65343===a||65371<=a&&65503>=a||65507===a||65512<=a&&65519>=a)||e["Small Form Variants"](a)&&!(65112<=a&&65118>=a||65123<=a&&65126>=a)||e["Unified Canadian Aboriginal Syllabics"](a)||e["Unified Canadian Aboriginal Syllabics Extended"](a)||
e["Vertical Forms"](a)||e["Yijing Hexagram Symbols"](a)||e["Yi Syllables"](a)||e["Yi Radicals"](a)?!0:!1};f.sort=d;f.swap=a;f.supportsPropertyExpression=function(a){return"data-driven"===a["property-type"]||"cross-faded-data-driven"===a["property-type"]};f.paintAttributeNames=function(a,b){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],
"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from"],"fill-pattern":["pattern_to","pattern_from"],"fill-extrusion-pattern":["pattern_to","pattern_from"]}[a]||[a.replace(b+"-","").replace(/-/g,"_")]};f.getLabelPlaneMatrix=function(a,b,c,d,e){var g=l.mat4.create();b?(l.mat4.scale(g,g,[1/e,1/e,1]),c||l.mat4.rotateZ(g,g,d.angle)):l.mat4.multiply(g,d.labelPlaneMatrix,a);return g};f.getGlCoordMatrix=
function(a,b,c,d,e){return b?(a=l.mat4.clone(a),l.mat4.scale(a,a,[e,e,1]),c||l.mat4.rotateZ(a,a,-d.angle),a):d.glCoordMatrix};f.translatePosMatrix=function(a,b,c,d,e,g,h){if(!c[0]&&!c[1])return a;if(g=e?"map"===d?g:0:"viewport"===d?-g:0)d=Math.sin(g),g=Math.cos(g),c=[c[0]*g-c[1]*d,c[0]*d+c[1]*g];h=[e?c[0]:pixelsToTileUnits(b,c[0],h),e?c[1]:pixelsToTileUnits(b,c[1],h),0];b=new Float32Array(16);c=h[0];e=h[1];h=h[2];var f,k,l,p,m,q,n,t,y,v;a===b?(b[12]=a[0]*c+a[4]*e+a[8]*h+a[12],b[13]=a[1]*c+a[5]*e+
a[9]*h+a[13],b[14]=a[2]*c+a[6]*e+a[10]*h+a[14],b[15]=a[3]*c+a[7]*e+a[11]*h+a[15]):(d=a[0],g=a[1],f=a[2],k=a[3],l=a[4],p=a[5],m=a[6],q=a[7],n=a[8],t=a[9],y=a[10],v=a[11],b[0]=d,b[1]=g,b[2]=f,b[3]=k,b[4]=l,b[5]=p,b[6]=m,b[7]=q,b[8]=n,b[9]=t,b[10]=y,b[11]=v,b[12]=d*c+l*e+n*h+a[12],b[13]=g*c+p*e+t*h+a[13],b[14]=f*c+m*e+y*h+a[14],b[15]=k*c+q*e+v*h+a[15]);return b};f.evaluateSizeForZoom=function(a,b){var c=0,d=0;if("constant"===a.kind)d=a.layoutSize;else if("source"!==a.kind){var e=a.interpolationType,
g=a.minZoom,h=a.maxZoom;e?(b=k.interpolationFactor(e,b,g,h),b=Math.min(1,Math.max(0,b))):b=0;"camera"===a.kind?d=a.minSize*(1-b)+a.maxSize*b:c=b}return{uSizeT:c,uSize:d}};f.xyTransformMat4=m;f.evaluateSizeForFeature=function(a,b,c){var d=b.uSizeT,e=c.lowerSize;c=c.upperSize;return"source"===a.kind?e/256:"composite"===a.kind?e/256*(1-d)+c/256*d:b.uSize};f.transformMat4=function(a,b,c){var d=b[0],e=b[1],g=b[2];b=b[3];a[0]=c[0]*d+c[4]*e+c[8]*g+c[12]*b;a[1]=c[1]*d+c[5]*e+c[9]*g+c[13]*b;a[2]=c[2]*d+c[6]*
e+c[10]*g+c[14]*b;a[3]=c[3]*d+c[7]*e+c[11]*g+c[15]*b;return a};var q={horizontal:1,vertical:2,horizontalOnly:3};f.placeGlyphsAlongLine=function(a,d,e,f,k,l,m,q,A,w,B,D,E,F){d/=24;var p=a.lineOffsetX*d,t=a.lineOffsetY*d;if(1<a.numGlyphs){k=a.glyphStartIndex+a.numGlyphs;var y=a.lineStartIndex,v=a.lineStartIndex+a.lineLength,u;var r=a.glyphStartIndex+a.numGlyphs;u=a.lineStartIndex;var x=a.lineStartIndex+a.lineLength,z=q.getoffsetX(a.glyphStartIndex),r=q.getoffsetX(r-1);u=(z=h(d*z,p,t,e,B,D,a.segment,
u,x,A,l,E,!1))?(u=h(d*r,p,t,e,B,D,a.segment,u,x,A,l,E,!1))?{first:z,last:u}:null:null;if(!u)return{notEnoughRoom:!0};x=g(u.first.point,m).point;m=g(u.last.point,m).point;if(f&&!e&&(F=n(a.writingMode,x,m,F)))return F;F=[u.first];for(f=a.glyphStartIndex+1;f<k-1;f++)F.push(h(d*q.getoffsetX(f),p,t,e,B,D,a.segment,y,v,A,l,E,!1));F.push(u.last)}else{if(f&&!e&&(y=g(D,k).point,v=a.lineStartIndex+a.segment+1,v=new c(A.getx(v),A.gety(v)),f=g(v,k),k=0<f.signedDistanceFromCamera?f.point:b(D,v,y,1,k),F=n(a.writingMode,
y,k,F)))return F;a=h(d*q.getoffsetX(a.glyphStartIndex),p,t,e,B,D,a.segment,a.lineStartIndex,a.lineStartIndex+a.lineLength,A,l,E,!1);if(!a)return{notEnoughRoom:!0};F=[a]}a=0;for(e=F;a<e.length;a+=1)A=e[a],l=w,q=A.point,A=A.angle,l.emplaceBack(q.x,q.y,A),l.emplaceBack(q.x,q.y,A),l.emplaceBack(q.x,q.y,A),l.emplaceBack(q.x,q.y,A);return{}}})},"com/huayun/webgis/geometry/Point2D":function(){define([],function(){function f(c,f){this.x=c;this.y=f;this.type="point"}f.prototype={clone:function(){return new f(this.x,
this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,f){return this.clone()._rotateAround(c,f)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},
perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var f=c.x-this.x;c=c.y-this.y;return f*f+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,
f){return Math.atan2(this.x*f-this.y*c,this.x*c+this.y*f)},_matMult:function(c){var f=c[2]*this.x+c[3]*this.y;this.x=c[0]*this.x+c[1]*this.y;this.y=f;return this},_add:function(c){this.x+=c.x;this.y+=c.y;return this},_sub:function(c){this.x-=c.x;this.y-=c.y;return this},_mult:function(c){this.x*=c;this.y*=c;return this},_div:function(c){this.x/=c;this.y/=c;return this},_multByPoint:function(c){this.x*=c.x;this.y*=c.y;return this},_divByPoint:function(c){this.x/=c.x;this.y/=c.y;return this},_unit:function(){this._div(this.mag());
return this},_perp:function(){var c=this.y;this.y=this.x;this.x=-c;return this},_rotate:function(c){var f=Math.cos(c);c=Math.sin(c);var l=c*this.x+f*this.y;this.x=f*this.x-c*this.y;this.y=l;return this},_rotateAround:function(c,f){var k=Math.cos(c);c=Math.sin(c);var d=f.y+c*(this.x-f.x)+k*(this.y-f.y);this.x=f.x+k*(this.x-f.x)-c*(this.y-f.y);this.y=d;return this},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}};f.convert=function(c){return c instanceof f?c:Array.isArray(c)?
new f(c[0],c[1]):c};return f})},"com/huayun/webgis/data/queryIntersectsEx":function(){define(["exports"],function(f){function c(a,c){var b=!1;if("point"===(Array.isArray(a)?a[0].type:a.type))a=Array.isArray(a)?a[0]:a;else{a=Array.isArray(a)?a[0].path[0]:a.path[0];for(var d=0,e=a.length-1;d<a.length;e=d++){var g=a[d],e=a[e];c.y=Array.isArray(c)?c[1]:c.y;c.x=Array.isArray(c)?c[0]:c.x;g.y>c.y!==e.y>c.y&&c.x<(e.x-g.x)*(c.y-g.y)/(e.y-g.y)+g.x&&(b=!b)}}return b}function k(a,c,d){var b,e;Array.isArray(a)?
b=a:e=a;Array.isArray(c)?b=c:e=c;Array.isArray(a)||Array.isArray(c)||l(a,c,d);return m(e,b[0])<d*d?!0:!1}function l(b,c,d){(Array.isArray(b)||Array.isArray(c))&&k(b,c,d);return a(b,c)<d*d?!0:!1}function d(a,c){if(0===a.length||0===c.length)return!1;for(var b=0;b<a.length-1;b++)for(var d=a[b],e=a[b+1],g=0;g<c.length-1;g++){var h=d,f=e,k=c[g],l=c[g+1];if(n(h,k,l)!==n(f,k,l)&&n(h,f,k)!==n(h,f,l))return!0}return!1}function a(a,c){var b=a.x-c[0];a=a.y-c[1];return b*b+a*a}function m(a,c){var b=a.x-c.x;
a=a.y-c.y;return b*b+a*a}function n(a,c,d){return(d[1]-a[1])*(c[0]-a[0])>(c[1]-a[1])*(d[0]-a[0])}function g(b,c,d){d*=d;if(1===c.length)return m(c[0],b)<d;for(var e=1;e<c.length;e++){var g;g=b;var h=c[e-1],f=c[e],k=(h[0]-f[0])*(h[0]-f[0])+(h[1]-f[1])*(h[1]-f[1]);if(0===k)g=a(g,h);else if(k=((g.x-h[0])*(f[0]-h[0])+(g.y-h[1])*(f[1]-h[1]))/k,0>k)g=a(g,h);else if(1<k)g=a(g,f);else{var l=[];l[0]=(f[0]-h[0])*k+h[0];l[1]=(f[1]-h[1])*k+h[1];g=a(g,l)}if(g<d)return!0}return!1}function h(a,c){for(var b=!1,d,
e,g,h=0;h<a.length;h++){d=a[h];var f=0;for(g=d.length-1;f<d.length;g=f++)e=d[f],g=d[g],e[1]>c.y!==g[1]>c.y&&c.x<(g[0]-e[0])*(c.y-e[1])/(g[1]-e[1])+e[0]&&(b=!b)}return b}f.lineex=function(a,e,h,f){e=e.paths;h=h.width*f/2;for(f=0;f<e.length;f++){for(var b=e[f],k=0;k<b.length;k++)if(c(a,b[k]))return!0;a:{var k=a,l=h;if(1<k.length){if(d(k,b)){k=!0;break a}for(var m=0;m<b.length;m++)if(g(b[m],k,l)){k=!0;break a}}for(m=0;m<k.length;m++)if(g(k[m],b,l)){k=!0;break a}k=!1}if(k)return!0}return!1};f.polygonex=
function(a,e){e=e.rings;if(1===a.length)return h(e,a[0]);for(var b=0;b<e.length;b++)for(var g=e[b],f=0;f<g.length;f++)if(c(a,g[f]))return!0;for(b=0;b<a.length;b++)if(h(e,a[b]))return!0;for(b=0;b<e.length;b++)if(d(a,e[b]))return!0;return!1};f.pointex=function(a,d,h,f,l,m){h=l*f;a=k(a,d,h)?!0:c(a,d)?!0:g(d,a,h)?!0:!1;if(a)return!0};f.multipointex=function(a,d,g,h,f){d=d.points;a=a[0];for(g=0;g<d.length;g++)if(h=d[g],l(a,h,f)||c(a,h,f))return!0;return!1}})},"com/huayun/webgis/core/base":function(){define(["custom/crypto-js.min"],
function(f){function c(a){return 10>a?"0"+a:a}if(dojoConfig&&dojoConfig.app){var k=dojoConfig.app.accessKey,l=dojoConfig.app.secretKey;if(k&&l){var d=f.enc.Utf8.parse("123456yrxo@kc6x3"),a=new Date,m=a.getFullYear()+c(a.getMonth()+1)+c(a.getDate());dojoConfig.token=function(a,c){a=f.enc.Utf8.parse(a+"+"+c+"+"+m);return f.AES.encrypt(a,d,{mode:f.mode.ECB,padding:f.pad.Pkcs7}).toString()}(k,l)}}})},"com/huayun/webgis/layers/TileLayer":function(){define("./Layer ../geometry/Extent ../views/3d/layers/TileLayerView3D ../geometry/Point ./support/TileSourceCache ./support/LOD ./support/TileInfo ../facade/TileFacade".split(" "),
function(f,c,k,l,d,a,m,n){var g=/(\/tile\/.+)/,h=function(a){f.call(this,a);this.id=a.id||"tileLayer";this.type="Tile";this.name=a.name||"\u9759\u6001\u80cc\u666f\u56fe";this.url=a.url;this.visible=void 0===a.visible?!0:a.visible;this.loaded=this.selectEnabled=!1;this.sourceCache=this.layerView=this.tileInfo=null;this.maxLevel=a.maxLevel};f&&(h.__proto__=f);h.prototype=Object.create(f&&f.prototype);h.prototype.constructor=h;h.prototype.createLayerView=function(a,c){c=new k({width:a.width,height:a.height,
opacity:this.opacity,visible:this.visible,view:a,id:this.id,layer:this});this._load(a);this.layerView=c;c.transform=a.viewpoint;return c};h.prototype._load=function(a){var b=this.url.replace(g,""),c=this.url.indexOf("?");-1<c?(c=this.url.substring(c),b=b+c+"\x26f\x3djson"):b+="?f\x3djson";var d=this;n.getTileInfoData(b,function(b,c){b?n.getTileInfoData(require.toUrl("com/huayun/webgis/layers/support/tileInfoData2385.json"),function(b,c){if(b)throw Error(b.message);d._resolve(a,c)}):d._resolve(a,c)})};
h.prototype._resolve=function(b,e){var g=e.tileInfo,h=g.origin,h=new l(h.x,h.y),f=[];e.lods.forEach(function(b){f.push(new a({level:b.level,scale:b.scale,resolution:b.resolution}))});e=e.fullExtent;e=new c(Number(e.xmin),Number(e.ymin),Number(e.xmax),Number(e.ymax));this.tileInfo=new m({lods:f,origin:h,size:g.cols,fullExtent:e});this.sourceCache=new d(this.id,{tileSize:this.tileInfo.size,type:"raster",minzoom:this.tileInfo.lods[0].level,maxzoom:this.tileInfo.lods[f.length-1].level},b.width,b.height,
this.url,this);b.setTileInfo(this.tileInfo)};h.prototype.refresh=function(){this.layerView.view.threeRender()};h.prototype.setVisible=function(a){this.visible=a;this.layerView.setVisible(a)};h.prototype.setUrl=function(a){this.url=a;this.sourceCache.updateTileUrl(a);a=this.sourceCache.getIds();var b=this.sourceCache;b.clearOtherLevel(this.layerView.view.viewpoint.level);for(var c=0;c<a.length;c+=1)b._reAddTile(a[c])};return h})},"com/huayun/webgis/layers/support/SourceFeatureState":function(){define(["../../utils/utils"],
function(f){var c=function(){this.state={};this.stateChanges={};this.deletedStates={}};c.prototype.updateState=function(c,l,d){for(var a=0;a<l.length;a++){var k=String(l[a]);this.stateChanges[c]=this.stateChanges[c]||{};this.stateChanges[c][k]=this.stateChanges[c][k]||{};f.extend(this.stateChanges[c][k],d);if(null===this.deletedStates[c]){this.deletedStates[c]={};for(var n in this.state[c])n!==k&&(this.deletedStates[c][n]=null)}else if(this.deletedStates[c]&&null===this.deletedStates[c][k]){this.deletedStates[c][k]=
{};for(var g in this.state[c][k])d[g]||(this.deletedStates[c][k][g]=null)}else for(var h in d)this.deletedStates[c]&&this.deletedStates[c][k]&&null===this.deletedStates[c][k][h]&&delete this.deletedStates[c][k][h]}};c.prototype.removeFeatureState=function(c,f,d){if(null!==this.deletedStates[c]){var a=String(f);this.deletedStates[c]=this.deletedStates[c]||{};if(d&&void 0!==f&&0<=f)null!==this.deletedStates[c][a]&&(this.deletedStates[c][a]=this.deletedStates[c][a]||{},this.deletedStates[c][a][d]=null);
else if(void 0!==f&&0<=f)if(this.stateChanges[c]&&this.stateChanges[c][a])for(d in this.deletedStates[c][a]={},this.stateChanges[c][a])this.deletedStates[c][a][d]=null;else this.deletedStates[c][a]=null;else this.deletedStates[c]=null}};c.prototype.getState=function(c,l){var d=String(l),d=f.extend({},(this.state[c]||{})[d],(this.stateChanges[c]||{})[d]);if(null===this.deletedStates[c])return{};if(this.deletedStates[c]){c=this.deletedStates[c][l];if(null===c)return{};for(var a in c)delete d[a]}return d};
c.prototype.initializeTileState=function(c,f){c.setFeatureState(this.state,f)};c.prototype.coalesceChanges=function(c,l){var d={},a;for(a in this.stateChanges){this.state[a]=this.state[a]||{};var k={},n;for(n in this.stateChanges[a])this.state[a][n]||(this.state[a][n]={}),f.extend(this.state[a][n],this.stateChanges[a][n]),k[n]=this.state[a][n];d[a]=k}for(var g in this.deletedStates){this.state[g]=this.state[g]||{};a={};if(null===this.deletedStates[g])for(var h in this.state[g])a[h]={},this.state[g][h]=
{};else for(var b in this.deletedStates[g]){if(null===this.deletedStates[g][b])this.state[g][b]={};else for(k=0,n=Object.keys(this.deletedStates[g][b]);k<n.length;k+=1)delete this.state[g][b][n[k]];a[b]=this.state[g][b]}d[g]=d[g]||{};f.extend(d[g],a)}this.stateChanges={};this.deletedStates={};if(0!==Object.keys(d).length)for(var e in c)c[e].setFeatureState(d,l)};return c})},"com/huayun/webgis/gl/members":function(){define(["exports","../utils/Constant","../utils/utils"],function(f,c,k){function l(a,
b){void 0===b&&(b=1);var d=0,g=0;a=a.map(function(a){var e=c.viewTypes[a.type].BYTES_PER_ELEMENT,h=d=k.align(d,Math.max(b,e)),f=a.components||1;g=Math.max(g,e);d+=e*f;return{name:a.name,type:a.type,components:f,offset:h}});var h=k.align(d,Math.max(g,b));return{members:a,size:h,alignment:b}}var d=l([{name:"a_pos",components:2,type:"Int16"}],4),a=l([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),m=l([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",
components:4,type:"Int16"}],4),n=l([{name:"a_pos",components:2,type:"Int16"}],4),g=l([{name:"a_pos",components:3,type:"Int16"}]);f.members=n.members;f.members$1=d.members;f.members$2=m.members;f.members$3=a.members;f.members$4=g.members;f.symbolLayoutAttributes=l([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]);f.dynamicLayoutAttributes=l([{name:"a_projected_pos",components:3,type:"Float32"}],4);f.posAttributes=l([{name:"a_pos",type:"Int16",components:2}]);
f.shaderOpacityAttributes=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];f.rasterBoundsAttributes=l([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);f.imageBoundsAttributes=l([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}])})},"com/huayun/webgis/gl/draw/drawRaster":function(){define("exports ../mode ../../geometry/Point ../Texture ../../utils/utils custom/gl-matrix-min".split(" "),function(f,c,k,
l,d,a){return function(a,f,g,h){g=a.view.context;var b=g.gl;f.getSource();for(var e=a.view.useProgram("raster"),k=c.StencilMode.disabled,l=c.ColorMode.alphaBlended,m=h.length&&h[0].overscaledZ,n=0;n<h.length;n+=1){var z=h[n],y=a.depthModeForSublayer(z.overscaledZ-m,c.DepthMode.ReadWrite,b.LESS),u=f.getTile(z),r=z.posMatrix;u.registerFadeDuration(300);var z=f.findLoadedParent(z,0),x;var A=u;x=z;var w=f,B=a.transform,D=d.now(),E=(D-A.timeAdded)/300,D=x?(D-x.timeAdded)/300:-1,w=w.getSource(),B=B.coveringZoomLevel({tileSize:w.tileSize,
roundZoom:w.roundZoom}),A=(B=!x||Math.abs(x.tileID.overscaledZ-B)>Math.abs(A.tileID.overscaledZ-B))&&A.refreshedUponExpiration?1:d.clamp(B?E:1-D,0,1);x=x?{opacity:1,mix:1-A}:{opacity:A,mix:0};1>x.opacity&&(a._fadeDirty=!0);E=A=void 0;D=b.LINEAR;g.activeTexture.set(b.TEXTURE0);u.texture.bind(D,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST);g.activeTexture.set(b.TEXTURE1);z?(z.texture.bind(D,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST),A=Math.pow(2,z.tileID.overscaledZ-u.tileID.overscaledZ),E=[u.tileID.canonical.x*
A%1,u.tileID.canonical.y*A%1]):u.texture.bind(D,b.CLAMP_TO_EDGE,b.LINEAR_MIPMAP_NEAREST);e.draw2(g,b.TRIANGLES,y,k,l,c.CullFaceMode.disabled,{u_matrix:r,u_tl_parent:E||[0,0],u_scale_parent:A||1,u_buffer_scale:1,u_fade_t:x.mix,u_opacity:x.opacity,u_image0:0,u_image1:1,u_brightness_low:0,u_brightness_high:1,u_saturation_factor:-0,u_contrast_factor:1,u_spin_weights:[1,0,0]},"tile",a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}}})},"com/huayun/webgis/utils/Resource":function(){define(["exports",
"dojo/Deferred"],function(f,c){function k(a,c){var b=new Image;b.setAttribute("crossorigin","anonymous");b.onload=function(){c(null,b)};b.onerror=function(){return c(Error("\u52a0\u8f7d\u56fe\u7247\u5931\u8d25, \u56fe\u7247\u5730\u5740\u662f: "+a))};b.src=a}function l(a,c){a.type="blob";return d(a,c)}function d(b,c){return!/^file:/.test(b.url)&&n&&g&&h&&g.prototype.hasOwnProperty("signal")?a(b,c):m(b,c)}function a(a,c){var b=new h,d=new g(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,
headers:a.headers,signal:b.signal}),e=!1;"json"===a.type&&d.headers.set("Accept","application/json");n(d).then(function(b){return b.ok?("blob"===a.type?b.blob():"arrayBuffer"===a.type?b.arrayBuffer():"json"===a.type?b.json():b.text()).then(function(a){e=!0;c(null,a)}).catch(function(a){return c(Error(a.message))}):c(Error(b.statusText+b.status+a.url))}).catch(function(a){c(Error(a.message))});return{cancel:function(){e||b.abort()}}}function m(a,c){var b=new XMLHttpRequest;b.open(a.method||"GET",a.url,
!0);"arrayBuffer"===a.type&&(b.responseType="arraybuffer");"blob"===a.type&&(b.responseType="blob");for(var d in a.headers)b.setRequestHeader(d,a.headers[d]);"json"===a.type&&b.setRequestHeader("Accept","application/json");b.withCredentials="include"===a.credentials;b.onerror=function(){c(Error(b.statusText))};b.onload=function(){if((200<=b.status&&300>b.status||0===b.status)&&null!==b.response){var d=b.response;if("json"===a.type)try{d=JSON.parse(b.response)}catch(v){return c(v)}c(null,d)}else c(Error(b.statusText+
b.status+a.url))};b.send(a.body);return{cancel:function(){return b.abort()}}}var n=self?self.fetch:window.fetch,g=self?self.Request:window.Request,h=self?self.AbortController:window.AbortController;f.loadImage=function(a,c,d){return"function"===typeof c?k(a,c):c&&(c.headers||"POST"===c.method)?(c.url=a,l(c,function(b,c){if(b)d(b);else if(c){var e=new Image,g=g||webkitURL;e.onload=function(){d(null,e);g.revokeObjectURL(e.src)};e.onerror=function(){return d(Error("\u52a0\u8f7d\u56fe\u7247\u5931\u8d25, \u56fe\u7247\u5730\u5740\u662f: "+
a))};e.src=g.createObjectURL(c)}})):k(a,d)};f.loadImagePromise=function(a,d){var b=new c;if(d&&(d.headers||"POST"===d.method))return d.url=a,l(d,function(c,d){if(c)b.reject(c);else if(d){var e=new Image,g=g||webkitURL;e.onload=function(){b.resolve(e);g.revokeObjectURL(e.src)};e.onerror=function(){return b.reject(Error("\u52a0\u8f7d\u56fe\u7247\u5931\u8d25, \u56fe\u7247\u5730\u5740\u662f: "+a))};e.src=g.createObjectURL(d)}}),b;k(a,function(a,c){a?b.reject(a):c&&b.resolve(c)});return b};f.loadJson=
function(a,c,g){if("function"===typeof c)return d({url:a,type:"json"},c);c||(c={});c.url=a;c.type="json";return d(c,g)};f.loadArrayBuffer=function(a,c,g){if("function"===typeof c)return d({url:a,type:"arrayBuffer"},c);c||(c={});c.url=a;c.type="arrayBuffer";return d(c,g)}})},"com/huayun/webgis/symbols/ImageSymbol":function(){define(["dojo/topic","custom/gl-matrix-min","./BaseSymbol"],function(f,c,k){var l=function(d){k.call(this,d);this.type="image";var a=d.opacity||1,l=d.size||1,n=void 0===d.isRotate?
!1:d.isRotate,g=void 0===d.rotateRadian?0:d.rotateRadian;this.used=this.loaded=!1;this.width=d.width;this.height=d.height;this.angle=d.angle||0;this.dx=d.dx||0;this.dy=d.dy||0;this.offset=void 0===d.offset?[0,0]:d.offset;var h=c.mat4.create();this.uniforms={u_size:l,u_pitch_with_map:0,u_opacity:a,u_texture:0,u_rotate_symbol:n,u_radian:g,u_modelMatrix:h};var b=new Image;b.setAttribute("crossorigin","anonymous");b.onload=function(a){this.loaded=!0;this.image=b;this.uniforms.u_texsize=[this.width,this.height];
this.used&&f.publish("threeRender")}.bind(this);b.src=d.url};k&&(l.__proto__=k);l.prototype=Object.create(k&&k.prototype);return l.prototype.constructor=l})},"com/huayun/webgis/geometry/MapPoint":function(){define(["dojo/_base/declare","./Geometry"],function(f,c){return f("com.huayun.webgis.geometry.MapPoint",[c],{constructor:function(c,f,d){this.x=c;this.y=f;this.z=d;this.type="point"},toString:function(){return"x: "+this.x+" y: "+this.y+"z: "+this.z}})})},"com/huayun/webgis/geometry/Point":function(){define(["./Geometry",
"./Extent"],function(f,c){var k=function(c,a,k,l){f.call(this);Array.isArray(c)?(this.x=c[0],this.y=c[1],this.z=c[2]):(this.x=c,this.y=a,this.z=k);this.hasZ=void 0===this.z;this.type="point";this.spatialReference=l};f&&(k.__proto__=f);k.prototype=Object.create(f&&f.prototype);k.prototype.constructor=k;k.prototype={clone:function(){return new k(this.x,this.y,this.z)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},
divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},radianJS:function(c){return Math.atan2(-(c.y-this.y),c.x-this.x)},rotateAround:function(c,a){return this.clone()._rotateAround(c,a)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},
mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var a=c.x-this.x;c=c.y-this.y;return a*a+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,a){return Math.atan2(this.x*a-this.y*c,this.x*c+this.y*a)},_matMult:function(c){var a=
c[2]*this.x+c[3]*this.y;this.x=c[0]*this.x+c[1]*this.y;this.y=a;return this},_add:function(c){this.x+=c.x;this.y+=c.y;return this},_sub:function(c){this.x-=c.x;this.y-=c.y;return this},_mult:function(c){this.x*=c;this.y*=c;return this},_div:function(c){this.x/=c;this.y/=c;return this},_multByPoint:function(c){this.x*=c.x;this.y*=c.y;return this},_divByPoint:function(c){this.x/=c.x;this.y/=c.y;return this},_unit:function(){this._div(this.mag());return this},_perp:function(){var c=this.y;this.y=this.x;
this.x=-c;return this},_rotate:function(c){var a=Math.cos(c);c=Math.sin(c);var d=c*this.x+a*this.y;this.x=a*this.x-c*this.y;this.y=d;return this},_rotateAround:function(c,a){var d=Math.cos(c);c=Math.sin(c);var f=a.y+c*(this.x-a.x)+d*(this.y-a.y);this.x=a.x+d*(this.x-a.x)-c*(this.y-a.y);this.y=f;return this},_round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},radian:function(c){return Math.atan2(c.y-this.y,c.x-this.x)},calculateOtherPoint:function(c,a){return new k(Math.cos(a)*
c+this.x,Math.sin(a)*c+this.y)},interpolate:function(c,a){return new k(this.x*a+c.x*(1-a),this.y*a+c.y*(1-a))},calculateOtherPoint2:function(c,a){c=Math.atan2(c.y-this.y,c.x-this.x);return new k(this.x-a*Math.sin(c),this.y+a*Math.cos(c))},calculateOtherPoint3:function(c,a){c=Math.atan2(c.y-this.y,c.x-this.x);return new k(this.x+a*Math.sin(c),this.y-a*Math.cos(c))}};k.prototype.update=function(c,a,f){this.x+=c;this.y+=a;f&&(this.z+=f)};k.convert=function(c){return c instanceof k?c:Array.isArray(c)?
new k(c[0],c[1]):c};var l={extent:{configurable:!1}};l.extent.get=function(){this._extent||(this._extent=new c(this.x,this.y,this.x,this.y));return this._extent};Object.defineProperties(k.prototype,l);return k})},"com/huayun/webgis/Map":function(){define(["./core/base","../core/EventEmitter","./utils/extendClazz","./layers/Layer"],function(f,c,k,l){function d(a){this.id=a&&a.id?a.id:"map";this.allLayers=[]}k(d,c);d.prototype.addLayer=function(a){if(!(a instanceof l))throw Error("\u6dfb\u52a0\u7684\u5fc5\u987b\u662f\u56fe\u5c42\u7c7b\u578b");
for(var c=0,d=this.allLayers.length;c<d;c++)if(this.allLayers[c].id===a.id)throw Error("\u56fe\u5c42id\u5fc5\u987b\u552f\u4e00.");this.allLayers.push(a);this.emit("addLayers",[a])};d.prototype.addLayers=function(a){for(var c=0,d=a.length;c<d;c++){var g=a[c];if(!(g instanceof l))throw Error("\u6dfb\u52a0\u7684\u5fc5\u987b\u662f\u56fe\u5c42\u7c7b\u578b");for(var f=0,b=this.allLayers.length;f<b;f++)if(this.allLayers[f].id===g.id)throw Error("\u56fe\u5c42id\u5fc5\u987b\u552f\u4e00.");this.allLayers.push(g)}this.emit("addLayers",
a)};d.prototype.addLayerBefore=function(a,c){if(!(a instanceof l))throw Error("\u6dfb\u52a0\u7684\u5fc5\u987b\u662f\u56fe\u5c42\u7c7b\u578b");for(var d=-1,g=this.allLayers.length-1;-1<g;g--){if(this.allLayers[g].id===a.id)throw Error("\u56fe\u5c42id\u5fc5\u987b\u552f\u4e00.");if(this.allLayers[g].id===c){d=g;break}}if(-1<d)this.allLayers.splice(d,0,a),this.emit("addLayers",[a],c,d);else throw Error("\u76ee\u6807layer\u4e0d\u5b58\u5728, \u65e0\u6cd5\u653e\u7f6e\u5230\u5b83\u4e4b\u524d!");};d.prototype.removeLayerById=
function(a){for(var c=this.allLayers.length-1;-1<c;c--)if(this.allLayers[c].id===a)return this.allLayers.splice(c,1),this.emit("removeLayers",[a]),!0;return!1};d.prototype.findAllLayers=function(){return this.allLayers};d.prototype.findLayerById=function(a){for(var c=this.allLayers.length-1;-1<c;c--)if(this.allLayers[c].id===a)return this.allLayers[c];return null};d.prototype.refresh=function(){};d.prototype.clear=function(){this.allLayers.forEach(function(a){a.clear()});this.allLayers=[]};return d})},
"com/huayun/webgis/symbols/CircleSymbol":function(){define(["./Symbol","../utils/Color"],function(f,c){var k=function(k){f.call(this,k);this.type="circle";var d=c.parse(k.color||k.fill||"#FF0000"),a=k.opacity||1,l=c.parse(k.strokeColor||k.stroke||"#FFFFFF"),n=k.strokeOpacity||1;this.radius=Number(k.radius||k.r||5);this.strokeWidth=Number(k.strokeWidth||k["stroke-width"]||0);this.pitchWithMap=!!k.pitchWithMap;this.scaleWithPitch=!!k.scaleWithPitch;this.dx=Number(k.dx||0);this.dy=Number(k.dy||0);this.angle=
Number(k.angle||0);this.color=[d.r,d.g,d.b,d.a];this.strokeColor=[l.r,l.g,l.b,l.a];this.uniforms={color:this.color,opacity:a,u_device_pixel_ratio:1,u_pitch_with_map:this.pitchWithMap,u_scale_with_map:this.scaleWithPitch,blur:0,stroke_color:this.strokeColor,stroke_width:this.strokeWidth,stroke_opacity:n,radius:this.radius,u_radian:0}};f&&(k.__proto__=f);k.prototype=Object.create(f&&f.prototype);k.prototype.constructor=k;k.prototype.setRadius=function(c){this.radius=c;this.uniforms.radius=c};k.prototype.setStrokeWidth=
function(c){this.uniforms.stroke_width=c};return k})},"com/huayun/webgis/utils/Color":function(){define([],function(){function f(a){a=Math.round(a);return 0>a?0:255<a?255:a}function c(a){return 0>a?0:1<a?1:a}function k(a){return"%"===a[a.length-1]?f(parseFloat(a)/100*255):f(parseInt(a))}function l(a){return"%"===a[a.length-1]?c(parseFloat(a)/100):c(parseFloat(a))}function d(a,c,b){0>b?b+=1:1<b&&--b;return 1>6*b?a+(c-a)*b*6:1>2*b?c:2>3*b?a+(c-a)*(2/3-b)*6:a}function a(a){a=a.replace(/ /g,"").toLowerCase();
if(a in m)return m[a].slice();if("#"===a[0])return 4===a.length?(a=parseInt(a.substr(1),16),0<=a&&4095>=a?[(a&3840)>>4|(a&3840)>>8,a&240|(a&240)>>4,a&15|(a&15)<<4,1]:null):7===a.length?(a=parseInt(a.substr(1),16),0<=a&&16777215>=a?[(a&16711680)>>16,(a&65280)>>8,a&255,1]:null):null;if("0x"===a.substr(0,2))return 5===a.length?(a=parseInt(a.substr(2),16),0<=a&&4095>=a?[(a&3840)>>4|(a&3840)>>8,a&240|(a&240)>>4,a&15|(a&15)<<4,1]:null):8===a.length?(a=parseInt(a.substr(2),16),0<=a&&16777215>=a?[(a&16711680)>>
16,(a&65280)>>8,a&255,1]:null):null;var c=a.indexOf("("),b=a.indexOf(")");if(-1!==c&&b+1===a.length){var e=a.substr(0,c),c=a.substr(c+1,b-(c+1)).split(",");a=1;switch(e){case "rgba":if(4!==c.length)return null;a=l(c.pop());case "rgb":return 3!==c.length?null:[k(c[0]),k(c[1]),k(c[2]),a];case "hsla":if(4!==c.length)return null;a=l(c.pop());case "hsl":if(3!==c.length)return null;e=(parseFloat(c[0])%360+360)%360/360;b=l(c[1]);c=l(c[2]);b=.5>=c?c*(b+1):c+b-c*b;c=2*c-b;return[f(255*d(c,b,e+1/3)),f(255*
d(c,b,e)),f(255*d(c,b,e-1/3)),a];default:return null}}a=a.split(",");return 3===a.length?[k(a[0]),k(a[1]),k(a[2]),1]:4===a.length?[k(a[0]),k(a[1]),k(a[2]),l(a[3])]:null}var m={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],
cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,
150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,
128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,
211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,
104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,
1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,
1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]},n=function(a,c,b,d){void 0===d&&(d=1);this.r=a;this.g=c;this.b=b;this.a=d};n.parse=function(c){if(c){if(c instanceof n)return c;if(c instanceof Array)return new n(c[0],
c[1],c[2],c[3]);if("string"===typeof c&&(c=a(c)))return new n(c[0]/255*c[3],c[1]/255*c[3],c[2]/255*c[3],c[3])}};n.prototype.toString=function(){var a=this.toArray();return"rgba("+Math.round(a[0])+","+Math.round(a[1])+","+Math.round(a[2])+","+a[3]+")"};n.prototype.toArray=function(){var a=this.r,c=this.g,b=this.b,d=this.a;return 0===d?[0,0,0,0]:[255*a/d,255*c/d,255*b/d,d]};n.black=new n(0,0,0,1);n.white=new n(1,1,1,1);n.transparent=new n(0,0,0,0);n.red=new n(1,0,0,1);return n})},"com/huayun/webgis/layers/support/UnitBezier":function(){define([],
function(){function f(c,f,l,d){this.cx=3*c;this.bx=3*(l-c)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*f;this.by=3*(d-f)-this.cy;this.ay=1-this.cy-this.by;this.p1x=c;this.p1y=d;this.p2x=l;this.p2y=d}f.prototype.sampleCurveX=function(c){return((this.ax*c+this.bx)*c+this.cx)*c};f.prototype.sampleCurveY=function(c){return((this.ay*c+this.by)*c+this.cy)*c};f.prototype.sampleCurveDerivativeX=function(c){return(3*this.ax*c+2*this.bx)*c+this.cx};f.prototype.solveCurveX=function(c,f){"undefined"===typeof f&&
(f=1E-6);var k,d,a,m;a=c;for(k=0;8>k;k++){m=this.sampleCurveX(a)-c;if(Math.abs(m)<f)return a;d=this.sampleCurveDerivativeX(a);if(1E-6>Math.abs(d))break;a-=m/d}k=0;d=1;a=c;if(a<k)return k;if(a>d)return d;for(;k<d;){m=this.sampleCurveX(a);if(Math.abs(m-c)<f)break;c>m?k=a:d=a;a=.5*(d-k)+k}return a};f.prototype.solve=function(c,f){return this.sampleCurveY(this.solveCurveX(c,f))};return f})},"com/huayun/webgis/layers/support/LOD":function(){define([],function(){function f(c){this.level=c.level;this.scale=
c.scale;this.resolution=c.resolution}f.prototype.toString=function(){return"level: "+this.level+" scale: "+this.scale+" resolution: "+this.resolution};return f})},"com/huayun/webgis/renderer/LineRenderer":function(){define("./Renderer ../geometry/Point ../data/bucket/LineBucketSimplify ../gl/mode ../gl/programAttributes ../gl/programCache".split(" "),function(f,c,k,l,d,a){function m(){}f&&(m.__proto__=f);m.prototype=Object.create(f&&f.prototype);m.prototype.constructor=m;var n=function(a,b,c){c=c.uniforms;
b=b.position;c.u_matrix=a.viewpoint.getMatrixForPoint(b[0],b[1],!1,!1,b[2]||0);c.u_units_to_pixels=[a.viewpoint.width/2,-a.viewpoint.height/2];c.u_ratio=1/a.viewpoint.resolution;return c},g=function(a,b,c,d){var e=1/a.resolution,g=c.uniforms;b=b.position;var f="round"===c.cap;c=a.lineAtlas.getDash(d.from,f);d=a.lineAtlas.getDash(d.to,f);var f=2*c.width,h=1*d.width;g.u_matrix=a.viewpoint.getMatrixForPoint(b[0],b[1],!1,!1,b[2]||0);g.u_units_to_pixels=[a.viewpoint.width/2,-a.viewpoint.height/2];g.u_ratio=
e;g.u_image=0;g.u_patternscale_a=[e/f,-c.height/2];g.u_patternscale_b=[e/h,-d.height/2];g.u_sdfgamma=a.lineAtlas.width/(256*Math.min(f,h))/2;g.u_tex_y_a=c.y;g.u_tex_y_b=d.y;return g};m.prototype.add=function(a,b,c,d){if(a.ground)for(var e=c.path[0],g=0;g<e.length;g++){var f=e[g];if(f.base)if(f.base.posMidified)f.z+=f.base.z,f.base=null;else{b.needAdd=!0;a.threeRender();return}}b.needAdd=!1;g=b.position||a.viewpoint.center||[0,0];e=g[0];g=g[1];if("multipolygon"===c.type){for(var f=[],h=0;h<c.polygons.length;h++){var k=
this._addOnePathFeature(c.polygons[h],a,b,d,e,g);f.push(k)}b.buckets.push(f)}else k=this._addOnePathFeature(c,a,b,d,e,g),b.buckets.push(k);b.position=[e,g,0]};m.prototype._addOnePathFeature=function(a,b,d,g,f,l){d=a.path;a=[];for(var e=0;e<d.length;e++){for(var h=d[e],m=[],p=new c(-1,-1),n=0;n<h.length;n++){var q=h[n];p.equals(q)||(m.push(new c(q.x-f,q.y-l,q.z)),p=q)}a.push(m)}f=new k;f.addFeature(a,g.join,g.cap,2,1.05);f.upload(b.context);return f};m.prototype.draw=function(c,b,e,f,k,m,v){if(b.needAdd||
0===b.buckets.length)if(this.add(c,b,e,f),b.needAdd)return;void 0===m&&(m=0);var h=c.context,p=h.gl,q;q=k?k.depthModeForSublayer(0,l.DepthMode.ReadWrite):new l.DepthMode(p.LEQUAL,l.DepthMode.ReadWrite,[.9,.9]);var r=l.ColorMode.alphaBlended;k=b.buckets;var t=f.dasharray;t&&(h.activeTexture.set(p.TEXTURE0),c.lineAtlas.bind(h));var A=a.useProgramSimplify(h,t?"basicLineSDF":"myline",d.basicLine),w=t?g(c,b,f,t):n(c,b,f);v||(c=f.width*this.getRealScale(f.fixed,c.scale,f.minScale),w.u_width=1>c?1:c);w.u_color=
f.color;f=k[m];"multipolygon"===e.type?f.forEach(function(a,c){A.draw(h,p.TRIANGLES,q,null,r,l.CullFaceMode.disabled,w,b.id+"-line"+m+"-"+c,a.layoutVertexBuffer,a.indexBuffer,a.segments)}):A.draw(h,p.TRIANGLES,q,null,r,l.CullFaceMode.disabled,w,b.id+"-line"+m,f.layoutVertexBuffer,f.indexBuffer,f.segments)};m.prototype.drawGlow=function(c,b,e,f,k,m,v){if(e=b.glow){void 0===m&&(m=0);var h=c.context,p=h.gl;k=k?k.depthModeForSublayer(0,l.DepthMode.ReadWrite):new l.DepthMode(p.LEQUAL,l.DepthMode.ReadWrite,
[.9,.9]);var q=l.ColorMode.alphaBlended,r=b.buckets,t=f.dasharray;t&&(h.activeTexture.set(p.TEXTURE0),c.lineAtlas.bind(h));var A=a.useProgramSimplify(h,t?"basicLineSDF":"basicLine",d.basicLine),t=t?g(c,b,f,t):n(c,b,f);v||(c=f.width*this.getRealScale(f.fixed,c.scale,f.minScale),t.u_width=1>c?1:c);c=r[m];t.u_color=e.color;A.draw(h,p.TRIANGLES,k,null,q,l.CullFaceMode.disabled,t,b.id+"-line"+m,c.layoutVertexBuffer,c.indexBuffer,c.segments)}};m.prototype.calculateExtent=function(a,b,c,d,g,f){a=c.extent;
g.push({id:b.id,g:b,minX:a.xmin,minY:a.ymin,maxX:a.xmax,maxY:a.ymax,symbol:d})};return m})},"com/huayun/webgis/data/captureIntersects":function(){define(["exports","../utils/utils","custom/gl-matrix-min"],function(f,c,k){function l(a,c){for(var d=!1,g=0,f=a.length-1;g<a.length;f=g++){var b=a[g],f=a[f];b.y>c.y!==f.y>c.y&&c.x<(f.x-b.x)*(c.y-b.y)/(f.y-b.y)+b.x&&(d=!d)}return d}function d(a,c,d){d*=d;if(1===c.length)return a.distSqr(c[0])<d;for(var g=1;g<c.length;g++){var f;f=a;var b=c[g-1],e=c[g],k=
b.distSqr(e);0===k?f=f.distSqr(b):(k=((f.x-b.x)*(e.x-b.x)+(f.y-b.y)*(e.y-b.y))/k,f=0>k?f.distSqr(b):1<k?f.distSqr(e):f.distSqr(e.sub(b)._mult(k)._add(b)));if(f<d)return!0}return!1}f.point=function(a,f,n,g,h,b){var e;g=n.uniforms.u_matrix;e=k.mat4.identity([]);k.mat4.translate(e,e,[1,1,0]);k.mat4.scale(e,e,[.5*b.width,.5*b.height,1]);e=k.mat4.multiply(e,e,g);var m=n.strokeWidth||0;h=n.captureRadius||15;a=(g=n.pitchWithMap)?a:c.projectQueryGeometry(a,e);m=h+m;h=g?f:c.projectPoint(f,e);f=k.vec4.transformMat4([],
[f.x,f.y,0,1],e);!n.scaleWithPitch&&g?m*=f[3]/b.cameraToCenterDistance:n.scaleWithPitch&&!g&&(m*=b.cameraToCenterDistance/f[3]);n=m;n=l(a,h)?!0:d(h,a,n)?!0:!1;if(n)return!0};f.line=function(a,f,k,g,h,b,e){f=f.path;h=(k.width+e||4)*g/2;for(k=0;k<f.length;k++){b=f[k];if(3<=a.length)for(g=0;g<b.length;g++)if(l(a,b[g]))return!0;a:{g=a;e=h;if(1<g.length){var m;b:{m=g;var p=b;if(0!==m.length&&0!==p.length)for(var n=0;n<m.length-1;n++)for(var v=m[n],z=m[n+1],y=0;y<p.length-1;y++){var u=v,r=z,x=p[y],A=p[y+
1];if(c.isCounterClockwise(u,x,A)!==c.isCounterClockwise(r,x,A)&&c.isCounterClockwise(u,r,x)!==c.isCounterClockwise(u,r,A)){m=!0;break b}}m=!1}if(m){g=!0;break a}for(m=0;m<b.length;m++)if(d(b[m],g,e)){g=!0;break a}}for(m=0;m<g.length;m++)if(d(g[m],b,e)){g=!0;break a}g=!1}if(g)return!0}return!1}})},"com/huayun/webgis/Graphic":function(){define(["./utils/Color"],function(f){function c(c){this.id=void 0===c.id?k++:c.id;this.feature=c.feature;this.layer=c.layer;this.symbol=c.symbol;this.position=null;
this.visible=void 0===c.visible?!0:c.visible;this.selectEnabled=void 0===c.selectEnabled?!0:c.selectEnabled;this._glow=null;this.buckets=[];this.isChangeSymbol=!0;this.renderer=c.renderer?c.renderer:null}var k=0;c.prototype.setVisible=function(c){this.visible=value};c.prototype.updatePosition=function(c,a,f){this.position[0]+=c;this.position[1]+=a;f&&(this.position[2]+=f)};c.prototype.updateGeometry=function(c,a){this.layer.indexNeedUpdate=!0;this.feature.geometry.update(c,a)};c.prototype.getAttribute=
function(c){return this.feature.attributes.find(function(a){return a.name&&a.name.toLowerCase()===c.toLowerCase()})};c.prototype.updateSymbol=function(c){this.symbol=c;this.layer.layerView.view.threeRender()};c.prototype.reset=function(){var c=this.buckets;c&&c.forEach(function(a){a.destroy()});this.buckets=[]};c.prototype.destroy=function(){this.buckets.forEach(function(c){c.destroy()});this.buckets=[]};var l={glow:{configurable:!0}};l.glow.set=function(c){c&&c.color?(this._glow=c,c=f.parse(c.color),
this._glow.color=[c.r,c.g,c.b,c.a]):this._glow=null};l.glow.get=function(){return this._glow};Object.defineProperties(c.prototype,l);return c})},"com/huayun/webgis/geometry/Anchor":function(){define(["../geometry/Point"],function(f){return function(c){function f(f,d,a,k){c.call(this,f,d);this.angle=a;void 0!==k&&(this.segment=k)}c&&(f.__proto__=c);f.prototype=Object.create(c&&c.prototype);f.prototype.constructor=f;f.prototype.clone=function(){return new f(this.x,this.y,this.angle,this.segment)};return f}(f)})},
"com/huayun/webgis/data/bucket/SymbolBucket":function(){define("../ArrayType ../../gl/SegmentVector ../../gl/programConfig ../../gl/dataTransfer ../../gl/members ../../geometry/Point2D ../../layers/support/EvaluationParameters ../../layers/support/expression/Formatted ../../utils/utils ../../utils/Constant".split(" "),function(f,c,k,l,d,a,m,n,g,h){function b(a,b,c){a.sections.forEach(function(a){var d=b.layout.get("text-transform").evaluate(c,{});"uppercase"===d?a.text=a.text.toLocaleUpperCase():
"lowercase"===d&&(a.text=a.text.toLocaleLowerCase())});return a}function e(a,b){var c=b.expression;if("constant"===c.kind)return{kind:"constant",layoutSize:c.evaluate(new m(a+1))};if("source"===c.kind)return{kind:"source"};var d=c.zoomStops;b=c.interpolationType;for(var e=0;e<d.length&&d[e]<=a;)e++;for(var g=e=Math.max(0,e-1);g<d.length&&d[g]<a+1;)g++;g=Math.min(d.length-1,g);a=d[e];d=d[g];if("composite"===c.kind)return{kind:"composite",minZoom:a,maxZoom:d,interpolationType:b};g=c.evaluate(new m(a));
c=c.evaluate(new m(d));return{kind:"camera",minZoom:a,maxZoom:d,minSize:g,maxSize:c,interpolationType:b}}function q(a,b,c,d,e,g,f,h){a.emplaceBack(b,c,Math.round(32*d),Math.round(32*e),g,f,h?h[0]:0,h?h[1]:0)}function p(a,b,c){a.emplaceBack(b.x,b.y,c);a.emplaceBack(b.x,b.y,c);a.emplaceBack(b.x,b.y,c);a.emplaceBack(b.x,b.y,c)}function t(a){function b(a,b,c){var d=g[a];delete g[a];g[b]=d;f[d].geometry[0].pop();f[d].geometry[0]=f[d].geometry[0].concat(c[0]);return d}function c(a,b,c){var d=e[b];delete e[b];
e[a]=d;f[d].geometry[0].shift();f[d].geometry[0]=c[0].concat(f[d].geometry[0]);return d}function d(a,b,c){b=c?b[0][b[0].length-1]:b[0][0];return a+":"+b.x+":"+b.y}for(var e={},g={},f=[],h=0,k=0;k<a.length;k++){var l=a[k],m=l.geometry;if(l=l.text?l.text.toString():null){var p=d(l,m),n=d(l,m,!0);if(p in g&&n in e&&g[p]!==e[n]){var m=c(p,n,m),q=b(p,n,f[m].geometry);delete e[p];delete g[n];g[d(l,f[q].geometry,!0)]=q;f[m].geometry=null}else p in g?b(p,n,m):n in e?c(p,n,m):(f.push(a[k]),h++,e[p]=h-1,g[n]=
h-1)}else f.push(a[k]),h++}return f.filter(function(a){return a.geometry})}var v=function(a){this.layoutVertexArray=new f.StructArrayLayout4i4ui16;this.indexArray=new f.StructArrayLayout3ui6;this.programConfigurations=a;this.segments=new c;this.dynamicLayoutVertexArray=new f.StructArrayLayout3f12;this.opacityVertexArray=new f.StructArrayLayout1ul4;this.placedSymbolArray=new f.PlacedSymbolArray};v.prototype.upload=function(a,b,c,e){c&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,
d.symbolLayoutAttributes.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,b),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,d.dynamicLayoutAttributes.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,d.shaderOpacityAttributes,!0),this.opacityVertexBuffer.itemSize=1);(c||e)&&this.programConfigurations.upload(a)};v.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),
this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())};var z=function(a,b,d){this.layoutVertexArray=new a;this.layoutAttributes=b;this.indexArray=new d;this.segments=new c;this.collisionVertexArray=new f.StructArrayLayout2ub2f12};z.prototype.upload=function(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes);this.indexBuffer=a.createIndexBuffer(this.indexArray);this.collisionVertexBuffer=
a.createVertexBuffer(this.collisionVertexArray,[{name:"a_placed",components:2,type:"Uint8",offset:0},{name:"a_shift",components:2,type:"Float32",offset:4}],!0)};z.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())};l.register("SymbolBuffers",v);l.register("CollisionBuffers",z);a=function(a){this.collisionBoxArray=a.collisionBoxArray;this.zoom=a.zoom;this.overscaling=a.overscaling;
this.layers=a.layers;this.layerIds=this.layers.map(function(a){return a.id});this.index=a.index;this.pixelRatio=a.pixelRatio;this.sourceLayerIndex=a.sourceLayerIndex;this.hasPattern=!1;var b=this.layers[0]._unevaluatedLayout._values;this.textSizeData=e(this.zoom,b["text-size"]);this.iconSizeData=e(this.zoom,b["icon-size"]);var b=this.layers[0].layout,c=b.get("symbol-sort-key"),d=b.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==d&&void 0!==c.constantOr(1);this.sortFeaturesByY=("viewport-y"===
d||"auto"===d&&!this.sortFeaturesByKey)&&(b.get("text-allow-overlap")||b.get("icon-allow-overlap")||b.get("text-ignore-placement")||b.get("icon-ignore-placement"));this.stateDependentLayerIds=this.layers.filter(function(a){return a.isStateDependent()}).map(function(a){return a.id});this.sourceID=a.sourceID};a.prototype.createArrays=function(){this.text=new v(new k.ProgramConfigurationSet(d.symbolLayoutAttributes.members,this.layers,this.zoom,function(a){return/^text/.test(a)}));this.icon=new v(new k.ProgramConfigurationSet(d.symbolLayoutAttributes.members,
this.layers,this.zoom,function(a){return/^icon/.test(a)}));this.collisionBox=new z(f.StructArrayLayout2i2i2i12,h.collisionBoxLayout,f.StructArrayLayout2ui4);this.collisionCircle=new z(f.StructArrayLayout2i2i2i12,h.collisionCircleLayout,f.StructArrayLayout3ui6);this.glyphOffsetArray=new f.GlyphOffsetArray;this.lineVertexArray=new f.SymbolLineVertexArray;this.symbolInstances=new f.SymbolInstanceArray};a.prototype.calculateGlyphDependencies=function(a,b,c,d){for(var e=0;e<a.length;e++)if(b[a.charCodeAt(e)]=
!0,c&&d){var g=h.verticalizedCharacterMap[a.charAt(e)];g&&(b[g.charCodeAt(0)]=!0)}};a.prototype.populate=function(a,c){var d=this.layers[0],e=d.layout,f=e.get("text-font"),k=e.get("text-field"),l=e.get("icon-image"),k=("constant"!==k.value.kind||0<k.value.value.toString().length)&&("constant"!==f.value.kind||0<f.value.value.length)&&!k.value.value.toString().startsWith("##"),l=("constant"!==l.value.kind||l.value.value&&0<l.value.value.length)&&!l.value.value.startsWith("##"),p=e.get("symbol-sort-key");
this.features=[];if(k||l){var q=c.iconDependencies;c=c.glyphDependencies;for(var y=new m(this.zoom),u=0;u<a.length;u+=1){var v=a[u],z=v.feature,O=v.index,N=v.sourceLayerIndex;if(d._featureFilter(y,z)){v=void 0;k&&(v=d.getValueAndResolveTokens("text-field",z),v=b(v instanceof n?v:n.fromString(v),d,z));var J=void 0;l&&(J=d.getValueAndResolveTokens("icon-image",z));if(v||J){var H=this.sortFeaturesByKey?p.evaluate(z,{}):void 0,O={text:v,icon:J,index:O,sourceLayerIndex:N,geometry:g.loadGeometry(z),properties:z.properties,
type:h.geometryTypes[z.type],sortKey:H};"undefined"!==typeof z.id&&(O.id=z.id);this.features.push(O);J&&(q[J]=!0);if(v)for(z=f.evaluate(z,{}).join(","),O="map"===e.get("text-rotation-alignment")&&"point"!==e.get("symbol-placement"),N=0,J=v.sections;N<J.length;N+=1){var H=J[N],I=g.allowsVerticalWritingMode(v.toString()),K=H.fontStack||z,K=c[K]=c[K]||{};this.calculateGlyphDependencies(H.text,K,O,I)}}}}"line"===e.get("symbol-placement")&&(this.features=t(this.features));this.sortFeaturesByKey&&this.features.sort(function(a,
b){return a.sortKey-b.sortKey})}};a.prototype.update=function(a,b,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,b,this.layers,c),this.icon.programConfigurations.updatePaintArrays(a,b,this.layers,c))};a.prototype.isEmpty=function(){return 0===this.symbolInstances.length};a.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload};a.prototype.upload=function(a){this.uploaded||
(this.collisionBox.upload(a),this.collisionCircle.upload(a));this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload);this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload);this.uploaded=!0};a.prototype.destroy=function(){this.text.destroy();this.icon.destroy();this.collisionBox.destroy();this.collisionCircle.destroy()};a.prototype.addToLineVertexArray=function(a,b){var c=this.lineVertexArray.length;if(void 0!==
a.segment){for(var d=a.dist(b[a.segment+1]),e=a.dist(b[a.segment]),g={},f=a.segment+1;f<b.length;f++)g[f]={x:b[f].x,y:b[f].y,tileUnitDistanceFromAnchor:d},f<b.length-1&&(d+=b[f+1].dist(b[f]));for(a=a.segment||0;0<=a;a--)g[a]={x:b[a].x,y:b[a].y,tileUnitDistanceFromAnchor:e},0<a&&(e+=b[a-1].dist(b[a]));for(e=0;e<b.length;e++)a=g[e],this.lineVertexArray.emplaceBack(a.x,a.y,a.tileUnitDistanceFromAnchor)}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}};a.prototype.addSymbols=function(a,
b,c,d,e,g,f,h,k,l){e=a.indexArray;for(var m=a.layoutVertexArray,n=a.dynamicLayoutVertexArray,t=a.segments.prepareSegment(4*b.length,a.layoutVertexArray,a.indexArray,g.sortKey),r=this.glyphOffsetArray.length,u=t.vertexLength,v=0;v<b.length;v+=1){var y=b[v],x=y.tl,z=y.tr,w=y.bl,A=y.br,B=y.tex,D=t.vertexLength,E=y.glyphOffset[1];q(m,h.x,h.y,x.x,E+x.y,B.x,B.y,c);q(m,h.x,h.y,z.x,E+z.y,B.x+B.w,B.y,c);q(m,h.x,h.y,w.x,E+w.y,B.x,B.y+B.h,c);q(m,h.x,h.y,A.x,E+A.y,B.x+B.w,B.y+B.h,c);p(n,h,0);e.emplaceBack(D,
D+1,D+2);e.emplaceBack(D+1,D+2,D+3);t.vertexLength+=4;t.primitiveLength+=2;this.glyphOffsetArray.emplaceBack(y.glyphOffset[0])}a.placedSymbolArray.emplaceBack(h.x,h.y,r,this.glyphOffsetArray.length-r,u,k,l,h.segment,c?c[0]:0,c?c[1]:0,d[0],d[1],f,!1,0);a.programConfigurations.populatePaintArrays(a.layoutVertexArray.length,g,g.index,{})};a.prototype._addCollisionDebugVertex=function(a,b,c,d,e,g){b.emplaceBack(0,0);return a.emplaceBack(c.x,c.y,d,e,Math.round(g.x),Math.round(g.y))};a.prototype.addCollisionDebugVertices=
function(a,b,c,d,e,g,f,h){var k=e.segments.prepareSegment(4,e.layoutVertexArray,e.indexArray),l=k.vertexLength,m=e.layoutVertexArray,p=e.collisionVertexArray,n=f.anchorX;f=f.anchorY;this._addCollisionDebugVertex(m,p,g,n,f,new pointGeometry(a,b));this._addCollisionDebugVertex(m,p,g,n,f,new pointGeometry(c,b));this._addCollisionDebugVertex(m,p,g,n,f,new pointGeometry(c,d));this._addCollisionDebugVertex(m,p,g,n,f,new pointGeometry(a,d));k.vertexLength+=4;h?(a=e.indexArray,a.emplaceBack(l,l+1,l+2),a.emplaceBack(l,
l+2,l+3),k.primitiveLength+=2):(a=e.indexArray,a.emplaceBack(l,l+1),a.emplaceBack(l+1,l+2),a.emplaceBack(l+2,l+3),a.emplaceBack(l+3,l),k.primitiveLength+=4)};a.prototype.addDebugCollisionBoxes=function(a,b,c){for(;a<b;a++){var d=this.collisionBoxArray.get(a),e=0<d.radius;this.addCollisionDebugVertices(d.x1,d.y1,d.x2,d.y2,e?this.collisionCircle:this.collisionBox,d.anchorPoint,c,e)}};a.prototype.generateCollisionDebugBuffers=function(){for(var a=0;a<this.symbolInstances.length;a++){var b=this.symbolInstances.get(a);
this.addDebugCollisionBoxes(b.textBoxStartIndex,b.textBoxEndIndex,b);this.addDebugCollisionBoxes(b.iconBoxStartIndex,b.iconBoxEndIndex,b)}};a.prototype._deserializeCollisionBoxesForSymbol=function(a,b,c,d,e){for(var g={};b<c;b++){var f=a.get(b);if(0===f.radius){g.textBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY};g.textFeatureIndex=f.featureIndex;break}else g.textCircles||(g.textCircles=[],g.textFeatureIndex=f.featureIndex),g.textCircles.push(f.anchorPointX,
f.anchorPointY,f.radius,f.signedDistanceFromAnchor,1)}for(c=d;c<e;c++)if(d=a.get(c),0===d.radius){g.iconBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY};g.iconFeatureIndex=d.featureIndex;break}return g};a.prototype.deserializeCollisionBoxes=function(a){this.collisionArrays=[];for(var b=0;b<this.symbolInstances.length;b++){var c=this.symbolInstances.get(b);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,c.textBoxStartIndex,c.textBoxEndIndex,
c.iconBoxStartIndex,c.iconBoxEndIndex))}};a.prototype.hasTextData=function(){return 0<this.text.segments.get().length};a.prototype.hasIconData=function(){return 0<this.icon.segments.get().length};a.prototype.hasCollisionBoxData=function(){return 0<this.collisionBox.segments.get().length};a.prototype.hasCollisionCircleData=function(){return 0<this.collisionCircle.segments.get().length};a.prototype.addIndicesForPlacedTextSymbol=function(a){var b=this.text.placedSymbolArray.get(a);a=b.vertexStartIndex+
4*b.numGlyphs;for(b=b.vertexStartIndex;b<a;b+=4)this.text.indexArray.emplaceBack(b,b+1,b+2),this.text.indexArray.emplaceBack(b+1,b+2,b+3)};a.prototype.getSortedSymbolIndexes=function(a){if(this.sortedAngle===a&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;var b=Math.sin(a);a=Math.cos(a);for(var c=[],d=[],e=[],g=0;g<this.symbolInstances.length;++g){e.push(g);var f=this.symbolInstances.get(g);c.push(Math.round(b*f.anchorX+a*f.anchorY)|0);d.push(f.featureIndex)}e.sort(function(a,
b){return c[a]-c[b]||d[b]-d[a]});return e};a.prototype.sortFeatures=function(a){var b=this;if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(1<this.text.segments.get().length||1<this.icon.segments.get().length)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a);this.sortedAngle=a;this.text.indexArray.clear();this.icon.indexArray.clear();this.featureSortOrder=[];a=0;for(var c=this.symbolInstanceIndexes;a<c.length;a+=1){var d=c[a],e=this.symbolInstances.get(d);this.featureSortOrder.push(e.featureIndex);
[e.rightJustifiedTextSymbolIndex,e.centerJustifiedTextSymbolIndex,e.leftJustifiedTextSymbolIndex].forEach(function(a,c,d){0<=a&&d.indexOf(a)===c&&b.addIndicesForPlacedTextSymbol(a)});0<=e.verticalPlacedTextSymbolIndex&&this.addIndicesForPlacedTextSymbol(e.verticalPlacedTextSymbolIndex);d=this.icon.placedSymbolArray.get(d);d.numGlyphs&&(d=d.vertexStartIndex,this.icon.indexArray.emplaceBack(d,d+1,d+2),this.icon.indexArray.emplaceBack(d+1,d+2,d+3))}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray);
this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}};a.MAX_GLYPHS=65535;a.addDynamicAttributes=p;l.register("SymbolBucket",a,{omit:["layers","collisionBoxArray","features","compareText"]});return a})},"com/huayun/webgis/gl/programAttributes":function(){define(["exports","../utils/Constant","../utils/utils"],function(f,c,k){f.basicLine=function(f,d){void 0===d&&(d=1);var a=0,l=0;f=f.map(function(g){var f=c.viewTypes[g.type].BYTES_PER_ELEMENT,b=a=k.align(a,Math.max(d,f)),
e=g.components||1;l=Math.max(l,f);a+=f*e;return{name:g.name,type:g.type,components:e,offset:b}});var n=k.align(a,Math.max(l,d));return{members:f,size:n,alignment:d}}([{name:"a_pos",type:"Float32",components:3},{name:"a_data",type:"Float32",components:4},{name:"a_normal",type:"Int16",components:2}],4)})},"com/huayun/webgis/symbols/TextSymbol":function(){define(["./Symbol","../utils/Color","./support/glyphManager","./support/CustomGlyphAtlas"],function(f,c,k,l){var d=function(a){f.call(this,a);var d=
c.parse(a.color||"#FF0000"),n=void 0===a.opacity?1:a.opacity,g=Number(a.size||a["font-size"]);this.fontSize=g;var h=void 0===a.isRotate?!1:a.isRotate,b=void 0===a.rotateRadian?0:a.rotateRadian;this.offset=(a.offset||[Number(a.dx),Number(a.dy)]).map(function(a){return a/g});this.hasHalo=a.stroke||!!a.halo;var e,q,p;this.hasHalo?a.halo?(e=a.halo.blur||0,q=c.parse(a.halo.color||"#FF0000"),p=a.halo.width||Number(a["stroke-width"])):(e=0,q=c.parse(a.stroke||"#FF0000"),p=Number(a["stroke-width"])):(e=0,
q=c.parse("#FFF"),p=0);this.type="text";this.uniforms={u_size:this.fontSize,u_pitch_with_map:0,u_opacity:n,u_texture:0,u_fill_color:[d.r,d.g,d.b,d.a],u_gamma_scale:1,u_rotate_symbol:h,u_radian:b,u_halo_color:[q.r,q.g,q.b,q.a],u_halo_width:p,u_halo_blur:e,u_is_halo:this.hasHalo?1:0};d=a.text;this.font=a=a.font||a["font-family"]||"sans-serif";if(d){this.text=d;n={};n[a]=[];h=0;for(b=d.length;h<b;h++)n[a].push(d.charCodeAt(h));this.glyphMap=k.getGlyphs(n);this.glyphAtlas=new l(this.glyphMap);a=this.glyphAtlas.image;
this.width=a.width;this.height=a.height;this.textWidth=this.glyphAtlas.textWidth}};f&&(d.__proto__=f);d.prototype=Object.create(f&&f.prototype);d.prototype.constructor=d;d.prototype.setText=function(a,c){if(void 0!==a&&0!==a.length){this.text=a;c||(c=this.font);var d={};d[c]=[];for(var g=0,f=a.length;g<f;g++)d[c].push(a.charCodeAt(g));this.glyphMap=k.getGlyphs(d);this.glyphAtlas=new l(this.glyphMap);c=this.glyphAtlas.image;this.width=c.width;this.height=c.height;this.textWidth=24*a.length}};d.prototype.setOffset=
function(a){var c=this.uniforms.u_size;this.offset=a.map(function(a){return a/c})};return d})},"com/huayun/webgis/layers/support/EvaluationParameters":function(){define(["./ZoomHistory"],function(f){var c=function(c,l){this.zoom=c;l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.zoomHistory=l.zoomHistory,this.transition=l.transition):(this.fadeDuration=this.now=0,this.zoomHistory=new f,this.transition={})};c.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-
this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)};c.prototype.getCrossfadeParameters=function(){var c=this.zoom,f=c-Math.floor(c),d=this.crossFadingFactor();return c>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:f+(1-f)*d}:{fromScale:.5,toScale:1,t:1-(1-d)*f}};return c})},"com/huayun/webgis/layers/support/expression/Var":function(){define([],function(){var f=function(c,f){this.type=f.type;this.name=c;this.boundExpression=f};f.parse=function(c,k){if(2!==c.length||"string"!==typeof c[1])return k.error("'var' expression requires exactly one string literal argument.");
c=c[1];return k.scope.has(c)?new f(c,k.scope.get(c)):k.error('Unknown variable "'+c+'". Make sure "'+c+'" has been bound in an enclosing "let" expression before using it.',1)};f.prototype.evaluate=function(c){return this.boundExpression.evaluate(c)};f.prototype.eachChild=function(){};f.prototype.possibleOutputs=function(){return[void 0]};f.prototype.serialize=function(){return["var",this.name]};return f})},"com/huayun/webgis/layers/GraphicLayer":function(){define("dojo/_base/declare ./Layer ../views/3d/layers/GraphicLayerView3D ../data/GraphicIndex com/huayun/webgis/symbols/PointSymbol com/huayun/webgis/symbols/CircleSymbol com/huayun/webgis/symbols/PolygonSymbol com/huayun/webgis/symbols/LineSymbol ../renderer/SimpleRenderer".split(" "),
function(f,c,k,l,d,a,m,n,g){return f("com.huayun.webgis.layers.GraphicLayer",[c],{constructor:function(a){a=a||{};this.type="graphic";this.graphics=[];this.id="graphic";this.maxLevel=a.maxLevel;this.minLevel=a.minLevel;this.opacity=1;f.safeMixin(this,a);this.graphicIndex=new l;this.queryPadding=20;this.selectEnabled=this.indexNeedUpdate=!0;this.highlightGraphics=[];this.renderer=a&&a.renderer||new g;a&&(this.glowRatio=void 0===a.glowRatio?8:a.glowRatio,a.graphics&&a.graphics.forEach(function(a){this.addGraphic(a)}.bind(this)))},
setRenderer:function(a){this.renderer=a;this.layerView&&(this.layerView.renderer=a)},createLayerView:function(a,b){this.layerView=b=new k({opacity:this.opacity,visible:this.visible,view:a,id:this.id,layer:this,glow:this.glow,renderer:this.renderer});b.transform=a.viewpoint;this.graphics.forEach(function(a){this.layerView.addGraphic(a)}.bind(this));return b},addGraphic:function(a,b){if(b)switch(b){case "first":this.graphics.splice(0,0,a);break;case "end":this.graphics.push(a)}else this.graphics.push(a);
a.layer=this;this.layerView&&this.layerView.addGraphic(a);this.indexNeedUpdate=!0},updateGraphic:function(a){this.layerView.addGraphic(a)},addGraphicBefore:function(a,b){a.layer=this;for(var c=this.graphics.length,d=!1,g=0;g<c;g++)if(b===this.graphics[g].id){this.graphics.splice(g,0,a);d=!0;break}d||this.graphics.push(a);this.layerView&&this.layerView.addGraphic(a);this.indexNeedUpdate=!0},removeGraphic:function(a){if(a){for(var b=this.graphics.length,c=0;c<b;c++)if(a.id===this.graphics[c].id){a.buckets.forEach(function(a){a.destroy()});
a.buckets=[];this.graphics.splice(c,1);break}this.layerView.view.threeRender()}},addMultiPoint:function(a){this.graphics.push(a);this.layerView.addMultiPoint(a)},removeGraphics:function(a){for(var b=0;b<a.length;b++)this.removeGraphic(a[b])},setVisible:function(a){this.visible=a;this.layerView.setVisible(a)},refresh:function(){this.layerView.view.threeRender()},clear:function(){this.graphics.forEach(function(a){a.bucket&&a.bucket.destroy()});this.graphics=[];this.layerView.view.threeRender()},queryFeaturesByGeometry:function(a,
b){this.indexNeedUpdate&&(this.graphicIndex.clear(),this.graphics.forEach(function(a){if(a.selectEnabled){var b;switch(a.feature.geometry.type){case "point":b=[[a.feature.geometry]];break;case "circle":b=[[a.feature.geometry.center]];break;case "multipoint":b=[a.feature.geometry.points];break;case "line":case "polygon":b=a.feature.geometry.path;break;default:b=[[]]}this.graphicIndex.insert(b,a.id)}}.bind(this)),this.indexNeedUpdate=!1);b=b||this.queryPadding;switch(a.type){case "point":a=[a]}return this.graphicIndex.query(a,
b,this.graphics,this.layerView.view.resolution,this.layerView.view.viewpoint)},captureFeaturesByGeometry:function(a,b){this.indexNeedUpdate&&(this.graphicIndex.clear(),this.graphics.forEach(function(a){if(a.selectEnabled){var b;switch(a.symbol.type){case "point":b=[[a.feature.geometry]];break;case "circle":b=[[a.feature.geometry.center]];break;case "text":return;case "image":b=[[a.feature.geometry]];break;default:b=a.feature.geometry.path}this.graphicIndex.insert(b,a.id)}}.bind(this)),this.indexNeedUpdate=
!1);b=b||this.queryPadding;switch(a.type){case "point":a=[a]}return this.graphicIndex.captureQuery(a,b,this.graphics,this.layerView.view.resolution,this.layerView.view.viewpoint)},queryRenderFeaturesByGeometry:function(a,b){this.indexNeedUpdate&&(this.graphicIndex.clear(),this.graphics.forEach(function(a){if(a.selectEnabled){var b;switch(a.symbol.type){case "point":b=[[a.feature.geometry]];break;case "circle":b=[[a.feature.geometry.center]];break;case "text":return;case "image":b=[[a.feature.geometry]];
break;default:b=a.feature.geometry.path}this.graphicIndex.insert(b,a.id)}}.bind(this)),this.indexNeedUpdate=!1);b=b||this.queryPadding;switch(a.type){case "point":a=[a]}return this.graphicIndex.queryRender(a,b,this.graphics,this.layerView.view.resolution,this.layerView.view.viewpoint)},highlightGraphic:function(a){this.highlightSymbol||(this.highlightSymbol={point:new d({color:"#FFFF00",radius:16}),line:new n({color:"#BF2BFF",width:4,join:"round",cap:"round"}),polygon:new m({color:"#FF4B37"})});var b=
!1;this.highlightGraphics.forEach(function(a){delete a.highLightSymbol;b=!0}.bind(this));this.highlightGraphics=[];a.forEach(function(a){a.highLightSymbol=this.highlightSymbol[a.symbol.type];b=!0}.bind(this));this.highlightGraphics=a;b&&this.layerView.view.threeRender()}})})},"com/huayun/webgis/layers/support/tileCover":function(){define(["./OverscaledTileID"],function(f){function c(c,a){if(c.y>a.y){var d=c;c=a;a=d}return{x0:c.x,y0:c.y,x1:a.x,y1:a.y,dx:a.x-c.x,dy:a.y-c.y}}function k(c,a,f,k,g){f=
Math.max(f,Math.floor(a.y0));k=Math.min(k,Math.ceil(a.y1));if(c.x0===a.x0&&c.y0===a.y0?c.x0+a.dy/c.dy*c.dx<a.x1:c.x1-a.dy/c.dy*c.dx<a.x0){var d=c;c=a;a=d}var d=c.dx/c.dy,b=a.dx/a.dy,e=0<c.dx,l=0>a.dx;for(--f;f<k+1;f++)g(Math.floor(b*Math.max(0,Math.min(a.dy,f+l-a.y0))+a.x0),Math.ceil(d*Math.max(0,Math.min(c.dy,f+e-c.y0))+c.x0),f)}function l(d,a,f,l,g,h){var b=c(d,a);a=c(a,f);d=c(f,d);b.dy>a.dy&&(f=b,b=a,a=f);b.dy>d.dy&&(f=b,b=d,d=f);a.dy>d.dy&&(f=a,a=d,d=f);b.dy&&k(d,b,l,g,h);a.dy&&k(d,a,l,g,h)}return function(c,
a,k){function d(a,b,d){var e,h;for(--a;a<b+1;a++)e=Math.floor(a),h=new f(c,0,c,e,d),g[c+"/"+e+"/"+d]=h}var g={};l(a[0],a[1],a[2],0,Infinity,d);l(a[2],a[3],a[0],0,Infinity,d);return Object.keys(g).map(function(a){return g[a]})}})},"com/huayun/webgis/views/layers/LayerView":function(){define([],function(){function f(c){this.id=c&&c.id?c.id:"layerView";this.layer=c.layer;this.view=c.view}f.prototype.refresh=function(){};return f})},"com/huayun/webgis/renderer/ImageRenderer":function(){define("custom/gl-matrix-min ./Renderer ../data/bucket/ImageBucketSimplify ../geometry/Point ../gl/mode ../gl/Texture ../gl/programCache".split(" "),
function(f,c,k,l,d,a,m){function n(){}c&&(n.__proto__=c);n.prototype=Object.create(c&&c.prototype);n.prototype.constructor=n;n.prototype.add=function(a,c,b,d){debugger;var e=new k,g=c.position||a.viewpoint.center||[0,0],f=g[0],g=g[1];if("multipoint"===b.type){for(var h=[],m=0;m<b.points.length;m++)h.push(new l(b.points[m].x-f,b.points[m].y-g,0));e.addFeature([h],d.width,d.height,d.offset)}else"point"===b.type&&e.addFeature([[new l(b.x-f,b.y-g,0)]],d.width,d.height,d.offset);e.upload(a.context);c.buckets.push(e);
c.position=[f,g]};n.prototype.draw=function(c,h,b,e,k,l){if(e.loaded){void 0===l&&(l=0);b=c.context;var g=b.gl;k=k?k.depthModeForSublayer(0,d.DepthMode.ReadOnly):new d.DepthMode(g.LEQUAL,d.DepthMode.ReadOnly,[.9,.9]);var p=d.StencilMode.disabled,n=d.ColorMode.alphaBlended,q=m.useProgramSimplify(b,"images",{layoutAttributes:[{name:"a_pos",type:"Float32",components:2,offset:0},{name:"a_data",type:"Int16",components:4,offset:8}]}),u=e.uniforms,r=h.position,x=this.getRealScale(e.fixed,c.scale,e.minScale),
A=void 0,w=c.resolution;e.markerSize?(x*=h.markerScaleFactor||1,A=e.markerSize/e.radius,x*=A):h.symbol.size&&void 0===h.symbol.tempW?(h.scaleFactor=h.scaleFactor||1,x*=h.scaleFactor,A=h.symbol.size/e.radius,h.symbol.tempW=A,x*=A):h.symbol.size&&void 0!==h.symbol.tempW?x*=h.symbol.tempW:(h.scaleFactor=h.scaleFactor||1,x*=h.scaleFactor);u.u_radian=h.rotation?e.angle+h.rotation:e.angle;var A=e.dx*x*w,w=e.dy*x*w,B=Math.sin(u.u_radian),D=Math.cos(u.u_radian),x=A*D-w*B,A=w*D+A*B;u.u_matrix=c.viewpoint.getMatrixForPoint(r[0]+
x,r[1]+A);r=[e.width,e.height];u.u_camera_to_center_distance=c.viewpoint.cameraToCenterDistance;w=u.u_matrix;B=c.viewpoint.labelPlaneMatrix;D=f.mat4.create();f.mat4.multiply(D,B,w);u.u_label_plane_matrix=D;c=c.viewpoint.glCoordMatrix;u.u_coord_matrix=c;u.u_texsize=r;b.activeTexture.set(g.TEXTURE0);c=e.texture;c||(c=e.texture=new a(b,e.image,g.RGBA,{useMipmap:!0}));c.bind(g.LINEAR,g.CLAMP_TO_EDGE);h["_imageOffset"+l]={dx:x,dy:A,size:r};e=h.buckets[l];q.draw(b,g.TRIANGLES,k,p,n,d.CullFaceMode.disabled,
u,h.id+"-image"+l,e.layoutVertexBuffer,e.indexBuffer,e.segments,null)}else e.used=!0};n.prototype.drawGlow=function(a,c,b,d,f,k,l){this.draw(a,c,b,d,f,k,l)};n.prototype.calculateExtent=function(a,c,b,d,f,k){k||(k=0);if(d.loaded){a=a.resolution;k=c["_imageOffset"+k];d=k.size;var e=b.x;b=b.y;var g=k.dy,e=e+k.dx;b+=g;f.push({id:c.id,g:c,minX:e-d[0]*a/2,minY:b-d[1]*a/2,maxX:e+d[0]*a/2,maxY:b+d[1]*a/2})}};return n})},"com/huayun/webgis/gl/potpack":function(){define([],function(){return function(f){for(var c=
0,k=0,l=0;l<f.length;l+=1)var d=f[l],c=c+d.w*d.h,k=Math.max(k,d.w);f.sort(function(a,b){return b.h-a.h});for(var k=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(c/.95)),k),h:Infinity}],a=d=l=0;a<f.length;a+=1)for(var m=f[a],n=k.length-1;0<=n;n--){var g=k[n];if(!(m.w>g.w||m.h>g.h)){m.x=g.x;m.y=g.y;d=Math.max(d,m.y+m.h);l=Math.max(l,m.x+m.w);m.w===g.w&&m.h===g.h?(m=k.pop(),n<k.length&&(k[n]=m)):m.h===g.h?(g.x+=m.w,g.w-=m.w):(m.w!==g.w&&k.push({x:g.x+m.w,y:g.y,w:g.w-m.w,h:m.h}),g.y+=m.h,g.h-=m.h);break}}return{w:l,
h:d,fill:c/(l*d)||0}}})},"com/huayun/webgis/utils/colorSpaces":function(){define(["./utils","./Color"],function(f,c){function k(a){return a>e?Math.pow(a,1/3):a/b+g}function l(a){return a>h?a*a*a:b*(a-g)}function d(a){return 255*(.0031308>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function a(a){a/=255;return.04045>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)}function m(b){var c=a(b.r),d=a(b.g),e=a(b.b),g=k((.4124564*c+.3575761*d+.1804375*e)/.95047),f=k((.2126729*c+.7151522*d+.072175*e)/1),c=k((.0193339*c+
.119192*d+.9503041*e)/1.08883);return{l:116*f-16,a:500*(g-f),b:200*(f-c),alpha:b.a}}function n(a){var b=(a.l+16)/116,e=isNaN(a.a)?b:b+a.a/500,g=isNaN(a.b)?b:b-a.b/200,b=1*l(b),e=.95047*l(e),g=1.08883*l(g);return new c(d(3.2404542*e-1.5371385*b-.4985314*g),d(-.969266*e+1.8760108*b+.041556*g),d(.0556434*e-.2040259*b+1.0572252*g),a.alpha)}var g=4/29,h=6/29,b=3*h*h,e=h*h*h,q=Math.PI/180,p=180/Math.PI;return Object.freeze({lab:{forward:m,reverse:n,interpolate:function(a,b,c){return{l:f.number(a.l,b.l,
c),a:f.number(a.a,b.a,c),b:f.number(a.b,b.b,c),alpha:f.number(a.alpha,b.alpha,c)}}},hcl:{forward:function(a){var b=m(a),c=b.a,d=b.b,e=Math.atan2(d,c)*p;return{h:0>e?e+360:e,c:Math.sqrt(c*c+d*d),l:b.l,alpha:a.a}},reverse:function(a){var b=a.h*q,c=a.c;return n({l:a.l,a:Math.cos(b)*c,b:Math.sin(b)*c,alpha:a.alpha})},interpolate:function(a,b,c){var d=a.h,e=b.h-d;return{h:d+c*(180<e||-180>e?e-360*Math.round(e/360):e),c:f.number(a.c,b.c,c),l:f.number(a.l,b.l,c),alpha:f.number(a.alpha,b.alpha,c)}}}})})},
"com/huayun/webgis/symbols/BaseSymbol":function(){define([],function(){return function(f){this.maxScale=this.minScale=0;this.fixedSize=f.fixedSize||f.isFixed||!0;this.fixed={isFixed:this.fixedSize,addratio:0}}})},"com/huayun/webgis/facade/TileFacade":function(){define(["exports","../utils/Resource"],function(f,c){f.getTileInfoData=function(f,l){var d=dojoConfig.token;c.loadJson(f,d?{headers:{"access-key":d}}:void 0,l)};f.loadTile=function(f,l){var d=dojoConfig.token;return c.loadImage(f,d?{headers:{"access-key":d}}:
void 0,l)}})},"com/huayun/webgis/gl/programConfig":function(){define("exports ../data/FeaturePositionMap ../layers/support/style/PossiblyEvaluatedPropertyValue ./constantBinder ./dataTransfer ../utils/utils".split(" "),function(f,c,k,l,d,a){var m=function(){this.binders={};this.cacheKey="";this._buffers=[];this._featureMap=new c;this._bufferOffset=0};m.createDynamic=function(c,d,b){var e=new m,g=[],f;for(f in c.paint._values)if(b(f)){var h=c.paint.get(f);if(h instanceof k&&a.supportsPropertyExpression(h.property.specification)){var n=
a.paintAttributeNames(f,c.type),z=h.property.specification.type,y=h.property.useIntegerZoom;if("cross-faded"===h.property.specification["property-type"]||"cross-faded-data-driven"===h.property.specification["property-type"])if("constant"===h.value.kind)e.binders[f]=new l.CrossFadedConstantBinder(h.value.value,n,z),g.push("/u_"+f);else{var u=a.layoutType(f,z,"source");e.binders[f]=new l.CrossFadedCompositeBinder(h.value,n,z,y,d,u,c.id);g.push("/a_"+f)}else"constant"===h.value.kind?(e.binders[f]=new l.ConstantBinder(h.value.value,
n,z),g.push("/u_"+f)):"source"===h.value.kind?(y=a.layoutType(f,z,"source"),e.binders[f]=new l.SourceExpressionBinder(h.value,n,z,y),g.push("/a_"+f)):(u=a.layoutType(f,z,"composite"),e.binders[f]=new l.CompositeExpressionBinder(h.value,n,z,y,d,u),g.push("/z_"+f))}}e.cacheKey=g.sort().join("");return e};m.prototype.populatePaintArrays=function(a,c,b,d){for(var e in this.binders)this.binders[e].populatePaintArray(a,c,d);void 0!==c.id&&this._featureMap.add(+c.id,b,this._bufferOffset,a);this._bufferOffset=
a};m.prototype.setConstantPatternPositions=function(a,c){for(var b in this.binders)this.binders[b].setConstantPatternPositions(a,c)};m.prototype.updatePaintArrays=function(a,c,b,d){var e=!1,g;for(g in a)for(var f=0,h=this._featureMap.getPositions(+g);f<h.length;f+=1){var k=h[f],m=c.feature(k.index),n;for(n in this.binders){var r=this.binders[n];r instanceof l.ConstantBinder||r instanceof l.CrossFadedConstantBinder||!0!==r.expression.isStateDependent||(e=b.paint.get(n),r.expression=e.value,r.updatePaintArray(k.start,
k.end,m,a[g],d),e=!0)}}return e};m.prototype.defines=function(){var a=[],c;for(c in this.binders)a.push.apply(a,this.binders[c].defines());return a};m.prototype.getPaintVertexBuffers=function(){return this._buffers};m.prototype.getUniforms=function(a,c){var b=[],d;for(d in this.binders)for(var g=this.binders[d],f=0,h=g.uniformNames;f<h.length;f+=1){var k=h[f];if(c[k]){var l=g.getBinding(a,c[k]);b.push({name:k,property:d,binding:l})}}return b};m.prototype.setUniforms=function(a,c,b,d){for(var e=0;e<
c.length;e+=1){var f=c[e],g=f.name,h=f.property;this.binders[h].setUniforms(a,f.binding,d,b.get(h),g)}};m.prototype.setUniform=function(a,c,b,d){this.binders[c].setUniform(a,b,d)};m.prototype.updatePatternPaintBuffers=function(a){var c=[],b;for(b in this.binders){var d=this.binders[b];d instanceof l.CrossFadedCompositeBinder?(d=2===a.fromScale?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer)&&c.push(d):(d instanceof l.SourceExpressionBinder||d instanceof l.CompositeExpressionBinder)&&d.paintVertexBuffer&&
c.push(d.paintVertexBuffer)}this._buffers=c};m.prototype.upload=function(a){for(var c in this.binders)this.binders[c].upload(a);a=[];for(var b in this.binders)c=this.binders[b],(c instanceof l.SourceExpressionBinder||c instanceof l.CompositeExpressionBinder)&&c.paintVertexBuffer&&a.push(c.paintVertexBuffer);this._buffers=a};m.prototype.destroy=function(){for(var a in this.binders)this.binders[a].destroy()};var n=function(a,c,b,d){void 0===d&&(d=function(){return!0});this.programConfigurations={};
for(var e=0;e<c.length;e+=1){var f=c[e];this.programConfigurations[f.id]=m.createDynamic(f,b,d);this.programConfigurations[f.id].layoutAttributes=a}this.needsUpload=!1};n.prototype.populatePaintArrays=function(a,c,b,d){for(var e in this.programConfigurations)this.programConfigurations[e].populatePaintArrays(a,c,b,d);this.needsUpload=!0};n.prototype.updatePaintArrays=function(a,c,b,d){for(var e=0;e<b.length;e+=1){var f=b[e];this.needsUpload=this.programConfigurations[f.id].updatePaintArrays(a,c,f,
d)||this.needsUpload}};n.prototype.get=function(a){return this.programConfigurations[a]};n.prototype.upload=function(a){if(this.needsUpload){for(var c in this.programConfigurations)this.programConfigurations[c].upload(a);this.needsUpload=!1}};n.prototype.destroy=function(){for(var a in this.programConfigurations)this.programConfigurations[a].destroy()};f.ProgramConfiguration=m;f.ProgramConfigurationSet=n;d.register("FeaturePositionMap",c);d.register("ProgramConfiguration",m,{omit:["_buffers"]});d.register("ProgramConfigurationSet",
n)})},"com/huayun/webgis/symbols/PolygonSymbol":function(){define(["./Symbol","../utils/Color"],function(f,c){var k=function(d){if(void 0!==d){f.call(this,d);this.type="polygon";var a=c.parse(d.color||"#FF0000");d=void 0===d.opacity?1:d.opacity;this._color=[a.r,a.g,a.b,a.a];this._opacity=d;this.uniforms={u_color:this.color,u_opacity:this.opacity}}};f&&(k.__proto__=f);k.prototype=Object.create(f&&f.prototype);k.prototype.constructor=k;k.prototype.clone=function(){var c=new k;c.minScale=this.minScale;
c.maxScale=this.maxScale;c.uniforms=this.uniforms;c.color=this.color;c.opacity=this.opacity;return c};var l={color:{configurable:!0},opacity:{configurable:!0}};l.color.set=function(d){d=c.parse(d||"#FF0000");this._color=[d.r,d.g,d.b,d.a];this.uniforms.u_color=this._color};l.opacity.set=function(c){this._opacity=c;this.uniforms.u_opacity=c};l.color.get=function(){return this._color};l.opacity.get=function(){return this._opacity};Object.defineProperties(k.prototype,l);return k})},"com/huayun/webgis/renderer/FillRenderer":function(){define(["../geometry/Point",
"../data/bucket/FillBucketSimplify","../gl/mode","../gl/programCache"],function(f,c,k,l){function d(){}d.prototype.add=function(a,c,d,f){var g=c.position||a.viewpoint.center||[0,0];f=g[0];g=g[1];if("multipolygon"===d.type){for(var b=[],e=0;e<d.polygons.length;e++){var k=this._addOnePathFeature(d.polygons[e],a,f,g);b.push(k)}c.buckets.push(b)}else k=this._addOnePathFeature(d,a,f,g),c.buckets.push(k);c.position=[f,g]};d.prototype._addOnePathFeature=function(a,d,k,g){var h=a.path;a=[];for(var b=0;b<
h.length;b++){for(var e=h[b],l=[],m=0;m<e.length;m++){var n=e[m];l.push(new f(n.x-k,n.y-g,0))}a.push(l)}k=new c;k.addFeature(a);k.upload(d.context);return k};d.prototype.draw=function(a,c,d,f,h,b){void 0===b&&(b=0);var e=k.ColorMode.alphaBlended,g=a.context,m=g.gl,n;n=h?h.depthModeForSublayer(0,k.DepthMode.ReadOnly):new k.DepthMode(m.LEQUAL,k.DepthMode.ReadOnly,[.9,.9]);var v=l.useProgramSimplify(g,"basicFill",{layoutAttributes:[{name:"a_pos",type:"Float32",components:2,offset:0}]}),z=f.uniforms;
h=c.position;z.u_matrix=a.viewpoint.getMatrixForPoint(h[0],h[1]);z.u_color=f.color;a=c.buckets[b];"multipolygon"===d.type?a.forEach(function(a,d){v.draw(g,m.TRIANGLES,n,null,e,k.CullFaceMode.disabled,z,c.id+"-fill"+b+"-"+d,a.layoutVertexBuffer,a.indexBuffer,a.segments)}):v.draw(g,m.TRIANGLES,n,null,e,k.CullFaceMode.disabled,z,c.id+"-fill"+b,a.layoutVertexBuffer,a.indexBuffer,a.segments)};d.prototype.drawGlow=function(a,c,d,f,h,b){var e=c.glow;if(e){void 0===b&&(b=0);d=k.ColorMode.alphaBlended;var g=
a.context,m=g.gl;h=h?h.depthModeForSublayer(0,k.DepthMode.ReadOnly):new k.DepthMode(m.LEQUAL,k.DepthMode.ReadOnly,[.9,.9]);var n=l.useProgramSimplify(g,"basicFill",{layoutAttributes:[{name:"a_pos",type:"Float32",components:2,offset:0}]});f=f.uniforms;var v=c.position;f.u_matrix=a.viewpoint.getMatrixForPoint(v[0],v[1]);f.u_color=e.color;a=c.buckets[b];n.draw(g,m.TRIANGLES,h,null,d,k.CullFaceMode.disabled,f,c.id+"-fill"+b,a.layoutVertexBuffer,a.indexBuffer,a.segments)}};d.prototype.calculateExtent=
function(a,c,d,f,h){a=d.extent;h.push({id:c.id,g:c,minX:a.xmin,minY:a.ymin,maxX:a.xmax,maxY:a.ymax,symbol:f})};return d})},"com/huayun/webgis/data/uniform":function(){define(["exports","../utils/Color"],function(f,c){var k=function(a,c){this.gl=a.gl;this.location=c},l=function(a){function b(b,c){a.call(this,b,c);this.current=0}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.set=function(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,
a))};return b}(k),d=function(a){function b(b,c){a.call(this,b,c);this.current=0}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.set=function(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))};return b}(k),a=function(a){function b(b,c){a.call(this,b,c);this.current=0}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.set=function(a){this.current!==a&&(this.current=a,this.gl.uniform1fv(this.location,
a))};return b}(k),m=function(a){function b(b,c){a.call(this,b,c);this.current=[0,0]}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.set=function(a){if(a[0]!==this.current[0]||a[1]!==this.current[1])this.current=a,this.gl.uniform2f(this.location,a[0],a[1])};return b}(k),n=function(a){function b(b,c){a.call(this,b,c);this.current=[0,0,0]}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.set=function(a){if(a[0]!==
this.current[0]||a[1]!==this.current[1]||a[2]!==this.current[2])this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2])};return b}(k),g=function(a){function b(b,c){a.call(this,b,c);this.current=[0,0,0,0]}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.set=function(a){if(a[0]!==this.current[0]||a[1]!==this.current[1]||a[2]!==this.current[2]||a[3]!==this.current[3])this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3])};return b}(k),
h=function(a){function b(b,d){a.call(this,b,d);this.current=c.transparent}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=b;b.prototype.set=function(a){if(a.r!==this.current.r||a.g!==this.current.g||a.b!==this.current.b||a.a!==this.current.a)this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a)};return b}(k),k=function(a){function b(b,c){a.call(this,b,c);this.current=new Float32Array(16)}a&&(b.__proto__=a);b.prototype=Object.create(a&&a.prototype);b.prototype.constructor=
b;b.prototype.set=function(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);else for(var b=1;16>b;b++)if(a[b]!==this.current[b]){this.current=a;this.gl.uniformMatrix4fv(this.location,!1,a);break}};return b}(k);f.Uniform1f=d;f.Uniform1fv=a;f.Uniform1i=l;f.Uniform2f=m;f.Uniform3f=n;f.Uniform4f=g;f.UniformMatrix4f=k;f.UniformColor=h})},"com/huayun/webgis/data/bucket/CircleBucketSimplify":function(){define(["../ArrayType","../../gl/SegmentVector"],
function(f,c){var k=function(k){this.layoutVertexArray=new f.StructArrayLayout2f2ib12;this.indexArray=new f.StructArrayLayout3ui6;this.segments=new c};k.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy())};k.prototype.addFeature=function(c){for(var d=0;d<c.length;d+=1)for(var a=0,f=c[d];a<f.length;a+=1){var k=f[a],g=k.x,k=k.y,h=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),b=h.vertexLength;
this.layoutVertexArray.emplaceBack(g,k,-1,-1);this.layoutVertexArray.emplaceBack(g,k,1,-1);this.layoutVertexArray.emplaceBack(g,k,1,1);this.layoutVertexArray.emplaceBack(g,k,-1,1);this.indexArray.emplaceBack(b,b+1,b+2);this.indexArray.emplaceBack(b,b+3,b+2);h.vertexLength+=4;h.primitiveLength+=2}};k.prototype.upload=function(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,[{name:"a_pos",type:"Float32",components:2,offset:0},{name:"a_data",type:"Int16",components:2,offset:8}]);
this.indexBuffer=c.createIndexBuffer(this.indexArray)};return k})},"url:com/huayun/webgis/gl/shaders/fill_extrusion.vertex.glsl":"#ifdef GL_ES\r\nprecision mediump float;\r\n#else\r\n\r\n#if !defined(lowp)\r\n#define lowp\r\n#endif\r\n\r\n#if !defined(mediump)\r\n#define mediump\r\n#endif\r\n\r\n#if !defined(highp)\r\n#define highp\r\n#endif\r\n\r\n#endif\r\n\r\nuniform mat4 u_matrix;\r\nuniform vec3 u_lightcolor;\r\nuniform lowp vec3 u_lightpos;\r\nuniform lowp float u_lightintensity;\r\nuniform float u_vertical_gradient;\r\nuniform lowp float u_opacity;\r\n\r\nattribute vec2 a_pos;\r\nattribute vec4 a_normal_ed;\r\n\r\nvarying vec4 v_color;\r\n\r\n// \u6761\u4ef6\u7f16\u8bd1\r\n// \u989c\u8272\r\n#ifndef HAS_UNIFORM_u_color\r\nuniform lowp float u_color_t;\r\nattribute highp vec4 a_color;\r\n#else\r\nuniform highp vec4 u_color;\r\n#endif\r\n\r\n// \u9ad8\u5ea6\r\n#ifndef HAS_UNIFORM_u_height\r\nuniform lowp float u_height_t;\r\nattribute highp vec2 a_height;\r\n#else\r\nuniform highp float u_height;\r\n#endif\r\n\r\n// \u5730\u5f62\r\n#ifdef HAS_TERRAIN\r\nuniform sampler2D u_height_image;\r\nuniform highp float u_min_height;\r\nuniform highp float u_delta_height;\r\n#else\r\n// \u5e95\u90e8\u9ad8\u5ea6\r\n#ifndef HAS_UNIFORM_u_base\r\nuniform lowp float u_base_t;\r\nattribute highp vec2 a_base;\r\n#else\r\nuniform highp float u_base;\r\n#endif\r\n#endif\r\n\r\n// \u5904\u7406\u51fd\u6570\r\nvec2 unpack_float(const float packedValue) {\r\n    int packedIntValue \x3d int(packedValue);\r\n    int v0 \x3d packedIntValue/256;\r\n    return vec2(v0, packedIntValue - v0 * 256);\r\n}\r\n\r\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\r\n    return mix(packedValue[0], packedValue[1], t);\r\n}\r\n\r\nvec4 decode_color(const vec2 encodedColor) {\r\n    return vec4(\r\n    unpack_float(encodedColor[0]) / 255.0,\r\n    unpack_float(encodedColor[1]) / 255.0\r\n    );\r\n}\r\n\r\nvec4 unpack_mix_color(const vec4 packedColors, const float t) {\r\n    vec4 minColor \x3d decode_color(vec2(packedColors[0], packedColors[1]));\r\n    vec4 maxColor \x3d decode_color(vec2(packedColors[2], packedColors[3]));\r\n    return mix(minColor, maxColor, t);\r\n}\r\n\r\nvoid main() {\r\n\r\n    #ifndef HAS_UNIFORM_u_height\r\n    highp float height \x3d unpack_mix_vec2(a_height, u_height_t);\r\n    #else\r\n    highp float height \x3d u_height;\r\n    #endif\r\n\r\n    #ifndef HAS_UNIFORM_u_color\r\n    highp vec4 color \x3d unpack_mix_color(a_color, u_color_t);\r\n    #else\r\n    highp vec4 color \x3d u_color;\r\n    #endif\r\n\r\n    #ifdef HAS_TERRAIN\r\n    vec3 rgb \x3d texture2D(u_height_image, a_pos/8192.0).rgb;\r\n    highp float base \x3d rgb.r * u_delta_height + u_min_height;\r\n    #else\r\n    #ifndef HAS_UNIFORM_u_base\r\n    highp float base \x3d unpack_mix_vec2(a_base, u_base_t);\r\n    #else\r\n    highp float base \x3d u_base;\r\n    #endif\r\n    #endif\r\n\r\n    vec3 normal \x3d a_normal_ed.xyz;\r\n    float t \x3d mod(normal.x, 2.0);\r\n    gl_Position \x3d u_matrix * vec4(a_pos, t \x3e 0.0 ? height + base : base, 1);\r\n    float colorvalue \x3d color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\r\n    v_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\r\n    vec4 ambientlight \x3d vec4(0.03, 0.03, 0.03, 1.0);\r\n    color +\x3d ambientlight;\r\n    float directional \x3d clamp(dot(normal / 16384.0, u_lightpos), 0.0, 1.0);\r\n    directional \x3d mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\r\n    if (normal.y !\x3d 0.0) {\r\n        directional *\x3d (\r\n        (1.0 - u_vertical_gradient) +\r\n        (u_vertical_gradient * clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0)));\r\n    }\r\n    v_color.r +\x3d clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\r\n    v_color.g +\x3d clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\r\n    v_color.b +\x3d clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\r\n    v_color *\x3d u_opacity;\r\n}\r\n",
"url:com/huayun/webgis/gl/shaders/fill_extrusion.fragment.glsl":"precision mediump float;\r\nvarying vec4 v_color;\r\n\r\nvoid main() {\r\n    gl_FragColor \x3d v_color;\r\n}\r\n","url:com/huayun/webgis/gl/shaders/cylinder.fragment.glsl":"precision mediump float;\r\nuniform float u_opacity;\r\n\r\n#ifdef HAS_PATTERN\r\nvarying vec2 v_uv;\r\nuniform sampler2D u_texture;\r\n#else\r\nuniform vec4 u_color;\r\n#endif\r\n\r\nvoid main() {\r\n    #ifdef HAS_PATTERN\r\n    gl_FragColor \x3d texture2D(u_texture, v_uv) * u_opacity;\r\n    #else\r\n    gl_FragColor \x3d u_color * u_opacity;\r\n    #endif\r\n}",
"url:com/huayun/webgis/gl/shaders/mesh.fragment.glsl":"precision mediump float;\r\nuniform vec3 u_color;\r\nvoid main() {\r\n    gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n}","url:com/huayun/webgis/gl/shaders/terrain.vertex.glsl":"const float m2d \x3d 111194.872221777 / 2.0;\r\n\r\nattribute vec4 position3DAndHeight;\r\nattribute vec3 textureCoordAndEncodedNormals;\r\n\r\nuniform mat4 u_matrix;\r\nuniform vec4 u_tileRectangle;\r\nuniform float u_resolution;\r\nvarying vec2 v_texture;\r\n//varying float color;\r\n\r\nfloat get2DGeographicYPositionFraction(vec2 textureCoordinates){\r\n    return 1.0 - textureCoordinates.y;\r\n}\r\n\r\nfloat get2DYPositionFraction(vec2 textureCoordinates) {\r\n    return get2DGeographicYPositionFraction(textureCoordinates);\r\n}\r\n\r\nvec4 getPositionPlanarEarth(vec3 position, float height, vec2 textureCoordinates){\r\n    float yPositionFraction \x3d get2DYPositionFraction(textureCoordinates);\r\n    vec4 rtcPosition2D \x3d vec4(mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), height/  111194.872221777, 1.0);\r\n    return u_matrix * rtcPosition2D;\r\n}\r\n\r\nvec4 getPositionColumbusViewMode(vec3 position, float height, vec2 textureCoordinates){\r\n    return getPositionPlanarEarth(position, height, textureCoordinates);\r\n}\r\n\r\nvec4 getPosition(vec3 position, float height, vec2 textureCoordinates) {\r\n    return getPositionColumbusViewMode(position, height, textureCoordinates);\r\n}\r\n\r\nvoid main() {\r\n    //    gl_Position \x3d u_matrix * vec4(a_pos, 0, 1);\r\n    vec3 position \x3d position3DAndHeight.xyz;\r\n    float height \x3d position3DAndHeight.w;\r\n    vec2 textureCoordinates \x3d textureCoordAndEncodedNormals.xy;\r\n    gl_Position \x3d getPosition(position, height, textureCoordinates);\r\n    v_texture \x3d textureCoordinates;\r\n    /*float ratio \x3d height / 200.0;\r\n    if (ratio \x3e 1.0) {\r\n        color \x3d 1.0;\r\n    } else {\r\n        color \x3d ratio;\r\n    }*/\r\n    /*if (height \x3e 20.0) {\r\n        color \x3d 1.0;\r\n    } else {\r\n        color \x3d 0.0;\r\n    }*/\r\n}",
"url:com/huayun/webgis/gl/shaders/cone.fragment.glsl":"precision mediump float;\r\nvarying vec4 v_color;\r\n\r\nvoid main() {\r\n    gl_FragColor \x3d v_color;\r\n}","url:com/huayun/webgis/gl/shaders/tifTerrain.fragment.glsl":"precision mediump float;\r\n\r\nuniform sampler2D u_image;\r\nvarying vec2 v_texture;\r\n\r\nvoid main() {\r\n//    vec2 tex_location \x3d vec2(v_texture.x, 1.0 - v_texture.y);\r\n    if(v_texture.x \x3c 0.0 || v_texture.x \x3e 1.0 || v_texture.y \x3c 0.0 || v_texture.y \x3e 1.0) {\r\n        discard;\r\n    }\r\n    gl_FragColor \x3d texture2D(u_image, v_texture);\r\n}",
"url:com/huayun/webgis/gl/shaders/line.fragment.glsl":"precision mediump float;\r\n\r\nvarying vec2 v_width2;\r\nvarying vec2 v_normal;\r\nvarying float v_gamma_scale;\r\nuniform highp vec4 u_color;\r\nuniform lowp float u_opacity;\r\n\r\nvoid main() {\r\n\r\n\r\n    highp vec4 color \x3d u_color;\r\n    lowp float blur \x3d 0.0;\r\n    lowp float opacity \x3d u_opacity;\r\n    lowp float u_device_pixel_ratio \x3d 1.0;\r\n\r\n    float dist \x3d length(v_normal) * v_width2.s;\r\n\r\n    float blur2 \x3d (blur + 1.0 / u_device_pixel_ratio) * v_gamma_scale;\r\n    float alpha \x3d clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\r\n    gl_FragColor \x3d color * (alpha * opacity);\r\n}",
"url:com/huayun/webgis/gl/shaders/line.vertex.glsl":"precision highp float;\r\n\r\n#define scale 0.01587301\r\n// #define scale 0.007936508\r\n\r\nattribute vec3 a_pos;\r\nattribute vec4 a_data;\r\nattribute vec2 a_normal;\r\n\r\nuniform mat4 u_matrix;\r\nuniform mediump float u_ratio;\r\nuniform vec2 u_units_to_pixels;\r\n\r\nvarying vec2 v_normal;\r\nvarying vec2 v_width2;\r\nvarying float v_gamma_scale;\r\nvarying highp float v_linesofar;\r\n\r\nuniform highp vec4 u_color;\r\nuniform lowp float u_blur;\r\nuniform lowp float u_opacity;\r\nuniform mediump float u_gapwidth;\r\nuniform lowp float u_offset;\r\nuniform mediump float u_width;\r\n\r\nvoid main() {\r\n    highp vec4 color \x3d u_color;\r\n    lowp float blur \x3d u_blur;\r\n    lowp float opacity \x3d u_opacity;\r\n    mediump float gapwidth \x3d u_gapwidth;\r\n    lowp float offset \x3d u_offset;\r\n    mediump float width \x3d u_width;\r\n\r\n    // the distance over which the line edge fades out.\r\n    // Retina devices need a smaller distance to avoid aliasing.\r\n    float ANTIALIASING \x3d 0.5;\r\n\r\n    vec2 a_extrude \x3d a_data.xy - 128.0;\r\n    float a_direction \x3d mod(a_data.z, 4.0) - 1.0;\r\n\r\n    v_linesofar \x3d (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0;\r\n\r\n    vec2 pos \x3d a_pos.xy;\r\n\r\n    mediump vec2 normal \x3d a_normal;\r\n    normal.y \x3d normal.y * 2.0 - 1.0;\r\n    v_normal \x3d normal;\r\n\r\n    // these transformations used to be applied in the JS and native code bases.\r\n    // moved them into the shader for clarity and simplicity.\r\n    gapwidth \x3d gapwidth / 2.0;\r\n    float halfwidth \x3d width / 2.0;\r\n    offset \x3d -1.0 * offset;\r\n\r\n    float inset \x3d gapwidth + (gapwidth \x3e 0.0 ? ANTIALIASING : 0.0);\r\n    float outset \x3d gapwidth + halfwidth * (gapwidth \x3e 0.0 ? 2.0 : 1.0) + (halfwidth \x3d\x3d 0.0 ? 0.0 : ANTIALIASING);\r\n\r\n    // Scale the extrusion vector down to a normal and then up by the line width\r\n    // of this vertex.\r\n    mediump vec2 dist \x3d outset * a_extrude * scale;\r\n\r\n    // Calculate the offset when drawing a line that is to the side of the actual line.\r\n    // We do this by creating a vector that points towards the extrude, but rotate\r\n    // it when we're drawing round end points (a_direction \x3d -1 or 1) since their\r\n    // extrude vector points in another direction.\r\n    mediump float u \x3d 0.5 * a_direction;\r\n    mediump float t \x3d 1.0 - abs(u);\r\n    mediump vec2 offset2 \x3d offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\r\n\r\n    vec4 projected_extrude \x3d u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\r\n    gl_Position \x3d u_matrix * vec4(pos + offset2 / u_ratio, a_pos.z, 1.0) + projected_extrude;\r\n\r\n    // calculate how much the perspective view squishes or stretches the extrude\r\n    float extrude_length_without_perspective \x3d length(dist);\r\n    float extrude_length_with_perspective \x3d length(projected_extrude.xy / gl_Position.w * u_units_to_pixels);\r\n    v_gamma_scale \x3d extrude_length_without_perspective / extrude_length_with_perspective;\r\n\r\n    v_width2 \x3d vec2(outset, inset);\r\n}",
"url:com/huayun/webgis/gl/shaders/rect.fragment.glsl":"precision mediump float;\r\nuniform vec4 u_color;\r\n\r\nvoid main() {\r\n    gl_FragColor \x3d u_color;\r\n}","url:com/huayun/webgis/gl/shaders/height_map.fragment.glsl":"precision mediump float;\r\nvarying float v_color;\r\n\r\nvoid main() {\r\n//    gl_FragColor \x3d vec4(v_color, v_color, v_color, 1.0);\r\n    gl_FragColor \x3d vec4(v_color, v_color, v_color, 1.0);\r\n}","url:com/huayun/webgis/gl/shaders/rect.vertex.glsl":"attribute vec2 a_pos;\r\nattribute vec4 a_size;\r\n\r\nuniform mat4 u_matrix;\r\nuniform lowp float u_device_pixel_ratio;\r\nuniform highp float u_camera_to_center_distance;\r\nuniform mediump vec2 u_extrude_scale;\r\nuniform highp float u_radian;\r\nuniform bool u_is_stroke;\r\n\r\nuniform highp float u_size;\r\n\r\nvoid main() {\r\n    gl_Position \x3d u_matrix * vec4(a_pos, 0.0, 1.0);\r\n    highp float angle_sin \x3d sin(u_radian);\r\n    highp float angle_cos \x3d cos(u_radian);\r\n    mat2 rotation_matrix \x3d mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\r\n    vec2 core_size \x3d a_size.xy / 2.0;\r\n    vec2 stroke_size \x3d a_size.zw / 2.0;\r\n    vec2 rotated_extrude;\r\n    if (u_is_stroke) {\r\n        rotated_extrude \x3d rotation_matrix * stroke_size * u_size;\r\n    } else {\r\n        rotated_extrude \x3d rotation_matrix * core_size * u_size;\r\n    }\r\n    gl_Position.xy +\x3d rotated_extrude * u_extrude_scale * u_camera_to_center_distance;\r\n}",
"url:com/huayun/webgis/gl/shaders/tiffTerrain.vertex.glsl":"precision highp float;\r\n\r\nattribute vec3 a_pos;\r\nuniform mat4 u_matrix;\r\n\r\nvarying vec2 v_texture;\r\n\r\nvoid main() {\r\n    vec2 pos \x3d a_pos.xy * 8192.0;\r\n    float height \x3d a_pos.z;\r\n    gl_Position \x3d u_matrix * vec4(pos, height, 1.0);\r\n    v_texture \x3d a_pos.xy;\r\n}","url:com/huayun/webgis/gl/shaders/terrain.fragment.glsl":"precision mediump float;\r\nuniform vec4 u_color;\r\n//varying float color;\r\nuniform sampler2D u_image;\r\nvarying vec2 v_texture;\r\n// const float m2d \x3d 111194.872221777 / 2.0;\r\n\r\nvoid main() {\r\n    vec2 tex_location \x3d vec2(v_texture.x, 1.0 - v_texture.y);\r\n    vec4 color0 \x3d texture2D(u_image, tex_location);\r\n    gl_FragColor \x3d color0;\r\n//    gl_FragColor \x3d vec4(color, color, color, 1.0);\r\n//    gl_FragColor \x3d vec4(1.0, 1.0, 0.0, 1.0);\r\n}",
"url:com/huayun/webgis/gl/shaders/background.fragment.glsl":"precision mediump float;\r\n\r\n/*uniform sampler2D u_image;\r\nvarying vec2 v_texture;*/\r\nvarying float y_screen;\r\n\r\nvoid main() {\r\n    //    gl_FragColor \x3d texture2D(u_image, v_texture);\r\n    float fogFactor \x3d 1.0 - smoothstep(0.3, 0.5, y_screen);\r\n    gl_FragColor \x3d vec4(0.94, 0.93, 0.91, 1.0) * (1.0-fogFactor) + vec4(0.0, 0.0, 0.0, 0.0) * fogFactor;\r\n}","url:com/huayun/webgis/gl/shaders/mesh.vertex.glsl":"precision highp float;\r\nattribute vec3 position;\r\nuniform mat4 u_matrix;\r\nuniform mat4 u_model;\r\nvoid main() {\r\n    gl_Position \x3d u_matrix * u_model * vec4(position, 1.0);\r\n}",
"url:com/huayun/webgis/gl/shaders/cone.vertex.glsl":"attribute vec3 a_pos;\r\nattribute vec4 a_color;\r\n\r\nvarying vec4 v_color;\r\nuniform mat4 u_matrix;\r\n\r\nvoid main() {\r\n    gl_Position \x3d u_matrix * vec4(a_pos, 1.0);\r\n    v_color \x3d a_color;\r\n}\r\n","url:com/huayun/webgis/gl/shaders/water.fragment.glsl":"precision mediump float;\r\nvoid main() {\r\n    gl_FragColor \x3d vec4(0.3, 0.7, 0.72, 1.0);\r\n}","url:com/huayun/webgis/gl/shaders/water.vertex.glsl":"attribute vec3 a_pos;\r\nuniform mat4 u_matrix;\r\nuniform float u_water_depth;\r\nvoid main() {\r\n    gl_Position \x3d u_matrix * vec4(a_pos.xy, a_pos.z \x3e 0.0?u_water_depth:0.0, 1.0);\r\n}",
"url:com/huayun/webgis/gl/shaders/height_map.vertex.glsl":"precision highp float;\r\n\r\nattribute vec3 a_pos;\r\n\r\nuniform float u_min_height;\r\nuniform float u_delta_height;\r\nvarying float v_color;\r\n\r\nvoid main() {\r\n    float height \x3d a_pos.z;\r\n    gl_Position \x3d vec4(a_pos.xy * 2.0 - 1.0, 0.0, 1.0);\r\n    v_color \x3d (height - u_min_height) / u_delta_height;\r\n}\r\n\r\n/*\r\nattribute vec4 position3DAndHeight;\r\nattribute vec3 textureCoordAndEncodedNormals;\r\n\r\nuniform float u_min_height;\r\nuniform float u_delta_height;\r\nvarying float v_color;\r\n\r\nvec4 getPosition(vec3 position, float height, vec2 textureCoordinates) {\r\n    float yPositionFraction \x3d 1.0 - textureCoordinates.y;\r\n    return vec4(textureCoordinates.x * 2.0 -1.0, yPositionFraction* 2.0 -1.0, 0.0, 1.0);\r\n}\r\n\r\nvoid main() {\r\n    vec3 position \x3d position3DAndHeight.xyz;\r\n    float height \x3d position3DAndHeight.w;\r\n    vec2 textureCoordinates \x3d textureCoordAndEncodedNormals.xy;\r\n    gl_Position \x3d getPosition(position, 0.0, textureCoordinates);\r\n    v_color \x3d (height - u_min_height) / u_delta_height;\r\n}*/",
"url:com/huayun/webgis/gl/shaders/cylinder.vertex.glsl":"attribute vec3 a_pos;\r\n\r\n#ifdef HAS_PATTERN\r\nattribute vec2 a_uv;\r\nvarying vec2 v_uv;\r\n#endif\r\n\r\nuniform mat4 u_matrix;\r\nuniform float u_size;\r\n\r\nvoid main() {\r\n    gl_Position \x3d u_matrix * vec4(u_size * a_pos.xy, a_pos.z, 1.0);\r\n    #ifdef HAS_PATTERN\r\n    v_uv \x3d a_uv;\r\n    #endif\r\n}\r\n","url:com/huayun/webgis/gl/shaders/background.vertex.glsl":"attribute vec4 a_pos;\r\n\r\nvarying float y_screen;\r\n//varying vec2 v_texture;\r\n\r\nvoid main() {\r\n    gl_Position \x3d vec4(a_pos.xy, 0.0, 1.0);\r\n//    v_texture \x3d a_pos.zw;\r\n    y_screen \x3d a_pos.y;\r\n}"}});
(function(){var f=this.require;f({cache:{}});!f.async&&f(["dojo"]);f.boot&&f.apply(null,f.boot)})();
//# sourceMappingURL=BaseMap.js.map