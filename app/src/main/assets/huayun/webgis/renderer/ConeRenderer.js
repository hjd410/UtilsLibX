//>>built
define("com/huayun/webgis/renderer/ConeRenderer",["../data/ArrayType","../gl/SegmentVector","../gl/mode","../gl/programCache"],function(_1,_2,_3,_4){function _5(){};_5.prototype.add=function(_6,_7,_8,_9){var _a=_8.position;var _b=_8.radius,_c=_8.length,_d=_8.slices,_e=Math.PI*2/_d;var _f=_6.context;var _10=new _1.StructArrayLayout7fb28();var _11=new _1.StructArrayLayout3ui6();var _12=_9.topColor,_13=_9.bottomColor;_10.emplaceBack(0,0,0,_13[0],_13[1],_13[2],_13[3]);var i,_14,cos,sin;for(i=0;i<_d;i++){_14=i*_e;cos=Math.cos(_14);sin=Math.sin(_14);_10.emplaceBack(_b*cos,_b*sin,_c,_12[0],_12[1],_12[2],_12[3]);}for(i=1;i<=_d;i++){if(i===_d){_11.emplaceBack(0,1,i);}else{_11.emplaceBack(0,i+1,i);}}for(i=1;i<_d-1;i++){_11.emplaceBack(i,i+1,_d);}_7.buckets.push({layoutVertexBuffer:_f.createVertexBuffer(_10,[{name:"a_pos",type:"Float32",components:3,offset:0},{name:"a_color",type:"Float32",components:4,offset:12},]),indexBuffer:_f.createIndexBuffer(_11),segments:_2.simpleSegment(0,0,_d+1,_d+2)});_7.position=[_a.x,_a.y,_a.z];};_5.prototype.draw=function(_15,_16,_17,_18,_19,_1a){if(_1a===undefined){_1a=0;}var _1b=_15.context;var gl=_1b.gl;var _1c;if(_19){_1c=_19.depthModeForSublayer(0,_3.DepthMode.ReadOnly);}else{_1c=new _3.DepthMode(gl.LEQUAL,_3.DepthMode.ReadOnly,[0.9,0.9]);}var _1d=_3.StencilMode.disabled;var _1e=_3.ColorMode.alphaBlended;var _1f=_4.useProgramSimplify(_1b,"cone",{layoutAttributes:[{name:"a_pos",type:"Float32",components:3,offset:0}]});var _20=_18.uniforms;var _21=_16.position;_20["u_matrix"]=_15.viewpoint.getMatrixForPoint(_21[0],_21[1],false,false,_21[2]);var _22=_16.buckets;var _23=_22[0];_1f.draw(_1b,gl.TRIANGLES,_1c,_1d,_1e,_3.CullFaceMode.disabled,_20,_16.id+"-cone",_23.layoutVertexBuffer,_23.indexBuffer,_23.segments);};_5.prototype.calculateExtent=function(){};return _5;});