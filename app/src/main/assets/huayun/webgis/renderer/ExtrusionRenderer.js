//>>built
define("com/huayun/webgis/renderer/ExtrusionRenderer",["../gl/mode","../gl/programCache","../geometry/Point","../data/bucket/FillExtrusionBucketSimplify"],function(_1,_2,_3,_4){function _5(){};_5.prototype.add=function(_6,_7,_8,_9){var _a=_7.position||_6.viewpoint.center||[0,0],cx=_a[0],cy=_a[1];var _b=_8.path;var g=[];for(var i=0;i<_b.length;i++){var _c=_b[i];var l=[];for(var j=0;j<_c.length;j++){var p=_c[j];l.push(new _3(Math.round(p.x-cx),Math.round(p.y-cy),0));}g.push(l);}var _d=new _4();_d.addFeature(g);_d.upload(_6.context);_7.buckets.push(_d);_7.position=[cx,cy];};_5.prototype.draw=function(_e,_f,_10,_11,_12,_13){if(_13===undefined){_13=0;}var _14=_1.ColorMode.alphaBlended;var _15=_e.context;var gl=_15.gl;var _16;if(_12){_16=_12.depthModeForSublayer(0,_1.DepthMode.ReadWrite);}else{_16=new _1.DepthMode(gl.LEQUAL,_1.DepthMode.ReadWrite,[0.9,0.9]);}var _17=_2.useProgramSimplify(_15,"fillExtrusion2",{layoutAttributes:[{name:"a_pos",type:"Int16",components:2,offset:0},{name:"a_normal_ed",type:"Int16",components:4,offset:4}],defines:["#define HAS_UNIFORM_u_color","#define HAS_UNIFORM_u_height","#define HAS_UNIFORM_u_base"]});var _18=_11.uniforms;var _19=_f.position;_18["u_matrix"]=_e.viewpoint.getMatrixForPoint(_19[0],_19[1],false,false,20);var _1a=_f.buckets[_13];_17.draw(_15,gl.TRIANGLES,_16,null,_14,_1.CullFaceMode.disabled,_18,_f.id+"-extrusion"+_13,_1a.layoutVertexBuffer,_1a.indexBuffer,_1a.segments);};_5.prototype.calculateExtent=function(){};return _5;});