//>>built
define("com/huayun/webgis/work/support/StyleLayerIndex",["../../layers/support/style/expressionFactory","../../layers/support/style/createStyleLayer","../../utils/utils"],function(_1,_2,_3){var _4=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function _5(_6){var _7="";for(var i=0,_8=_4;i<_8.length;i+=1){var k=_8[i];_7+="/"+(JSON.stringify(_6[k]));}return _7;};function _9(_a,_b){var _c={};for(var i=0;i<_a.length;i++){var k=(_b&&_b[_a[i].id])||_5(_a[i]);if(_b){_b[_a[i].id]=k;}var _d=_c[k];if(!_d){_d=_c[k]=[];}_d.push(_a[i]);}var _e=[];for(var _f in _c){_e.push(_c[_f]);}return _e;};var _10=function _10(_11){this.keyCache={};if(_11){this.replace(_11);}};_10.prototype.replace=function replace(_12){this._layerConfigs={};this._layers={};this.update(_12,[]);};_10.prototype.update=function update(_13,_14){var _15=this;for(var i=0,_16=_13;i<_16.length;i+=1){var _17=_16[i];this._layerConfigs[_17.id]=_17;var _18=this._layers[_17.id]=_2(_17);_18._featureFilter=_1.createFilter(_18.filter);if(this.keyCache[_17.id]){delete this.keyCache[_17.id];}}for(var i$1=0,_19=_14;i$1<_19.length;i$1+=1){var id=_19[i$1];delete this.keyCache[id];delete this._layerConfigs[id];delete this._layers[id];}this.familiesBySource={};var _1a=_9(_3.values(this._layerConfigs),this.keyCache);for(var i$2=0,_1b=_1a;i$2<_1b.length;i$2+=1){var _1c=_1b[i$2];var _1d=_1c.map(function(_1e){return _15._layers[_1e.id];});var _1f=_1d[0];if(_1f.visibility==="none"){continue;}var _20=_1f.source||"";var _21=this.familiesBySource[_20];if(!_21){_21=this.familiesBySource[_20]={};}var _22=_1f.sourceLayer||"_geojsonTileLayer";var _23=_21[_22];if(!_23){_23=_21[_22]=[];}_23.push(_1d);}};return _10;});