//>>built
define("com/huayun/webgis/symbols/TextSymbol",["./Symbol","../utils/Color","./support/glyphManager","./support/CustomGlyphAtlas"],function(_1,_2,_3,_4){var _5=function(_6){_1.call(this,_6);var _7=_2.parse(_6.color||"#FF0000"),_8=_6.opacity===undefined?1:_6.opacity,_9=Number(_6.size||_6["font-size"]);this.fontSize=_9;var _a=_6.isRotate===undefined?false:_6.isRotate;var _b=_6.rotateRadian===undefined?0:_6.rotateRadian;var _c=_6.offset||[Number(_6.dx),Number(_6.dy)];this.offset=_c.map(function(_d){return _d/_9;});this.hasHalo=_6["stroke"]||!!_6.halo;var _e,_f,_10;if(this.hasHalo){if(_6.halo){_e=_6.halo.blur||0;_f=_2.parse(_6.halo.color||"#FF0000");_10=_6.halo.width||Number(_6["stroke-width"]);}else{_e=0;_f=_2.parse(_6.stroke||"#FF0000");_10=Number(_6["stroke-width"]);}}else{_e=0;_f=_2.parse("#FFF");_10=0;}this.type="text";this.uniforms={"u_size":this.fontSize,"u_pitch_with_map":0,"u_opacity":_8,"u_texture":0,"u_fill_color":[_7.r,_7.g,_7.b,_7.a],"u_gamma_scale":1,"u_rotate_symbol":_a,"u_radian":_b,"u_halo_color":[_f.r,_f.g,_f.b,_f.a],"u_halo_width":_10,"u_halo_blur":_e,"u_is_halo":this.hasHalo?1:0};var _11=_6.text;var _12=_6.font||_6["font-family"]||"sans-serif";this.font=_12;if(_11){this.text=_11;var _13={};_13[_12]=[];for(var i=0,len=_11.length;i<len;i++){_13[_12].push(_11.charCodeAt(i));}this.glyphMap=_3.getGlyphs(_13);this.glyphAtlas=new _4(this.glyphMap);var _14=this.glyphAtlas.image;this.width=_14.width;this.height=_14.height;this.textWidth=this.glyphAtlas.textWidth;}};if(_1){_5.__proto__=_1;}_5.prototype=Object.create(_1&&_1.prototype);_5.prototype.constructor=_5;_5.prototype.setText=function(_15,_16){if(_15===undefined||_15.length===0){return;}this.text=_15;if(!_16){_16=this.font;}var _17={};_17[_16]=[];for(var i=0,len=_15.length;i<len;i++){_17[_16].push(_15.charCodeAt(i));}this.glyphMap=_3.getGlyphs(_17);this.glyphAtlas=new _4(this.glyphMap);var _18=this.glyphAtlas.image;this.width=_18.width;this.height=_18.height;this.textWidth=24*_15.length;};_5.prototype.setOffset=function(_19){var _1a=this.uniforms.u_size;this.offset=_19.map(function(_1b){return _1b/_1a;});};return _5;});