//>>built
define("com/huayun/webgis/symbols/support/CustomGlyphAtlas",["../../gl/potpack","../../utils/image"],function(_1,_2){var _3=1;return function(_4){var _5={};var _6=0,_7=-Infinity;var _8=0;for(var _9 in _4){var _a=_4[_9];var _b=_5[_9]={};for(var id in _a){var _c=_a[+id];if(!_c||_c.bitmap.width===0||_c.bitmap.height===0){continue;}var _d={x:_6,y:0,w:_c.bitmap.width+2*_3,h:_c.bitmap.height+2*_3};_6+=_d.w;_8+=_c.metrics.advance;if(_d.h>_7){_7=_d.h;}_b[id]={rect:_d,metrics:_c.metrics};}}var w=_6,h=_7;var _e=new _2.AlphaImage({width:w||1,height:h||1});for(var _f in _4){var _10=_4[_f];for(var _11 in _10){var _12=_10[+_11];if(!_12||_12.bitmap.width===0||_12.bitmap.height===0){continue;}var _13=_5[_f][_11].rect;_2.AlphaImage.copy(_12.bitmap,_e,{x:0,y:0},{x:_13.x+_3,y:_13.y+_3},_12.bitmap);}}this.image=_e;this.positions=_5;this.textWidth=_8;};});