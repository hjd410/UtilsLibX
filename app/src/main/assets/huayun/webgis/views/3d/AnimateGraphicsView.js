//>>built
define("com/huayun/webgis/views/3d/AnimateGraphicsView",["exports","custom/gl-matrix-min","com/huayun/webgis/gl/mode","com/huayun/webgis/data/ArrayType","com/huayun/webgis/gl/SegmentVector","com/huayun/webgis/geometry/Point"],function(_1,_2,_3,_4,_5,_6){var _7=function(_8,_9,_a){var _b=new _4.StructArrayLayout3ui6();_b.emplaceBack(0,1,2);_b.emplaceBack(1,3,2);var _c=new _4.StructArrayLayout3f12();_c.emplaceBack(0,1,0);_c.emplaceBack(0,-1,0);_c.emplaceBack(1,1,1);_c.emplaceBack(1,-1,1);var _d=_8.feature.geometry;var _e=_9.viewpoint.center,cx=_e[0],cy=_e[1];var _f=_d.path;var _10=0;var _11=new _4.StructArrayLayout6fb24();for(var i=0;i<_f.length;i++){var _12=_f[i];var p1=_12[0],p2=_12[1],p3=_12[2];_11.emplaceBack(Math.round(p1.x-cx),Math.round(p1.y-cy),Math.round(p2.x-cx),Math.round(p2.y-cy),Math.round(p3.x-cx),Math.round(p3.y-cy));_10++;}var _13=_9.context.createVertexBuffer(_11,[{name:"source",type:"Float32",components:2,offset:0},{name:"middle",type:"Float32",components:2,offset:8},{name:"target",type:"Float32",components:2,offset:16}]);_8.vertexBuffer=_9.context.createVertexBuffer(_c,[{name:"a_data",type:"Float32",components:3,offset:0}]);_8.indexBuffer=_9.context.createIndexBuffer(_b);_8.instanceBuffer=_13;_8.segment=_5.simpleSegment(0,0,4,2);_8.position=[cx,cy];_8.count=_10;};var _14=function(_15,_16){var _17=_3.ColorMode.srcBlended;var _18=_15.depthModeForSublayer();var _19=_15.view.context;var _1a=_3.StencilMode.disabled;var gl=_19.gl;var _1b=_15.view.useProgramSimplify("moveLine",{layoutAttributes:[{name:"a_data",type:"Float32",components:3,offset:0},{name:"source",type:"Float32",components:2,offset:0},{name:"middle",type:"Float32",components:2,offset:8},{name:"target",type:"Float32",components:2,offset:16}]});var _1c=_16.symbol;var _1d=_1c.uniforms;var _1e=_16.position;_1d["u_matrix"]=_15.transform.getMatrixForPoint(_1e[0],_1e[1]);_1d["segment"]=50;_1d["u_len"]=_1c.length*_15.view.resolution;_1b.drawInstancedANGLE(_19,gl.TRIANGLES,_18,null,_17,_3.CullFaceMode.disabled,_1d,_16.id,_16.vertexBuffer,_16.indexBuffer,_16.segment,_16.instanceBuffer,_16.count);};var _1f=function(_20,_21,_22){var _23=new _4.StructArrayLayout3ui6();_23.emplaceBack(0,1,2);_23.emplaceBack(1,3,2);var _24=new _4.StructArrayLayout3f12();_24.emplaceBack(-1,1,0);_24.emplaceBack(-1,-1,0);_24.emplaceBack(1,1,1);_24.emplaceBack(1,-1,1);var _25=_20.feature.geometry;var _26=_21.viewpoint.center,cx=_26[0],cy=_26[1];var _27=_25.path;var _28=0;var _29=new _4.StructArrayLayout6fb24();for(var i=0;i<_27.length;i++){var _2a=_27[i];var p1=_2a[0],p2=_2a[1];_29.emplaceBack(Math.round(p1.x-cx),Math.round(p1.y-cy),0,Math.round(p2.x-cx),Math.round(p2.y-cy),0);_28++;}var _2b=_21.context.createVertexBuffer(_29,[{name:"source",type:"Float32",components:3,offset:0},{name:"target",type:"Float32",components:3,offset:12}]);_20.vertexBuffer=_21.context.createVertexBuffer(_24,[{name:"a_pos",type:"Float32",components:3,offset:0}]);_20.indexBuffer=_21.context.createIndexBuffer(_23);_20.instanceBuffer=_2b;_20.segment=_5.simpleSegment(0,0,4,2);_20.position=[cx,cy];_20.count=_28;};var _2c=function(_2d,_2e){var _2f=_2d.view.context;var gl=_2f.gl;var _30=_2d.depthModeForSublayer(0,_3.DepthMode.ReadOnly);var _31=_3.ColorMode.srcBlended;var _32=_2e.symbol;var _33=_2d.view.useProgramSimplify("moveArc",{layoutAttributes:[{name:"a_pos",type:"Float32",components:3,offset:0},{name:"source",type:"Float32",components:3,offset:0},{name:"target",type:"Float32",components:3,offset:12}]});var _34=_32.uniforms;var _35=_2e.position;_34["u_matrix"]=_2d.transform.getMatrixForPoint(_35[0],_35[1]);_34["numSegments"]=50;_34["u_len"]=_32.length*_2d.view.resolution;_33.drawInstancedANGLE(_2f,gl.TRIANGLES,_30,null,_31,_3.CullFaceMode.disabled,_34,_2e.id,_2e.vertexBuffer,_2e.indexBuffer,_2e.segment,_2e.instanceBuffer,_2e.count);};var _36=function(_37,_38,_39){var _3a=50;var _3b=new _4.StructArrayLayout1f4();for(var i=0;i<_3a;i++){_3b.emplaceBack(i/_3a);}var _3c=_37.feature.geometry;var _3d=_38.viewpoint.center,cx=_3d[0],cy=_3d[1];var _3e=_3c.path;var _3f=0;var _40=new _4.StructArrayLayout6fb24();for(i=0;i<_3e.length;i++){var _41=_3e[i];var p1=_41[0],p2=_41[1];_40.emplaceBack(Math.round(p1.x-cx),Math.round(p1.y-cy),0,Math.round(p2.x-cx),Math.round(p2.y-cy),0);_3f++;}_37.vertexBuffer=_38.context.createVertexBuffer(_3b,[{name:"a_ratio",type:"Float32",components:1,offset:0}]);_37.instanceBuffer=_38.context.createVertexBuffer(_40,[{name:"source",type:"Float32",components:3,offset:0},{name:"target",type:"Float32",components:3,offset:12}]);_37.segment=_5.simpleSegment(0,0,_3a,1);_37.position=[cx,cy];_37.count=_3f;};var _42=function(_43,_44){var _45=_3.ColorMode.srcBlended;var _46=_43.depthModeForSublayer(0,_3.DepthMode.ReadOnly);var _47=_43.view.context;var gl=_47.gl;var _48=_43.view.useProgramSimplify("arcParticle",{layoutAttributes:[{name:"a_ratio",type:"Float32",components:1,offset:0},{name:"source",type:"Float32",components:3,offset:0},{name:"target",type:"Float32",components:3,offset:12}]});var _49=_44.symbol;var _4a=_49.uniforms;var _4b=_44.position;_4a["u_matrix"]=_43.transform.getMatrixForPoint(_4b[0],_4b[1]);_48.drawArraysInstancedANGLE(_47,gl.POINTS,_46,null,_45,_3.CullFaceMode.disabled,_4a,_44.id,_44.vertexBuffer,null,_44.segment,_44.instanceBuffer,_44.count);};_1.draw={line:_14,arc:_2c,arcParticle:_42};_1.add={line:_7,arc:_1f,arcParticle:_36};});