//>>built
define("com/huayun/webgis/gl/Texture",[],function(){var _1=function _1(_2,_3,_4,_5){this.context=_2;this.format=_4;this.texture=_2.gl.createTexture();this.update(_3,_5);};_1.prototype.update=function update(_6,_7,_8){var _9=_6.width;var _a=_6.height;var _b=(!this.size||this.size[0]!==_9||this.size[1]!==_a)&&!_8;var _c=this;var _d=_c.context;var gl=_d.gl;this.useMipmap=Boolean(_7&&_7.useMipmap);gl.bindTexture(gl.TEXTURE_2D,this.texture);_d.pixelStoreUnpackFlipY.set(false);_d.pixelStoreUnpack.set(1);_d.pixelStoreUnpackPremultiplyAlpha.set(this.format===gl.RGBA&&(!_7||_7.premultiply!==false));if(_b){this.size=[_9,_a];if(_6 instanceof HTMLImageElement||_6 instanceof HTMLCanvasElement||_6 instanceof HTMLVideoElement||_6 instanceof ImageData){gl.texImage2D(gl.TEXTURE_2D,0,this.format,this.format,gl.UNSIGNED_BYTE,_6);}else{gl.texImage2D(gl.TEXTURE_2D,0,this.format,_9,_a,0,this.format,gl.UNSIGNED_BYTE,_6.data);}}else{var _e=_8||{x:0,y:0};var x=_e.x;var y=_e.y;if(_6 instanceof HTMLImageElement||_6 instanceof HTMLCanvasElement||_6 instanceof HTMLVideoElement||_6 instanceof ImageData){gl.texSubImage2D(gl.TEXTURE_2D,0,x,y,gl.RGBA,gl.UNSIGNED_BYTE,_6);}else{gl.texSubImage2D(gl.TEXTURE_2D,0,x,y,_9,_a,gl.RGBA,gl.UNSIGNED_BYTE,_6.data);}}if(this.useMipmap&&this.isSizePowerOfTwo()){gl.generateMipmap(gl.TEXTURE_2D);}};_1.prototype.bind=function bind(_f,_10,_11){var ref=this;var _12=ref.context;var gl=_12.gl;gl.bindTexture(gl.TEXTURE_2D,this.texture);if(_11===gl.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()){_11=gl.LINEAR;}if(_f!==this.filter){gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,_f);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,_11||_f);this.filter=_f;}if(_10!==this.wrap){gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,_10);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,_10);this.wrap=_10;}};_1.prototype.isSizePowerOfTwo=function isSizePowerOfTwo(){return this.size[0]===this.size[1]&&(Math.log(this.size[0])/Math.LN2)%1===0;};_1.prototype.destroy=function destroy(){var ref=this.context;var gl=ref.gl;gl.deleteTexture(this.texture);this.texture=(null);};return _1;});