//>>built
define("com/huayun/webgis/gl/Buffer",["exports","./BaseValue","../utils/Constant"],function(f,_1,_2){function _3(_4,_5,_6){this.context=_4;var gl=_4.gl;this.buffer=gl.createBuffer();this.dynamicDraw=Boolean(_6);this.context.unbindVAO();_4.bindElementBuffer.set(this.buffer);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,_5.arrayBuffer,this.dynamicDraw?gl.DYNAMIC_DRAW:gl.STATIC_DRAW);if(!this.dynamicDraw){delete _5.arrayBuffer;}};_3.prototype.bind=function bind(){this.context.bindElementBuffer.set(this.buffer);};_3.prototype.updateData=function updateData(_7){var gl=this.context.gl;this.context.unbindVAO();this.bind();gl.bufferSubData(gl.ELEMENT_ARRAY_BUFFER,0,_7.arrayBuffer);};_3.prototype.destroy=function destroy(){var gl=this.context.gl;if(this.buffer){gl.deleteBuffer(this.buffer);delete this.buffer;}};f.IndexBuffer=_3;var _8=function _8(_9,_a,_b,_c){this.length=_a.length;this.attributes=_b;this.itemSize=_a.bytesPerElement;this.dynamicDraw=_c;this.context=_9;var gl=_9.gl;this.buffer=gl.createBuffer();_9.bindVertexBuffer.set(this.buffer);gl.bufferData(gl.ARRAY_BUFFER,_a.arrayBuffer,this.dynamicDraw?gl.DYNAMIC_DRAW:gl.STATIC_DRAW);if(!this.dynamicDraw){delete _a.arrayBuffer;}};_8.prototype.bind=function bind(){this.context.bindVertexBuffer.set(this.buffer);};_8.prototype.updateData=function updateData(_d){var gl=this.context.gl;this.bind();gl.bufferSubData(gl.ARRAY_BUFFER,0,_d.arrayBuffer);};_8.prototype.enableAttributes=function enableAttributes(gl,_e){for(var j=0;j<this.attributes.length;j++){var _f=this.attributes[j];var _10=_e.attributes[_f.name];if(_10!==undefined){gl.enableVertexAttribArray(_10);}}};_8.prototype.setVertexAttribPointers=function setVertexAttribPointers(gl,_11,_12){for(var j=0;j<this.attributes.length;j++){var _13=this.attributes[j];var _14=_11.attributes[_13.name];if(_14!==undefined){gl.vertexAttribPointer(_14,_13.components,(gl)[_2.AttributeType[_13.type]],false,this.itemSize,_13.offset+(this.itemSize*(_12||0)));}}};_8.prototype.destroy=function destroy(){var gl=this.context.gl;if(this.buffer){gl.deleteBuffer(this.buffer);delete this.buffer;}};f.VertexBuffer=_8;var _15=function _15(_16,_17,_18){this.context=_16;this.width=_17;this.height=_18;var gl=_16.gl;var fbo=this.framebuffer=gl.createFramebuffer();this.colorAttachment=new _1.ColorAttachment(_16,fbo);this.depthAttachment=new _1.DepthAttachment(_16,fbo);};_15.prototype.destroy=function destroy(){var gl=this.context.gl;var _19=this.colorAttachment.get();if(_19){gl.deleteTexture(_19);}var _1a=this.depthAttachment.get();if(_1a){gl.deleteRenderbuffer(_1a);}gl.deleteFramebuffer(this.framebuffer);};f.Framebuffer=_15;});