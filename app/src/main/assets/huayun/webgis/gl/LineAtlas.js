//>>built
define("com/huayun/webgis/gl/LineAtlas",[],function(){var _1=function _1(_2,_3){this.width=_2;this.height=_3;this.nextRow=0;this.bytes=4;this.data=new Uint8Array(this.width*this.height*this.bytes);this.positions={};};_1.prototype.getDash=function getDash(_4,_5){var _6=_4.join(",")+String(_5);if(!this.positions[_6]){this.positions[_6]=this.addDash(_4,_5);}return this.positions[_6];};_1.prototype.addDash=function addDash(_7,_8){var n=_8?7:0;var _9=2*n+1;var _a=128;if(this.nextRow+_9>this.height){return null;}var _b=0;for(var i=0;i<_7.length;i++){_b+=_7[i];}var _c=this.width/_b;var _d=_c/2;var _e=_7.length%2===1;for(var y=-n;y<=n;y++){var _f=this.nextRow+n+y;var _10=this.width*_f;var _11=_e?-_7[_7.length-1]:0;var _12=_7[0];var _13=1;for(var x=0;x<this.width;x++){while(_12<x/_c){_11=_12;_12=_12+_7[_13];if(_e&&_13===_7.length-1){_12+=_7[0];}_13++;}var _14=Math.abs(x-_11*_c);var _15=Math.abs(x-_12*_c);var _16=Math.min(_14,_15);var _17=(_13%2)===1;var _18=(void 0);if(_8){var _19=n?y/n*(_d+1):0;if(_17){var _1a=_d-Math.abs(_19);_18=Math.sqrt(_16*_16+_1a*_1a);}else{_18=_d-Math.sqrt(_16*_16+_19*_19);}}else{_18=(_17?1:-1)*_16;}this.data[3+(_10+x)*4]=Math.max(0,Math.min(255,_18+_a));}}var pos={y:(this.nextRow+n+0.5)/this.height,height:2*n/this.height,width:_b};this.nextRow+=_9;this.dirty=true;return pos;};_1.prototype.bind=function bind(_1b){var gl=_1b.gl;if(!this.texture){this.texture=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,this.texture);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.REPEAT);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,this.width,this.height,0,gl.RGBA,gl.UNSIGNED_BYTE,this.data);}else{gl.bindTexture(gl.TEXTURE_2D,this.texture);if(this.dirty){this.dirty=false;gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,this.width,this.height,gl.RGBA,gl.UNSIGNED_BYTE,this.data);}}};return _1;});