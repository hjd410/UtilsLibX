//>>built
define("com/huayun/webgis/gl/Context",["./BaseValue","./Buffer","./mode","../utils/utils"],function(_1,_2,_3,_4){var id=0;function _5(gl){this.id=id++;this.gl=gl;this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object");this.clearColor=new _1.ClearColor(this);this.colorMask=new _1.ColorMask(this);this.clearDepth=new _1.ClearDepth(this);this.depthRange=new _1.DepthRange(this);this.depthMask=new _1.DepthMask(this);this.depthTest=new _1.DepthTest(this);this.depthFunc=new _1.DepthFunc(this);this.cullFace=new _1.CullFace(this);this.cullFaceSide=new _1.CullFaceSide(this);this.blend=new _1.Blend(this);this.blendFunc=new _1.BlendFunc(this);this.blendColor=new _1.BlendColor(this);this.blendEquation=new _1.BlendEquation(this);this.clearStencil=new _1.ClearStencil(this);this.stencilMask=new _1.StencilMask(this);this.stencilFunc=new _1.StencilFunc(this);this.stencilOp=new _1.StencilOp(this);this.stencilTest=new _1.StencilTest(this);this.frontFace=new _1.FrontFace(this);this.program=new _1.Program(this);this.activeTexture=new _1.ActiveTextureUnit(this);this.viewport=new _1.Viewport(this);this.bindFramebuffer=new _1.BindFramebuffer(this);this.bindRenderbuffer=new _1.BindRenderbuffer(this);this.bindTexture=new _1.BindTexture(this);this.bindVertexArrayOES=this.extVertexArrayObject&&new _1.BindVertexArrayOES(this);this.bindElementBuffer=new _1.BindElementBuffer(this);this.bindVertexBuffer=new _1.BindVertexBuffer(this);this.pixelStoreUnpack=new _1.PixelStoreUnpack(this);this.pixelStoreUnpackPremultiplyAlpha=new _1.PixelStoreUnpackPremultiplyAlpha(this);this.pixelStoreUnpackFlipY=new _1.PixelStoreUnpackFlipY(this);this.extTextureFilterAnisotropic=(gl.getExtension("EXT_texture_filter_anisotropic")||gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"));if(this.extTextureFilterAnisotropic){this.extTextureFilterAnisotropicMax=gl.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT);}this.extTextureHalfFloat=gl.getExtension("OES_texture_half_float");if(this.extTextureHalfFloat){gl.getExtension("OES_texture_half_float_linear");}this.elementIndexUint=gl.getExtension("OES_element_index_uint");this.extInstancedArray=gl.getExtension("ANGLE_instanced_arrays");};_5.prototype.setDefault=function setDefault(){this.unbindVAO();this.clearColor.setDefault();this.clearDepth.setDefault();this.clearStencil.setDefault();this.colorMask.setDefault();this.stencilMask.setDefault();this.stencilFunc.setDefault();this.stencilOp.setDefault();this.stencilTest.setDefault();this.depthMask.setDefault();this.depthRange.setDefault();this.depthTest.setDefault();this.depthFunc.setDefault();this.blend.setDefault();this.blendFunc.setDefault();this.blendColor.setDefault();this.blendEquation.setDefault();this.cullFace.setDefault();this.cullFaceSide.setDefault();this.frontFace.setDefault();this.program.setDefault();this.activeTexture.setDefault();this.bindFramebuffer.setDefault();this.pixelStoreUnpack.setDefault();this.pixelStoreUnpackPremultiplyAlpha.setDefault();this.pixelStoreUnpackFlipY.setDefault();};_5.prototype.setBasic=function setBasic(){this.clearColor.setDefault();this.clearDepth.setDefault();this.clearStencil.setDefault();this.colorMask.setDefault();this.stencilMask.setDefault();this.stencilFunc.setDefault();this.stencilOp.setDefault();this.stencilTest.setDefault();this.depthMask.setDefault();this.depthRange.setDefault();this.depthTest.setDefault();this.depthFunc.setDefault();this.blend.setDefault();this.blendFunc.setDefault();this.blendColor.setDefault();this.blendEquation.setDefault();this.cullFace.setDefault();this.cullFaceSide.setDefault();this.frontFace.setDefault();this.program.setDefault();this.activeTexture.setDefault();this.bindFramebuffer.setDefault();this.pixelStoreUnpack.setDefault();this.pixelStoreUnpackPremultiplyAlpha.setDefault();this.pixelStoreUnpackFlipY.setDefault();};_5.prototype.setDirty=function setDirty(){this.clearColor.dirty=true;this.clearDepth.dirty=true;this.clearStencil.dirty=true;this.colorMask.dirty=true;this.depthMask.dirty=true;this.stencilMask.dirty=true;this.stencilFunc.dirty=true;this.stencilOp.dirty=true;this.stencilTest.dirty=true;this.depthRange.dirty=true;this.depthTest.dirty=true;this.depthFunc.dirty=true;this.blend.dirty=true;this.blendFunc.dirty=true;this.blendColor.dirty=true;this.blendEquation.dirty=true;this.cullFace.dirty=true;this.cullFaceSide.dirty=true;this.frontFace.dirty=true;this.program.dirty=true;this.activeTexture.dirty=true;this.viewport.dirty=true;this.bindFramebuffer.dirty=true;this.bindRenderbuffer.dirty=true;this.bindTexture.dirty=true;this.bindVertexBuffer.dirty=true;this.bindElementBuffer.dirty=true;if(this.extVertexArrayObject){this.bindVertexArrayOES.dirty=true;}this.pixelStoreUnpack.dirty=true;this.pixelStoreUnpackPremultiplyAlpha.dirty=true;this.pixelStoreUnpackFlipY.dirty=true;};_5.prototype.createIndexBuffer=function createIndexBuffer(_6,_7){return new _2.IndexBuffer(this,_6,_7);};_5.prototype.createVertexBuffer=function createVertexBuffer(_8,_9,_a){return new _2.VertexBuffer(this,_8,_9,_a);};_5.prototype.createRenderbuffer=function createRenderbuffer(_b,_c,_d){var gl=this.gl;var _e=gl.createRenderbuffer();this.bindRenderbuffer.set(_e);gl.renderbufferStorage(gl.RENDERBUFFER,_b,_c,_d);this.bindRenderbuffer.set(null);return _e;};_5.prototype.createFramebuffer=function createFramebuffer(_f,_10){return new _2.Framebuffer(this,_f,_10);};_5.prototype.clear=function clear(ref){var _11=ref.color;var _12=ref.depth;var gl=this.gl;var _13=0;if(_11){_13|=gl.COLOR_BUFFER_BIT;this.clearColor.set(_11);this.colorMask.set([true,true,true,true]);}if(typeof _12!=="undefined"){_13|=gl.DEPTH_BUFFER_BIT;this.depthRange.set([0,1]);this.clearDepth.set(_12);this.depthMask.set(true);}gl.clear(_13);};_5.prototype.setCullFace=function setCullFace(_14){if(_14.enable===false){this.cullFace.set(false);}else{this.cullFace.set(true);this.cullFaceSide.set(_14.mode);this.frontFace.set(_14.frontFace);}};_5.prototype.setDepthMode=function setDepthMode(_15){if(_15.func===this.gl.ALWAYS&&!_15.mask){this.depthTest.set(false);}else{this.depthTest.set(true);this.depthFunc.set(_15.func);this.depthMask.set(_15.mask);this.depthRange.set(_15.range);}};_5.prototype.setStencilMode=function setStencilMode(_16){if(_16.test.func===this.gl.ALWAYS&&!_16.mask){this.stencilTest.set(false);}else{this.stencilTest.set(true);this.stencilMask.set(_16.mask);this.stencilOp.set([_16.fail,_16.depthFail,_16.pass]);this.stencilFunc.set({func:_16.test.func,ref:_16.ref,mask:_16.test.mask});}};_5.prototype.setColorMode=function setColorMode(_17){if(_4.deepEqual(_17.blendFunction,_3.ColorMode.Replace)){this.blend.set(false);}else{this.blend.set(true);this.blendFunc.set(_17.blendFunction);this.blendColor.set(_17.blendColor);}this.colorMask.set(_17.mask);};_5.prototype.unbindVAO=function(){if(this.extVertexArrayObject){this.bindVertexArrayOES.set(null);}};return _5;});